"use strict";(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[9017],{9017:(O,p,a)=>{a.r(p),a.d(p,{ChatConversationsComponent:()=>w});var t=a(1360),d=a(2881),i=a(9417),v=a(1910),C=a(5207),f=a(5953),c=a(1141),u=a(6221),m=a(935),_=a(8150),h=a(2242),g=a(5716),E=a(5779);const F=()=>["/chat"],x=()=>["/chat/analytics"];function R(o,r){if(1&o&&(t.j41(0,"div",17)(1,"div",18)(2,"p",19),t.EFF(3,"Loaded Conversations"),t.k0s(),t.j41(4,"p",6),t.EFF(5),t.k0s()(),t.j41(6,"div",18)(7,"p",19),t.EFF(8,"Open"),t.k0s(),t.j41(9,"p",20),t.EFF(10),t.k0s()(),t.j41(11,"div",18)(12,"p",19),t.EFF(13,"Resolved"),t.k0s(),t.j41(14,"p",21),t.EFF(15),t.k0s()(),t.j41(16,"div",18)(17,"p",19),t.EFF(18,"Escalated"),t.k0s(),t.j41(19,"p",22),t.EFF(20),t.k0s()()()),2&o){const e=t.XpG();t.R7$(5),t.JRh(e.filteredConversations.length),t.R7$(5),t.JRh(e.countByStatus("open")),t.R7$(5),t.JRh(e.countByStatus("resolved")),t.R7$(5),t.JRh(e.countEscalated())}}function b(o,r){if(1&o){const e=t.RV6();t.j41(0,"div",1)(1,"div",23)(2,"div",24)(3,"label",25),t.EFF(4,"Search"),t.k0s(),t.j41(5,"span",26),t.nrm(6,"i",27),t.j41(7,"input",28),t.mxI("ngModelChange",function(n){t.eBV(e);const l=t.XpG();return t.DH7(l.searchTerm,n)||(l.searchTerm=n),t.Njj(n)}),t.bIt("input",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.applyFilters())}),t.k0s()()(),t.j41(8,"div",24)(9,"label",25),t.EFF(10,"Status"),t.k0s(),t.j41(11,"p-dropdown",29),t.mxI("ngModelChange",function(n){t.eBV(e);const l=t.XpG();return t.DH7(l.selectedStatus,n)||(l.selectedStatus=n),t.Njj(n)}),t.bIt("onChange",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.applyFilters())}),t.k0s()(),t.j41(12,"div",24)(13,"label",25),t.EFF(14,"Platform"),t.k0s(),t.j41(15,"p-dropdown",30),t.mxI("ngModelChange",function(n){t.eBV(e);const l=t.XpG();return t.DH7(l.selectedPlatform,n)||(l.selectedPlatform=n),t.Njj(n)}),t.bIt("onChange",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.applyFilters())}),t.k0s()()(),t.j41(16,"div",31)(17,"p-button",32),t.bIt("onClick",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.clearFilters())}),t.k0s()()()}if(2&o){const e=t.XpG();t.R7$(7),t.R50("ngModel",e.searchTerm),t.R7$(4),t.Y8G("options",e.statusOptions),t.R50("ngModel",e.selectedStatus),t.Y8G("showClear",!0),t.R7$(4),t.Y8G("options",e.platformOptions),t.R50("ngModel",e.selectedPlatform),t.Y8G("showClear",!0),t.R7$(2),t.Y8G("outlined",!0)}}function j(o,r){1&o&&(t.j41(0,"div",18)(1,"div",33),t.nrm(2,"p-skeleton",34)(3,"p-skeleton",34)(4,"p-skeleton",34),t.k0s()())}function y(o,r){1&o&&(t.j41(0,"tr")(1,"th"),t.EFF(2,"Customer"),t.k0s(),t.j41(3,"th"),t.EFF(4,"Platform"),t.k0s(),t.j41(5,"th"),t.EFF(6,"Status"),t.k0s(),t.j41(7,"th"),t.EFF(8,"Agent"),t.k0s(),t.j41(9,"th"),t.EFF(10,"Sentiment"),t.k0s(),t.j41(11,"th"),t.EFF(12,"Messages"),t.k0s(),t.j41(13,"th"),t.EFF(14,"Last Message"),t.k0s()())}function k(o,r){if(1&o&&(t.j41(0,"tr")(1,"td")(2,"div",39)(3,"span",40),t.EFF(4),t.k0s(),t.j41(5,"span",41),t.EFF(6),t.k0s()()(),t.j41(7,"td"),t.nrm(8,"p-tag",42),t.k0s(),t.j41(9,"td"),t.nrm(10,"p-tag",43),t.k0s(),t.j41(11,"td"),t.EFF(12),t.k0s(),t.j41(13,"td"),t.nrm(14,"p-tag",43),t.k0s(),t.j41(15,"td"),t.EFF(16),t.k0s(),t.j41(17,"td",44)(18,"div",45),t.EFF(19),t.k0s(),t.j41(20,"div",46),t.EFF(21),t.nI1(22,"date"),t.k0s()()()),2&o){const e=r.$implicit,s=t.XpG(2);t.R7$(4),t.JRh(e.user_name),t.R7$(2),t.JRh(e.user_id),t.R7$(2),t.Y8G("value",e.platform),t.R7$(2),t.Y8G("value",e.status)("severity",s.getStatusSeverity(e.status)),t.R7$(2),t.JRh(e.agent||"Unassigned"),t.R7$(2),t.Y8G("value",e.sentiment)("severity",s.getSentimentSeverity(e.sentiment)),t.R7$(2),t.JRh(e.message_count),t.R7$(2),t.Y8G("title",e.last_message),t.R7$(),t.JRh(e.last_message),t.R7$(2),t.JRh(t.i5U(22,12,e.last_message_time,"short"))}}function M(o,r){if(1&o&&(t.j41(0,"div",35)(1,"p-table",36),t.DNE(2,y,15,0,"ng-template",37)(3,k,23,15,"ng-template",38),t.k0s()()),2&o){const e=t.XpG();t.R7$(),t.Y8G("value",e.filteredConversations)("paginator",!0)("rows",10)("showCurrentPageReport",!0)}}let w=(()=>{class o{chatService=(0,t.WQX)(f.m);router=(0,t.WQX)(v.Ix);loading=!1;showFilters=!1;totalRecords=0;conversations=[];filteredConversations=[];searchTerm="";selectedStatus=null;selectedPlatform=null;statusOptions=[{label:"Open",value:"open"},{label:"Resolved",value:"resolved"},{label:"Pending",value:"pending"},{label:"Escalated",value:"escalated"}];platformOptions=[{label:"Web",value:"web"},{label:"Mobile",value:"mobile"},{label:"Slack",value:"slack"},{label:"Email",value:"email"}];ngOnInit(){this.loadConversations()}loadConversations(){this.loading=!0,this.chatService.getConversations(100,0).subscribe({next:e=>{this.conversations=e.data||[],this.totalRecords=e.total||this.conversations.length,this.syncPlatformOptions(),this.applyFilters(),this.loading=!1},error:e=>{console.error("Error loading conversations",e),this.loading=!1}})}syncPlatformOptions(){const e=Array.from(new Set(this.conversations.map(s=>s.platform).filter(Boolean)));this.platformOptions=e.map(s=>({label:this.toTitle(s),value:s}))}applyFilters(){const e=this.searchTerm.trim().toLowerCase();this.filteredConversations=this.conversations.filter(s=>{const n=!this.selectedStatus||s.status===this.selectedStatus,l=!this.selectedPlatform||s.platform===this.selectedPlatform,P=`${s.user_name} ${s.agent||""} ${s.platform} ${s.last_message}`.toLowerCase(),T=!e||P.includes(e);return n&&l&&T})}clearFilters(){this.searchTerm="",this.selectedStatus=null,this.selectedPlatform=null,this.applyFilters()}countByStatus(e){return this.filteredConversations.filter(s=>s.status===e).length}countEscalated(){return this.filteredConversations.filter(e=>e.escalated).length}getStatusSeverity(e){switch((e||"").toLowerCase()){case"resolved":return"success";case"open":return"info";case"pending":return"warn";case"escalated":return"danger";default:return"secondary"}}getSentimentSeverity(e){switch((e||"").toLowerCase()){case"positive":return"success";case"neutral":return"info";case"negative":return"danger";default:return"secondary"}}toTitle(e){return e&&e.charAt(0).toUpperCase()+e.slice(1)}static \u0275fac=function(s){return new(s||o)};static \u0275cmp=t.VBU({type:o,selectors:[["app-chat-conversations"]],decls:20,vars:14,consts:[[1,"bg-gray-50","min-h-screen","p-6"],[1,"bg-white","rounded-lg","shadow-sm","p-6","mb-6"],[1,"flex","items-center","justify-between","flex-wrap","gap-4"],[1,"flex","items-center","gap-4"],[1,"w-12","h-12","bg-gradient-to-br","from-blue-500","to-cyan-600","rounded-lg","flex","items-center","justify-center"],[1,"pi","pi-comments","text-white","text-xl"],[1,"text-3xl","font-bold","text-gray-900"],[1,"text-gray-600","m-0"],[1,"flex","flex-wrap","items-center","gap-2","sm:gap-3"],["icon","pi pi-refresh","severity","info",1,"hidden","sm:inline-flex",3,"onClick","outlined","rounded"],["icon","pi pi-filter","severity","secondary",1,"hidden","sm:inline-flex",3,"onClick","outlined","rounded"],["label","Dashboard","icon","pi pi-home","severity","secondary",1,"hidden","sm:inline-flex",3,"outlined","routerLink"],["label","Analytics","icon","pi pi-chart-bar","severity","secondary",1,"hidden","sm:inline-flex",3,"outlined","routerLink"],["class","grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6 mb-6",4,"ngIf"],["class","bg-white rounded-lg shadow-sm p-6 mb-6",4,"ngIf"],["class","bg-white rounded-lg shadow-sm p-6",4,"ngIf"],["class","bg-white rounded-lg shadow-sm overflow-hidden",4,"ngIf"],[1,"grid","grid-cols-1","md:grid-cols-2","xl:grid-cols-4","gap-6","mb-6"],[1,"bg-white","rounded-lg","shadow-sm","p-6"],[1,"text-sm","font-medium","text-gray-600"],[1,"text-3xl","font-bold","text-blue-600"],[1,"text-3xl","font-bold","text-green-600"],[1,"text-3xl","font-bold","text-red-600"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"flex","flex-col","gap-2"],[1,"text-sm","font-medium","text-gray-700"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["type","text","pInputText","","placeholder","Search by user, agent, platform",1,"w-full",3,"ngModelChange","input","ngModel"],["optionLabel","label","optionValue","value","placeholder","All statuses",1,"w-full",3,"ngModelChange","onChange","options","ngModel","showClear"],["optionLabel","label","optionValue","value","placeholder","All platforms",1,"w-full",3,"ngModelChange","onChange","options","ngModel","showClear"],[1,"flex","justify-end","gap-2","mt-4"],["label","Clear","icon","pi pi-filter-slash","severity","secondary",3,"onClick","outlined"],[1,"space-y-4"],["height","4rem"],[1,"bg-white","rounded-lg","shadow-sm","overflow-hidden"],["styleClass","p-datatable-sm","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} conversations",3,"value","paginator","rows","showCurrentPageReport"],["pTemplate","header"],["pTemplate","body"],[1,"flex","flex-col"],[1,"font-medium","text-gray-900"],[1,"text-xs","text-gray-500"],["severity","info",3,"value"],[3,"value","severity"],[1,"max-w-80"],[1,"text-sm","text-gray-600","truncate",3,"title"],[1,"text-xs","text-gray-400"]],template:function(s,n){1&s&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),t.nrm(5,"i",5),t.k0s(),t.j41(6,"div")(7,"h1",6),t.EFF(8,"Conversations"),t.k0s(),t.j41(9,"p",7),t.EFF(10,"Monitor live conversations and agent assignment status"),t.k0s()()(),t.j41(11,"div",8)(12,"p-button",9),t.bIt("onClick",function(){return n.loadConversations()}),t.k0s(),t.j41(13,"p-button",10),t.bIt("onClick",function(){return n.showFilters=!n.showFilters}),t.k0s(),t.nrm(14,"p-button",11)(15,"p-button",12),t.k0s()()(),t.DNE(16,R,21,4,"div",13)(17,b,18,8,"div",14)(18,j,5,0,"div",15)(19,M,4,4,"div",16),t.k0s()),2&s&&(t.R7$(12),t.Y8G("outlined",!0)("rounded",!0),t.R7$(),t.Y8G("outlined",!n.showFilters)("rounded",!0),t.R7$(),t.Y8G("outlined",!0)("routerLink",t.lJ4(12,F)),t.R7$(),t.Y8G("outlined",!0)("routerLink",t.lJ4(13,x)),t.R7$(),t.Y8G("ngIf",!n.loading),t.R7$(),t.Y8G("ngIf",n.showFilters),t.R7$(),t.Y8G("ngIf",n.loading),t.R7$(),t.Y8G("ngIf",!n.loading))},dependencies:[d.MD,d.bT,d.vh,i.YN,i.me,i.BC,i.vS,C.Wk,c.tm,c.$n,E.Ei,u.bG,u.XI,m.$C,m.vw,_.kr,_.ms,h.um,h.Sm,g.k2,g.EA],encapsulation:2})}return o})()}}]);