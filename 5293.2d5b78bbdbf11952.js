"use strict";(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[5293],{5293:(E,p,l)=>{l.r(p),l.d(p,{RetailShopComponent:()=>R});var d=l(2881),c=l(9417),u=l(1141),m=l(2242),g=l(8150),_=l(8533),t=l(1360);function h(o,s){if(1&o&&(t.j41(0,"div",36),t.EFF(1),t.k0s()),2&o){const e=t.XpG();t.R7$(),t.SpI(" ",e.error," ")}}function b(o,s){1&o&&(t.j41(0,"div",37),t.EFF(1," Loading products... "),t.k0s())}function f(o,s){1&o&&(t.j41(0,"div",37),t.EFF(1," No products found. "),t.k0s())}function x(o,s){if(1&o&&(t.j41(0,"span",50),t.EFF(1),t.k0s()),2&o){const e=t.XpG().$implicit,i=t.XpG(2);t.R7$(),t.JRh(i.formatCurrency(e.price))}}function v(o,s){if(1&o){const e=t.RV6();t.j41(0,"article",40)(1,"div",41),t.EFF(2),t.k0s(),t.j41(3,"div",42)(4,"div",43)(5,"h3",27),t.EFF(6),t.k0s(),t.j41(7,"span",44),t.EFF(8),t.k0s()(),t.j41(9,"p",45),t.EFF(10),t.k0s()(),t.j41(11,"div",46)(12,"div",17)(13,"span",47),t.EFF(14),t.k0s(),t.DNE(15,x,2,1,"span",48),t.k0s(),t.j41(16,"p-button",49),t.bIt("onClick",function(){const r=t.eBV(e).$implicit,n=t.XpG(2);return t.Njj(n.addToCart(r))}),t.k0s()()()}if(2&o){const e=s.$implicit,i=t.XpG(2);t.R7$(2),t.SpI(" ",e.name.charAt(0)," "),t.R7$(4),t.JRh(e.name),t.R7$(2),t.JRh(e.category),t.R7$(2),t.JRh(e.description||"No description available."),t.R7$(4),t.JRh(i.formatCurrency(i.getDisplayPrice(e))),t.R7$(),t.Y8G("ngIf",e.discountPrice>0)}}function y(o,s){if(1&o&&(t.j41(0,"div",38),t.DNE(1,v,17,6,"article",39),t.k0s()),2&o){const e=t.XpG();t.R7$(),t.Y8G("ngForOf",e.filteredProducts)}}function C(o,s){1&o&&(t.j41(0,"div",51),t.EFF(1," Cart is empty. "),t.k0s())}function k(o,s){if(1&o){const e=t.RV6();t.j41(0,"div",54)(1,"div",55)(2,"div")(3,"p",56),t.EFF(4),t.k0s(),t.j41(5,"p",28),t.EFF(6),t.k0s()(),t.j41(7,"button",57),t.bIt("click",function(){const r=t.eBV(e).$implicit,n=t.XpG(2);return t.Njj(n.removeItem(r))}),t.nrm(8,"i",58),t.k0s()(),t.j41(9,"div",59)(10,"div",60)(11,"button",61),t.bIt("click",function(){const r=t.eBV(e).$implicit,n=t.XpG(2);return t.Njj(n.decreaseQty(r))}),t.EFF(12,"-"),t.k0s(),t.j41(13,"span",62),t.EFF(14),t.k0s(),t.j41(15,"button",61),t.bIt("click",function(){const r=t.eBV(e).$implicit,n=t.XpG(2);return t.Njj(n.increaseQty(r))}),t.EFF(16,"+"),t.k0s()(),t.j41(17,"p",63),t.EFF(18),t.k0s()()()}if(2&o){const e=s.$implicit,i=t.XpG(2);t.R7$(4),t.JRh(e.product.name),t.R7$(2),t.JRh(i.formatCurrency(i.getDisplayPrice(e.product))),t.R7$(8),t.JRh(e.quantity),t.R7$(4),t.SpI(" ",i.formatCurrency(i.getDisplayPrice(e.product)*e.quantity)," ")}}function F(o,s){if(1&o&&(t.j41(0,"div",52),t.DNE(1,k,19,4,"div",53),t.k0s()),2&o){const e=t.XpG();t.R7$(),t.Y8G("ngForOf",e.cart)}}let R=(()=>{class o{productService;categoryService;loading=!1;error="";products=[];categories=[{label:"All categories",value:""}];searchTerm="";selectedCategory="";cart=[];constructor(e,i){this.productService=e,this.categoryService=i}ngOnInit(){this.loadCategories(),this.loadProducts()}get filteredProducts(){const e=this.searchTerm.trim().toLowerCase();return this.products.filter(i=>(!e||i.name.toLowerCase().includes(e)||i.category.toLowerCase().includes(e)||i.description.toLowerCase().includes(e)||i.sku.toLowerCase().includes(e)||i.barcode.toLowerCase().includes(e))&&(!this.selectedCategory||i.category===this.selectedCategory))}get totalCartItems(){return this.cart.reduce((e,i)=>e+i.quantity,0)}get cartSubtotal(){return this.cart.reduce((e,i)=>e+this.getDisplayPrice(i.product)*i.quantity,0)}get cartTax(){return.1*this.cartSubtotal}get cartTotal(){return this.cartSubtotal+this.cartTax}loadProducts(){this.loading=!0,this.error="",this.productService.listProducts(void 0,0,100).subscribe({next:e=>{const i=Array.isArray(e?.data)?e.data:[];this.products=i.map(r=>this.mapProduct(r)).filter(r=>r.isActive),this.products.length||(this.products=this.getFallbackProducts(),this.error="Product API returned no active products. Showing demo products."),this.loading=!1},error:()=>{this.products=this.getFallbackProducts(),this.error="Cannot load products from API. Showing demo products.",this.loading=!1}})}loadCategories(){this.categoryService.listCategories(0,100).subscribe({next:e=>{const r=(Array.isArray(e?.data)?e.data:[]).map(a=>String(a?.name||"").trim()).filter(a=>!!a),n=[...new Set(r)];this.categories=[{label:"All categories",value:""},...n.map(a=>({label:a,value:a}))]},error:()=>{this.categories=[{label:"All categories",value:""},{label:"Essentials",value:"Essentials"},{label:"Lifestyle",value:"Lifestyle"},{label:"Electronics",value:"Electronics"}]}})}addToCart(e){const i=this.cart.find(r=>r.product.id===e.id);i?i.quantity+=1:this.cart.unshift({product:e,quantity:1})}increaseQty(e){e.quantity+=1}decreaseQty(e){e.quantity-=1,e.quantity<=0&&this.removeItem(e)}removeItem(e){this.cart=this.cart.filter(i=>i.product.id!==e.product.id)}clearFilters(){this.searchTerm="",this.selectedCategory=""}checkoutDemo(){this.cart.length&&alert("Demo checkout. Integrate real checkout API later.")}formatCurrency(e){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:2}).format(e||0)}getDisplayPrice(e){return e.discountPrice>0?e.discountPrice:e.price}mapProduct(e){const i=String(e?._id||e?.id||""),r=Number(e?.selling_price??e?.price??0),n=Number(e?.discount_price??0);return{id:i,name:String(e?.name||"Unnamed product"),category:String(e?.category||"Uncategorized"),description:String(e?.description||""),price:r,discountPrice:n,isActive:!1!==e?.is_active,sku:String(e?.sku||""),barcode:String(e?.barcode||"")}}getFallbackProducts(){return[{id:"demo-1",name:"Smart Home Camera",category:"Electronics",description:"Indoor camera with motion alerts and cloud backup.",price:89,discountPrice:69,isActive:!0,sku:"EL-0001",barcode:"100001"},{id:"demo-2",name:"Travel Backpack 28L",category:"Lifestyle",description:"Lightweight daily backpack with laptop compartment.",price:59,discountPrice:0,isActive:!0,sku:"LS-0015",barcode:"100002"},{id:"demo-3",name:"Vitamin C Serum",category:"Essentials",description:"Daily skincare serum for brightening and hydration.",price:34,discountPrice:29,isActive:!0,sku:"ES-0042",barcode:"100003"}]}static \u0275fac=function(i){return new(i||o)(t.rXU(_.bk),t.rXU(_.M$))};static \u0275cmp=t.VBU({type:o,selectors:[["app-retail-shop"]],decls:62,vars:16,consts:[[1,"min-h-screen","bg-slate-50"],[1,"bg-gradient-to-r","from-sky-700","via-cyan-600","to-emerald-600","text-white"],[1,"max-w-7xl","mx-auto","px-6","py-10","lg:py-14"],[1,"flex","flex-col","lg:flex-row","lg:items-center","lg:justify-between","gap-6"],[1,"text-cyan-100","text-sm","font-semibold","uppercase","tracking-wider"],[1,"text-3xl","lg:text-4xl","font-bold","mt-2"],[1,"text-cyan-50","mt-2","max-w-2xl"],[1,"bg-white/15","rounded-xl","px-4","py-3"],[1,"text-sm","text-cyan-50"],[1,"text-2xl","font-bold"],[1,"max-w-7xl","mx-auto","p-6"],["class","mb-4 rounded-lg border border-amber-200 bg-amber-50 text-amber-700 px-4 py-3 text-sm",4,"ngIf"],[1,"bg-white","border","border-slate-200","rounded-xl","p-4","mb-6"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-3"],[1,"text-xs","text-slate-500","mb-1","block"],["pInputText","","placeholder","Search products, SKU, category...",1,"w-full",3,"ngModelChange","ngModel"],["optionLabel","label","optionValue","value",1,"w-full",3,"ngModelChange","options","ngModel"],[1,"flex","items-end","gap-2"],["label","Clear","severity","secondary",3,"onClick","outlined"],["label","Reload","icon","pi pi-refresh",3,"onClick"],[1,"grid","grid-cols-1","xl:grid-cols-12","gap-6"],[1,"xl:col-span-8"],["class","bg-white rounded-xl border border-slate-200 p-12 text-center text-slate-500",4,"ngIf"],["class","grid grid-cols-1 md:grid-cols-2 gap-4",4,"ngIf"],[1,"xl:col-span-4"],[1,"bg-white","border","border-slate-200","rounded-xl","p-4","sticky","top-4"],[1,"flex","items-center","justify-between","mb-3"],[1,"font-semibold","text-slate-900"],[1,"text-xs","text-slate-500"],["class","text-sm text-slate-500 py-8 text-center",4,"ngIf"],["class","space-y-3 max-h-[24rem] overflow-auto pr-1",4,"ngIf"],[1,"mt-4","pt-4","border-t","border-slate-200"],[1,"flex","justify-between","text-sm","text-slate-600","mb-1"],[1,"flex","justify-between","text-sm","text-slate-600","mb-2"],[1,"flex","justify-between","text-base","font-bold","text-slate-900","mb-3"],["label","Checkout (Demo)","icon","pi pi-credit-card","styleClass","w-full",3,"onClick","disabled"],[1,"mb-4","rounded-lg","border","border-amber-200","bg-amber-50","text-amber-700","px-4","py-3","text-sm"],[1,"bg-white","rounded-xl","border","border-slate-200","p-12","text-center","text-slate-500"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["class","bg-white border border-slate-200 rounded-xl p-4 flex flex-col",4,"ngFor","ngForOf"],[1,"bg-white","border","border-slate-200","rounded-xl","p-4","flex","flex-col"],[1,"w-full","h-32","rounded-lg","bg-gradient-to-br","from-cyan-100","to-indigo-100","text-indigo-700","flex","items-center","justify-center","text-3xl","font-bold","mb-3"],[1,"flex-1"],[1,"flex","items-start","justify-between","gap-3"],[1,"text-xs","px-2","py-1","rounded-full","bg-slate-100","text-slate-700"],[1,"text-sm","text-slate-600","mt-2","min-h-[2.5rem]"],[1,"mt-3","flex","items-center","justify-between"],[1,"text-lg","font-bold","text-slate-900"],["class","text-sm text-slate-400 line-through",4,"ngIf"],["label","Add to cart","icon","pi pi-shopping-cart","size","small",3,"onClick"],[1,"text-sm","text-slate-400","line-through"],[1,"text-sm","text-slate-500","py-8","text-center"],[1,"space-y-3","max-h-[24rem]","overflow-auto","pr-1"],["class","border border-slate-200 rounded-lg p-3",4,"ngFor","ngForOf"],[1,"border","border-slate-200","rounded-lg","p-3"],[1,"flex","items-start","justify-between","gap-2"],[1,"text-sm","font-medium","text-slate-900"],["type","button",1,"text-slate-400","hover:text-red-500",3,"click"],[1,"pi","pi-trash"],[1,"mt-2","flex","items-center","justify-between"],[1,"flex","items-center","gap-2"],["type","button",1,"w-7","h-7","rounded","border","border-slate-300","hover:bg-slate-100",3,"click"],[1,"text-sm","font-medium","w-6","text-center"],[1,"text-sm","font-semibold","text-slate-900"]],template:function(i,r){1&i&&(t.j41(0,"div",0)(1,"section",1)(2,"div",2)(3,"div",3)(4,"div")(5,"p",4),t.EFF(6,"Public Storefront Demo"),t.k0s(),t.j41(7,"h1",5),t.EFF(8,"Retail Shop"),t.k0s(),t.j41(9,"p",6),t.EFF(10,"Customer-facing ecommerce page powered by existing Retail APIs."),t.k0s()(),t.j41(11,"div",7)(12,"p",8),t.EFF(13,"Cart items"),t.k0s(),t.j41(14,"p",9),t.EFF(15),t.k0s()()()()(),t.j41(16,"div",10),t.DNE(17,h,2,1,"div",11),t.j41(18,"div",12)(19,"div",13)(20,"div")(21,"label",14),t.EFF(22,"Search"),t.k0s(),t.j41(23,"input",15),t.mxI("ngModelChange",function(a){return t.DH7(r.searchTerm,a)||(r.searchTerm=a),a}),t.k0s()(),t.j41(24,"div")(25,"label",14),t.EFF(26,"Category"),t.k0s(),t.j41(27,"p-dropdown",16),t.mxI("ngModelChange",function(a){return t.DH7(r.selectedCategory,a)||(r.selectedCategory=a),a}),t.k0s()(),t.j41(28,"div",17)(29,"p-button",18),t.bIt("onClick",function(){return r.clearFilters()}),t.k0s(),t.j41(30,"p-button",19),t.bIt("onClick",function(){return r.loadProducts()}),t.k0s()()()(),t.j41(31,"div",20)(32,"div",21),t.DNE(33,b,2,0,"div",22)(34,f,2,0,"div",22)(35,y,2,1,"div",23),t.k0s(),t.j41(36,"aside",24)(37,"div",25)(38,"div",26)(39,"h2",27),t.EFF(40,"Shopping Cart"),t.k0s(),t.j41(41,"span",28),t.EFF(42),t.k0s()(),t.DNE(43,C,2,0,"div",29)(44,F,2,1,"div",30),t.j41(45,"div",31)(46,"div",32)(47,"span"),t.EFF(48,"Subtotal"),t.k0s(),t.j41(49,"span"),t.EFF(50),t.k0s()(),t.j41(51,"div",33)(52,"span"),t.EFF(53,"Tax (10%)"),t.k0s(),t.j41(54,"span"),t.EFF(55),t.k0s()(),t.j41(56,"div",34)(57,"span"),t.EFF(58,"Total"),t.k0s(),t.j41(59,"span"),t.EFF(60),t.k0s()(),t.j41(61,"p-button",35),t.bIt("onClick",function(){return r.checkoutDemo()}),t.k0s()()()()()()()),2&i&&(t.R7$(15),t.JRh(r.totalCartItems),t.R7$(2),t.Y8G("ngIf",r.error),t.R7$(6),t.R50("ngModel",r.searchTerm),t.R7$(4),t.Y8G("options",r.categories),t.R50("ngModel",r.selectedCategory),t.R7$(2),t.Y8G("outlined",!0),t.R7$(4),t.Y8G("ngIf",r.loading),t.R7$(),t.Y8G("ngIf",!r.loading&&0===r.filteredProducts.length),t.R7$(),t.Y8G("ngIf",!r.loading&&r.filteredProducts.length>0),t.R7$(7),t.SpI("",r.totalCartItems," items"),t.R7$(),t.Y8G("ngIf",0===r.cart.length),t.R7$(),t.Y8G("ngIf",r.cart.length>0),t.R7$(6),t.JRh(r.formatCurrency(r.cartSubtotal)),t.R7$(5),t.JRh(r.formatCurrency(r.cartTax)),t.R7$(5),t.JRh(r.formatCurrency(r.cartTotal)),t.R7$(),t.Y8G("disabled",0===r.cart.length))},dependencies:[d.MD,d.Sq,d.bT,c.YN,c.me,c.BC,c.vS,u.tm,u.$n,m.um,m.Sm,g.kr,g.ms],encapsulation:2})}return o})()}}]);