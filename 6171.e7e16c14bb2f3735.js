"use strict";(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[6171,8512],{2215:(F,b,g)=>{g.d(b,{G:()=>D});var f=g(8989),p=g(8810),e=g(6354),m=g(9437),E=g(1360),u=g(4412),y=g(1985);let C=(()=>{class _{configs={local:{environment:"local",host:"http://localhost:8081",name:"Local Development"},production:{environment:"production",host:"https://test-api.routing-deviation.ghn.tech",name:"Production API"}};currentConfigSubject=new u.t(this.configs.local);currentConfig$=this.currentConfigSubject.asObservable();constructor(){this.loadSavedConfig()}getCurrentConfig(){return this.currentConfigSubject.value}getHost(){return this.getCurrentConfig().host}getEnvironment(){return this.getCurrentConfig().environment}switchEnvironment(i){const a=this.configs[i];a&&(this.currentConfigSubject.next(a),this.saveConfig(a),console.log(`[API Config] Switched to ${a.name} (${a.host})`))}getAvailableConfigs(){return Object.values(this.configs)}isLocal(){return"local"===this.getEnvironment()}isProduction(){return"production"===this.getEnvironment()}testConnection(){const i=this.getHost(),a=`${i}/_`;return new y.c(l=>{fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}).then(d=>{l.next(d.ok?{success:!0,host:i}:{success:!1,host:i,status:d.status}),l.complete()}).catch(d=>{l.next({success:!1,host:i,error:d.message}),l.complete()})})}loadSavedConfig(){try{if(typeof window<"u"&&window.localStorage){const i=localStorage.getItem("api-config");if(i){const a=JSON.parse(i);a.environment&&this.configs[a.environment]&&this.currentConfigSubject.next(this.configs[a.environment])}}}catch(i){console.warn("[API Config] Failed to load saved config:",i)}}saveConfig(i){try{typeof window<"u"&&window.localStorage&&localStorage.setItem("api-config",JSON.stringify({environment:i.environment}))}catch(a){console.warn("[API Config] Failed to save config:",a)}}static \u0275fac=function(a){return new(a||_)};static \u0275prov=E.jDH({token:_,factory:_.\u0275fac,providedIn:"root"})}return _})(),D=(()=>{class _{http;apiConfig;defaultTimeout=3e4;authToken="ZCXb4Thq56HgXlQC4IKS4EcghaYt6xxmIoHdazBJgVBRAwYqbLhx9rE3QTuzIqpo";constructor(i,a){this.http=i,this.apiConfig=a}getAuthHeaders(){const i={"Content-Type":"application/json"},a=this.authToken;return a&&(i.Authorization=`Bearer ${a}`),new f.Lr(i)}getHost(){return this.apiConfig.getHost()}getUrl(i){return this.getHost()+(i.startsWith("/")?i:"/"+i)}handleError(i){let a;return a=typeof ErrorEvent<"u"&&i.error instanceof ErrorEvent?{status:0,message:"Network error",error:"NETWORK_ERROR"}:{status:i.status,message:i.error?.message||i.message||"Server error",error:i.error?.error||"SERVER_ERROR",data:i.error},console.error("[API Error]",a),(0,p.$)(()=>a)}transformResponse(i){return{ok:!0,status:200,data:i,message:"Success"}}get(i,a){const l=this.getUrl(i);let d=new f.Nl;return a&&Object.keys(a).forEach(h=>{null!=a[h]&&(d=d.set(h,a[h].toString()))}),console.log(`[API] GET ${l}`,a),this.http.get(l,{params:d,headers:this.getAuthHeaders()}).pipe((0,e.T)(h=>this.transformResponse(h)),(0,m.W)(h=>this.handleError(h)))}post(i,a){const l=this.getUrl(i);return console.log(`[API] POST ${l}`,a),this.http.post(l,a,{headers:this.getAuthHeaders()}).pipe((0,e.T)(d=>this.transformResponse(d)),(0,m.W)(d=>this.handleError(d)))}put(i,a){const l=this.getUrl(i);return console.log(`[API] PUT ${l}`,a),this.http.put(l,a,{headers:this.getAuthHeaders()}).pipe((0,e.T)(d=>this.transformResponse(d)),(0,m.W)(d=>this.handleError(d)))}delete(i,a){const l=this.getUrl(i);return console.log(`[API] DELETE ${l}`,a),this.http.delete(l,{headers:this.getAuthHeaders(),body:a}).pipe((0,e.T)(d=>this.transformResponse(d)),(0,m.W)(d=>this.handleError(d)))}patch(i,a){const l=this.getUrl(i);return console.log(`[API] PATCH ${l}`,a),this.http.patch(l,a,{headers:this.getAuthHeaders()}).pipe((0,e.T)(d=>this.transformResponse(d)),(0,m.W)(d=>this.handleError(d)))}upload(i,a){const l=this.getUrl(i);console.log(`[API] UPLOAD ${l}`);const d={},h=this.authToken;return h&&(d.Authorization=`Bearer ${h}`),this.http.post(l,a,{headers:new f.Lr(d)}).pipe((0,e.T)(x=>this.transformResponse(x)),(0,m.W)(x=>this.handleError(x)))}static \u0275fac=function(a){return new(a||_)(E.KVO(f.Qq),E.KVO(C))};static \u0275prov=E.jDH({token:_,factory:_.\u0275fac,providedIn:"root"})}return _})()},6171:(F,b,g)=>{g.r(b),g.d(b,{DatasetFormComponent:()=>G});var f=g(2881),p=g(9417),e=g(1360),m=g(1910),E=g(8512);function u(o,c){1&o&&(e.j41(0,"div",16),e.nrm(1,"div",17),e.j41(2,"span",18),e.EFF(3,"\u0110ang t\u1ea3i..."),e.k0s()())}function y(o,c){if(1&o&&(e.j41(0,"div",19)(1,"div",20),e.qSk(),e.j41(2,"svg",21),e.nrm(3,"path",22),e.k0s(),e.joV(),e.j41(4,"span",23),e.EFF(5),e.k0s()()()),2&o){const t=e.XpG();e.R7$(5),e.JRh(t.error)}}function C(o,c){1&o&&(e.qSk(),e.nrm(0,"path",66))}function D(o,c){1&o&&(e.qSk(),e.nrm(0,"path",67))}function _(o,c){1&o&&(e.qSk(),e.nrm(0,"path",68))}function k(o,c){if(1&o){const t=e.RV6();e.j41(0,"div",57),e.bIt("click",function(){const r=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.onTypeSelect(r.id))}),e.j41(1,"div",58)(2,"div",59),e.qSk(),e.j41(3,"svg",60),e.DNE(4,C,1,0,"path",61)(5,D,1,0,"path",62)(6,_,1,0,"path",63),e.k0s()(),e.joV(),e.j41(7,"div",64),e.EFF(8),e.k0s(),e.j41(9,"div",65),e.EFF(10),e.k0s()()()}if(2&o){const t=c.$implicit,n=e.XpG(2);e.Y8G("ngClass",n.formData.type===t.id?"border-orange-500 bg-orange-50":"border-gray-300"),e.R7$(2),e.Y8G("ngClass",n.formData.type===t.id?"bg-orange-100":"bg-gray-100"),e.R7$(),e.Y8G("ngClass",n.formData.type===t.id?"text-orange-600":"text-gray-600"),e.R7$(),e.Y8G("ngIf","truck"===t.icon),e.R7$(),e.Y8G("ngIf","demand"===t.icon),e.R7$(),e.Y8G("ngIf","trip"===t.icon),e.R7$(2),e.JRh(t.name),e.R7$(2),e.JRh(t.description)}}function i(o,c){if(1&o&&(e.j41(0,"option",74),e.EFF(1),e.k0s()),2&o){const t=c.$implicit;e.Y8G("ngValue",t),e.R7$(),e.Lme(" ",t.name," - ",t.description," ")}}function a(o,c){if(1&o){const t=e.RV6();e.j41(0,"div",69)(1,"div",70)(2,"h3",35),e.EFF(3,"Query Template"),e.k0s(),e.j41(4,"p",11),e.EFF(5,"Ch\u1ecdn query template \u0111\u1ec3 t\u1ea1o Danh m\u1ee5c d\u1eef li\u1ec7u"),e.k0s()(),e.j41(6,"div",71)(7,"label",72),e.EFF(8,"Ch\u1ecdn Query *"),e.k0s(),e.j41(9,"select",73),e.mxI("ngModelChange",function(r){e.eBV(t);const s=e.XpG(2);return e.DH7(s.selectedQueryTemplate,r)||(s.selectedQueryTemplate=r),e.Njj(r)}),e.bIt("ngModelChange",function(r){e.eBV(t);const s=e.XpG(2);return e.Njj(s.onQueryTemplateSelect(r))}),e.j41(10,"option",74),e.EFF(11,"-- Ch\u1ecdn query template --"),e.k0s(),e.DNE(12,i,2,3,"option",75),e.k0s()()()}if(2&o){const t=e.XpG(2);e.R7$(9),e.R50("ngModel",t.selectedQueryTemplate),e.R7$(),e.Y8G("ngValue",null),e.R7$(2),e.Y8G("ngForOf",t.queryTemplates)}}function l(o,c){1&o&&(e.j41(0,"span",86),e.EFF(1,"*"),e.k0s())}function d(o,c){if(1&o){const t=e.RV6();e.j41(0,"input",87),e.mxI("ngModelChange",function(r){e.eBV(t);const s=e.XpG().$implicit,v=e.XpG(3);return e.DH7(v.queryParameters[s.name],r)||(v.queryParameters[s.name]=r),e.Njj(r)}),e.bIt("ngModelChange",function(){e.eBV(t);const r=e.XpG(4);return e.Njj(r.onParameterChange())}),e.k0s()}if(2&o){const t=e.XpG().$implicit,n=e.XpG(3);e.R50("ngModel",n.queryParameters[t.name]),e.Y8G("required",t.required)("placeholder",t.label)}}function h(o,c){if(1&o){const t=e.RV6();e.j41(0,"input",88),e.mxI("ngModelChange",function(r){e.eBV(t);const s=e.XpG().$implicit,v=e.XpG(3);return e.DH7(v.queryParameters[s.name],r)||(v.queryParameters[s.name]=r),e.Njj(r)}),e.bIt("ngModelChange",function(){e.eBV(t);const r=e.XpG(4);return e.Njj(r.onParameterChange())}),e.k0s()}if(2&o){const t=e.XpG().$implicit,n=e.XpG(3);e.R50("ngModel",n.queryParameters[t.name]),e.Y8G("required",t.required)("placeholder",t.label)}}function x(o,c){if(1&o){const t=e.RV6();e.j41(0,"input",89),e.mxI("ngModelChange",function(r){e.eBV(t);const s=e.XpG().$implicit,v=e.XpG(3);return e.DH7(v.queryParameters[s.name],r)||(v.queryParameters[s.name]=r),e.Njj(r)}),e.bIt("ngModelChange",function(){e.eBV(t);const r=e.XpG(4);return e.Njj(r.onParameterChange())}),e.k0s()}if(2&o){const t=e.XpG().$implicit,n=e.XpG(3);e.R50("ngModel",n.queryParameters[t.name]),e.Y8G("required",t.required)}}function j(o,c){if(1&o&&(e.j41(0,"option",93),e.EFF(1),e.k0s()),2&o){const t=c.$implicit;e.Y8G("value",t.value),e.R7$(),e.SpI(" ",t.label," ")}}function M(o,c){if(1&o){const t=e.RV6();e.j41(0,"select",90),e.mxI("ngModelChange",function(r){e.eBV(t);const s=e.XpG().$implicit,v=e.XpG(3);return e.DH7(v.queryParameters[s.name],r)||(v.queryParameters[s.name]=r),e.Njj(r)}),e.bIt("ngModelChange",function(){e.eBV(t);const r=e.XpG(4);return e.Njj(r.onParameterChange())}),e.j41(1,"option",91),e.EFF(2),e.k0s(),e.DNE(3,j,2,2,"option",92),e.k0s()}if(2&o){const t=e.XpG().$implicit,n=e.XpG(3);e.R50("ngModel",n.queryParameters[t.name]),e.Y8G("required",t.required),e.R7$(2),e.SpI("-- Ch\u1ecdn ",t.label," --"),e.R7$(),e.Y8G("ngForOf",t.options)}}function T(o,c){if(1&o&&(e.j41(0,"div",79)(1,"label",80),e.EFF(2),e.DNE(3,l,2,0,"span",81),e.k0s(),e.DNE(4,d,1,3,"input",82)(5,h,1,3,"input",83)(6,x,1,2,"input",84)(7,M,4,4,"select",85),e.k0s()),2&o){const t=c.$implicit;e.R7$(2),e.SpI(" ",t.label," "),e.R7$(),e.Y8G("ngIf",t.required),e.R7$(),e.Y8G("ngIf","string"===t.type),e.R7$(),e.Y8G("ngIf","number"===t.type),e.R7$(),e.Y8G("ngIf","date"===t.type),e.R7$(),e.Y8G("ngIf","select"===t.type)}}function w(o,c){if(1&o&&(e.j41(0,"div",69)(1,"div",76)(2,"h3",35),e.EFF(3,"Query Parameters"),e.k0s(),e.j41(4,"p",11),e.EFF(5,"Nh\u1eadp gi\xe1 tr\u1ecb cho c\xe1c tham s\u1ed1 c\u1ee7a query"),e.k0s()(),e.j41(6,"div",77)(7,"div",69),e.DNE(8,T,8,6,"div",78),e.k0s()()()),2&o){const t=e.XpG(2);e.R7$(8),e.Y8G("ngForOf",t.selectedQueryTemplate.parameters)}}function R(o,c){if(1&o){const t=e.RV6();e.j41(0,"div",69)(1,"div",94)(2,"h3",35),e.EFF(3,"SQL Preview"),e.k0s(),e.j41(4,"p",11),e.EFF(5,"Preview c\u1ee7a SQL query v\u1edbi parameters"),e.k0s()(),e.j41(6,"div",95)(7,"div",96)(8,"span",97),e.EFF(9,"Generated SQL"),e.k0s(),e.j41(10,"button",98),e.bIt("click",function(){e.eBV(t);const r=e.XpG(2);return e.Njj(r.copySqlToClipboard())}),e.qSk(),e.j41(11,"svg",99),e.nrm(12,"path",100),e.k0s(),e.EFF(13," Copy "),e.k0s()(),e.joV(),e.j41(14,"div",101)(15,"pre",102),e.EFF(16),e.k0s()()()()}if(2&o){const t=e.XpG(2);e.R7$(16),e.JRh(t.generatedSql)}}function I(o,c){1&o&&(e.qSk(),e.j41(0,"svg",103),e.nrm(1,"path",104),e.k0s())}function S(o,c){1&o&&(e.qSk(),e.j41(0,"svg",5),e.nrm(1,"path",105),e.k0s())}function q(o,c){if(1&o){const t=e.RV6();e.j41(0,"div",24)(1,"div",25)(2,"div",26)(3,"div")(4,"label",27),e.qSk(),e.j41(5,"svg",28),e.nrm(6,"path",29),e.k0s(),e.EFF(7," Lo\u1ea1i Danh m\u1ee5c d\u1eef li\u1ec7u * "),e.k0s(),e.joV(),e.j41(8,"div",30),e.DNE(9,k,11,8,"div",31),e.k0s()(),e.DNE(10,a,13,3,"div",32)(11,w,9,1,"div",32)(12,R,17,1,"div",32),e.j41(13,"div",33)(14,"div",34)(15,"h3",35),e.EFF(16,"Th\xf4ng tin c\u01a1 b\u1ea3n"),e.k0s(),e.j41(17,"p",11),e.EFF(18,"C\xe1c th\xf4ng tin nh\u1eadn di\u1ec7n Danh m\u1ee5c d\u1eef li\u1ec7u"),e.k0s()(),e.j41(19,"div")(20,"label",36),e.EFF(21," T\xean Danh m\u1ee5c d\u1eef li\u1ec7u * "),e.j41(22,"span",37),e.EFF(23,"(b\u1eaft bu\u1ed9c)"),e.k0s()(),e.j41(24,"input",38),e.mxI("ngModelChange",function(r){e.eBV(t);const s=e.XpG();return e.DH7(s.formData.name,r)||(s.formData.name=r),e.Njj(r)}),e.k0s()(),e.j41(25,"div")(26,"label",36),e.EFF(27,"M\xf4 t\u1ea3"),e.k0s(),e.j41(28,"textarea",39),e.mxI("ngModelChange",function(r){e.eBV(t);const s=e.XpG();return e.DH7(s.formData.description,r)||(s.formData.description=r),e.Njj(r)}),e.k0s()(),e.j41(29,"div",40)(30,"div")(31,"label",36),e.EFF(32,"Owner / Team"),e.k0s(),e.j41(33,"input",41),e.mxI("ngModelChange",function(r){e.eBV(t);const s=e.XpG();return e.DH7(s.formData.created_by,r)||(s.formData.created_by=r),e.Njj(r)}),e.k0s()(),e.j41(34,"div")(35,"label",36),e.EFF(36,"Version"),e.k0s(),e.j41(37,"input",42),e.mxI("ngModelChange",function(r){e.eBV(t);const s=e.XpG();return e.DH7(s.formData.version,r)||(s.formData.version=r),e.Njj(r)}),e.k0s()()(),e.j41(38,"div")(39,"label",36),e.EFF(40,"Usage / Use Case"),e.k0s(),e.j41(41,"input",43),e.mxI("ngModelChange",function(r){e.eBV(t);const s=e.XpG();return e.DH7(s.formData.usage,r)||(s.formData.usage=r),e.Njj(r)}),e.k0s()(),e.j41(42,"div",44)(43,"div",45),e.EFF(44,"Ch\u1ea5t l\u01b0\u1ee3ng & Th\u1ed1ng k\xea"),e.k0s(),e.j41(45,"div",30)(46,"div")(47,"label",46),e.EFF(48,"Records"),e.k0s(),e.j41(49,"input",47),e.mxI("ngModelChange",function(r){e.eBV(t);const s=e.XpG();return e.DH7(s.formData.records,r)||(s.formData.records=r),e.Njj(r)}),e.k0s()(),e.j41(50,"div")(51,"label",46),e.EFF(52,"Columns"),e.k0s(),e.j41(53,"input",47),e.mxI("ngModelChange",function(r){e.eBV(t);const s=e.XpG();return e.DH7(s.formData.cols,r)||(s.formData.cols=r),e.Njj(r)}),e.k0s()(),e.j41(54,"div")(55,"label",46),e.EFF(56,"Quality (%)"),e.k0s(),e.j41(57,"input",48),e.mxI("ngModelChange",function(r){e.eBV(t);const s=e.XpG();return e.DH7(s.formData.quality,r)||(s.formData.quality=r),e.Njj(r)}),e.k0s()()()()()()(),e.j41(58,"div",49)(59,"div",11)(60,"span",50),e.EFF(61,"*"),e.k0s(),e.EFF(62," = Tr\u01b0\u1eddng b\u1eaft bu\u1ed9c "),e.k0s(),e.j41(63,"div",51)(64,"button",52),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.onCancel())}),e.EFF(65," H\u1ee7y "),e.k0s(),e.j41(66,"button",53),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.onSave())}),e.j41(67,"span",54),e.DNE(68,I,2,0,"svg",55)(69,S,2,0,"svg",56),e.EFF(70),e.k0s()()()()()}if(2&o){const t=e.XpG();e.R7$(9),e.Y8G("ngForOf",t.datasetTypes),e.R7$(),e.Y8G("ngIf",t.showQuerySection),e.R7$(),e.Y8G("ngIf",t.selectedQueryTemplate),e.R7$(),e.Y8G("ngIf",t.showSqlPreview),e.R7$(12),e.R50("ngModel",t.formData.name),e.R7$(4),e.R50("ngModel",t.formData.description),e.R7$(5),e.R50("ngModel",t.formData.created_by),e.R7$(4),e.R50("ngModel",t.formData.version),e.R7$(4),e.R50("ngModel",t.formData.usage),e.R7$(8),e.R50("ngModel",t.formData.records),e.R7$(4),e.R50("ngModel",t.formData.cols),e.R7$(4),e.R50("ngModel",t.formData.quality),e.R7$(7),e.Y8G("disabled",t.saving),e.R7$(2),e.Y8G("disabled",t.saving||!t.isFormValid()),e.R7$(2),e.Y8G("ngIf",t.saving),e.R7$(),e.Y8G("ngIf",!t.saving),e.R7$(),e.SpI(" ",t.saving?"\u0110ang l\u01b0u...":t.isEditMode?"C\u1eadp nh\u1eadt":"L\u01b0u"," Data Product ")}}let G=(()=>{class o{route;router;datasetService;datasetId=null;isEditMode=!1;formData={type:"",name:"",description:"",created_by:"",version:"v1",usage:"",records:0,cols:0,quality:0};loading=!1;saving=!1;error=null;datasetTypes=[{id:"truck",name:"Truck",description:"D\u1eef li\u1ec7u v\u1ec1 xe t\u1ea3i v\xe0 ph\u01b0\u01a1ng ti\u1ec7n",icon:"truck"},{id:"demand",name:"Demand",description:"D\u1eef li\u1ec7u v\u1ec1 nhu c\u1ea7u giao nh\u1eadn",icon:"demand"},{id:"trip",name:"Trip",description:"D\u1eef li\u1ec7u v\u1ec1 c\xe1c chuy\u1ebfn v\u1eadn chuy\u1ec3n",icon:"trip"}];showQuerySection=!1;queryTemplates=[];selectedQueryTemplate=null;queryParameters={};generatedSql="";showSqlPreview=!1;constructor(t,n,r){this.route=t,this.router=n,this.datasetService=r}ngOnInit(){this.datasetId=this.route.snapshot.paramMap.get("id"),this.isEditMode=!!this.datasetId,this.isEditMode&&this.datasetId&&this.loadDatasetForEdit()}ngOnDestroy(){}loadDatasetForEdit(){this.datasetId&&(this.loading=!0,this.datasetService.getDataset(this.datasetId).subscribe({next:t=>{if(t.ok&&t.data){const n=t.data;this.formData={type:n.type||"",name:n.name||"",description:n.description||"",created_by:n.created_by||"",version:"v1",usage:n.usage||"",records:n.records||0,cols:n.cols||0,quality:n.quality||0}}else this.error="Kh\xf4ng th\u1ec3 t\u1ea3i dataset \u0111\u1ec3 ch\u1ec9nh s\u1eeda";this.loading=!1},error:t=>{this.error=t?.message||"L\u1ed7i khi t\u1ea3i dataset",this.loading=!1}}))}onTypeSelect(t){this.formData.type=t,this.showQuerySection=!0,this.loadQueryTemplates(t)}loadQueryTemplates(t){this.queryTemplates=[{id:"truck_fleet_master",name:"Truck Fleet Master Data",description:"D\u1eef li\u1ec7u master v\u1ec1 \u0111\u1ed9i xe theo b\u01b0u c\u1ee5c",sql_template:"SELECT * FROM truck_fleet WHERE warehouse_id = {{warehouse_id}}",parameters:[{name:"warehouse_id",type:"string",label:"M\xe3 b\u01b0u c\u1ee5c",required:!0,default_value:""}]},{id:"demand_summary",name:"Demand Summary",description:"T\xf3m t\u1eaft nhu c\u1ea7u giao nh\u1eadn theo ng\xe0y",sql_template:"SELECT date, SUM(pick_orders) as pick_total, SUM(deliver_orders) as deliver_total FROM demand WHERE date BETWEEN {{start_date}} AND {{end_date}} GROUP BY date",parameters:[{name:"start_date",type:"date",label:"Ng\xe0y b\u1eaft \u0111\u1ea7u",required:!0},{name:"end_date",type:"date",label:"Ng\xe0y k\u1ebft th\xfac",required:!0}]}]}onQueryTemplateSelect(t){this.selectedQueryTemplate=this.queryTemplates.find(n=>n.id===t)||null,this.selectedQueryTemplate&&(this.queryParameters={},this.selectedQueryTemplate.parameters.forEach(n=>{this.queryParameters[n.name]=n.default_value||""}),this.updateSqlPreview())}onParameterChange(){this.updateSqlPreview()}updateSqlPreview(){if(!this.selectedQueryTemplate)return;let t=this.selectedQueryTemplate.sql_template;Object.keys(this.queryParameters).forEach(n=>{const r=this.queryParameters[n];t=t.replace(new RegExp(`{{${n}}}`,"g"),r?`'${r}'`:"NULL")}),this.generatedSql=t,this.showSqlPreview=!0}copySqlToClipboard(){this.generatedSql&&navigator.clipboard.writeText(this.generatedSql)}onSave(){if(!this.isFormValid())return;this.saving=!0,this.error=null;const t={...this.formData,query_template:this.selectedQueryTemplate?.id,parameters:this.queryParameters,generated_sql:this.generatedSql};(this.isEditMode&&this.datasetId?this.datasetService.updateDataset(this.datasetId,t):this.datasetService.createDataset(t)).subscribe({next:r=>{r.ok?this.router.navigate(["/datasets"],{queryParams:{success:this.isEditMode?"updated":"created"}}):this.error=r.data?.message||"L\u1ed7i khi l\u01b0u dataset",this.saving=!1},error:r=>{this.error=r?.message||"L\u1ed7i khi l\u01b0u dataset",this.saving=!1}})}onCancel(){this.router.navigate(["/datasets"])}isFormValid(){return!(!this.formData.type||!this.formData.name.trim()||this.showQuerySection&&!this.selectedQueryTemplate||!this.areParametersValid())}areParametersValid(){return!this.selectedQueryTemplate||this.selectedQueryTemplate.parameters.every(t=>{const n=this.queryParameters[t.name];return!t.required||null!=n&&""!==n})}getTypeIcon(t){return this.datasetTypes.find(r=>r.id===t)?.icon||"default"}getTypeDescription(t){return this.datasetTypes.find(r=>r.id===t)?.description||""}static \u0275fac=function(n){return new(n||o)(e.rXU(m.nX),e.rXU(m.Ix),e.rXU(E.q))};static \u0275cmp=e.VBU({type:o,selectors:[["app-dataset-form"]],decls:20,vars:4,consts:[[1,"min-h-screen","bg-gray-50"],[1,"bg-white","shadow-sm","border-b","border-gray-200"],[1,"max-w-4xl","mx-auto","px-4","sm:px-6","lg:px-8"],[1,"py-6"],[1,"inline-flex","items-center","gap-2","text-gray-600","hover:text-gray-900","mb-4","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"text-sm","font-semibold"],[1,"flex","items-center","gap-3","mb-2"],[1,"text-3xl","font-bold","text-gray-900"],[1,"text-xs","font-normal","px-2","py-1","bg-blue-100","text-blue-700","rounded"],[1,"text-sm","text-gray-600"],[1,"max-w-4xl","mx-auto","px-4","sm:px-6","lg:px-8","py-8"],["class","flex items-center justify-center py-16",4,"ngIf"],["class","bg-red-50 border border-red-200 rounded-lg p-6 mb-6",4,"ngIf"],["class","bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden",4,"ngIf"],[1,"flex","items-center","justify-center","py-16"],[1,"animate-spin","rounded-full","h-8","w-8","border-b-2","border-orange-500"],[1,"ml-2","text-gray-600"],[1,"bg-red-50","border","border-red-200","rounded-lg","p-6","mb-6"],[1,"flex","items-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-red-500","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-red-700"],[1,"bg-white","rounded-xl","shadow-lg","border","border-gray-200","overflow-hidden"],[1,"p-12"],[1,"space-y-12"],[1,"block","text-base","font-bold","text-gray-900","mb-5","flex","items-center","gap-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-orange-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],["class","cursor-pointer border-2 rounded-lg p-4 text-center transition-all hover:border-gray-400",3,"ngClass","click",4,"ngFor","ngForOf"],["class","space-y-4",4,"ngIf"],[1,"space-y-5"],[1,"border-l-4","border-orange-500","pl-4"],[1,"text-xl","font-bold","text-gray-900","mb-1"],[1,"block","text-sm","font-bold","text-gray-900","mb-2"],[1,"text-xs","font-normal","text-red-500","ml-1"],["type","text","required","","placeholder","e.g., Truck Fleet Master Data 2024",1,"w-full","border-2","border-gray-300","rounded-lg","px-4","py-3","focus:ring-2","focus:ring-orange-500","focus:border-orange-500","text-base","transition-all",3,"ngModelChange","ngModel"],["rows","4","placeholder","M\xf4 t\u1ea3 chi ti\u1ebft v\u1ec1 Danh m\u1ee5c d\u1eef li\u1ec7u n\xe0y, use cases, v\xe0 gi\xe1 tr\u1ecb mang l\u1ea1i...",1,"w-full","border-2","border-gray-300","rounded-lg","px-4","py-3","focus:ring-2","focus:ring-orange-500","focus:border-orange-500","text-base","transition-all",3,"ngModelChange","ngModel"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-5"],["type","text","placeholder","e.g., Logistics Team",1,"w-full","border-2","border-gray-300","rounded-lg","px-4","py-3","focus:ring-2","focus:ring-orange-500","focus:border-orange-500","transition-all",3,"ngModelChange","ngModel"],["type","text","value","v1",1,"w-full","border-2","border-gray-300","rounded-lg","px-4","py-3","focus:ring-2","focus:ring-orange-500","focus:border-orange-500","transition-all",3,"ngModelChange","ngModel"],["type","text","placeholder","e.g., Route Planning, ML Training, Analytics Dashboard",1,"w-full","border-2","border-gray-300","rounded-lg","px-4","py-3","focus:ring-2","focus:ring-orange-500","focus:border-orange-500","transition-all",3,"ngModelChange","ngModel"],[1,"bg-blue-50","border-2","border-blue-200","rounded-xl","p-5"],[1,"text-sm","font-bold","text-gray-900","mb-4"],[1,"block","text-xs","text-gray-600","mb-2"],["type","number","min","0",1,"w-full","border","border-gray-300","rounded","px-3","py-2","text-sm","focus:ring-2","focus:ring-blue-500","focus:border-blue-500",3,"ngModelChange","ngModel"],["type","number","min","0","max","100",1,"w-full","border","border-gray-300","rounded","px-3","py-2","text-sm","focus:ring-2","focus:ring-blue-500","focus:border-blue-500",3,"ngModelChange","ngModel"],[1,"px-8","py-5","border-t-2","border-gray-200","bg-gradient-to-r","from-gray-50","to-gray-100","flex","justify-between","items-center"],[1,"font-semibold","text-red-500"],[1,"flex","gap-3"],[1,"px-6","py-2.5","border-2","border-gray-300","rounded-lg","hover:bg-white","hover:border-gray-400","font-semibold","text-gray-700","transition-all","disabled:opacity-50",3,"click","disabled"],[1,"px-8","py-2.5","bg-gradient-to-r","from-orange-500","to-orange-600","hover:from-orange-600","hover:to-orange-700","text-white","rounded-lg","font-bold","shadow-md","hover:shadow-xl","transition-all","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","items-center","gap-2"],["class","w-5 h-5 animate-spin","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],["class","w-5 h-5","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],[1,"cursor-pointer","border-2","rounded-lg","p-4","text-center","transition-all","hover:border-gray-400",3,"click","ngClass"],[1,"mb-2"],[1,"w-12","h-12","mx-auto","mb-2","rounded-lg","flex","items-center","justify-center",3,"ngClass"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6",3,"ngClass"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16V6a1 1 0 00-1-1H4a1 1 0 00-1 1v10a1 1 0 001 1h1m8-1a1 1 0 01-1 1H9m4-1V8a1 1 0 011-1h2.586a1 1 0 01.707.293l3.414 3.414a1 1 0 01.293.707V16a1 1 0 01-1 1h-1m-6-1a1 1 0 001 1h1M5 17a2 2 0 104 0m-4 0a2 2 0 114 0m6 0a2 2 0 104 0m-4 0a2 2 0 114 0",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7",4,"ngIf"],[1,"text-sm","font-medium","text-gray-700"],[1,"text-xs","text-gray-500","mt-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16V6a1 1 0 00-1-1H4a1 1 0 00-1 1v10a1 1 0 001 1h1m8-1a1 1 0 01-1 1H9m4-1V8a1 1 0 011-1h2.586a1 1 0 01.707.293l3.414 3.414a1 1 0 01.293.707V16a1 1 0 01-1 1h-1m-6-1a1 1 0 001 1h1M5 17a2 2 0 104 0m-4 0a2 2 0 114 0m6 0a2 2 0 104 0m-4 0a2 2 0 114 0"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"],[1,"space-y-4"],[1,"border-l-4","border-purple-500","pl-4"],[1,"bg-purple-50","border-2","border-purple-200","rounded-xl","p-5"],[1,"block","text-sm","font-bold","text-gray-900","mb-3"],[1,"w-full","border-2","border-gray-300","rounded-lg","px-4","py-3","focus:ring-2","focus:ring-purple-500","focus:border-purple-500","transition-all",3,"ngModelChange","ngModel"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"border-l-4","border-indigo-500","pl-4"],[1,"bg-indigo-50","border-2","border-indigo-200","rounded-xl","p-5"],["class","space-y-2",4,"ngFor","ngForOf"],[1,"space-y-2"],[1,"block","text-sm","font-bold","text-gray-900"],["class","text-red-500",4,"ngIf"],["type","text","class","w-full border-2 border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all",3,"ngModel","required","placeholder","ngModelChange",4,"ngIf"],["type","number","class","w-full border-2 border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all",3,"ngModel","required","placeholder","ngModelChange",4,"ngIf"],["type","date","class","w-full border-2 border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all",3,"ngModel","required","ngModelChange",4,"ngIf"],["class","w-full border-2 border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all",3,"ngModel","required","ngModelChange",4,"ngIf"],[1,"text-red-500"],["type","text",1,"w-full","border-2","border-gray-300","rounded-lg","px-4","py-3","focus:ring-2","focus:ring-indigo-500","focus:border-indigo-500","transition-all",3,"ngModelChange","ngModel","required","placeholder"],["type","number",1,"w-full","border-2","border-gray-300","rounded-lg","px-4","py-3","focus:ring-2","focus:ring-indigo-500","focus:border-indigo-500","transition-all",3,"ngModelChange","ngModel","required","placeholder"],["type","date",1,"w-full","border-2","border-gray-300","rounded-lg","px-4","py-3","focus:ring-2","focus:ring-indigo-500","focus:border-indigo-500","transition-all",3,"ngModelChange","ngModel","required"],[1,"w-full","border-2","border-gray-300","rounded-lg","px-4","py-3","focus:ring-2","focus:ring-indigo-500","focus:border-indigo-500","transition-all",3,"ngModelChange","ngModel","required"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"border-l-4","border-green-500","pl-4"],[1,"bg-white","border-2","border-gray-200","rounded-xl","overflow-hidden"],[1,"px-5","py-3","bg-gradient-to-r","from-gray-50","to-gray-100","border-b-2","border-gray-200","flex","items-center","justify-between"],[1,"text-sm","font-bold","text-gray-900"],[1,"px-3","py-1.5","bg-white","border","border-gray-300","hover:bg-gray-50","rounded-lg","text-xs","font-medium","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","inline-block","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"],[1,"p-5"],[1,"text-sm","font-mono","bg-gray-50","p-4","rounded-lg","overflow-auto","border","border-gray-200","whitespace-pre-wrap"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","animate-spin"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"]],template:function(n,r){1&n&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),e.bIt("click",function(){return r.onCancel()}),e.qSk(),e.j41(5,"svg",5),e.nrm(6,"path",6),e.k0s(),e.joV(),e.j41(7,"span",7),e.EFF(8,"Quay l\u1ea1i Danh m\u1ee5c d\u1eef li\u1ec7u"),e.k0s()(),e.j41(9,"div",8)(10,"h2",9),e.EFF(11),e.k0s(),e.j41(12,"span",10),e.EFF(13,"Data Mesh"),e.k0s()(),e.j41(14,"p",11),e.EFF(15,"\u0110i\u1ec1n th\xf4ng tin Dataset mu\u1ed1n \u0111\u1ed3ng b\u1ed9"),e.k0s()()()(),e.j41(16,"div",12),e.DNE(17,u,4,0,"div",13)(18,y,6,1,"div",14)(19,q,71,17,"div",15),e.k0s()()),2&n&&(e.R7$(11),e.SpI("",r.isEditMode?"Ch\u1ec9nh s\u1eeda":"T\u1ea1o"," Danh m\u1ee5c d\u1eef li\u1ec7u"),e.R7$(6),e.Y8G("ngIf",r.loading),e.R7$(),e.Y8G("ngIf",r.error&&!r.loading),e.R7$(),e.Y8G("ngIf",!r.loading))},dependencies:[f.MD,f.YU,f.Sq,f.bT,p.YN,p.xH,p.y7,p.me,p.Q0,p.wz,p.BC,p.YS,p.VZ,p.zX,p.vS],encapsulation:2})}return o})()},8512:(F,b,g)=>{g.d(b,{q:()=>e});var f=g(1360),p=g(2215);let e=(()=>{class m{api;constructor(u){this.api=u}getDatasets(u={}){return this.api.post("/routing-deviation/internal/dataset/list",u)}getDataset(u){return this.api.post("/routing-deviation/internal/dataset/get",{dataset_id:u})}getDatasetTypes(){return this.api.post("/routing-deviation/internal/dataset/get-type")}getDatasetQuery(){return this.api.post("/routing-deviation/internal/dataset/get-query")}getDatasetMetadata(){return this.api.post("/routing-deviation/internal/dataset/get-metadata")}createDataset(u){return this.api.post("/routing-deviation/internal/dataset",u)}updateDataset(u,y){return this.api.post(`/routing-deviation/internal/dataset/${u}`,y)}getWarehouses(u){return this.api.post("/routing-deviation/internal/dataset/get-warehouses",u)}getDemands(u){return this.api.post("/routing-deviation/internal/dataset/get-demands",u)}getDemandsWithTimeRange(u){return this.api.post("/routing-deviation/internal/dataset/get-demands",u)}getDemandsShiftRatio(u){return this.api.post("/routing-deviation/internal/dataset/get-demands-shift-ratio",u)}getDemandsByDays(u){return this.api.post("/routing-deviation/internal/dataset/get-demands-by-days",u)}static \u0275fac=function(y){return new(y||m)(f.KVO(p.G))};static \u0275prov=f.jDH({token:m,factory:m.\u0275fac,providedIn:"root"})}return m})()}}]);