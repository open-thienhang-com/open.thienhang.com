"use strict";(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[3848],{3848:(L,m,r)=>{r.r(m),r.d(m,{ReviewsComponent:()=>G});var g=r(2881),d=r(9417),P=r(5207),_=r(1141),R=r(491),u=r(1570),h=r(2242),O=r(1305),v=r(8150),f=r(7722),w=r(4799),C=r(6221),b=r(6150),M=r(8542),D=r(5716),c=r(5779),E=r(5545),e=r(1360);const k=()=>({width:"600px"}),j=()=>[10,25,50];function F(a,p){1&a&&(e.j41(0,"tr")(1,"th"),e.EFF(2,"Title"),e.k0s(),e.j41(3,"th"),e.EFF(4,"Apartment"),e.k0s(),e.j41(5,"th"),e.EFF(6,"Review"),e.k0s(),e.j41(7,"th"),e.EFF(8,"Guest ID"),e.k0s(),e.j41(9,"th"),e.EFF(10,"Date Posted"),e.k0s(),e.j41(11,"th"),e.EFF(12,"Actions"),e.k0s()())}function y(a,p){if(1&a&&(e.j41(0,"small",38),e.EFF(1),e.k0s()),2&a){const t=e.XpG().$implicit;e.R7$(),e.SpI("ID: ",t.id,"")}}function I(a,p){if(1&a&&(e.j41(0,"small",38),e.EFF(1),e.nI1(2,"date"),e.k0s()),2&a){const t=e.XpG().$implicit;e.R7$(),e.SpI(" Updated: ",e.i5U(2,1,t.date_updated,"short")," ")}}function T(a,p){if(1&a){const t=e.RV6();e.j41(0,"tr")(1,"td")(2,"strong"),e.EFF(3),e.k0s(),e.nrm(4,"br"),e.DNE(5,y,2,1,"small",33),e.k0s(),e.j41(6,"td"),e.EFF(7),e.k0s(),e.j41(8,"td")(9,"div",34),e.EFF(10),e.k0s()(),e.j41(11,"td")(12,"span",35),e.EFF(13),e.k0s()(),e.j41(14,"td")(15,"span"),e.EFF(16),e.nI1(17,"date"),e.k0s(),e.nrm(18,"br"),e.DNE(19,I,3,4,"small",33),e.k0s(),e.j41(20,"td")(21,"button",36),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.editReview(n))}),e.k0s(),e.j41(22,"button",37),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.deleteReview(n))}),e.k0s()()()}if(2&a){const t=p.$implicit,i=e.XpG(2);e.R7$(3),e.JRh(t.title),e.R7$(2),e.Y8G("ngIf",t.id),e.R7$(2),e.JRh(i.getApartmentName(t.apartment_id)),e.R7$(3),e.SpI(" ",t.review.length>100?t.review.substring(0,100)+"...":t.review," "),e.R7$(3),e.JRh(t.account_id),e.R7$(3),e.JRh(e.i5U(17,7,t.date_posted,"short")),e.R7$(3),e.Y8G("ngIf",t.date_updated)}}function B(a,p){1&a&&(e.j41(0,"tr")(1,"td",39)(2,"div",40),e.nrm(3,"i",41),e.j41(4,"p"),e.EFF(5,"No reviews found"),e.k0s()()()())}function x(a,p){if(1&a&&(e.j41(0,"div",28)(1,"p-table",29),e.DNE(2,F,13,0,"ng-template",30)(3,T,23,10,"ng-template",31)(4,B,6,0,"ng-template",32),e.k0s()()),2&a){const t=e.XpG();e.R7$(),e.Y8G("value",t.filteredReviews)("paginator",!0)("rows",10)("rowsPerPageOptions",e.lJ4(5,j))("showCurrentPageReport",!0)}}function A(a,p){1&a&&(e.j41(0,"div",42),e.nrm(1,"p-skeleton",43)(2,"p-skeleton",43)(3,"p-skeleton",44),e.k0s())}function S(a,p){if(1&a){const t=e.RV6();e.j41(0,"button",45),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.closeDialog())}),e.k0s(),e.j41(1,"button",46),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.saveReview())}),e.k0s()}if(2&a){const t=e.XpG();e.R7$(),e.Y8G("label",t.isEditMode?"Update":"Create")("icon",t.isEditMode?"pi pi-check":"pi pi-plus")("disabled",t.loading)}}let G=(()=>{class a{hotelService;messageService;confirmationService;reviews=[];apartments=[];apartmentsForDropdown=[];bookings=[];loading=!1;showDialog=!1;isEditMode=!1;selectedReview=null;formData=this.getEmptyReviewForm();searchQuery="";selectedApartmentFilter=null;constructor(t,i,n){this.hotelService=t,this.messageService=i,this.confirmationService=n}ngOnInit(){this.loadReviews(),this.loadApartments(),this.loadBookings()}loadReviews(){this.loading=!0,this.hotelService.getReviews().subscribe({next:t=>{this.reviews=t.data||[],this.loading=!1},error:()=>{this.messageService.add({severity:"error",summary:"Error",detail:"Failed to load reviews"}),this.loading=!1}})}loadApartments(){this.hotelService.getApartments().subscribe({next:t=>{this.apartments=t.data||[],this.apartmentsForDropdown=this.apartments.map(i=>({...i,id:i.id||i._id,title:i.title||i.name||i.id||i._id}))},error:()=>{}})}loadBookings(){this.hotelService.getBookings().subscribe({next:t=>{this.bookings=t.data||[]},error:()=>{}})}openDialog(){this.isEditMode=!1,this.formData=this.getEmptyReviewForm(),!this.formData.apartment_id&&this.apartmentsForDropdown.length>0&&(this.formData.apartment_id=this.apartmentsForDropdown[0].id),!this.formData.booking_id&&this.bookings.length>0&&(this.formData.booking_id=this.bookings[0].id),this.showDialog=!0}editReview(t){this.isEditMode=!0,this.selectedReview=t,this.formData={...t},this.showDialog=!0}saveReview(){const t=[];if((!this.formData.title||""===this.formData.title.trim())&&t.push("Title"),(!this.formData.review||""===this.formData.review.trim())&&t.push("Review Content"),(!this.formData.apartment_id||""===this.formData.apartment_id.trim())&&t.push("Apartment ID"),(!this.formData.account_id||""===this.formData.account_id.trim())&&t.push("Account ID"),(!this.formData.booking_id||""===this.formData.booking_id.trim())&&t.push("Booking ID"),t.length>0)return void this.messageService.add({severity:"warn",summary:"Validation Error",detail:`Please fill in required fields: ${t.join(", ")}`});const i={...this.formData,id:this.isEditMode?this.selectedReview.id:void 0,title:this.formData.title.trim(),review:this.formData.review.trim(),apartment_id:this.formData.apartment_id.trim(),account_id:this.formData.account_id.trim(),booking_id:this.formData.booking_id.trim(),date_posted:this.isEditMode?this.selectedReview.date_posted:(new Date).toISOString(),date_updated:this.isEditMode?(new Date).toISOString():null};this.loading=!0,(this.isEditMode?this.hotelService.updateReview(this.selectedReview.id,i):this.hotelService.createReview(i)).subscribe({next:()=>{this.messageService.add({severity:"success",summary:"Success",detail:this.isEditMode?"Review updated successfully":"Review created successfully"}),this.loadReviews(),this.showDialog=!1,this.loading=!1},error:s=>{this.messageService.add({severity:"error",summary:"Error",detail:s?.error?.message||s?.message||"Failed to save review"}),this.loading=!1}})}deleteReview(t){this.confirmationService.confirm({message:"Are you sure you want to delete this review?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this.loading=!0,this.hotelService.deleteReview(t.id).subscribe({next:()=>{this.messageService.add({severity:"success",summary:"Success",detail:"Review deleted successfully"}),this.loadReviews()},error:()=>{this.messageService.add({severity:"error",summary:"Error",detail:"Failed to delete review"}),this.loading=!1}})}})}get filteredReviews(){let t=this.reviews;if(this.searchQuery){const i=this.searchQuery.toLowerCase();t=t.filter(n=>n.title.toLowerCase().includes(i)||n.review.toLowerCase().includes(i)||n.id&&n.id.toLowerCase().includes(i)||n.apartment_id.toLowerCase().includes(i))}return this.selectedApartmentFilter&&(t=t.filter(i=>i.apartment_id===this.selectedApartmentFilter)),t}getApartmentName(t){const i=this.apartments.find(n=>(n.id||n._id)===t);return i?i.title||i.name:t}closeDialog(){this.showDialog=!1,this.formData=this.getEmptyReviewForm()}getEmptyReviewForm(){const i=this.bookings.length>0?this.bookings[0].id:"";return{title:"Great stay!",review:"This apartment was wonderful. Clean, comfortable, and in a great location.",apartment_id:this.apartmentsForDropdown.length>0?this.apartmentsForDropdown[0].id:"",account_id:`guest_${Date.now()}`,booking_id:i,date_posted:(new Date).toISOString(),date_updated:null}}static \u0275fac=function(i){return new(i||a)(e.rXU(E.g),e.rXU(c.bg),e.rXU(c.td))};static \u0275cmp=e.VBU({type:a,selectors:[["app-hotel-reviews"]],features:[e.Jv_([c.bg,c.td])],decls:46,vars:24,consts:[["loadingTemplate",""],[1,"reviews-page"],[1,"page-header"],[1,"header-content"],[1,"subtitle"],["pButton","","type","button","label","Add New Review","icon","pi pi-plus",1,"p-button-primary","p-button-lg",3,"click"],[1,"search-section"],[1,"search-container"],[1,"pi","pi-search"],["type","text","placeholder","Search reviews...",1,"search-input",3,"ngModelChange","ngModel"],["optionLabel","title","optionValue","id","placeholder","Filter by Apartment",1,"apartment-filter",3,"ngModelChange","options","ngModel","showClear"],[1,"result-count"],["class","table-container",4,"ngIf","ngIfElse"],[3,"visibleChange","onHide","visible","header","modal","closable"],[1,"review-form"],[1,"form-group"],["for","title"],["id","title","type","text","pInputText","","name","title","placeholder","Review title","required","",3,"ngModelChange","ngModel"],["for","review"],["id","review","pInputTextarea","","name","review","rows","5","placeholder","Write your review here...","required","",3,"ngModelChange","ngModel"],[1,"form-row"],["for","apartment_id"],["id","apartment_id","optionLabel","title","optionValue","id","placeholder","Select Apartment","name","apartment_id",3,"ngModelChange","options","ngModel","required"],["for","account_id"],["id","account_id","type","text","pInputText","","name","account_id","placeholder","e.g., acc_001","required","",3,"ngModelChange","ngModel"],["for","booking_id"],["id","booking_id","optionLabel","id","optionValue","id","placeholder","Select Booking","name","booking_id",3,"ngModelChange","options","ngModel","showClear","required"],["pTemplate","footer"],[1,"table-container"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} reviews","styleClass","p-datatable-striped",3,"value","paginator","rows","rowsPerPageOptions","showCurrentPageReport"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["class","text-muted",4,"ngIf"],[1,"review-content"],[1,"account-id"],["pButton","","type","button","icon","pi pi-pencil","pTooltip","Edit Review",1,"p-button-rounded","p-button-text","p-button-warning",3,"click"],["pButton","","type","button","icon","pi pi-trash","pTooltip","Delete Review",1,"p-button-rounded","p-button-text","p-button-danger",3,"click"],[1,"text-muted"],["colspan","6",1,"text-center"],[1,"empty-state"],[1,"pi","pi-comment",2,"font-size","3rem","color","#ccc"],[1,"loading-container"],["width","100%","height","50px","styleClass","mb-3"],["width","100%","height","50px"],["pButton","","type","button","label","Cancel","icon","pi pi-times",1,"p-button-text",3,"click"],["pButton","","type","button",1,"p-button-primary",3,"click","label","icon","disabled"]],template:function(i,n){if(1&i){const s=e.RV6();e.j41(0,"div",1),e.nrm(1,"p-toast")(2,"p-confirmDialog"),e.j41(3,"div",2)(4,"div",3)(5,"div")(6,"h1"),e.EFF(7,"Reviews Management"),e.k0s(),e.j41(8,"p",4),e.EFF(9,"Manage guest reviews and feedback"),e.k0s()(),e.j41(10,"button",5),e.bIt("click",function(){return e.eBV(s),e.Njj(n.openDialog())}),e.k0s()()(),e.j41(11,"div",6)(12,"div",7),e.nrm(13,"i",8),e.j41(14,"input",9),e.mxI("ngModelChange",function(o){return e.eBV(s),e.DH7(n.searchQuery,o)||(n.searchQuery=o),e.Njj(o)}),e.k0s()(),e.j41(15,"p-dropdown",10),e.mxI("ngModelChange",function(o){return e.eBV(s),e.DH7(n.selectedApartmentFilter,o)||(n.selectedApartmentFilter=o),e.Njj(o)}),e.k0s(),e.j41(16,"p",11),e.EFF(17),e.k0s()(),e.DNE(18,x,5,6,"div",12)(19,A,4,0,"ng-template",null,0,e.C5r),e.j41(21,"p-dialog",13),e.mxI("visibleChange",function(o){return e.eBV(s),e.DH7(n.showDialog,o)||(n.showDialog=o),e.Njj(o)}),e.bIt("onHide",function(){return e.eBV(s),e.Njj(n.closeDialog())}),e.j41(22,"form",14)(23,"div",15)(24,"label",16),e.EFF(25,"Title *"),e.k0s(),e.j41(26,"input",17),e.mxI("ngModelChange",function(o){return e.eBV(s),e.DH7(n.formData.title,o)||(n.formData.title=o),e.Njj(o)}),e.k0s()(),e.j41(27,"div",15)(28,"label",18),e.EFF(29,"Review Content *"),e.k0s(),e.j41(30,"textarea",19),e.mxI("ngModelChange",function(o){return e.eBV(s),e.DH7(n.formData.review,o)||(n.formData.review=o),e.Njj(o)}),e.EFF(31,"        "),e.k0s()(),e.j41(32,"div",20)(33,"div",15)(34,"label",21),e.EFF(35,"Apartment ID *"),e.k0s(),e.j41(36,"p-dropdown",22),e.mxI("ngModelChange",function(o){return e.eBV(s),e.DH7(n.formData.apartment_id,o)||(n.formData.apartment_id=o),e.Njj(o)}),e.k0s()(),e.j41(37,"div",15)(38,"label",23),e.EFF(39,"Guest Account ID *"),e.k0s(),e.j41(40,"input",24),e.mxI("ngModelChange",function(o){return e.eBV(s),e.DH7(n.formData.account_id,o)||(n.formData.account_id=o),e.Njj(o)}),e.k0s()()(),e.j41(41,"div",15)(42,"label",25),e.EFF(43,"Booking ID *"),e.k0s(),e.j41(44,"p-dropdown",26),e.mxI("ngModelChange",function(o){return e.eBV(s),e.DH7(n.formData.booking_id,o)||(n.formData.booking_id=o),e.Njj(o)}),e.k0s()()(),e.DNE(45,S,2,3,"ng-template",27),e.k0s()()}if(2&i){const s=e.sdS(20);e.R7$(14),e.R50("ngModel",n.searchQuery),e.R7$(),e.Y8G("options",n.apartmentsForDropdown),e.R50("ngModel",n.selectedApartmentFilter),e.Y8G("showClear",!0),e.R7$(2),e.SpI("",n.filteredReviews.length," reviews found"),e.R7$(),e.Y8G("ngIf",!n.loading)("ngIfElse",s),e.R7$(3),e.Aen(e.lJ4(23,k)),e.R50("visible",n.showDialog),e.Y8G("header",n.isEditMode?"Edit Review":"Create New Review")("modal",!0)("closable",!0),e.R7$(5),e.R50("ngModel",n.formData.title),e.R7$(4),e.R50("ngModel",n.formData.review),e.R7$(6),e.Y8G("options",n.apartmentsForDropdown),e.R50("ngModel",n.formData.apartment_id),e.Y8G("required",!0),e.R7$(4),e.R50("ngModel",n.formData.account_id),e.R7$(4),e.Y8G("options",n.bookings),e.R50("ngModel",n.formData.booking_id),e.Y8G("showClear",!0)("required",!0)}},dependencies:[g.MD,g.bT,g.vh,d.YN,d.qT,d.me,d.BC,d.cb,d.YS,d.vS,d.cV,P.iI,_.tm,_._f,c.Ei,R.Dw,u.Ph,u.lG,h.um,h.Sm,O.Z2,v.kr,v.ms,f.MB,f.y8,w.FP,w.TM,C.bG,C.XI,b.EJ,M.Ss,M.m_,D.k2,D.EA],styles:[".reviews-page[_ngcontent-%COMP%]{padding:2rem}.reviews-page[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem;background:linear-gradient(135deg,var(--p-surface-0) 0%,rgba(var(--p-primary-500),.05) 100%);padding:2rem;border-radius:12px;border-bottom:2px solid rgba(var(--p-primary-500),.2)}.reviews-page[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:space-between;align-items:center}.reviews-page[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:2rem;font-weight:700;color:var(--p-surface-900)}.reviews-page[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{margin:0;font-size:.95rem;color:var(--p-surface-600)}.reviews-page[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem;gap:1rem}.reviews-page[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]{flex:1;position:relative;display:flex;align-items:center}.reviews-page[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{position:absolute;left:12px;color:var(--p-surface-500);font-size:1rem}.reviews-page[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{width:100%;padding:.75rem 1rem .75rem 2.5rem;border:2px solid var(--p-surface-200);border-radius:8px;font-size:.95rem;transition:all .2s}.reviews-page[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--p-primary-500);box-shadow:0 0 0 3px rgba(var(--p-primary-500),.1)}.reviews-page[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .apartment-filter[_ngcontent-%COMP%]{min-width:200px}.reviews-page[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .result-count[_ngcontent-%COMP%]{margin:0;font-size:.9rem;color:var(--p-surface-600);white-space:nowrap}.reviews-page[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]{background:var(--p-surface-0);border-radius:12px;padding:1rem;box-shadow:0 2px 8px #00000014}.reviews-page[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .review-content[_ngcontent-%COMP%]{max-width:300px;line-height:1.5;color:var(--p-surface-700)}.reviews-page[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .account-id[_ngcontent-%COMP%]{font-family:Courier New,monospace;font-size:.85rem;color:var(--p-surface-600)}.reviews-page[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .text-muted[_ngcontent-%COMP%]{color:var(--p-surface-500);font-size:.85rem}.reviews-page[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{text-align:center;padding:3rem;color:var(--p-surface-600)}.reviews-page[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{display:block;margin-bottom:1rem}.reviews-page[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:1.1rem}.reviews-page[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]{padding:2rem}.reviews-page[_ngcontent-%COMP%]   .review-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.reviews-page[_ngcontent-%COMP%]   .review-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.reviews-page[_ngcontent-%COMP%]   .review-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;color:var(--p-surface-700);font-size:.9rem}.reviews-page[_ngcontent-%COMP%]   .review-form[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1.5rem}@media (max-width: 768px){.reviews-page[_ngcontent-%COMP%]   .review-form[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})}return a})()}}]);