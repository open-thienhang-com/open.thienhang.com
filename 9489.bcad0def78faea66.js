"use strict";(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[9489],{9489:(A,p,l)=>{l.r(p),l.d(p,{CustomersComponent:()=>I});var u=l(2881),d=l(9417),g=l(1141),c=l(6221),_=l(1570),C=l(2242),f=l(1305),h=l(8150),v=l(6150),b=l(7722),m=l(5779),y=l(8533),e=l(1360);const M=()=>({width:"680px"});function E(n,a){1&n&&(e.j41(0,"div",42)(1,"div",43),e.nrm(2,"i",44),e.k0s(),e.j41(3,"p",7),e.EFF(4,"Loading customers..."),e.k0s()())}function T(n,a){1&n&&(e.j41(0,"tr")(1,"th"),e.EFF(2,"Name"),e.k0s(),e.j41(3,"th"),e.EFF(4,"Phone"),e.k0s(),e.j41(5,"th"),e.EFF(6,"Email"),e.k0s(),e.j41(7,"th"),e.EFF(8,"Customer Type"),e.k0s(),e.j41(9,"th"),e.EFF(10,"Status"),e.k0s(),e.j41(11,"th"),e.EFF(12,"Updated At"),e.k0s(),e.j41(13,"th"),e.EFF(14,"Actions"),e.k0s()())}function j(n,a){if(1&n){const t=e.RV6();e.j41(0,"tr")(1,"td")(2,"div",49),e.EFF(3),e.k0s(),e.j41(4,"div",50),e.EFF(5),e.k0s()(),e.j41(6,"td"),e.EFF(7),e.k0s(),e.j41(8,"td"),e.EFF(9),e.k0s(),e.j41(10,"td"),e.EFF(11),e.k0s(),e.j41(12,"td"),e.nrm(13,"p-badge",51),e.k0s(),e.j41(14,"td"),e.EFF(15),e.nI1(16,"date"),e.k0s(),e.j41(17,"td")(18,"div",52)(19,"p-button",53),e.bIt("onClick",function(){const s=e.eBV(t).$implicit,o=e.XpG(2);return e.Njj(o.viewCustomer(s))}),e.k0s(),e.j41(20,"p-button",54),e.bIt("onClick",function(){const s=e.eBV(t).$implicit,o=e.XpG(2);return e.Njj(o.editCustomer(s))}),e.k0s()()()()}if(2&n){const t=a.$implicit,i=e.XpG(2);e.R7$(3),e.JRh(t.name),e.R7$(2),e.JRh(t.address||"-"),e.R7$(2),e.JRh(t.phone||"-"),e.R7$(2),e.JRh(t.email||"-"),e.R7$(2),e.JRh(t.customerType||"-"),e.R7$(2),e.Y8G("value",i.getStatusLabel(t.isActive))("severity",i.getStatusSeverity(t.isActive)),e.R7$(2),e.JRh(e.i5U(16,10,t.updatedAt,"short")),e.R7$(4),e.Y8G("outlined",!0),e.R7$(),e.Y8G("outlined",!0)}}function F(n,a){1&n&&(e.j41(0,"tr")(1,"td",55),e.EFF(2,"No customers found"),e.k0s()())}function k(n,a){if(1&n&&(e.j41(0,"p-table",45),e.DNE(1,T,15,0,"ng-template",46)(2,j,21,13,"ng-template",47)(3,F,3,0,"ng-template",48),e.k0s()),2&n){const t=e.XpG();e.Y8G("value",t.filteredCustomers)("paginator",!0)("rows",10)("showCurrentPageReport",!0)}}function x(n,a){if(1&n){const t=e.RV6();e.j41(0,"div",56)(1,"div")(2,"label",26),e.EFF(3,"Name *"),e.k0s(),e.j41(4,"input",57),e.mxI("ngModelChange",function(s){e.eBV(t);const o=e.XpG();return e.DH7(o.editingCustomer.name,s)||(o.editingCustomer.name=s),e.Njj(s)}),e.k0s()(),e.j41(5,"div")(6,"label",26),e.EFF(7,"Customer Type *"),e.k0s(),e.j41(8,"input",58),e.mxI("ngModelChange",function(s){e.eBV(t);const o=e.XpG();return e.DH7(o.editingCustomer.customerType,s)||(o.editingCustomer.customerType=s),e.Njj(s)}),e.k0s()(),e.j41(9,"div")(10,"label",26),e.EFF(11,"Phone *"),e.k0s(),e.j41(12,"input",59),e.mxI("ngModelChange",function(s){e.eBV(t);const o=e.XpG();return e.DH7(o.editingCustomer.phone,s)||(o.editingCustomer.phone=s),e.Njj(s)}),e.k0s()(),e.j41(13,"div")(14,"label",26),e.EFF(15,"Email *"),e.k0s(),e.j41(16,"input",60),e.mxI("ngModelChange",function(s){e.eBV(t);const o=e.XpG();return e.DH7(o.editingCustomer.email,s)||(o.editingCustomer.email=s),e.Njj(s)}),e.k0s()(),e.j41(17,"div")(18,"label",26),e.EFF(19,"Status"),e.k0s(),e.j41(20,"p-dropdown",61),e.mxI("ngModelChange",function(s){e.eBV(t);const o=e.XpG();return e.DH7(o.editingCustomer.isActive,s)||(o.editingCustomer.isActive=s),e.Njj(s)}),e.k0s()(),e.j41(21,"div")(22,"label",26),e.EFF(23,"Created At"),e.k0s(),e.nrm(24,"input",62),e.nI1(25,"date"),e.k0s(),e.j41(26,"div",63)(27,"label",26),e.EFF(28,"Address *"),e.k0s(),e.j41(29,"textarea",64),e.mxI("ngModelChange",function(s){e.eBV(t);const o=e.XpG();return e.DH7(o.editingCustomer.address,s)||(o.editingCustomer.address=s),e.Njj(s)}),e.k0s()(),e.j41(30,"div")(31,"label",26),e.EFF(32,"Updated At"),e.k0s(),e.nrm(33,"input",62),e.nI1(34,"date"),e.k0s()()}if(2&n){const t=e.XpG();e.R7$(4),e.R50("ngModel",t.editingCustomer.name),e.Y8G("disabled","view"===t.dialogMode),e.R7$(4),e.R50("ngModel",t.editingCustomer.customerType),e.Y8G("disabled","view"===t.dialogMode),e.R7$(4),e.R50("ngModel",t.editingCustomer.phone),e.Y8G("disabled","view"===t.dialogMode),e.R7$(4),e.R50("ngModel",t.editingCustomer.email),e.Y8G("disabled","view"===t.dialogMode),e.R7$(4),e.R50("ngModel",t.editingCustomer.isActive),e.Y8G("options",t.dialogStatusOptions)("disabled","view"===t.dialogMode),e.R7$(4),e.Y8G("ngModel",e.i5U(25,15,t.editingCustomer.createdAt,"medium")),e.R7$(5),e.R50("ngModel",t.editingCustomer.address),e.Y8G("disabled","view"===t.dialogMode),e.R7$(4),e.Y8G("ngModel",e.i5U(34,18,t.editingCustomer.updatedAt,"medium"))}}function R(n,a){if(1&n){const t=e.RV6();e.j41(0,"p-button",67),e.bIt("onClick",function(){e.eBV(t);const s=e.XpG(2);return e.Njj(s.saveCustomer())}),e.k0s()}if(2&n){const t=e.XpG(2);e.Y8G("loading",t.saving)}}function w(n,a){if(1&n){const t=e.RV6();e.j41(0,"p-button",65),e.bIt("onClick",function(){e.eBV(t);const s=e.XpG();return e.Njj(s.cancelEdit())}),e.k0s(),e.DNE(1,R,1,1,"p-button",66)}if(2&n){const t=e.XpG();e.Y8G("outlined",!0)("disabled",t.saving),e.R7$(),e.Y8G("ngIf","view"!==t.dialogMode)}}let I=(()=>{class n{messageService;customerService;customers=[];filteredCustomers=[];loading=!1;saving=!1;searchTerm="";selectedStatus="";selectedType="";showCustomerDialog=!1;dialogMode="create";editingCustomer=null;statusOptions=[{label:"All Status",value:""},{label:"Active",value:"active"},{label:"Inactive",value:"inactive"}];typeOptions=[{label:"All Types",value:""}];dialogStatusOptions=[{label:"Active",value:!0},{label:"Inactive",value:!1}];constructor(t,i){this.messageService=t,this.customerService=i}ngOnInit(){this.loadCustomers()}loadCustomers(){this.loading=!0,this.customerService.listCustomers(0,50).subscribe({next:t=>{const i=Array.isArray(t?.data)?t.data:[];this.customers=i.map(s=>this.mapCustomer(s)),this.refreshTypeOptions(),this.applyFilters(),this.loading=!1},error:t=>{this.loading=!1,this.customers=[],this.filteredCustomers=[],this.messageService.add({severity:"error",summary:"Error",detail:t?.error?.message||"Failed to load customers"})}})}applyFilters(){const t=this.searchTerm.trim().toLowerCase();this.filteredCustomers=this.customers.filter(i=>(!t||i.name.toLowerCase().includes(t)||i.phone.toLowerCase().includes(t)||i.email.toLowerCase().includes(t)||i.address.toLowerCase().includes(t)||i.customerType.toLowerCase().includes(t))&&(!this.selectedStatus||(i.isActive?"active":"inactive")===this.selectedStatus)&&(!this.selectedType||i.customerType===this.selectedType))}clearFilters(){this.searchTerm="",this.selectedStatus="",this.selectedType="",this.applyFilters()}createCustomer(){this.dialogMode="create",this.editingCustomer={id:"",name:"",phone:"",email:"",address:"",customerType:"",isActive:!0,createdAt:null,updatedAt:null},this.showCustomerDialog=!0}viewCustomer(t){this.openCustomerByMode(t,"view")}editCustomer(t){this.openCustomerByMode(t,"edit")}saveCustomer(){if(!this.editingCustomer||"view"===this.dialogMode)return void this.cancelEdit();const t={name:this.editingCustomer.name.trim(),phone:this.editingCustomer.phone.trim(),email:this.editingCustomer.email.trim(),address:this.editingCustomer.address.trim(),customer_type:this.editingCustomer.customerType.trim(),is_active:this.editingCustomer.isActive};t.name&&t.phone&&t.email&&t.address&&t.customer_type?(this.saving=!0,("edit"===this.dialogMode&&this.editingCustomer.id?this.customerService.updateCustomer(this.editingCustomer.id,t):this.customerService.createCustomer(t)).subscribe({next:()=>{this.saving=!1,this.showCustomerDialog=!1,this.editingCustomer=null,this.messageService.add({severity:"success",summary:"Success",detail:"edit"===this.dialogMode?"Customer updated":"Customer created"}),this.loadCustomers()},error:s=>{this.saving=!1,this.messageService.add({severity:"error",summary:"Error",detail:s?.error?.message||"Failed to save customer"})}})):this.messageService.add({severity:"warn",summary:"Validation",detail:"Name, phone, email, address and customer type are required."})}cancelEdit(){this.showCustomerDialog=!1,this.editingCustomer=null}getStatusSeverity(t){return t?"success":"danger"}getStatusLabel(t){return t?"active":"inactive"}getActiveCustomersCount(){return this.customers.filter(t=>t.isActive).length}openCustomerByMode(t,i){this.dialogMode=i,this.saving=!0,this.customerService.getCustomer(t.id).subscribe({next:s=>{this.editingCustomer=this.mapCustomer(s?.data||t),this.showCustomerDialog=!0,this.saving=!1},error:()=>{this.editingCustomer={...t},this.showCustomerDialog=!0,this.saving=!1}})}refreshTypeOptions(){const t=[...new Set(this.customers.map(i=>i.customerType).filter(i=>!!i))];this.typeOptions=[{label:"All Types",value:""},...t.map(i=>({label:i,value:i}))]}mapCustomer(t){return{id:String(t?._id||t?.id||""),name:String(t?.name||""),phone:String(t?.phone||""),email:String(t?.email||""),address:String(t?.address||""),customerType:String(t?.customer_type||""),isActive:!1!==t?.is_active,createdAt:t?.created_at?new Date(t.created_at):null,updatedAt:t?.updated_at?new Date(t.updated_at):null}}static \u0275fac=function(i){return new(i||n)(e.rXU(m.bg),e.rXU(y.m6))};static \u0275cmp=e.VBU({type:n,selectors:[["app-customers"]],features:[e.Jv_([m.bg])],decls:73,vars:22,consts:[[1,"bg-gray-50","min-h-screen","p-6"],[1,"bg-white","rounded-lg","shadow-sm","p-6","mb-6"],[1,"flex","flex-col","lg:flex-row","lg:items-center","lg:justify-between","gap-4"],[1,"flex","items-center","gap-4"],[1,"w-12","h-12","bg-gradient-to-br","from-violet-500","to-indigo-600","rounded-lg","flex","items-center","justify-center"],[1,"pi","pi-users","text-white","text-xl"],[1,"text-3xl","font-bold","text-gray-900"],[1,"text-gray-600"],[1,"flex","items-center","gap-2"],["icon","pi pi-refresh","severity","info","pTooltip","Refresh",1,"hidden","sm:inline-flex",3,"onClick","outlined","rounded"],["label","Add Customer","icon","pi pi-plus","severity","primary",3,"onClick"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-6","mb-6"],[1,"bg-white","rounded-lg","shadow-sm","p-6"],[1,"flex","items-center","justify-between"],[1,"text-sm","font-medium","text-gray-600"],[1,"w-12","h-12","bg-blue-100","rounded-lg","flex","items-center","justify-center"],[1,"pi","pi-users","text-blue-600","text-xl"],[1,"text-3xl","font-bold","text-green-600"],[1,"w-12","h-12","bg-green-100","rounded-lg","flex","items-center","justify-center"],[1,"pi","pi-check-circle","text-green-600","text-xl"],[1,"text-3xl","font-bold","text-indigo-600"],[1,"w-12","h-12","bg-indigo-100","rounded-lg","flex","items-center","justify-center"],[1,"pi","pi-sitemap","text-indigo-600","text-xl"],[1,"bg-white","rounded-lg","shadow-sm","mb-6"],[1,"p-6"],[1,"grid","grid-cols-1","sm:grid-cols-2","lg:grid-cols-4","gap-4"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],[1,"p-input-icon-left","w-full"],[1,"pi","pi-search"],["pInputText","","placeholder","Search by name, phone, email...",1,"w-full",3,"ngModelChange","input","ngModel"],["optionLabel","label","optionValue","value",1,"w-full",3,"ngModelChange","onChange","ngModel","options"],[1,"flex","items-end"],["label","Clear Filters","icon","pi pi-times","severity","secondary",3,"onClick","outlined"],[1,"bg-white","rounded-xl","border","border-gray-200","overflow-hidden"],[1,"px-6","py-4","border-b","border-gray-200","flex","items-center","justify-between"],[1,"text-lg","font-semibold","text-gray-900"],[1,"text-sm","text-gray-500"],["class","bg-white rounded-xl border border-gray-200 p-10 text-center",4,"ngIf"],["styleClass","p-datatable-sm","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} customers",3,"value","paginator","rows","showCurrentPageReport",4,"ngIf"],[3,"visibleChange","visible","header","modal","closable"],["class","grid grid-cols-1 md:grid-cols-2 gap-4",4,"ngIf"],["pTemplate","footer"],[1,"bg-white","rounded-xl","border","border-gray-200","p-10","text-center"],[1,"w-12","h-12","bg-blue-100","rounded-full","flex","items-center","justify-center","mx-auto","mb-3"],[1,"pi","pi-spin","pi-spinner","text-blue-500","text-xl"],["styleClass","p-datatable-sm","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} customers",3,"value","paginator","rows","showCurrentPageReport"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"font-semibold","text-gray-900"],[1,"text-xs","text-gray-500","mt-0.5"],[3,"value","severity"],[1,"flex","gap-1"],["icon","pi pi-eye","size","small",3,"onClick","outlined"],["icon","pi pi-pencil","size","small",3,"onClick","outlined"],["colspan","7",1,"text-center","py-12","text-gray-500"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["pInputText","","placeholder","Customer name",1,"w-full",3,"ngModelChange","ngModel","disabled"],["pInputText","","placeholder","e.g. retail, vip",1,"w-full",3,"ngModelChange","ngModel","disabled"],["pInputText","","placeholder","Phone number",1,"w-full",3,"ngModelChange","ngModel","disabled"],["pInputText","","placeholder","Email",1,"w-full",3,"ngModelChange","ngModel","disabled"],["optionLabel","label","optionValue","value",1,"w-full",3,"ngModelChange","ngModel","options","disabled"],["pInputText","","disabled","",1,"w-full",3,"ngModel"],[1,"md:col-span-2"],["pInputTextarea","","rows","3","placeholder","Address",1,"w-full",3,"ngModelChange","ngModel","disabled"],["label","Close",3,"onClick","outlined","disabled"],["label","Save","icon","pi pi-check",3,"loading","onClick",4,"ngIf"],["label","Save","icon","pi pi-check",3,"onClick","loading"]],template:function(i,s){1&i&&(e.nrm(0,"p-toast"),e.j41(1,"div",0)(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",4),e.nrm(6,"i",5),e.k0s(),e.j41(7,"div")(8,"h1",6),e.EFF(9,"Customer Management"),e.k0s(),e.j41(10,"p",7),e.EFF(11,"Manage retail customers from Retail Domain API"),e.k0s()()(),e.j41(12,"div",8)(13,"p-button",9),e.bIt("onClick",function(){return s.loadCustomers()}),e.k0s(),e.j41(14,"p-button",10),e.bIt("onClick",function(){return s.createCustomer()}),e.k0s()()()(),e.j41(15,"div",11)(16,"div",12)(17,"div",13)(18,"div")(19,"p",14),e.EFF(20,"Total Customers"),e.k0s(),e.j41(21,"p",6),e.EFF(22),e.k0s()(),e.j41(23,"div",15),e.nrm(24,"i",16),e.k0s()()(),e.j41(25,"div",12)(26,"div",13)(27,"div")(28,"p",14),e.EFF(29,"Active Customers"),e.k0s(),e.j41(30,"p",17),e.EFF(31),e.k0s()(),e.j41(32,"div",18),e.nrm(33,"i",19),e.k0s()()(),e.j41(34,"div",12)(35,"div",13)(36,"div")(37,"p",14),e.EFF(38,"Customer Types"),e.k0s(),e.j41(39,"p",20),e.EFF(40),e.k0s()(),e.j41(41,"div",21),e.nrm(42,"i",22),e.k0s()()()(),e.j41(43,"div",23)(44,"div",24)(45,"div",25)(46,"div")(47,"label",26),e.EFF(48,"Search"),e.k0s(),e.j41(49,"span",27),e.nrm(50,"i",28),e.j41(51,"input",29),e.mxI("ngModelChange",function(r){return e.DH7(s.searchTerm,r)||(s.searchTerm=r),r}),e.bIt("input",function(){return s.applyFilters()}),e.k0s()()(),e.j41(52,"div")(53,"label",26),e.EFF(54,"Status"),e.k0s(),e.j41(55,"p-dropdown",30),e.mxI("ngModelChange",function(r){return e.DH7(s.selectedStatus,r)||(s.selectedStatus=r),r}),e.bIt("onChange",function(){return s.applyFilters()}),e.k0s()(),e.j41(56,"div")(57,"label",26),e.EFF(58,"Customer Type"),e.k0s(),e.j41(59,"p-dropdown",30),e.mxI("ngModelChange",function(r){return e.DH7(s.selectedType,r)||(s.selectedType=r),r}),e.bIt("onChange",function(){return s.applyFilters()}),e.k0s()(),e.j41(60,"div",31)(61,"p-button",32),e.bIt("onClick",function(){return s.clearFilters()}),e.k0s()()()()(),e.j41(62,"div",33)(63,"div",34)(64,"h2",35),e.EFF(65),e.k0s(),e.j41(66,"p",36),e.EFF(67,"Source: Retail Domain API"),e.k0s()(),e.DNE(68,E,5,0,"div",37)(69,k,4,4,"p-table",38),e.k0s(),e.j41(70,"p-dialog",39),e.mxI("visibleChange",function(r){return e.DH7(s.showCustomerDialog,r)||(s.showCustomerDialog=r),r}),e.DNE(71,x,35,21,"div",40)(72,w,2,3,"ng-template",41),e.k0s()()),2&i&&(e.R7$(13),e.Y8G("outlined",!0)("rounded",!0),e.R7$(9),e.JRh(s.customers.length),e.R7$(9),e.JRh(s.getActiveCustomersCount()),e.R7$(9),e.JRh(s.typeOptions.length-1),e.R7$(11),e.R50("ngModel",s.searchTerm),e.R7$(4),e.R50("ngModel",s.selectedStatus),e.Y8G("options",s.statusOptions),e.R7$(4),e.R50("ngModel",s.selectedType),e.Y8G("options",s.typeOptions),e.R7$(2),e.Y8G("outlined",!0),e.R7$(4),e.SpI("Customer List (",s.filteredCustomers.length,")"),e.R7$(3),e.Y8G("ngIf",s.loading),e.R7$(),e.Y8G("ngIf",!s.loading),e.R7$(),e.Aen(e.lJ4(21,M)),e.R50("visible",s.showCustomerDialog),e.Y8G("header","create"===s.dialogMode?"Add Customer":"edit"===s.dialogMode?"Edit Customer":"Customer Detail")("modal",!0)("closable",!s.saving),e.R7$(),e.Y8G("ngIf",s.editingCustomer))},dependencies:[u.MD,u.bT,u.vh,d.YN,d.me,d.BC,d.vS,g.tm,g.$n,m.Ei,c.bG,c.XI,_.Ph,_.lG,C.um,C.Sm,f.Z2,h.kr,h.ms,v.EJ,v.Ex,b.MB,b.y8],encapsulation:2})}return n})()}}]);