"use strict";(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[9295],{491:(S,E,i)=>{i.d(E,{Dw:()=>P,Zp:()=>p});var _=i(2881),t=i(1360),O=i(9744),M=i(5779),R=i(3491),B=i(6263);const r=["header"],h=["title"],w=["subtitle"],F=["content"],T=["footer"],U=["*",[["p-header"]],[["p-footer"]]],g=["*","p-header","p-footer"];function A(n,b){1&n&&t.eu8(0)}function e(n,b){if(1&n&&(t.j41(0,"div",8),t.SdG(1,1),t.DNE(2,A,1,0,"ng-container",6),t.k0s()),2&n){const c=t.XpG();t.R7$(2),t.Y8G("ngTemplateOutlet",c.headerTemplate||c._headerTemplate)}}function f(n,b){if(1&n&&(t.qex(0),t.EFF(1),t.bVm()),2&n){const c=t.XpG(2);t.R7$(),t.JRh(c.header)}}function D(n,b){1&n&&t.eu8(0)}function j(n,b){if(1&n&&(t.j41(0,"div",9),t.DNE(1,f,2,1,"ng-container",10)(2,D,1,0,"ng-container",6),t.k0s()),2&n){const c=t.XpG();t.R7$(),t.Y8G("ngIf",c.header&&!c._titleTemplate&&!c.titleTemplate),t.R7$(),t.Y8G("ngTemplateOutlet",c.titleTemplate||c._titleTemplate)}}function a(n,b){if(1&n&&(t.qex(0),t.EFF(1),t.bVm()),2&n){const c=t.XpG(2);t.R7$(),t.JRh(c.subheader)}}function I(n,b){1&n&&t.eu8(0)}function d(n,b){if(1&n&&(t.j41(0,"div",11),t.DNE(1,a,2,1,"ng-container",10)(2,I,1,0,"ng-container",6),t.k0s()),2&n){const c=t.XpG();t.R7$(),t.Y8G("ngIf",c.subheader&&!c._subtitleTemplate&&!c.subtitleTemplate),t.R7$(),t.Y8G("ngTemplateOutlet",c.subtitleTemplate||c._subtitleTemplate)}}function C(n,b){1&n&&t.eu8(0)}function v(n,b){1&n&&t.eu8(0)}function m(n,b){if(1&n&&(t.j41(0,"div",12),t.SdG(1,2),t.DNE(2,v,1,0,"ng-container",6),t.k0s()),2&n){const c=t.XpG();t.R7$(2),t.Y8G("ngTemplateOutlet",c.footerTemplate||c._footerTemplate)}}const k=({dt:n})=>`\n.p-card {\n    background: ${n("card.background")};\n    color: ${n("card.color")};\n    box-shadow: ${n("card.shadow")};\n    border-radius: ${n("card.border.radius")};\n    display: flex;\n    flex-direction: column;\n}\n\n.p-card-caption {\n    display: flex;\n    flex-direction: column;\n    gap: ${n("card.caption.gap")};\n}\n\n.p-card-body {\n    padding: ${n("card.body.padding")};\n    display: flex;\n    flex-direction: column;\n    gap: ${n("card.body.gap")};\n}\n\n.p-card-title {\n    font-size: ${n("card.title.font.size")};\n    font-weight: ${n("card.title.font.weight")};\n}\n\n.p-card-subtitle {\n    color: ${n("card.subtitle.color")};\n}\n`,o={root:"p-card p-component",header:"p-card-header",body:"p-card-body",caption:"p-card-caption",title:"p-card-title",subtitle:"p-card-subtitle",content:"p-card-content",footer:"p-card-footer"};let l=(()=>{class n extends B.j{name="card";theme=k;classes=o;static \u0275fac=(()=>{let c;return function(u){return(c||(c=t.xGo(n)))(u||n)}})();static \u0275prov=t.jDH({token:n,factory:n.\u0275fac})}return n})(),p=(()=>{class n extends R.${header;subheader;set style(c){(0,O.aI)(this._style(),c)||this._style.set(c)}styleClass;headerFacet;footerFacet;headerTemplate;titleTemplate;subtitleTemplate;contentTemplate;footerTemplate;_headerTemplate;_titleTemplate;_subtitleTemplate;_contentTemplate;_footerTemplate;_style=(0,t.vPA)(null);_componentStyle=(0,t.WQX)(l);getBlockableElement(){return this.el.nativeElement.children[0]}templates;ngAfterContentInit(){this.templates.forEach(c=>{switch(c.getType()){case"header":this._headerTemplate=c.template;break;case"title":this._titleTemplate=c.template;break;case"subtitle":this._subtitleTemplate=c.template;break;case"content":default:this._contentTemplate=c.template;break;case"footer":this._footerTemplate=c.template}})}static \u0275fac=(()=>{let c;return function(u){return(c||(c=t.xGo(n)))(u||n)}})();static \u0275cmp=t.VBU({type:n,selectors:[["p-card"]],contentQueries:function($,u,G){if(1&$&&(t.wni(G,M.Y9,5),t.wni(G,M.wi,5),t.wni(G,r,4),t.wni(G,h,4),t.wni(G,w,4),t.wni(G,F,4),t.wni(G,T,4),t.wni(G,M.Ei,4)),2&$){let y;t.mGM(y=t.lsd())&&(u.headerFacet=y.first),t.mGM(y=t.lsd())&&(u.footerFacet=y.first),t.mGM(y=t.lsd())&&(u.headerTemplate=y.first),t.mGM(y=t.lsd())&&(u.titleTemplate=y.first),t.mGM(y=t.lsd())&&(u.subtitleTemplate=y.first),t.mGM(y=t.lsd())&&(u.contentTemplate=y.first),t.mGM(y=t.lsd())&&(u.footerTemplate=y.first),t.mGM(y=t.lsd())&&(u.templates=y)}},inputs:{header:"header",subheader:"subheader",style:"style",styleClass:"styleClass"},features:[t.Jv_([l]),t.Vt3],ngContentSelectors:g,decls:9,vars:10,consts:[[3,"ngClass","ngStyle"],["class","p-card-header",4,"ngIf"],[1,"p-card-body"],["class","p-card-title",4,"ngIf"],["class","p-card-subtitle",4,"ngIf"],[1,"p-card-content"],[4,"ngTemplateOutlet"],["class","p-card-footer",4,"ngIf"],[1,"p-card-header"],[1,"p-card-title"],[4,"ngIf"],[1,"p-card-subtitle"],[1,"p-card-footer"]],template:function($,u){1&$&&(t.NAR(U),t.j41(0,"div",0),t.DNE(1,e,3,1,"div",1),t.j41(2,"div",2),t.DNE(3,j,3,2,"div",3)(4,d,3,2,"div",4),t.j41(5,"div",5),t.SdG(6),t.DNE(7,C,1,0,"ng-container",6),t.k0s(),t.DNE(8,m,3,1,"div",7),t.k0s()()),2&$&&(t.HbH(u.styleClass),t.Y8G("ngClass","p-card p-component")("ngStyle",u._style()),t.BMQ("data-pc-name","card"),t.R7$(),t.Y8G("ngIf",u.headerFacet||u.headerTemplate||u._headerTemplate),t.R7$(2),t.Y8G("ngIf",u.header||u.titleTemplate||u._titleTemplate),t.R7$(),t.Y8G("ngIf",u.subheader||u.subtitleTemplate||u._subtitleTemplate),t.R7$(3),t.Y8G("ngTemplateOutlet",u.contentTemplate||u._contentTemplate),t.R7$(),t.Y8G("ngIf",u.footerFacet||u.footerTemplate||u._footerTemplate))},dependencies:[_.MD,_.YU,_.bT,_.T3,_.B3,M.Gg],encapsulation:2,changeDetection:0})}return n})(),P=(()=>{class n{static \u0275fac=function($){return new($||n)};static \u0275mod=t.$C({type:n});static \u0275inj=t.G2t({imports:[p,M.Gg,M.Gg]})}return n})()},935:(S,E,i)=>{i.d(E,{$C:()=>j,vw:()=>D});var _=i(2881),t=i(1360),O=i(5779),M=i(3491),R=i(6263);const B=["icon"],r=["*"];function h(a,I){if(1&a&&t.nrm(0,"span",4),2&a){const d=t.XpG(2);t.Y8G("ngClass",d.icon)}}function w(a,I){if(1&a&&(t.qex(0),t.DNE(1,h,1,1,"span",3),t.bVm()),2&a){const d=t.XpG();t.R7$(),t.Y8G("ngIf",d.icon)}}function F(a,I){}function T(a,I){1&a&&t.DNE(0,F,0,0,"ng-template")}function U(a,I){if(1&a&&(t.j41(0,"span",5),t.DNE(1,T,1,0,null,6),t.k0s()),2&a){const d=t.XpG();t.R7$(),t.Y8G("ngTemplateOutlet",d.iconTemplate||d._iconTemplate)}}const g=({dt:a})=>`\n.p-tag {\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n    background: ${a("tag.primary.background")};\n    color: ${a("tag.primary.color")};\n    font-size: ${a("tag.font.size")};\n    font-weight: ${a("tag.font.weight")};\n    padding: ${a("tag.padding")};\n    border-radius: ${a("tag.border.radius")};\n    gap: ${a("tag.gap")};\n}\n\n.p-tag-icon {\n    font-size: ${a("tag.icon.size")};\n    width: ${a("tag.icon.size")};\n    height:${a("tag.icon.size")};\n}\n\n.p-tag-rounded {\n    border-radius: ${a("tag.rounded.border.radius")};\n}\n\n.p-tag-success {\n    background: ${a("tag.success.background")};\n    color: ${a("tag.success.color")};\n}\n\n.p-tag-info {\n    background: ${a("tag.info.background")};\n    color: ${a("tag.info.color")};\n}\n\n.p-tag-warn {\n    background: ${a("tag.warn.background")};\n    color: ${a("tag.warn.color")};\n}\n\n.p-tag-danger {\n    background: ${a("tag.danger.background")};\n    color: ${a("tag.danger.color")};\n}\n\n.p-tag-secondary {\n    background: ${a("tag.secondary.background")};\n    color: ${a("tag.secondary.color")};\n}\n\n.p-tag-contrast {\n    background: ${a("tag.contrast.background")};\n    color: ${a("tag.contrast.color")};\n}\n`,A={root:({props:a})=>["p-tag p-component",{"p-tag-info":"info"===a.severity,"p-tag-success":"success"===a.severity,"p-tag-warn":"warn"===a.severity,"p-tag-danger":"danger"===a.severity,"p-tag-secondary":"secondary"===a.severity,"p-tag-contrast":"contrast"===a.severity,"p-tag-rounded":a.rounded}],icon:"p-tag-icon",label:"p-tag-label"};let e=(()=>{class a extends R.j{name="tag";theme=g;classes=A;static \u0275fac=(()=>{let d;return function(v){return(d||(d=t.xGo(a)))(v||a)}})();static \u0275prov=t.jDH({token:a,factory:a.\u0275fac})}return a})(),D=(()=>{class a extends M.${get style(){return this._style}set style(d){this._style=d,this.cd.markForCheck()}styleClass;severity;value;icon;rounded;iconTemplate;templates;_iconTemplate;_style;_componentStyle=(0,t.WQX)(e);ngAfterContentInit(){this.templates?.forEach(d=>{"icon"===d.getType()&&(this._iconTemplate=d.template)})}containerClass(){let d="p-tag p-component";return this.severity&&(d+=` p-tag-${this.severity}`),this.rounded&&(d+=" p-tag-rounded"),this.styleClass&&(d+=` ${this.styleClass}`),d}static \u0275fac=(()=>{let d;return function(v){return(d||(d=t.xGo(a)))(v||a)}})();static \u0275cmp=t.VBU({type:a,selectors:[["p-tag"]],contentQueries:function(C,v,m){if(1&C&&(t.wni(m,B,4),t.wni(m,O.Ei,4)),2&C){let k;t.mGM(k=t.lsd())&&(v.iconTemplate=k.first),t.mGM(k=t.lsd())&&(v.templates=k)}},hostVars:4,hostBindings:function(C,v){2&C&&(t.Aen(v.style),t.HbH(v.containerClass()))},inputs:{style:"style",styleClass:"styleClass",severity:"severity",value:"value",icon:"icon",rounded:[2,"rounded","rounded",t.L39]},features:[t.Jv_([e]),t.Vt3],ngContentSelectors:r,decls:5,vars:3,consts:[[4,"ngIf"],["class","p-tag-icon",4,"ngIf"],[1,"p-tag-label"],["class","p-tag-icon",3,"ngClass",4,"ngIf"],[1,"p-tag-icon",3,"ngClass"],[1,"p-tag-icon"],[4,"ngTemplateOutlet"]],template:function(C,v){1&C&&(t.NAR(),t.SdG(0),t.DNE(1,w,2,1,"ng-container",0)(2,U,2,1,"span",1),t.j41(3,"span",2),t.EFF(4),t.k0s()),2&C&&(t.R7$(),t.Y8G("ngIf",!v.iconTemplate&&!v._iconTemplate),t.R7$(),t.Y8G("ngIf",v.iconTemplate||v._iconTemplate),t.R7$(2),t.JRh(v.value))},dependencies:[_.MD,_.YU,_.bT,_.T3,O.Gg],encapsulation:2,changeDetection:0})}return a})(),j=(()=>{class a{static \u0275fac=function(C){return new(C||a)};static \u0275mod=t.$C({type:a});static \u0275inj=t.G2t({imports:[D,O.Gg,O.Gg]})}return a})()},5545:(S,E,i)=>{i.d(E,{g:()=>M});var _=i(4754),t=i(1360),O=i(8989);let M=(()=>{class R{http;baseUrl=`${(0,_.Gi)()}/data-mesh/domains/hotel`;constructor(r){this.http=r}createApartment(r){return this.http.post(`${this.baseUrl}/apartments`,r)}getApartments(){return this.http.get(`${this.baseUrl}/apartments`)}getApartmentById(r){return this.http.get(`${this.baseUrl}/apartments/${r}`)}updateApartment(r,h){return this.http.put(`${this.baseUrl}/apartments/${r}`,h)}deleteApartment(r){return this.http.delete(`${this.baseUrl}/apartments/${r}`)}createRoom(r){return this.http.post(`${this.baseUrl}/rooms/room`,r)}getRooms(){return this.http.get(`${this.baseUrl}/rooms/rooms`)}getRoomById(r){return this.http.get(`${this.baseUrl}/rooms/room/${r}`)}updateRoom(r,h){return this.http.put(`${this.baseUrl}/rooms/room/${r}`,h)}deleteRoom(r){return this.http.delete(`${this.baseUrl}/rooms/room/${r}`)}createBooking(r){return this.http.post(`${this.baseUrl}/bookings/booking`,r)}getBookingById(r){return this.http.get(`${this.baseUrl}/bookings/booking/${r}`)}getBookings(){return this.http.get(`${this.baseUrl}/bookings/bookings`)}updateBooking(r,h){return this.http.put(`${this.baseUrl}/bookings/booking/${r}`,h)}deleteBooking(r){return this.http.delete(`${this.baseUrl}/bookings/booking/${r}`)}cancelBooking(r){return this.http.patch(`${this.baseUrl}/bookings/booking/${r}/cancel`,{})}createReview(r){return this.http.post(`${this.baseUrl}/reviews/review`,r)}getReviewById(r){return this.http.get(`${this.baseUrl}/reviews/review/${r}`)}getReviews(){return this.http.get(`${this.baseUrl}/reviews/reviews`)}getReviewsByApartment(r){return this.http.get(`${this.baseUrl}/reviews/reviews?apartment_id=${r}`)}updateReview(r,h){return this.http.put(`${this.baseUrl}/reviews/review/${r}`,h)}deleteReview(r){return this.http.delete(`${this.baseUrl}/reviews/review/${r}`)}createRating(r){return this.http.post(`${this.baseUrl}/ratings/rating`,r)}getRatingById(r){return this.http.get(`${this.baseUrl}/ratings/rating/${r}`)}getRatings(){return this.http.get(`${this.baseUrl}/ratings/ratings`)}getRatingsByApartment(r){return this.http.get(`${this.baseUrl}/ratings/ratings?apartment_id=${r}`)}getRoomsByApartment(r){return this.http.get(`${this.baseUrl}/rooms/rooms?apartment_id=${r}`)}updateRating(r,h){return this.http.put(`${this.baseUrl}/ratings/rating/${r}`,h)}deleteRating(r){return this.http.delete(`${this.baseUrl}/ratings/rating/${r}`)}healthCheck(){return this.http.get(`${this.baseUrl}/health/`)}getVersion(){return this.http.get(`${this.baseUrl}/version`)}static \u0275fac=function(h){return new(h||R)(t.KVO(O.Qq))};static \u0275prov=t.jDH({token:R,factory:R.\u0275fac,providedIn:"root"})}return R})()},5716:(S,E,i)=>{i.d(E,{EA:()=>T,k2:()=>U});var _=i(2881),t=i(1360),O=i(5779),M=i(3491),R=i(6263);const B=({dt:g})=>`\n.p-skeleton {\n    overflow: hidden;\n    background: ${g("skeleton.background")};\n    border-radius: ${g("skeleton.border.radius")};\n}\n\n.p-skeleton::after {\n    content: "";\n    animation: p-skeleton-animation 1.2s infinite;\n    height: 100%;\n    left: 0;\n    position: absolute;\n    right: 0;\n    top: 0;\n    transform: translateX(-100%);\n    z-index: 1;\n    background: linear-gradient(90deg, rgba(255, 255, 255, 0), ${g("skeleton.animation.background")}, rgba(255, 255, 255, 0));\n}\n\n[dir='rtl'] .p-skeleton::after {\n    animation-name: p-skeleton-animation-rtl;\n}\n\n.p-skeleton-circle {\n    border-radius: 50%;\n}\n\n.p-skeleton-animation-none::after {\n    animation: none;\n}\n\n@keyframes p-skeleton-animation {\n    from {\n        transform: translateX(-100%);\n    }\n    to {\n        transform: translateX(100%);\n    }\n}\n\n@keyframes p-skeleton-animation-rtl {\n    from {\n        transform: translateX(100%);\n    }\n    to {\n        transform: translateX(-100%);\n    }\n}\n`,r={root:{position:"relative"}},h={root:({props:g})=>["p-skeleton p-component",{"p-skeleton-circle":"circle"===g.shape,"p-skeleton-animation-none":"none"===g.animation}]};let w=(()=>{class g extends R.j{name="skeleton";theme=B;classes=h;inlineStyles=r;static \u0275fac=(()=>{let e;return function(D){return(e||(e=t.xGo(g)))(D||g)}})();static \u0275prov=t.jDH({token:g,factory:g.\u0275fac})}return g})(),T=(()=>{class g extends M.${styleClass;style;shape="rectangle";animation="wave";borderRadius;size;width="100%";height="1rem";_componentStyle=(0,t.WQX)(w);containerClass(){return{"p-skeleton p-component":!0,"p-skeleton-circle":"circle"===this.shape,"p-skeleton-animation-none":"none"===this.animation}}get containerStyle(){const e=this._componentStyle?.inlineStyles.root;let f;return f=this.size?{...this.style,...e,width:this.size,height:this.size,borderRadius:this.borderRadius}:{...e,width:this.width,height:this.height,borderRadius:this.borderRadius,...this.style},f}static \u0275fac=(()=>{let e;return function(D){return(e||(e=t.xGo(g)))(D||g)}})();static \u0275cmp=t.VBU({type:g,selectors:[["p-skeleton"]],inputs:{styleClass:"styleClass",style:"style",shape:"shape",animation:"animation",borderRadius:"borderRadius",size:"size",width:"width",height:"height"},features:[t.Jv_([w]),t.Vt3],decls:1,vars:7,consts:[[3,"ngClass","ngStyle"]],template:function(f,D){1&f&&t.nrm(0,"div",0),2&f&&(t.HbH(D.styleClass),t.Y8G("ngClass",D.containerClass())("ngStyle",D.containerStyle),t.BMQ("data-pc-name","skeleton")("aria-hidden",!0)("data-pc-section","root"))},dependencies:[_.MD,_.YU,_.B3,O.Gg],encapsulation:2,changeDetection:0})}return g})(),U=(()=>{class g{static \u0275fac=function(f){return new(f||g)};static \u0275mod=t.$C({type:g});static \u0275inj=t.G2t({imports:[T,O.Gg,O.Gg]})}return g})()},9295:(S,E,i)=>{i.r(E),i.d(E,{RevenueComponent:()=>v});var _=i(2881),t=i(9417),O=i(5207),M=i(1141),R=i(491),B=i(8150),r=i(8559),h=i(6221),w=i(6150),F=i(7722),T=i(5716),U=i(935),g=i(5779),A=i(5545),e=i(1360);const f=()=>[10,25,50];function D(m,k){if(1&m&&(e.j41(0,"p-card",15)(1,"div",16),e.nrm(2,"p-chart",17),e.k0s()()),2&m){const o=e.XpG();e.R7$(2),e.Y8G("data",o.revenueChartData)("options",o.revenueChartOptions)}}function j(m,k){1&m&&(e.j41(0,"tr")(1,"th"),e.EFF(2,"Rank"),e.k0s(),e.j41(3,"th"),e.EFF(4,"Apartment"),e.k0s(),e.j41(5,"th"),e.EFF(6,"Revenue"),e.k0s(),e.j41(7,"th"),e.EFF(8,"Bookings"),e.k0s(),e.j41(9,"th"),e.EFF(10,"Average Price"),e.k0s(),e.j41(11,"th"),e.EFF(12,"Revenue Share"),e.k0s()())}function a(m,k){if(1&m&&(e.j41(0,"tr")(1,"td"),e.nrm(2,"p-tag",23),e.k0s(),e.j41(3,"td")(4,"span",24),e.EFF(5),e.k0s()(),e.j41(6,"td")(7,"span",25),e.EFF(8),e.nI1(9,"currency"),e.k0s()(),e.j41(10,"td")(11,"span",26),e.EFF(12),e.k0s()(),e.j41(13,"td")(14,"span",27),e.EFF(15),e.nI1(16,"currency"),e.k0s()(),e.j41(17,"td")(18,"div",28)(19,"div",29),e.nrm(20,"div",30),e.k0s(),e.j41(21,"span",31),e.EFF(22),e.nI1(23,"number"),e.k0s()()()()),2&m){const o=k.$implicit,l=k.rowIndex,s=e.XpG(2);e.R7$(2),e.Y8G("value","#"+(l+1))("severity",l<3?"success":"info"),e.R7$(3),e.JRh(o.apartment_name),e.R7$(3),e.JRh(e.bMT(9,9,o.revenue)),e.R7$(4),e.JRh(o.bookings),e.R7$(3),e.JRh(e.bMT(16,11,o.averagePrice)),e.R7$(5),e.xc7("width",s.getRevenueShare(o.revenue),"%"),e.R7$(2),e.SpI(" ",e.i5U(23,13,s.getRevenueShare(o.revenue),"1.1-1"),"% ")}}function I(m,k){1&m&&(e.j41(0,"tr")(1,"td",32)(2,"div",33),e.nrm(3,"i",34),e.j41(4,"p"),e.EFF(5,"No revenue data available"),e.k0s()()()())}function d(m,k){if(1&m&&(e.j41(0,"p-card",18)(1,"p-table",19),e.DNE(2,j,13,0,"ng-template",20)(3,a,24,16,"ng-template",21)(4,I,6,0,"ng-template",22),e.k0s()()),2&m){const o=e.XpG();e.R7$(),e.Y8G("value",o.apartmentRevenueData)("paginator",!0)("rows",10)("rowsPerPageOptions",e.lJ4(5,f))("showCurrentPageReport",!0)}}function C(m,k){1&m&&(e.j41(0,"div",35),e.nrm(1,"p-skeleton",36),e.k0s())}let v=(()=>{class m{hotelService;messageService;bookings=[];apartments=[];loading=!1;selectedPeriod="month";periodOptions=[{label:"Last 7 Days",value:"week"},{label:"Last 30 Days",value:"month"},{label:"Last 3 Months",value:"quarter"},{label:"Last Year",value:"year"}];revenueChartData;revenueChartOptions;apartmentRevenueData=[];totalRevenue=0;totalBookings=0;averageRevenue=0;growthRate=0;constructor(o,l){this.hotelService=o,this.messageService=l}ngOnInit(){this.loadData()}loadData(){this.loading=!0,Promise.all([this.hotelService.getBookings().toPromise(),this.hotelService.getApartments().toPromise()]).then(([o,l])=>{this.bookings=o?.data||[],this.apartments=l?.data||[],this.processRevenueData(),this.loading=!1}).catch(()=>{this.messageService.add({severity:"error",summary:"Error",detail:"Failed to load revenue data"}),this.loading=!1})}processRevenueData(){const o=this.getFilteredBookings();this.calculateMetrics(o),this.buildChartData(o),this.buildApartmentRevenue(o)}getFilteredBookings(){const o=new Date;let l=new Date;switch(this.selectedPeriod){case"week":l.setDate(o.getDate()-7);break;case"month":l.setDate(o.getDate()-30);break;case"quarter":l.setMonth(o.getMonth()-3);break;case"year":l.setFullYear(o.getFullYear()-1)}return this.bookings.filter(s=>{const p=new Date(s.created);return p>=l&&p<=o&&"canceled"!==s.booking_status})}calculateMetrics(o){this.totalBookings=o.length,this.totalRevenue=o.reduce((p,P)=>p+(P.total_price||0),0),this.averageRevenue=this.totalBookings>0?this.totalRevenue/this.totalBookings:0;const s=this.getPreviousPeriodBookings().reduce((p,P)=>p+(P.total_price||0),0);this.growthRate=s>0?(this.totalRevenue-s)/s*100:this.totalRevenue>0?100:0}getPreviousPeriodBookings(){const o=new Date;let l=new Date,s=new Date;switch(this.selectedPeriod){case"week":l.setDate(o.getDate()-14),s.setDate(o.getDate()-7);break;case"month":l.setDate(o.getDate()-60),s.setDate(o.getDate()-30);break;case"quarter":l.setMonth(o.getMonth()-6),s.setMonth(o.getMonth()-3);break;case"year":l.setFullYear(o.getFullYear()-2),s.setFullYear(o.getFullYear()-1)}return this.bookings.filter(p=>{const P=new Date(p.created);return P>=l&&P<s&&"canceled"!==p.booking_status})}buildChartData(o){const l=new Map;o.forEach(n=>{const b=new Date(n.created).toISOString().split("T")[0],c=l.get(b)||{revenue:0,count:0};l.set(b,{revenue:c.revenue+(n.total_price||0),count:c.count+1})});const s=Array.from(l.keys()).sort(),p=s.map(n=>l.get(n).revenue),P=s.map(n=>l.get(n).count);this.revenueChartData={labels:s.map(n=>new Date(n).toLocaleDateString("en-US","year"===this.selectedPeriod?{month:"short",year:"numeric"}:{month:"short",day:"numeric"})),datasets:[{label:"Revenue",data:p,fill:!0,backgroundColor:"rgba(59, 130, 246, 0.2)",borderColor:"rgb(59, 130, 246)",tension:.4},{label:"Bookings",data:P,fill:!1,backgroundColor:"rgba(34, 197, 94, 0.2)",borderColor:"rgb(34, 197, 94)",tension:.4,yAxisID:"y1"}]},this.revenueChartOptions={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},title:{display:!0,text:"Revenue & Bookings Trend"}},scales:{y:{type:"linear",display:!0,position:"left",title:{display:!0,text:"Revenue ($)"}},y1:{type:"linear",display:!0,position:"right",title:{display:!0,text:"Number of Bookings"},grid:{drawOnChartArea:!1}}}}}buildApartmentRevenue(o){const l=new Map;o.forEach(s=>{const p=l.get(s.apartment_id)||{revenue:0,bookings:0};l.set(s.apartment_id,{revenue:p.revenue+(s.total_price||0),bookings:p.bookings+1})}),this.apartmentRevenueData=Array.from(l.entries()).map(([s,p])=>({apartment_id:s,apartment_name:this.getApartmentName(s),revenue:p.revenue,bookings:p.bookings,averagePrice:p.bookings>0?p.revenue/p.bookings:0})).sort((s,p)=>p.revenue-s.revenue)}onPeriodChange(){this.processRevenueData()}getApartmentName(o){const l=this.apartments.find(s=>(s.id||s._id)===o);return l?l.title:o}getGrowthColor(){return this.growthRate>=0?"success":"danger"}getRevenueShare(o){return 0===this.totalRevenue?0:o/this.totalRevenue*100}getOccupancyRate(){const o="week"===this.selectedPeriod?7:"month"===this.selectedPeriod?30:"quarter"===this.selectedPeriod?90:365,l=this.totalBookings>0?this.bookings.reduce((P,n)=>P+(n.count_of_days||0),0)/this.totalBookings:0,p=this.apartments.length*o;return p>0?this.totalBookings*l/p*100:0}static \u0275fac=function(l){return new(l||m)(e.rXU(A.g),e.rXU(g.bg))};static \u0275cmp=e.VBU({type:m,selectors:[["app-hotel-revenue"]],features:[e.Jv_([g.bg])],decls:48,vars:24,consts:[["loadingTemplate",""],[1,"revenue-page"],[1,"page-header"],[1,"header-content"],[1,"subtitle"],[1,"header-actions"],["optionLabel","label","optionValue","value",1,"period-selector",3,"ngModelChange","onChange","options","ngModel"],["pButton","","type","button","label","Refresh","icon","pi pi-refresh",1,"p-button-secondary",3,"click"],[1,"summary-cards"],[1,"summary-stat"],[1,"stat-value"],[1,"stat-label"],[1,"stat-change",3,"ngClass"],["header","Revenue & Bookings Trend",4,"ngIf","ngIfElse"],["header","Revenue by Apartment",4,"ngIf"],["header","Revenue & Bookings Trend"],[1,"chart-container"],["type","line",3,"data","options"],["header","Revenue by Apartment"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} apartments","styleClass","p-datatable-sm",3,"value","paginator","rows","rowsPerPageOptions","showCurrentPageReport"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[3,"value","severity"],[1,"apartment-name"],[1,"revenue-amount"],[1,"booking-count"],[1,"avg-price"],[1,"revenue-share"],[1,"share-bar"],[1,"share-fill"],[1,"share-percent"],["colspan","6",1,"text-center"],[1,"empty-state"],[1,"pi","pi-chart-line"],[1,"loading-container"],["height","400px"]],template:function(l,s){if(1&l){const p=e.RV6();e.j41(0,"div",1),e.nrm(1,"p-toast"),e.j41(2,"div",2)(3,"div",3)(4,"div")(5,"h1"),e.EFF(6,"Revenue Analytics"),e.k0s(),e.j41(7,"p",4),e.EFF(8,"Track revenue performance and booking trends"),e.k0s()(),e.j41(9,"div",5)(10,"p-dropdown",6),e.mxI("ngModelChange",function(n){return e.eBV(p),e.DH7(s.selectedPeriod,n)||(s.selectedPeriod=n),e.Njj(n)}),e.bIt("onChange",function(){return e.eBV(p),e.Njj(s.onPeriodChange())}),e.k0s(),e.j41(11,"button",7),e.bIt("click",function(){return e.eBV(p),e.Njj(s.loadData())}),e.k0s()()()(),e.j41(12,"div",8)(13,"p-card")(14,"div",9)(15,"span",10),e.EFF(16),e.nI1(17,"currency"),e.k0s(),e.j41(18,"span",11),e.EFF(19,"Total Revenue"),e.k0s(),e.j41(20,"span",12),e.nrm(21,"i"),e.EFF(22),e.nI1(23,"number"),e.k0s()()(),e.j41(24,"p-card")(25,"div",9)(26,"span",10),e.EFF(27),e.k0s(),e.j41(28,"span",11),e.EFF(29,"Total Bookings"),e.k0s()()(),e.j41(30,"p-card")(31,"div",9)(32,"span",10),e.EFF(33),e.nI1(34,"currency"),e.k0s(),e.j41(35,"span",11),e.EFF(36,"Average Revenue per Booking"),e.k0s()()(),e.j41(37,"p-card")(38,"div",9)(39,"span",10),e.EFF(40),e.nI1(41,"number"),e.k0s(),e.j41(42,"span",11),e.EFF(43,"Occupancy Rate"),e.k0s()()()(),e.DNE(44,D,3,2,"p-card",13)(45,d,5,6,"p-card",14)(46,C,2,0,"ng-template",null,0,e.C5r),e.k0s()}if(2&l){const p=e.sdS(47);e.R7$(10),e.Y8G("options",s.periodOptions),e.R50("ngModel",s.selectedPeriod),e.R7$(6),e.JRh(e.bMT(17,14,s.totalRevenue)),e.R7$(4),e.Y8G("ngClass","text-"+s.getGrowthColor()),e.R7$(),e.HbH(s.growthRate>=0?"pi pi-arrow-up":"pi pi-arrow-down"),e.R7$(),e.Lme(" ",s.growthRate>=0?"+":"","",e.i5U(23,16,s.growthRate,"1.1-1"),"% "),e.R7$(5),e.JRh(s.totalBookings),e.R7$(6),e.JRh(e.bMT(34,19,s.averageRevenue)),e.R7$(7),e.SpI("",e.i5U(41,21,s.getOccupancyRate(),"1.1-1"),"%"),e.R7$(4),e.Y8G("ngIf",!s.loading)("ngIfElse",p),e.R7$(),e.Y8G("ngIf",!s.loading)}},dependencies:[_.MD,_.YU,_.bT,_.QX,_.oe,t.YN,t.BC,t.vS,O.iI,M.tm,M._f,g.Ei,R.Dw,R.Zp,B.kr,B.ms,r.Fr,r.X9,h.bG,h.XI,w.EJ,F.MB,F.y8,T.k2,T.EA,U.$C,U.vw],styles:[".revenue-page[_ngcontent-%COMP%]{padding:2rem}.revenue-page[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem;background:linear-gradient(135deg,var(--p-surface-0) 0%,rgba(var(--p-primary-500),.05) 100%);padding:2rem;border-radius:12px;border-bottom:2px solid rgba(var(--p-primary-500),.2)}.revenue-page[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:space-between;align-items:center}.revenue-page[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:2rem;font-weight:700;color:var(--p-surface-900)}.revenue-page[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{margin:0;font-size:.95rem;color:var(--p-surface-600)}.revenue-page[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;gap:1rem;align-items:center}.revenue-page[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .period-selector[_ngcontent-%COMP%]{min-width:180px}.revenue-page[_ngcontent-%COMP%]   .summary-cards[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:1.5rem;margin-bottom:2rem}.revenue-page[_ngcontent-%COMP%]   .summary-cards[_ngcontent-%COMP%]   p-card[_ngcontent-%COMP%]   .summary-stat[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:1rem}.revenue-page[_ngcontent-%COMP%]   .summary-cards[_ngcontent-%COMP%]   p-card[_ngcontent-%COMP%]   .summary-stat[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;color:var(--p-primary-600);margin-bottom:.5rem}.revenue-page[_ngcontent-%COMP%]   .summary-cards[_ngcontent-%COMP%]   p-card[_ngcontent-%COMP%]   .summary-stat[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{font-size:.85rem;color:var(--p-surface-600);margin-bottom:.5rem}.revenue-page[_ngcontent-%COMP%]   .summary-cards[_ngcontent-%COMP%]   p-card[_ngcontent-%COMP%]   .summary-stat[_ngcontent-%COMP%]   .stat-change[_ngcontent-%COMP%]{font-size:.9rem;font-weight:600;display:flex;align-items:center;gap:.25rem}.revenue-page[_ngcontent-%COMP%]   .summary-cards[_ngcontent-%COMP%]   p-card[_ngcontent-%COMP%]   .summary-stat[_ngcontent-%COMP%]   .stat-change.text-success[_ngcontent-%COMP%]{color:var(--p-success-600)}.revenue-page[_ngcontent-%COMP%]   .summary-cards[_ngcontent-%COMP%]   p-card[_ngcontent-%COMP%]   .summary-stat[_ngcontent-%COMP%]   .stat-change.text-danger[_ngcontent-%COMP%]{color:var(--p-danger-600)}.revenue-page[_ngcontent-%COMP%]   .chart-container[_ngcontent-%COMP%]{height:400px;position:relative}.revenue-page[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]{padding:2rem}.revenue-page[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{padding:3rem;text-align:center;color:var(--p-surface-600)}.revenue-page[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:3rem;margin-bottom:1rem;color:var(--p-surface-400)}.revenue-page[_ngcontent-%COMP%]   .apartment-name[_ngcontent-%COMP%]{font-weight:500}.revenue-page[_ngcontent-%COMP%]   .revenue-amount[_ngcontent-%COMP%]{font-weight:600;color:var(--p-primary-600);font-size:1.1rem}.revenue-page[_ngcontent-%COMP%]   .booking-count[_ngcontent-%COMP%]{font-weight:600;color:var(--p-surface-700)}.revenue-page[_ngcontent-%COMP%]   .avg-price[_ngcontent-%COMP%]{font-weight:500;color:var(--p-surface-600)}.revenue-page[_ngcontent-%COMP%]   .revenue-share[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.revenue-page[_ngcontent-%COMP%]   .revenue-share[_ngcontent-%COMP%]   .share-bar[_ngcontent-%COMP%]{flex:1;height:8px;background:var(--p-surface-200);border-radius:4px;overflow:hidden}.revenue-page[_ngcontent-%COMP%]   .revenue-share[_ngcontent-%COMP%]   .share-bar[_ngcontent-%COMP%]   .share-fill[_ngcontent-%COMP%]{height:100%;background:linear-gradient(90deg,var(--p-primary-500),var(--p-primary-300));transition:width .3s ease}.revenue-page[_ngcontent-%COMP%]   .revenue-share[_ngcontent-%COMP%]   .share-percent[_ngcontent-%COMP%]{font-weight:600;color:var(--p-surface-700);min-width:50px;text-align:right}"]})}return m})()}}]);