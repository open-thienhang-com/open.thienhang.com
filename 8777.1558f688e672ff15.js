"use strict";(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[8777],{8777:(I,u,n)=>{n.r(u),n.d(u,{FilesListComponent:()=>T});var e=n(1360),d=n(2881),p=n(9417),v=n(5207),m=n(1141),g=n(6221),_=n(935),c=n(8150),F=n(2242),h=n(5716),f=n(4631),E=n(5779);const R=()=>["/files"],b=()=>["/files/stats"];function k(s,r){if(1&s&&(e.j41(0,"div",28)(1,"span",29),e.EFF(2,"Upload success:"),e.k0s(),e.j41(3,"span",30),e.EFF(4),e.k0s()()),2&s){const t=e.XpG();e.R7$(4),e.Lme(" ",t.uploadResult.name," (",t.uploadResult.storage_provider,")")}}function C(s,r){if(1&s&&(e.j41(0,"div",31)(1,"div",32)(2,"div")(3,"h2",33),e.EFF(4,"Latest Upload Result"),e.k0s(),e.j41(5,"p",34),e.EFF(6,"Returned directly from upload API"),e.k0s()(),e.nrm(7,"p-tag",35),e.k0s(),e.j41(8,"div",36)(9,"div")(10,"span",37),e.EFF(11,"ID:"),e.k0s(),e.j41(12,"span",38),e.EFF(13),e.k0s()(),e.j41(14,"div")(15,"span",37),e.EFF(16,"Name:"),e.k0s(),e.j41(17,"span",38),e.EFF(18),e.k0s()(),e.j41(19,"div")(20,"span",37),e.EFF(21,"Type:"),e.k0s(),e.j41(22,"span",38),e.EFF(23),e.k0s()(),e.j41(24,"div")(25,"span",37),e.EFF(26,"Size:"),e.k0s(),e.j41(27,"span",38),e.EFF(28),e.k0s()(),e.j41(29,"div")(30,"span",37),e.EFF(31,"Provider:"),e.k0s(),e.j41(32,"span",38),e.EFF(33),e.k0s()(),e.j41(34,"div")(35,"span",37),e.EFF(36,"Upload Date:"),e.k0s(),e.j41(37,"span",38),e.EFF(38),e.nI1(39,"date"),e.k0s()()(),e.j41(40,"div",39)(41,"a",40),e.EFF(42," Open uploaded file "),e.k0s()()()),2&s){const t=e.XpG();e.R7$(7),e.Y8G("value",t.uploadResult.status)("severity","uploaded"===t.uploadResult.status?"success":"info"),e.R7$(6),e.JRh(t.uploadResult.id),e.R7$(5),e.JRh(t.uploadResult.name),e.R7$(5),e.JRh(t.uploadResult.type),e.R7$(5),e.JRh(t.formatBytes(t.uploadResult.size)),e.R7$(5),e.JRh(t.uploadResult.storage_provider),e.R7$(5),e.JRh(e.i5U(39,9,t.uploadResult.upload_date,"medium")),e.R7$(3),e.Y8G("href",t.uploadResult.url,e.B4B)}}function y(s,r){1&s&&(e.j41(0,"div",41)(1,"div",42),e.nrm(2,"p-skeleton",43)(3,"p-skeleton",43)(4,"p-skeleton",43),e.k0s()())}function j(s,r){1&s&&(e.j41(0,"tr")(1,"th"),e.EFF(2,"Name"),e.k0s(),e.j41(3,"th"),e.EFF(4,"Type"),e.k0s(),e.j41(5,"th"),e.EFF(6,"Provider"),e.k0s(),e.j41(7,"th"),e.EFF(8,"Size"),e.k0s(),e.j41(9,"th"),e.EFF(10,"Uploaded By"),e.k0s(),e.j41(11,"th"),e.EFF(12,"Upload Date"),e.k0s(),e.j41(13,"th"),e.EFF(14,"Tags"),e.k0s()())}function P(s,r){1&s&&e.nrm(0,"p-tag",54),2&s&&e.Y8G("value",r.$implicit)}function M(s,r){if(1&s&&(e.j41(0,"tr")(1,"td")(2,"div",48)(3,"span",38),e.EFF(4),e.k0s(),e.j41(5,"a",49),e.EFF(6,"Open file"),e.k0s()()(),e.j41(7,"td"),e.nrm(8,"p-tag",50),e.k0s(),e.j41(9,"td"),e.nrm(10,"p-tag",51),e.k0s(),e.j41(11,"td"),e.EFF(12),e.k0s(),e.j41(13,"td"),e.EFF(14),e.k0s(),e.j41(15,"td"),e.EFF(16),e.nI1(17,"date"),e.k0s(),e.j41(18,"td")(19,"div",52),e.DNE(20,P,1,1,"p-tag",53),e.k0s()()()),2&s){const t=r.$implicit,i=e.XpG(2);e.R7$(4),e.JRh(t.name),e.R7$(),e.Y8G("href",t.url,e.B4B),e.R7$(3),e.Y8G("value",t.type),e.R7$(2),e.Y8G("value",t.storage_provider),e.R7$(2),e.JRh(i.formatBytes(t.size)),e.R7$(2),e.JRh(t.uploaded_by),e.R7$(2),e.JRh(e.i5U(17,8,t.upload_date,"short")),e.R7$(4),e.Y8G("ngForOf",t.tags)}}function L(s,r){if(1&s&&(e.j41(0,"div",44)(1,"p-table",45),e.DNE(2,j,15,0,"ng-template",46)(3,M,21,11,"ng-template",47),e.k0s()()),2&s){const t=e.XpG();e.R7$(),e.Y8G("value",t.filteredFiles)("paginator",!0)("rows",10)("showCurrentPageReport",!0)}}let T=(()=>{class s{filesService=(0,e.WQX)(f.F);loading=!1;uploading=!1;totalRecords=0;files=[];filteredFiles=[];selectedFile=null;selectedProvider="supabase";uploadResult=null;searchTerm="";selectedProviderFilter=null;providerOptions=[{label:"Local",value:"local"},{label:"Supabase",value:"supabase"},{label:"ImageKit",value:"imagekit"}];providerFilterOptions=[{label:"Local",value:"local"},{label:"Supabase",value:"supabase"},{label:"ImageKit",value:"imagekit"}];ngOnInit(){this.loadFiles()}loadFiles(){this.loading=!0,this.filesService.getFiles(100,0).subscribe({next:t=>{this.files=t.files||[],this.totalRecords=t.total||this.files.length,this.syncProviderFilters(),this.applyFilters(),this.loading=!1},error:t=>{console.error("Error loading files",t),this.loading=!1}})}onFileSelected(t){const i=t.target;this.selectedFile=i.files&&i.files.length?i.files[0]:null}upload(){this.selectedFile&&(this.uploading=!0,this.filesService.uploadFile(this.selectedProvider,this.selectedFile).subscribe({next:t=>{this.uploadResult=t,this.uploading=!1,this.selectedFile=null,this.loadFiles()},error:t=>{console.error("Upload failed",t),this.uploading=!1}}))}applyFilters(){const t=this.searchTerm.trim().toLowerCase();this.filteredFiles=this.files.filter(i=>{const l=!this.selectedProviderFilter||i.storage_provider===this.selectedProviderFilter,a=`${i.name} ${i.storage_provider} ${i.uploaded_by} ${i.type}`.toLowerCase(),o=!t||a.includes(t);return l&&o})}clearFilters(){this.searchTerm="",this.selectedProviderFilter=null,this.applyFilters()}formatBytes(t){if(!t)return"0 B";const l=Math.floor(Math.log(t)/Math.log(1024)),a=t/Math.pow(1024,l);return`${a.toFixed(a>=10?0:1)} ${["B","KB","MB","GB","TB"][l]}`}syncProviderFilters(){const t=Array.from(new Set(this.files.map(i=>i.storage_provider).filter(Boolean)));this.providerFilterOptions=t.map(i=>({label:i.charAt(0).toUpperCase()+i.slice(1),value:i}))}static \u0275fac=function(i){return new(i||s)};static \u0275cmp=e.VBU({type:s,selectors:[["app-files-list"]],decls:44,vars:21,consts:[[1,"bg-gray-50","min-h-screen","p-6"],[1,"bg-white","rounded-lg","shadow-sm","p-6","mb-6"],[1,"flex","items-center","justify-between","flex-wrap","gap-4"],[1,"text-3xl","font-bold","text-gray-900","m-0"],[1,"text-gray-600","mt-2","mb-0"],[1,"flex","flex-wrap","gap-2"],["label","Dashboard","icon","pi pi-home","severity","secondary",3,"outlined","routerLink"],["label","Stats","icon","pi pi-chart-bar","severity","secondary",3,"outlined","routerLink"],["icon","pi pi-refresh","severity","info",3,"onClick","outlined","rounded"],[1,"text-lg","font-semibold","text-gray-900","mt-0","mb-4"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4","items-end"],[1,"md:col-span-1"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],["optionLabel","label","optionValue","value",1,"w-full",3,"ngModelChange","options","ngModel"],[1,"md:col-span-2"],["type","file",1,"w-full","border","rounded-md","p-2",3,"change"],["label","Upload","icon","pi pi-upload",1,"w-full",3,"onClick","disabled","loading"],["class","mt-3 text-sm",4,"ngIf"],["class","bg-white rounded-lg shadow-sm p-6 mb-6 border border-green-100",4,"ngIf"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"p-input-icon-left","w-full"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search by name/provider/uploader",1,"w-full",3,"ngModelChange","input","ngModel"],["optionLabel","label","optionValue","value","placeholder","All providers",1,"w-full",3,"ngModelChange","onChange","options","ngModel","showClear"],[1,"flex","items-end"],["label","Clear","icon","pi pi-filter-slash","severity","secondary",3,"onClick","outlined"],["class","bg-white rounded-lg shadow-sm p-6",4,"ngIf"],["class","bg-white rounded-lg shadow-sm overflow-hidden",4,"ngIf"],[1,"mt-3","text-sm"],[1,"text-green-600","font-medium"],[1,"text-gray-700"],[1,"bg-white","rounded-lg","shadow-sm","p-6","mb-6","border","border-green-100"],[1,"flex","items-start","justify-between","flex-wrap","gap-3","mb-4"],[1,"text-lg","font-semibold","text-gray-900","mt-0","mb-1"],[1,"text-sm","text-gray-500","m-0"],[3,"value","severity"],[1,"grid","grid-cols-1","md:grid-cols-2","xl:grid-cols-3","gap-4","text-sm"],[1,"text-gray-500"],[1,"font-medium","text-gray-900"],[1,"mt-4"],["target","_blank","rel","noopener",1,"text-blue-600","text-sm","font-medium",3,"href"],[1,"bg-white","rounded-lg","shadow-sm","p-6"],[1,"space-y-4"],["height","4rem"],[1,"bg-white","rounded-lg","shadow-sm","overflow-hidden"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} files","styleClass","p-datatable-sm",3,"value","paginator","rows","showCurrentPageReport"],["pTemplate","header"],["pTemplate","body"],[1,"flex","flex-col"],["target","_blank","rel","noopener",1,"text-xs","text-blue-600",3,"href"],["severity","info",3,"value"],["severity","success",3,"value"],[1,"flex","flex-wrap","gap-1"],["severity","secondary",3,"value",4,"ngFor","ngForOf"],["severity","secondary",3,"value"]],template:function(i,l){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"h1",3),e.EFF(5,"File Library"),e.k0s(),e.j41(6,"p",4),e.EFF(7,"Browse files, inspect metadata, and upload to providers"),e.k0s()(),e.j41(8,"div",5),e.nrm(9,"p-button",6)(10,"p-button",7),e.j41(11,"p-button",8),e.bIt("onClick",function(){return l.loadFiles()}),e.k0s()()()(),e.j41(12,"div",1)(13,"h2",9),e.EFF(14,"Upload File"),e.k0s(),e.j41(15,"div",10)(16,"div",11)(17,"label",12),e.EFF(18,"Provider"),e.k0s(),e.j41(19,"p-dropdown",13),e.mxI("ngModelChange",function(o){return e.DH7(l.selectedProvider,o)||(l.selectedProvider=o),o}),e.k0s()(),e.j41(20,"div",14)(21,"label",12),e.EFF(22,"Select file"),e.k0s(),e.j41(23,"input",15),e.bIt("change",function(o){return l.onFileSelected(o)}),e.k0s()(),e.j41(24,"div",11)(25,"p-button",16),e.bIt("onClick",function(){return l.upload()}),e.k0s()()(),e.DNE(26,k,5,2,"div",17),e.k0s(),e.DNE(27,C,43,12,"div",18),e.j41(28,"div",1)(29,"div",19)(30,"div")(31,"label",12),e.EFF(32,"Search"),e.k0s(),e.j41(33,"span",20),e.nrm(34,"i",21),e.j41(35,"input",22),e.mxI("ngModelChange",function(o){return e.DH7(l.searchTerm,o)||(l.searchTerm=o),o}),e.bIt("input",function(){return l.applyFilters()}),e.k0s()()(),e.j41(36,"div")(37,"label",12),e.EFF(38,"Provider"),e.k0s(),e.j41(39,"p-dropdown",23),e.mxI("ngModelChange",function(o){return e.DH7(l.selectedProviderFilter,o)||(l.selectedProviderFilter=o),o}),e.bIt("onChange",function(){return l.applyFilters()}),e.k0s()(),e.j41(40,"div",24)(41,"p-button",25),e.bIt("onClick",function(){return l.clearFilters()}),e.k0s()()()(),e.DNE(42,y,5,0,"div",26)(43,L,4,4,"div",27),e.k0s()),2&i&&(e.R7$(9),e.Y8G("outlined",!0)("routerLink",e.lJ4(19,R)),e.R7$(),e.Y8G("outlined",!0)("routerLink",e.lJ4(20,b)),e.R7$(),e.Y8G("outlined",!0)("rounded",!0),e.R7$(8),e.Y8G("options",l.providerOptions),e.R50("ngModel",l.selectedProvider),e.R7$(6),e.Y8G("disabled",l.uploading||!l.selectedFile)("loading",l.uploading),e.R7$(),e.Y8G("ngIf",l.uploadResult),e.R7$(),e.Y8G("ngIf",l.uploadResult),e.R7$(8),e.R50("ngModel",l.searchTerm),e.R7$(4),e.Y8G("options",l.providerFilterOptions),e.R50("ngModel",l.selectedProviderFilter),e.Y8G("showClear",!0),e.R7$(2),e.Y8G("outlined",!0),e.R7$(),e.Y8G("ngIf",l.loading),e.R7$(),e.Y8G("ngIf",!l.loading))},dependencies:[d.MD,d.Sq,d.bT,d.vh,p.YN,p.me,p.BC,p.vS,v.Wk,m.tm,m.$n,E.Ei,g.bG,g.XI,_.$C,_.vw,c.kr,c.ms,F.um,F.Sm,h.k2,h.EA],encapsulation:2})}return s})()}}]);