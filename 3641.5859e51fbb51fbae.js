"use strict";(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[3641],{3641:(x,d,a)=>{a.r(d),a.d(d,{ChatAnalyticsComponent:()=>k});var t=a(1360),p=a(2881),r=a(9417),v=a(5207),y=a(5953),c=a(1141),g=a(8150),C=a(491),m=a(8559),h=a(6221),u=a(935),_=a(5716),E=a(5779);const f=()=>["/chat"],b=()=>["/chat/conversations"];function F(i,s){1&i&&(t.j41(0,"div",15)(1,"div",16),t.nrm(2,"p-skeleton",17)(3,"p-skeleton",17)(4,"p-skeleton",17),t.k0s()())}function O(i,s){1&i&&(t.j41(0,"tr")(1,"th"),t.EFF(2,"Agent"),t.k0s(),t.j41(3,"th"),t.EFF(4,"Conversations"),t.k0s(),t.j41(5,"th"),t.EFF(6,"Avg Response"),t.k0s(),t.j41(7,"th"),t.EFF(8,"Satisfaction"),t.k0s()())}function P(i,s){if(1&i&&(t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.k0s(),t.j41(7,"td"),t.nrm(8,"p-tag",33),t.k0s()()),2&i){const e=s.$implicit,n=t.XpG(2);t.R7$(2),t.JRh(e.agent),t.R7$(2),t.JRh(e.conversations),t.R7$(2),t.JRh(e.avg_response_time),t.R7$(2),t.Y8G("value",e.satisfaction+"/5")("severity",n.getSatisfactionSeverity(e.satisfaction))}}function R(i,s){if(1&i&&(t.qex(0),t.j41(1,"div",18)(2,"div",15)(3,"p",19),t.EFF(4,"Total Conversations"),t.k0s(),t.j41(5,"p",6),t.EFF(6),t.k0s()(),t.j41(7,"div",15)(8,"p",19),t.EFF(9,"Resolution Rate"),t.k0s(),t.j41(10,"p",20),t.EFF(11),t.k0s()(),t.j41(12,"div",15)(13,"p",19),t.EFF(14,"Avg Response Time"),t.k0s(),t.j41(15,"p",21),t.EFF(16),t.k0s()(),t.j41(17,"div",15)(18,"p",19),t.EFF(19,"CSAT"),t.k0s(),t.j41(20,"p",22),t.EFF(21),t.k0s()()(),t.j41(22,"div",23)(23,"div",15)(24,"h2",24),t.EFF(25,"Platform Distribution"),t.k0s(),t.nrm(26,"p-chart",25),t.k0s(),t.j41(27,"div",15)(28,"h2",24),t.EFF(29,"Sentiment Analysis"),t.k0s(),t.nrm(30,"p-chart",26),t.k0s()(),t.j41(31,"div",27)(32,"div",28)(33,"h2",29),t.EFF(34,"Agent Performance"),t.k0s()(),t.j41(35,"p-table",30),t.DNE(36,O,9,0,"ng-template",31)(37,P,9,5,"ng-template",32),t.k0s()(),t.bVm()),2&i){const e=t.XpG();t.R7$(6),t.JRh(e.analytics.overview.total_conversations),t.R7$(5),t.JRh(e.analytics.overview.resolution_rate),t.R7$(5),t.JRh(e.analytics.overview.average_response_time),t.R7$(5),t.SpI("",e.analytics.overview.customer_satisfaction,"/5"),t.R7$(5),t.Y8G("data",e.platformChartData)("options",e.chartOptions),t.R7$(4),t.Y8G("data",e.sentimentChartData)("options",e.barChartOptions),t.R7$(5),t.Y8G("value",e.analytics.agent_performance)("paginator",!0)("rows",8)}}let k=(()=>{class i{chatService=(0,t.WQX)(y.m);loading=!1;analytics=null;selectedPeriod="7d";periodOptions=[{label:"Last 24 hours",value:"24h"},{label:"Last 7 days",value:"7d"},{label:"Last 30 days",value:"30d"}];platformChartData;sentimentChartData;chartOptions;barChartOptions;ngOnInit(){this.initChartOptions(),this.loadAnalytics()}loadAnalytics(){this.loading=!0,this.chatService.getAnalytics(this.selectedPeriod).subscribe({next:e=>{this.analytics=e.data,this.setupCharts(e.data),this.loading=!1},error:e=>{console.error("Error loading analytics",e),this.loading=!1}})}setupCharts(e){const n=getComputedStyle(document.documentElement);this.platformChartData={labels:Object.keys(e.platform_distribution||{}).map(o=>this.toTitle(o)),datasets:[{data:Object.values(e.platform_distribution||{}),backgroundColor:[n.getPropertyValue("--blue-500"),n.getPropertyValue("--cyan-500"),n.getPropertyValue("--green-500"),n.getPropertyValue("--orange-500"),n.getPropertyValue("--purple-500")]}]},this.sentimentChartData={labels:Object.keys(e.sentiment_analysis||{}).map(o=>this.toTitle(o)),datasets:[{label:"Sentiment",backgroundColor:n.getPropertyValue("--blue-500"),data:Object.values(e.sentiment_analysis||{})}]}}initChartOptions(){const e=getComputedStyle(document.documentElement),n=e.getPropertyValue("--text-color"),o=e.getPropertyValue("--surface-border");this.chartOptions={plugins:{legend:{labels:{color:n}}}},this.barChartOptions={plugins:{legend:{labels:{color:n}}},scales:{x:{ticks:{color:n},grid:{color:o}},y:{ticks:{color:n},grid:{color:o}}}}}getSatisfactionSeverity(e){return e>=4.5?"success":e>=4?"info":e>=3?"warn":"danger"}toTitle(e){return e&&e.charAt(0).toUpperCase()+e.slice(1)}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=t.VBU({type:i,selectors:[["app-chat-analytics"]],decls:18,vars:12,consts:[[1,"bg-gray-50","min-h-screen","p-6"],[1,"bg-white","rounded-lg","shadow-sm","p-6","mb-6"],[1,"flex","items-center","justify-between","flex-wrap","gap-4"],[1,"flex","items-center","gap-4"],[1,"w-12","h-12","bg-gradient-to-br","from-purple-500","to-blue-600","rounded-lg","flex","items-center","justify-center"],[1,"pi","pi-chart-bar","text-white","text-xl"],[1,"text-3xl","font-bold","text-gray-900"],[1,"text-gray-600","m-0"],[1,"flex","flex-wrap","items-center","gap-2","sm:gap-3"],["optionLabel","label","optionValue","value",1,"w-11rem",3,"ngModelChange","options","ngModel"],["icon","pi pi-refresh","severity","info",3,"onClick","outlined","rounded"],["label","Dashboard","icon","pi pi-home","severity","secondary",1,"hidden","sm:inline-flex",3,"outlined","routerLink"],["label","Conversations","icon","pi pi-comments","severity","secondary",1,"hidden","sm:inline-flex",3,"outlined","routerLink"],["class","bg-white rounded-lg shadow-sm p-6",4,"ngIf"],[4,"ngIf"],[1,"bg-white","rounded-lg","shadow-sm","p-6"],[1,"space-y-4"],["height","4rem"],[1,"grid","grid-cols-1","md:grid-cols-2","xl:grid-cols-4","gap-6","mb-6"],[1,"text-sm","font-medium","text-gray-600"],[1,"text-3xl","font-bold","text-green-600"],[1,"text-3xl","font-bold","text-orange-600"],[1,"text-3xl","font-bold","text-purple-600"],[1,"grid","grid-cols-1","xl:grid-cols-2","gap-6","mb-6"],[1,"text-lg","font-semibold","text-gray-900","mt-0","mb-4"],["type","doughnut",3,"data","options"],["type","bar",3,"data","options"],[1,"bg-white","rounded-lg","shadow-sm","overflow-hidden"],[1,"px-6","py-4","border-b","border-gray-200"],[1,"text-lg","font-semibold","text-gray-900","m-0"],["styleClass","p-datatable-sm",3,"value","paginator","rows"],["pTemplate","header"],["pTemplate","body"],[3,"value","severity"]],template:function(n,o){1&n&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),t.nrm(5,"i",5),t.k0s(),t.j41(6,"div")(7,"h1",6),t.EFF(8,"Chat Analytics"),t.k0s(),t.j41(9,"p",7),t.EFF(10,"Operational metrics and channel-level performance insights"),t.k0s()()(),t.j41(11,"div",8)(12,"p-dropdown",9),t.mxI("ngModelChange",function(l){return t.DH7(o.selectedPeriod,l)||(o.selectedPeriod=l),l}),t.k0s(),t.j41(13,"p-button",10),t.bIt("onClick",function(){return o.loadAnalytics()}),t.k0s(),t.nrm(14,"p-button",11)(15,"p-button",12),t.k0s()()(),t.DNE(16,F,5,0,"div",13)(17,R,38,11,"ng-container",14),t.k0s()),2&n&&(t.R7$(12),t.Y8G("options",o.periodOptions),t.R50("ngModel",o.selectedPeriod),t.R7$(),t.Y8G("outlined",!0)("rounded",!0),t.R7$(),t.Y8G("outlined",!0)("routerLink",t.lJ4(10,f)),t.R7$(),t.Y8G("outlined",!0)("routerLink",t.lJ4(11,b)),t.R7$(),t.Y8G("ngIf",o.loading),t.R7$(),t.Y8G("ngIf",!o.loading&&o.analytics))},dependencies:[p.MD,p.bT,r.YN,r.BC,r.vS,v.Wk,c.tm,c.$n,E.Ei,g.kr,g.ms,C.Dw,m.Fr,m.X9,h.bG,h.XI,u.$C,u.vw,_.k2,_.EA],encapsulation:2})}return i})()}}]);