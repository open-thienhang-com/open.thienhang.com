"use strict";(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[7923],{7923:(ha,P,p)=>{p.r(P),p.d(P,{DatasetComponent:()=>la});var A=p(467),e=p(1360),C=p(2881),j=p(9417),V=p(6502),Y=p(935),X=p(1141),G=p(8559),z=p(8537),H=p(1570),R=p(3792),$=p(6221),L=p(4381),U=p(1823),E=p(1413),I=p(152),W=p(3294),F=p(7673),q=p(7468),J=p(5558),Q=p(6354),T=p(9437),K=p(4754),Z=p(8512),ee=p(1910),te=p(7643),ae=p(5779);const re=["demandSummaryCanvas"],ie=["demandPickupTimeCanvas"],oe=["demandDeliveryTimeCanvas"],se=["demandTimelineAreaCanvas"],ne=(i,n)=>({"border-orange-300 bg-orange-50/50 ring-1 ring-orange-200":i,"hover:border-orange-200 hover:bg-gray-50":n}),de=()=>["demand","truck","trip","hub"],le=(i,n,t,a,r)=>({"bg-orange-100 text-orange-700":i,"bg-blue-100 text-blue-700":n,"bg-green-100 text-green-700":t,"bg-purple-100 text-purple-700":a,"bg-gray-100 text-gray-700":r}),N=(i,n)=>({"bg-orange-500 text-white shadow-sm":i,"text-gray-600 hover:bg-gray-200":n}),he=i=>({"min-width":i}),ce=()=>[5,10,25,50],ge=()=>({"min-width":"100%"}),B=(i,n)=>({"bg-orange-600 text-white":i,"bg-gray-200 text-gray-700 hover:bg-gray-300":n}),O=(i,n)=>({"bg-orange-100 text-orange-700 hover:bg-orange-200 cursor-pointer":i,"bg-gray-100 text-gray-400 cursor-not-allowed":n}),me=(i,n)=>({"bg-orange-50":i,"hover:bg-gray-50":n});function ue(i,n){1&i&&(e.j41(0,"div",33),e.EFF(1,"Loading retail APIs..."),e.k0s())}function pe(i,n){if(1&i&&(e.j41(0,"div",34),e.EFF(1),e.k0s()),2&i){const t=e.XpG(2);e.R7$(),e.SpI(" ",t.retailOverviewNotice," ")}}function _e(i,n){if(1&i&&(e.j41(0,"p",35),e.EFF(1),e.nI1(2,"date"),e.k0s()),2&i){const t=e.XpG(2);e.R7$(),e.SpI(" ",e.i5U(2,1,t.retailHealth.timestamp,"short")," ")}}function fe(i,n){1&i&&(e.j41(0,"div",36),e.EFF(1," No active alerts "),e.k0s())}function ve(i,n){if(1&i&&(e.j41(0,"p",23),e.EFF(1),e.k0s()),2&i){const t=e.XpG().$implicit,a=e.XpG(3);e.R7$(),e.JRh(a.getAlertSubtitle(t))}}function be(i,n){if(1&i&&(e.j41(0,"div",39)(1,"p",40),e.EFF(2),e.k0s(),e.DNE(3,ve,2,1,"p",41),e.k0s()),2&i){const t=n.$implicit,a=e.XpG(3);e.R7$(2),e.JRh(a.getAlertTitle(t)),e.R7$(),e.Y8G("ngIf",a.getAlertSubtitle(t))}}function xe(i,n){if(1&i&&(e.j41(0,"div",37),e.DNE(1,be,4,2,"div",38),e.nI1(2,"slice"),e.k0s()),2&i){const t=e.XpG(2);e.R7$(),e.Y8G("ngForOf",e.brH(2,1,t.retailAlerts,0,5))}}function ye(i,n){if(1&i&&(e.j41(0,"div",12)(1,"div",13)(2,"div")(3,"h2",14),e.EFF(4,"Retail Domain Overview"),e.k0s(),e.j41(5,"p",15),e.EFF(6,"Live status from Retail APIs"),e.k0s()(),e.DNE(7,ue,2,0,"div",16),e.k0s(),e.DNE(8,pe,2,1,"div",17),e.j41(9,"div",18)(10,"div",19)(11,"p",20),e.EFF(12,"Health"),e.k0s(),e.j41(13,"div",21)(14,"span",22),e.EFF(15),e.k0s()(),e.j41(16,"p",23),e.EFF(17),e.k0s(),e.DNE(18,_e,3,4,"p",24),e.k0s(),e.j41(19,"div",19)(20,"p",20),e.EFF(21,"Version"),e.k0s(),e.j41(22,"p",25),e.EFF(23),e.k0s(),e.j41(24,"p",26),e.EFF(25),e.k0s()(),e.j41(26,"div",19)(27,"p",20),e.EFF(28,"Total Products"),e.k0s(),e.j41(29,"p",25),e.EFF(30),e.nI1(31,"number"),e.k0s(),e.j41(32,"p",26),e.EFF(33),e.nI1(34,"number"),e.k0s()(),e.j41(35,"div",19)(36,"p",20),e.EFF(37,"Inventory Value"),e.k0s(),e.j41(38,"p",25),e.EFF(39),e.nI1(40,"number"),e.k0s(),e.j41(41,"p",26),e.EFF(42),e.k0s()()(),e.j41(43,"div",27)(44,"div",28)(45,"h3",29),e.EFF(46,"Stock Alerts"),e.k0s(),e.j41(47,"span",30),e.EFF(48),e.k0s()(),e.DNE(49,fe,2,0,"div",31)(50,xe,3,5,"div",32),e.k0s()()),2&i){const t=e.XpG();e.R7$(7),e.Y8G("ngIf",t.loadingRetailOverview),e.R7$(),e.Y8G("ngIf",t.retailOverviewNotice),e.R7$(6),e.Y8G("ngClass",t.getHealthBadgeClass(t.retailHealth.status)),e.R7$(),e.SpI(" ",t.retailHealth.status||"unknown"," "),e.R7$(2),e.JRh(t.retailHealth.service||"retail"),e.R7$(),e.Y8G("ngIf",t.retailHealth.timestamp),e.R7$(5),e.JRh(t.retailVersion.version||"N/A"),e.R7$(2),e.SpI("Adapter: ",t.retailVersion.adapter||"retail",""),e.R7$(5),e.JRh(e.bMT(31,16,t.retailInventoryAnalytics.total_products||0)),e.R7$(3),e.SpI("Total Quantity: ",e.bMT(34,18,t.retailInventoryAnalytics.total_quantity||0),""),e.R7$(6),e.JRh(e.bMT(40,20,t.retailInventoryAnalytics.inventory_value||0)),e.R7$(3),e.Lme(" Low stock: ",t.retailInventoryAnalytics.low_stock_products||0," | Out of stock: ",t.retailInventoryAnalytics.out_of_stock_products||0," "),e.R7$(6),e.SpI("",t.retailAlerts.length," alerts"),e.R7$(),e.Y8G("ngIf",0===t.retailAlerts.length),e.R7$(),e.Y8G("ngIf",t.retailAlerts.length>0)}}function ke(i,n){1&i&&(e.j41(0,"div",48)(1,"div",49),e.nrm(2,"div",50),e.j41(3,"span",51),e.EFF(4,"Loading datasets..."),e.k0s()()())}function we(i,n){if(1&i&&(e.j41(0,"div",52)(1,"div",53),e.qSk(),e.j41(2,"svg",54),e.nrm(3,"path",55),e.k0s(),e.joV(),e.j41(4,"div")(5,"h4",56),e.EFF(6,"Data loading error"),e.k0s(),e.j41(7,"span",57),e.EFF(8),e.k0s()()()()),2&i){const t=e.XpG(2);e.R7$(8),e.JRh(t.error)}}function De(i,n){if(1&i&&(e.j41(0,"div",58)(1,"div",59),e.qSk(),e.j41(2,"svg",60),e.nrm(3,"path",61),e.k0s(),e.joV(),e.j41(4,"div")(5,"h4",62),e.EFF(6,"Default data mode"),e.k0s(),e.j41(7,"span",63),e.EFF(8),e.k0s()()()()),2&i){const t=e.XpG(2);e.R7$(8),e.JRh(t.fallbackNotice)}}function Ce(i,n){1&i&&(e.qSk(),e.j41(0,"svg",79),e.nrm(1,"path",80),e.k0s())}function je(i,n){1&i&&(e.qSk(),e.j41(0,"svg",79),e.nrm(1,"path",81),e.k0s())}function Se(i,n){1&i&&(e.qSk(),e.j41(0,"svg",79),e.nrm(1,"path",82),e.k0s())}function Fe(i,n){1&i&&(e.qSk(),e.j41(0,"svg",79),e.nrm(1,"path",83),e.k0s())}function Re(i,n){1&i&&(e.qSk(),e.j41(0,"svg",79),e.nrm(1,"path",84),e.k0s())}function Te(i,n){if(1&i&&(e.j41(0,"p",85),e.EFF(1),e.k0s()),2&i){const t=e.XpG().$implicit;e.R7$(),e.JRh(t.description)}}function Ee(i,n){if(1&i&&(e.j41(0,"div",76)(1,"span",77),e.EFF(2,"Created:"),e.k0s(),e.j41(3,"span",86),e.EFF(4),e.nI1(5,"date"),e.k0s()()),2&i){const t=e.XpG().$implicit;e.R7$(4),e.JRh(e.i5U(5,1,t.created_at,"short"))}}function Ie(i,n){if(1&i){const t=e.RV6();e.j41(0,"button",66),e.bIt("click",function(){const r=e.eBV(t).$implicit,o=e.XpG(3);return e.Njj(o.viewDataset(r))}),e.j41(1,"div",67)(2,"div",68),e.DNE(3,Ce,2,0,"svg",69)(4,je,2,0,"svg",69)(5,Se,2,0,"svg",69)(6,Fe,2,0,"svg",69)(7,Re,2,0,"svg",69),e.k0s(),e.j41(8,"div",70)(9,"h4",71),e.EFF(10),e.k0s(),e.j41(11,"p",72)(12,"span",73),e.EFF(13),e.k0s()()()(),e.DNE(14,Te,2,1,"p",74),e.j41(15,"div",75)(16,"div",76)(17,"span",77),e.EFF(18,"Records:"),e.k0s(),e.j41(19,"span",29),e.EFF(20),e.nI1(21,"number"),e.k0s()(),e.DNE(22,Ee,6,4,"div",78),e.k0s()()}if(2&i){const t=n.$implicit,a=e.XpG(3);e.Y8G("ngClass",e.l_i(16,ne,a.selectedDatasetId===t.id,a.selectedDatasetId!==t.id)),e.R7$(2),e.xc7("background","demand"===t.type?"linear-gradient(to bottom right, #fb923c, #ea580c)":"truck"===t.type?"linear-gradient(to bottom right, #60a5fa, #3b82f6)":"trip"===t.type?"linear-gradient(to bottom right, #4ade80, #22c55e)":"hub"===t.type?"linear-gradient(to bottom right, #a78bfa, #8b5cf6)":"linear-gradient(to bottom right, #6b7280, #374151)"),e.R7$(),e.Y8G("ngIf","truck"===t.type),e.R7$(),e.Y8G("ngIf","demand"===t.type),e.R7$(),e.Y8G("ngIf","trip"===t.type),e.R7$(),e.Y8G("ngIf","hub"===t.type),e.R7$(),e.Y8G("ngIf",!t.type||"truck"!==t.type&&"demand"!==t.type&&"trip"!==t.type&&"hub"!==t.type),e.R7$(3),e.JRh(t.name||"Unnamed Dataset"),e.R7$(2),e.Y8G("ngClass",e.s1E(20,le,"demand"===t.type,"truck"===t.type,"trip"===t.type,"hub"===t.type,!e.lJ4(19,de).includes(t.type||""))),e.R7$(),e.SpI(" ",t.type||"unknown"," "),e.R7$(),e.Y8G("ngIf",t.description),e.R7$(6),e.JRh(e.bMT(21,14,t.records||0)),e.R7$(2),e.Y8G("ngIf",t.created_at)}}function We(i,n){if(1&i&&(e.j41(0,"div",64),e.DNE(1,Ie,23,26,"button",65),e.k0s()),2&i){const t=e.XpG(2);e.R7$(),e.Y8G("ngForOf",t.datasets)("ngForTrackBy",t.trackByDatasetId)}}function Me(i,n){if(1&i){const t=e.RV6();e.j41(0,"div",87)(1,"div",49),e.qSk(),e.j41(2,"svg",88),e.nrm(3,"path",89),e.k0s(),e.joV(),e.j41(4,"h3",90),e.EFF(5,"No datasets yet"),e.k0s(),e.j41(6,"p",91),e.EFF(7,"Create a dataset to start analysis"),e.k0s(),e.j41(8,"button",92),e.bIt("click",function(){e.eBV(t);const r=e.XpG(2);return e.Njj(r.createDataset())}),e.EFF(9," Create Dataset "),e.k0s()()()}}function Pe(i,n){if(1&i&&(e.j41(0,"div",42),e.DNE(1,ke,5,0,"div",43)(2,we,9,1,"div",44)(3,De,9,1,"div",45)(4,We,2,2,"div",46)(5,Me,10,0,"div",47),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.Y8G("ngIf",t.loading),e.R7$(),e.Y8G("ngIf",t.error&&!t.loading),e.R7$(),e.Y8G("ngIf",t.fallbackNotice&&!t.loading),e.R7$(),e.Y8G("ngIf",!t.loading&&!t.error&&t.datasets.length>0),e.R7$(),e.Y8G("ngIf",!t.loading&&!t.error&&0===t.datasets.length)}}function Ae(i,n){if(1&i&&(e.j41(0,"span"),e.EFF(1),e.nI1(2,"date"),e.nI1(3,"date"),e.k0s()),2&i){const t=e.XpG(3);e.R7$(),e.Lme(" ",e.i5U(2,2,t.demandStartDate,"dd/MM/yyyy")," - ",e.i5U(3,5,t.demandEndDate,"dd/MM/yyyy")," ")}}function Ge(i,n){1&i&&(e.j41(0,"span",117),e.EFF(1,"Not selected"),e.k0s())}function $e(i,n){if(1&i&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&i){const t=e.XpG(3);e.R7$(),e.Lme(" ",t.warehouseRegionShortname," - ",t.getRegionName(t.warehouseRegionShortname)," ")}}function Ne(i,n){1&i&&(e.j41(0,"span",117),e.EFF(1,"-"),e.k0s())}function Be(i,n){if(1&i&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&i){const t=e.XpG(3);e.R7$(),e.SpI(" ",t.timelineWarehouses[0].province_name," ")}}function Oe(i,n){1&i&&(e.j41(0,"span",117),e.EFF(1,"-"),e.k0s())}function Ve(i,n){if(1&i&&(e.j41(0,"div",122)(1,"div",86),e.EFF(2),e.k0s(),e.j41(3,"div",77),e.EFF(4),e.k0s()()),2&i){const t=n.$implicit,a=e.XpG(4);e.R7$(2),e.JRh(t.name||"Ca"),e.R7$(2),e.JRh(a.formatShiftTime(t))}}function Ye(i,n){if(1&i&&(e.j41(0,"div",118)(1,"div",119)(2,"div",120),e.EFF(3,"Shift Name"),e.k0s(),e.j41(4,"div",120),e.EFF(5,"Time Range"),e.k0s()(),e.DNE(6,Ve,5,2,"div",121),e.k0s()),2&i){const t=e.XpG(3);e.R7$(6),e.Y8G("ngForOf",t.shifts)}}function Xe(i,n){1&i&&(e.j41(0,"span",117),e.EFF(1,"-"),e.k0s())}function ze(i,n){if(1&i&&(e.j41(0,"div",109)(1,"table",110)(2,"tbody")(3,"tr",111)(4,"td",112),e.EFF(5,"Time Range:"),e.k0s(),e.j41(6,"td",113),e.DNE(7,Ae,4,8,"span",114)(8,Ge,2,0,"span",115),e.k0s()(),e.j41(9,"tr",111)(10,"td",112),e.EFF(11,"Region:"),e.k0s(),e.j41(12,"td",113),e.DNE(13,$e,2,2,"span",114)(14,Ne,2,0,"span",115),e.k0s()(),e.j41(15,"tr",111)(16,"td",112),e.EFF(17,"Province:"),e.k0s(),e.j41(18,"td",113),e.DNE(19,Be,2,1,"span",114)(20,Oe,2,0,"span",115),e.k0s()(),e.j41(21,"tr")(22,"td",112),e.EFF(23,"Shifts:"),e.k0s(),e.j41(24,"td",113),e.DNE(25,Ye,7,1,"div",116)(26,Xe,2,0,"span",115),e.k0s()()()()()),2&i){const t=e.XpG(2);e.R7$(7),e.Y8G("ngIf",t.demandStartDate&&t.demandEndDate),e.R7$(),e.Y8G("ngIf",!t.demandStartDate||!t.demandEndDate),e.R7$(5),e.Y8G("ngIf",t.warehouseRegionShortname),e.R7$(),e.Y8G("ngIf",!t.warehouseRegionShortname),e.R7$(5),e.Y8G("ngIf",t.timelineWarehouses.length>0&&t.timelineWarehouses[0].province_name),e.R7$(),e.Y8G("ngIf",0===t.timelineWarehouses.length||!t.timelineWarehouses[0].province_name),e.R7$(5),e.Y8G("ngIf",t.shifts&&t.shifts.length>0),e.R7$(),e.Y8G("ngIf",!t.shifts||0===t.shifts.length)}}function He(i,n){if(1&i){const t=e.RV6();e.j41(0,"button",139),e.bIt("click",function(){e.eBV(t);const r=e.XpG(3);return e.Njj(r.clearAllPoints())}),e.EFF(1," Clear all "),e.k0s()}}function Le(i,n){if(1&i){const t=e.RV6();e.j41(0,"button",140),e.bIt("click",function(){e.eBV(t);const r=e.XpG(3);return e.Njj(r.clearSearch())}),e.qSk(),e.j41(1,"svg",101),e.nrm(2,"path",141),e.k0s()()}}function Ue(i,n){if(1&i){const t=e.RV6();e.j41(0,"div",144)(1,"div",145),e.EFF(2),e.k0s(),e.j41(3,"div",70)(4,"div",146),e.EFF(5),e.k0s(),e.j41(6,"div",147),e.EFF(7),e.k0s()(),e.j41(8,"button",148),e.bIt("click",function(){const r=e.eBV(t).$implicit,o=e.XpG(4);return e.Njj(o.removeFromTimeline(r))}),e.qSk(),e.j41(9,"svg",149),e.nrm(10,"path",141),e.k0s()()()}if(2&i){const t=n.$implicit,a=n.index,r=e.XpG(4);e.R7$(2),e.SpI(" ",(r.timelineCurrentPage-1)*r.timelinePageSize+a+1," "),e.R7$(3),e.JRh(t.warehouse_name),e.R7$(2),e.Lme("",t.district_name,", ",t.province_name,"")}}function qe(i,n){if(1&i&&(e.j41(0,"div",142),e.DNE(1,Ue,11,4,"div",143),e.k0s()),2&i){const t=e.XpG(3);e.R7$(),e.Y8G("ngForOf",t.paginatedTimelineWarehouses)}}function Je(i,n){if(1&i){const t=e.RV6();e.j41(0,"div",150)(1,"div",23),e.EFF(2),e.k0s(),e.j41(3,"div",151)(4,"button",152),e.bIt("click",function(){e.eBV(t);const r=e.XpG(3);return e.Njj(r.goToTimelinePreviousPage())}),e.EFF(5," Previous "),e.k0s(),e.j41(6,"span",153),e.EFF(7),e.k0s(),e.j41(8,"button",152),e.bIt("click",function(){e.eBV(t);const r=e.XpG(3);return e.Njj(r.goToTimelineNextPage())}),e.EFF(9," Next "),e.k0s()()()}if(2&i){const t=e.XpG(3);e.R7$(2),e.E5c(" Showing ",t.getTimelinePageStart(),"-",t.getTimelinePageEnd()," / ",t.timelineWarehouses.length," "),e.R7$(2),e.Y8G("disabled",1===t.timelineCurrentPage),e.R7$(3),e.Lme(" ",t.timelineCurrentPage," / ",t.timelineTotalPages," "),e.R7$(),e.Y8G("disabled",t.timelineCurrentPage===t.timelineTotalPages)}}function Qe(i,n){1&i&&(e.j41(0,"div",154),e.qSk(),e.j41(1,"svg",155),e.nrm(2,"path",127),e.k0s(),e.joV(),e.j41(3,"p",156),e.EFF(4,"No warehouse selected"),e.k0s(),e.j41(5,"p",157),e.EFF(6,"Select region and warehouse to add to the list"),e.k0s()())}function Ke(i,n){if(1&i){const t=e.RV6();e.j41(0,"div",123)(1,"div",124)(2,"h3",125),e.qSk(),e.j41(3,"svg",126),e.nrm(4,"path",127),e.k0s(),e.joV(),e.j41(5,"span"),e.EFF(6,"Warehouse List"),e.k0s(),e.j41(7,"span",128),e.EFF(8),e.k0s()(),e.DNE(9,He,2,0,"button",129),e.k0s(),e.j41(10,"div",130)(11,"div",8)(12,"div",131),e.qSk(),e.j41(13,"svg",132),e.nrm(14,"path",133),e.k0s()(),e.joV(),e.j41(15,"input",134),e.mxI("ngModelChange",function(r){e.eBV(t);const o=e.XpG(2);return e.DH7(o.demandSearchQuery,r)||(o.demandSearchQuery=r),e.Njj(r)}),e.bIt("ngModelChange",function(){e.eBV(t);const r=e.XpG(2);return e.Njj(r.triggerChangeDetection())}),e.k0s(),e.DNE(16,Le,3,0,"button",135),e.k0s()(),e.DNE(17,qe,2,1,"div",136)(18,Je,10,7,"div",137)(19,Qe,7,0,"div",138),e.k0s()}if(2&i){const t=e.XpG(2);e.R7$(8),e.JRh(t.timelineWarehouses.length),e.R7$(),e.Y8G("ngIf",t.timelineWarehouses.length>0),e.R7$(6),e.R50("ngModel",t.demandSearchQuery),e.R7$(),e.Y8G("ngIf",t.demandSearchQuery),e.R7$(),e.Y8G("ngIf",t.timelineWarehouses.length>0),e.R7$(),e.Y8G("ngIf",t.timelineWarehouses.length>t.timelinePageSize),e.R7$(),e.Y8G("ngIf",0===t.timelineWarehouses.length)}}function Ze(i,n){1&i&&(e.j41(0,"div",87)(1,"div",49),e.nrm(2,"div",242),e.j41(3,"span",243),e.EFF(4,"Loading demand data..."),e.k0s()()())}function et(i,n){if(1&i&&(e.j41(0,"div",244)(1,"div",53)(2,"div",245),e.qSk(),e.j41(3,"svg",246),e.nrm(4,"path",55),e.k0s()(),e.joV(),e.j41(5,"div")(6,"h4",56),e.EFF(7,"Data loading error"),e.k0s(),e.j41(8,"span",57),e.EFF(9),e.k0s()()()()),2&i){const t=e.XpG(3);e.R7$(9),e.JRh(t.demandsError)}}function tt(i,n){1&i&&(e.j41(0,"div",247)(1,"div",248),e.nrm(2,"div",249),e.j41(3,"span",243),e.EFF(4,"Loading timeline data..."),e.k0s()()())}function at(i,n){if(1&i&&(e.j41(0,"div",250)(1,"p",251),e.EFF(2),e.k0s()()),2&i){const t=e.XpG(3);e.R7$(2),e.JRh(t.timelineDataError)}}function rt(i,n){if(1&i){const t=e.RV6();e.j41(0,"div",252)(1,"div",175)(2,"label",197),e.EFF(3,"Chart Type:"),e.k0s(),e.j41(4,"div",253)(5,"button",254),e.bIt("click",function(){e.eBV(t);const r=e.XpG(3);return r.timelineChartType="column",e.Njj(r.updateTimelineChart())}),e.EFF(6," Bar "),e.k0s(),e.j41(7,"button",254),e.bIt("click",function(){e.eBV(t);const r=e.XpG(3);return r.timelineChartType="line",e.Njj(r.updateTimelineChart())}),e.EFF(8," Line "),e.k0s()()(),e.j41(9,"div",151)(10,"input",255),e.mxI("ngModelChange",function(r){e.eBV(t);const o=e.XpG(3);return e.DH7(o.showTimelineAverage,r)||(o.showTimelineAverage=r),e.Njj(r)}),e.bIt("change",function(){e.eBV(t);const r=e.XpG(3);return e.Njj(r.updateTimelineChart())}),e.k0s(),e.j41(11,"label",256),e.EFF(12," Show average line "),e.k0s()()()}if(2&i){const t=e.XpG(3);e.R7$(5),e.Y8G("ngClass",e.l_i(3,B,"column"===t.timelineChartType,"column"!==t.timelineChartType)),e.R7$(2),e.Y8G("ngClass",e.l_i(6,B,"line"===t.timelineChartType,"line"!==t.timelineChartType)),e.R7$(3),e.R50("ngModel",t.showTimelineAverage)}}function it(i,n){1&i&&(e.j41(0,"div",261)(1,"p",262),e.EFF(2,"No data to display"),e.k0s()())}function ot(i,n){if(1&i&&(e.j41(0,"div",257)(1,"div",258),e.nrm(2,"canvas",259,1),e.k0s(),e.DNE(4,it,3,0,"div",260),e.k0s()),2&i){const t=e.XpG(3);e.R7$(4),e.Y8G("ngIf",!t.hasTimelineData)}}function st(i,n){if(1&i){const t=e.RV6();e.j41(0,"tr",277),e.bIt("click",function(){const r=e.eBV(t).$implicit,o=e.XpG(4);return e.Njj(o.toggleTimelineWarehouse(o.toString(r.warehouse_id||r.id)))}),e.j41(1,"td",278),e.bIt("click",function(r){return e.eBV(t),e.Njj(r.stopPropagation())}),e.j41(2,"input",279),e.bIt("change",function(){const r=e.eBV(t).$implicit,o=e.XpG(4);return e.Njj(o.toggleTimelineWarehouse(o.toString(r.warehouse_id||r.id)))}),e.k0s()(),e.j41(3,"td",280),e.EFF(4),e.k0s(),e.j41(5,"td",281),e.EFF(6),e.k0s()()}if(2&i){const t=n.$implicit,a=e.XpG(4);e.R7$(2),e.Y8G("checked",0===a.selectedTimelineWarehouseIds.length||a.selectedTimelineWarehouseIds.includes(a.toString(t.warehouse_id||t.id))),e.R7$(2),e.JRh(t.warehouse_name),e.R7$(2),e.JRh(t.warehouse_id)}}function nt(i,n){if(1&i){const t=e.RV6();e.j41(0,"div",282)(1,"div",283),e.EFF(2," Showing "),e.j41(3,"span",284),e.EFF(4),e.k0s(),e.EFF(5," to "),e.j41(6,"span",284),e.EFF(7),e.k0s(),e.EFF(8," in total "),e.j41(9,"span",284),e.EFF(10),e.k0s(),e.EFF(11," warehouses "),e.k0s(),e.j41(12,"div",151)(13,"button",285),e.bIt("click",function(){e.eBV(t);const r=e.XpG(4);return e.Njj(r.goToTimelineWarehousePreviousPage())}),e.EFF(14," Previous "),e.k0s(),e.j41(15,"span",283),e.EFF(16," Page "),e.j41(17,"span",284),e.EFF(18),e.k0s(),e.EFF(19," / "),e.j41(20,"span",284),e.EFF(21),e.k0s()(),e.j41(22,"button",285),e.bIt("click",function(){e.eBV(t);const r=e.XpG(4);return e.Njj(r.goToTimelineWarehouseNextPage())}),e.EFF(23," Next "),e.k0s()()()}if(2&i){const t=e.XpG(4);e.R7$(4),e.JRh(t.getTimelineWarehousePageStart()),e.R7$(3),e.JRh(t.getTimelineWarehousePageEnd()),e.R7$(3),e.JRh(t.availableTimelineWarehouses.length),e.R7$(3),e.Y8G("disabled",1===t.timelineWarehouseCurrentPage)("ngClass",e.l_i(9,O,t.timelineWarehouseCurrentPage>1,1===t.timelineWarehouseCurrentPage)),e.R7$(5),e.JRh(t.timelineWarehouseCurrentPage),e.R7$(3),e.JRh(t.timelineWarehouseTotalPages),e.R7$(),e.Y8G("disabled",t.timelineWarehouseCurrentPage===t.timelineWarehouseTotalPages)("ngClass",e.l_i(12,O,t.timelineWarehouseCurrentPage<t.timelineWarehouseTotalPages,t.timelineWarehouseCurrentPage===t.timelineWarehouseTotalPages))}}function dt(i,n){if(1&i){const t=e.RV6();e.j41(0,"div",263)(1,"div",264)(2,"label",197),e.EFF(3),e.k0s(),e.j41(4,"div",253)(5,"button",265),e.bIt("click",function(){e.eBV(t);const r=e.XpG(3);return e.Njj(r.selectAllTimelineWarehouses())}),e.EFF(6," Select all "),e.k0s(),e.j41(7,"button",266),e.bIt("click",function(){e.eBV(t);const r=e.XpG(3);return e.Njj(r.deselectAllTimelineWarehouses())}),e.EFF(8," Clear selection "),e.k0s()()(),e.j41(9,"div",267)(10,"table",268)(11,"thead",269)(12,"tr")(13,"th",270)(14,"input",271),e.bIt("change",function(){e.eBV(t);const r=e.XpG(3);return e.Njj(r.selectedTimelineWarehouseIds.length===r.availableTimelineWarehouses.length?r.deselectAllTimelineWarehouses():r.selectAllTimelineWarehouses())}),e.k0s()(),e.j41(15,"th",272),e.EFF(16,"Warehouse Name"),e.k0s(),e.j41(17,"th",273),e.EFF(18,"ID"),e.k0s()()(),e.j41(19,"tbody",274),e.DNE(20,st,7,3,"tr",275),e.k0s()()(),e.DNE(21,nt,24,15,"div",276),e.k0s()}if(2&i){const t=e.XpG(3);e.R7$(3),e.SpI(" Select Warehouses (",0===t.selectedTimelineWarehouseIds.length?"All":t.selectedTimelineWarehouseIds.length+" selected",") "),e.R7$(11),e.Y8G("checked",t.selectedTimelineWarehouseIds.length===t.availableTimelineWarehouses.length&&t.availableTimelineWarehouses.length>0),e.R7$(6),e.Y8G("ngForOf",t.paginatedAvailableTimelineWarehouses),e.R7$(),e.Y8G("ngIf",t.timelineWarehouseTotalPages>1)}}function lt(i,n){1&i&&(e.j41(0,"div",247)(1,"div",248),e.nrm(2,"div",249),e.j41(3,"span",243),e.EFF(4,"Loading shift ratio data..."),e.k0s()()())}function ht(i,n){if(1&i&&(e.j41(0,"p",295),e.EFF(1),e.k0s()),2&i){const t=e.XpG(5);e.R7$(),e.JRh(t.shiftRatioError)}}function ct(i,n){1&i&&(e.j41(0,"p",295),e.EFF(1,"No regional analysis data found"),e.k0s())}function gt(i,n){if(1&i&&(e.j41(0,"div",291),e.qSk(),e.j41(1,"svg",292),e.nrm(2,"path",287),e.k0s(),e.joV(),e.j41(3,"h3",293),e.EFF(4,"No data"),e.k0s(),e.DNE(5,ht,2,1,"p",294)(6,ct,2,0,"p",294),e.k0s()),2&i){const t=e.XpG(4);e.R7$(5),e.Y8G("ngIf",t.shiftRatioError),e.R7$(),e.Y8G("ngIf",!t.shiftRatioError)}}function mt(i,n){1&i&&(e.j41(0,"tr",306)(1,"td",307),e.EFF(2," No data "),e.k0s()())}function ut(i,n){if(1&i&&(e.j41(0,"tr",308)(1,"td",309)(2,"div",310)(3,"div",311)(4,"span",312),e.EFF(5),e.k0s()(),e.j41(6,"div")(7,"div",313),e.EFF(8),e.k0s()()()(),e.j41(9,"td",314)(10,"span",315),e.EFF(11),e.k0s()(),e.j41(12,"td",316)(13,"div",317)(14,"span",318),e.EFF(15),e.k0s(),e.j41(16,"div",319),e.nrm(17,"div",320),e.k0s()()(),e.j41(18,"td",316)(19,"div",317)(20,"span",321),e.EFF(21),e.k0s(),e.j41(22,"div",319),e.nrm(23,"div",322),e.k0s()()()()),2&i){const t=n.$implicit,a=n.index,r=e.XpG(5);e.R7$(5),e.JRh(a+1),e.R7$(3),e.JRh(t.shift_name||(null==t.shift?null:t.shift.name)||(null==r.shifts[a]?null:r.shifts[a].name)||"Shift "+(a+1)),e.R7$(3),e.Lme(" ",void 0!==(null==t.shift?null:t.shift.start_hour)?t.shift.start_hour:(null==r.shifts[a]?null:r.shifts[a].start_hour)||0,":00 - ",void 0!==(null==t.shift?null:t.shift.end_hour)?t.shift.end_hour:(null==r.shifts[a]?null:r.shifts[a].end_hour)||0,":00 "),e.R7$(4),e.SpI("",(100*(t.pick_ratio||0)).toFixed(1),"%"),e.R7$(2),e.xc7("width",100*(t.pick_ratio||0),"%"),e.R7$(4),e.SpI("",(100*(t.deliver_ratio||0)).toFixed(1),"%"),e.R7$(2),e.xc7("width",100*(t.deliver_ratio||0),"%")}}function pt(i,n){if(1&i&&(e.j41(0,"div",296)(1,"h4",297),e.qSk(),e.j41(2,"svg",298),e.nrm(3,"path",127),e.k0s(),e.EFF(4," Shift Volume Ratio Table "),e.k0s(),e.joV(),e.j41(5,"div",267)(6,"table",299)(7,"thead",300)(8,"tr")(9,"th",301),e.EFF(10,"Shift"),e.k0s(),e.j41(11,"th",302),e.EFF(12,"Time Slot"),e.k0s(),e.j41(13,"th",303),e.EFF(14,"Pick Ratio (%)"),e.k0s(),e.j41(15,"th",303),e.EFF(16,"Deliver Ratio (%)"),e.k0s()()(),e.j41(17,"tbody",274),e.DNE(18,mt,3,0,"tr",304)(19,ut,24,10,"tr",305),e.k0s()()()()),2&i){const t=e.XpG(4);e.R7$(18),e.Y8G("ngIf",!t.shiftRatios||0===t.shiftRatios.length),e.R7$(),e.Y8G("ngForOf",t.shiftRatios)}}function _t(i,n){if(1&i&&(e.j41(0,"div",323)(1,"div",324)(2,"div",67)(3,"div",325),e.qSk(),e.j41(4,"svg",169),e.nrm(5,"path",172),e.k0s()(),e.joV(),e.j41(6,"div")(7,"h5",14),e.EFF(8,"Pick Distribution by Shift"),e.k0s(),e.j41(9,"p",23),e.EFF(10,"Total pick volume by shift"),e.k0s()()(),e.j41(11,"div",326),e.nrm(12,"canvas",327,2),e.k0s()(),e.j41(14,"div",328)(15,"div",67)(16,"div",329),e.qSk(),e.j41(17,"svg",169),e.nrm(18,"path",172),e.k0s()(),e.joV(),e.j41(19,"div")(20,"h5",14),e.EFF(21,"Deliver Distribution by Shift"),e.k0s(),e.j41(22,"p",23),e.EFF(23,"Total deliver volume by shift"),e.k0s()()(),e.j41(24,"div",326),e.nrm(25,"canvas",327,3),e.k0s()()()),2&i){const t=e.XpG(4);e.R7$(12),e.xc7("display",t.shiftRatios&&0!==t.shiftRatios.length?"block":"none"),e.R7$(13),e.xc7("display",t.shiftRatios&&0!==t.shiftRatios.length?"block":"none")}}function ft(i,n){if(1&i&&(e.j41(0,"div",286)(1,"div")(2,"div",174)(3,"div",175)(4,"div",176),e.qSk(),e.j41(5,"svg",177),e.nrm(6,"path",287),e.k0s()(),e.joV(),e.j41(7,"div")(8,"h3",178),e.EFF(9,"Shift-based Volume Analysis"),e.k0s(),e.j41(10,"p",179),e.EFF(11,"Analyze volume distribution by shift and time window"),e.k0s()()()(),e.j41(12,"div",180),e.DNE(13,lt,5,0,"div",181)(14,gt,7,2,"div",288)(15,pt,20,2,"div",289)(16,_t,27,4,"div",290),e.k0s()()()),2&i){const t=e.XpG(3);e.R7$(13),e.Y8G("ngIf",t.loadingShiftRatio),e.R7$(),e.Y8G("ngIf",!t.loadingShiftRatio&&(t.shiftRatioError||!t.shiftRatios||0===t.shiftRatios.length)),e.R7$(),e.Y8G("ngIf",!t.loadingShiftRatio),e.R7$(),e.Y8G("ngIf",!t.loadingShiftRatio&&t.shiftRatios&&t.shiftRatios.length>0)}}function vt(i,n){if(1&i&&(e.j41(0,"span",330),e.EFF(1," (Showing: "),e.j41(2,"span",331),e.EFF(3),e.k0s(),e.EFF(4,") "),e.k0s()),2&i){const t=e.XpG(3);e.R7$(3),e.JRh(t.filteredDemands.length)}}function bt(i,n){1&i&&(e.j41(0,"div",87)(1,"div",49),e.nrm(2,"div",50),e.j41(3,"span",243),e.EFF(4,"Loading demand data..."),e.k0s()()())}function xt(i,n){if(1&i&&(e.j41(0,"div",332)(1,"div",53)(2,"div",245),e.qSk(),e.j41(3,"svg",246),e.nrm(4,"path",55),e.k0s()(),e.joV(),e.j41(5,"div")(6,"h4",56),e.EFF(7,"Data loading error"),e.k0s(),e.j41(8,"span",57),e.EFF(9),e.k0s()()()()),2&i){const t=e.XpG(3);e.R7$(9),e.JRh(t.demandsError)}}function yt(i,n){1&i&&(e.j41(0,"div",333)(1,"div",334)(2,"div",335),e.qSk(),e.j41(3,"svg",169),e.nrm(4,"path",99),e.k0s()(),e.joV(),e.j41(5,"div")(6,"h4",336),e.EFF(7,"No warehouses yet"),e.k0s(),e.j41(8,"p",337),e.EFF(9,"Please add warehouses to the timeline to view demand data."),e.k0s()()()())}function kt(i,n){1&i&&(e.j41(0,"div",338),e.qSk(),e.j41(1,"svg",339),e.nrm(2,"path",161),e.k0s(),e.joV(),e.j41(3,"p",340),e.EFF(4,"Select warehouses to view details"),e.k0s()())}function wt(i,n){1&i&&(e.qSk(),e.nrm(0,"path",350))}function Dt(i,n){1&i&&(e.qSk(),e.nrm(0,"path",351))}function Ct(i,n){if(1&i&&(e.qSk(),e.j41(0,"svg",347),e.DNE(1,wt,1,0,"path",348)(2,Dt,1,0,"path",349),e.k0s()),2&i){const t=e.XpG(4);e.R7$(),e.Y8G("ngIf","asc"===t.demandSortOrder),e.R7$(),e.Y8G("ngIf","desc"===t.demandSortOrder)}}function jt(i,n){1&i&&(e.qSk(),e.nrm(0,"path",350))}function St(i,n){1&i&&(e.qSk(),e.nrm(0,"path",351))}function Ft(i,n){if(1&i&&(e.qSk(),e.j41(0,"svg",347),e.DNE(1,jt,1,0,"path",348)(2,St,1,0,"path",349),e.k0s()),2&i){const t=e.XpG(4);e.R7$(),e.Y8G("ngIf","asc"===t.demandSortOrder),e.R7$(),e.Y8G("ngIf","desc"===t.demandSortOrder)}}function Rt(i,n){1&i&&(e.qSk(),e.nrm(0,"path",350))}function Tt(i,n){1&i&&(e.qSk(),e.nrm(0,"path",351))}function Et(i,n){if(1&i&&(e.qSk(),e.j41(0,"svg",347),e.DNE(1,Rt,1,0,"path",348)(2,Tt,1,0,"path",349),e.k0s()),2&i){const t=e.XpG(4);e.R7$(),e.Y8G("ngIf","asc"===t.demandSortOrder),e.R7$(),e.Y8G("ngIf","desc"===t.demandSortOrder)}}function It(i,n){1&i&&(e.qSk(),e.nrm(0,"path",350))}function Wt(i,n){1&i&&(e.qSk(),e.nrm(0,"path",351))}function Mt(i,n){if(1&i&&(e.qSk(),e.j41(0,"svg",347),e.DNE(1,It,1,0,"path",348)(2,Wt,1,0,"path",349),e.k0s()),2&i){const t=e.XpG(4);e.R7$(),e.Y8G("ngIf","asc"===t.demandSortOrder),e.R7$(),e.Y8G("ngIf","desc"===t.demandSortOrder)}}function Pt(i,n){1&i&&(e.qSk(),e.nrm(0,"path",350))}function At(i,n){1&i&&(e.qSk(),e.nrm(0,"path",351))}function Gt(i,n){if(1&i&&(e.qSk(),e.j41(0,"svg",347),e.DNE(1,Pt,1,0,"path",348)(2,At,1,0,"path",349),e.k0s()),2&i){const t=e.XpG(4);e.R7$(),e.Y8G("ngIf","asc"===t.demandSortOrder),e.R7$(),e.Y8G("ngIf","desc"===t.demandSortOrder)}}function $t(i,n){if(1&i){const t=e.RV6();e.j41(0,"tr",341)(1,"th",342)(2,"button",343),e.bIt("click",function(){e.eBV(t);const r=e.XpG(3);return e.Njj(r.sortDemands("warehouse_name"))}),e.EFF(3," Warehouse "),e.DNE(4,Ct,3,2,"svg",344),e.k0s()(),e.j41(5,"th",345)(6,"button",346),e.bIt("click",function(){e.eBV(t);const r=e.XpG(3);return e.Njj(r.sortDemands("total_pick"))}),e.EFF(7," Total Pick "),e.DNE(8,Ft,3,2,"svg",344),e.k0s()(),e.j41(9,"th",345)(10,"button",346),e.bIt("click",function(){e.eBV(t);const r=e.XpG(3);return e.Njj(r.sortDemands("total_deliver"))}),e.EFF(11," Total Deliver "),e.DNE(12,Et,3,2,"svg",344),e.k0s()(),e.j41(13,"th",345)(14,"button",346),e.bIt("click",function(){e.eBV(t);const r=e.XpG(3);return e.Njj(r.sortDemands("avg_pick_per_day"))}),e.EFF(15," Avg Pick/Day "),e.DNE(16,Mt,3,2,"svg",344),e.k0s()(),e.j41(17,"th",345)(18,"button",346),e.bIt("click",function(){e.eBV(t);const r=e.XpG(3);return e.Njj(r.sortDemands("avg_deliver_per_day"))}),e.EFF(19," Avg Deliver/Day "),e.DNE(20,Gt,3,2,"svg",344),e.k0s()()()}if(2&i){const t=e.XpG(3);e.R7$(4),e.Y8G("ngIf","warehouse_name"===t.demandSortField),e.R7$(4),e.Y8G("ngIf","total_pick"===t.demandSortField),e.R7$(4),e.Y8G("ngIf","total_deliver"===t.demandSortField),e.R7$(4),e.Y8G("ngIf","avg_pick_per_day"===t.demandSortField),e.R7$(4),e.Y8G("ngIf","avg_deliver_per_day"===t.demandSortField)}}function Nt(i,n){if(1&i){const t=e.RV6();e.j41(0,"tr",352),e.bIt("click",function(){const r=e.eBV(t).$implicit,o=e.XpG(3);return e.Njj(o.selectDemand(r))}),e.j41(1,"td",353)(2,"div")(3,"div",354),e.EFF(4),e.k0s(),e.j41(5,"div",72),e.EFF(6),e.k0s()()(),e.j41(7,"td",355),e.EFF(8),e.nI1(9,"number"),e.k0s(),e.j41(10,"td",355),e.EFF(11),e.nI1(12,"number"),e.k0s(),e.j41(13,"td",356),e.EFF(14),e.nI1(15,"number"),e.k0s(),e.j41(16,"td",356),e.EFF(17),e.nI1(18,"number"),e.k0s()()}if(2&i){const t=n.$implicit,a=e.XpG(3);e.Y8G("ngClass",e.l_i(17,me,a.isDemandSelected(t),!a.isDemandSelected(t))),e.R7$(4),e.JRh(t.warehouse_name||"\u2014"),e.R7$(2),e.SpI("ID: ",t.warehouse_id,""),e.R7$(2),e.SpI(" ",e.bMT(9,7,t.total_pick)," "),e.R7$(3),e.SpI(" ",e.bMT(12,9,t.total_deliver)," "),e.R7$(3),e.SpI(" ",e.i5U(15,11,t.avg_pick_per_day,"1.1-1")," "),e.R7$(3),e.SpI(" ",e.i5U(18,14,t.avg_deliver_per_day,"1.1-1")," ")}}function Bt(i,n){if(1&i&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&i){const t=e.XpG(4);e.R7$(),e.SpI('No results for "',t.demandSearchQuery,'"')}}function Ot(i,n){1&i&&(e.j41(0,"span"),e.EFF(1,"No data"),e.k0s())}function Vt(i,n){if(1&i){const t=e.RV6();e.j41(0,"button",363),e.bIt("click",function(){e.eBV(t);const r=e.XpG(4);return e.Njj(r.clearSearch())}),e.EFF(1," Clear filter "),e.k0s()}}function Yt(i,n){if(1&i&&(e.j41(0,"tr")(1,"td",357)(2,"div",358),e.qSk(),e.j41(3,"svg",359),e.nrm(4,"path",360),e.k0s(),e.joV(),e.j41(5,"div",361),e.DNE(6,Bt,2,1,"span",114)(7,Ot,2,0,"span",114),e.k0s(),e.DNE(8,Vt,2,0,"button",362),e.k0s()()()),2&i){const t=e.XpG(3);e.R7$(6),e.Y8G("ngIf",t.demandSearchQuery),e.R7$(),e.Y8G("ngIf",!t.demandSearchQuery),e.R7$(),e.Y8G("ngIf",t.demandSearchQuery)}}function Xt(i,n){if(1&i){const t=e.RV6();e.j41(0,"div",158)(1,"div",159)(2,"div",96)(3,"h2",160),e.qSk(),e.j41(4,"svg",98),e.nrm(5,"path",161),e.k0s(),e.joV(),e.j41(6,"span"),e.EFF(7,"Volume Management"),e.k0s()()()(),e.j41(8,"div",162),e.DNE(9,Ze,5,0,"div",47)(10,et,10,1,"div",163),e.j41(11,"div",164)(12,"div",165)(13,"div",166)(14,"div",167)(15,"div",168),e.qSk(),e.j41(16,"svg",169),e.nrm(17,"path",161),e.k0s()()(),e.joV(),e.j41(18,"div",170),e.EFF(19),e.nI1(20,"number"),e.k0s(),e.j41(21,"div",171),e.EFF(22,"Total Pick/Deliver"),e.k0s()(),e.j41(23,"div",166)(24,"div",167)(25,"div",168),e.qSk(),e.j41(26,"svg",169),e.nrm(27,"path",172),e.k0s()()(),e.joV(),e.j41(28,"div",170),e.EFF(29),e.nI1(30,"number"),e.k0s(),e.j41(31,"div",171),e.EFF(32,"Total Pick"),e.k0s()(),e.j41(33,"div",166)(34,"div",167)(35,"div",168),e.qSk(),e.j41(36,"svg",169),e.nrm(37,"path",172),e.k0s()()(),e.joV(),e.j41(38,"div",170),e.EFF(39),e.nI1(40,"number"),e.k0s(),e.j41(41,"div",171),e.EFF(42,"Total Deliver"),e.k0s()()()(),e.j41(43,"div",173)(44,"div")(45,"div",174)(46,"div",175)(47,"div",176),e.qSk(),e.j41(48,"svg",177),e.nrm(49,"path",161),e.k0s()(),e.joV(),e.j41(50,"div")(51,"h3",178),e.EFF(52,"Volume Trend Over Time"),e.k0s(),e.j41(53,"p",179),e.EFF(54,"Daily Volume - Total picked and delivered volume for the selected date range (based on Information time)"),e.k0s()()()(),e.j41(55,"div",180),e.DNE(56,tt,5,0,"div",181)(57,at,3,1,"div",182)(58,rt,13,9,"div",183)(59,ot,5,1,"div",184)(60,dt,22,4,"div",185),e.k0s()()(),e.DNE(61,ft,17,4,"div",186),e.j41(62,"div",173)(63,"div")(64,"div",174)(65,"div",187)(66,"div",175)(67,"div",176),e.qSk(),e.j41(68,"svg",188),e.nrm(69,"path",161),e.k0s()(),e.joV(),e.j41(70,"div")(71,"h3",178),e.EFF(72,"Volume Chart by Warehouse"),e.k0s(),e.j41(73,"p",179),e.EFF(74,"Analyze and compare volume across warehouses"),e.k0s()()(),e.j41(75,"div",189)(76,"button",190),e.bIt("click",function(){e.eBV(t);const r=e.XpG(2);return r.chartType="bar",e.Njj(r.triggerChangeDetection())}),e.qSk(),e.j41(77,"svg",191),e.nrm(78,"path",161),e.k0s(),e.EFF(79," Bar "),e.k0s(),e.joV(),e.j41(80,"button",190),e.bIt("click",function(){e.eBV(t);const r=e.XpG(2);return r.chartType="line",e.Njj(r.triggerChangeDetection())}),e.qSk(),e.j41(81,"svg",191),e.nrm(82,"path",192),e.k0s(),e.EFF(83," Line "),e.k0s()()(),e.joV(),e.j41(84,"div",193)(85,"div",194),e.qSk(),e.j41(86,"svg",195),e.nrm(87,"path",196),e.k0s(),e.joV(),e.j41(88,"span",197),e.EFF(89,"Showing data:"),e.k0s()(),e.j41(90,"div",198)(91,"label",199)(92,"input",200),e.mxI("ngModelChange",function(r){e.eBV(t);const o=e.XpG(2);return e.DH7(o.chartShowPick,r)||(o.chartShowPick=r),e.Njj(r)}),e.bIt("change",function(){e.eBV(t);const r=e.XpG(2);return e.Njj(r.triggerChangeDetection())}),e.k0s(),e.j41(93,"div",201),e.nrm(94,"div",202),e.j41(95,"span",203),e.EFF(96,"Total Pick"),e.k0s()()(),e.j41(97,"label",199)(98,"input",200),e.mxI("ngModelChange",function(r){e.eBV(t);const o=e.XpG(2);return e.DH7(o.chartShowDeliver,r)||(o.chartShowDeliver=r),e.Njj(r)}),e.bIt("change",function(){e.eBV(t);const r=e.XpG(2);return e.Njj(r.triggerChangeDetection())}),e.k0s(),e.j41(99,"div",201),e.nrm(100,"div",202),e.j41(101,"span",203),e.EFF(102,"Total Deliver"),e.k0s()()(),e.j41(103,"label",199)(104,"input",200),e.mxI("ngModelChange",function(r){e.eBV(t);const o=e.XpG(2);return e.DH7(o.chartShowAvgPick,r)||(o.chartShowAvgPick=r),e.Njj(r)}),e.bIt("change",function(){e.eBV(t);const r=e.XpG(2);return e.Njj(r.triggerChangeDetection())}),e.k0s(),e.j41(105,"div",201),e.nrm(106,"div",202),e.j41(107,"span",203),e.EFF(108,"Avg Pick/Day"),e.k0s()()(),e.j41(109,"label",199)(110,"input",200),e.mxI("ngModelChange",function(r){e.eBV(t);const o=e.XpG(2);return e.DH7(o.chartShowAvgDeliver,r)||(o.chartShowAvgDeliver=r),e.Njj(r)}),e.bIt("change",function(){e.eBV(t);const r=e.XpG(2);return e.Njj(r.triggerChangeDetection())}),e.k0s(),e.j41(111,"div",201),e.nrm(112,"div",202),e.j41(113,"span",203),e.EFF(114,"Avg Deliver/Day"),e.k0s()()()()()(),e.j41(115,"div",204)(116,"div",205)(117,"div",206)(118,"div",207),e.nrm(119,"p-chart",208),e.k0s()()()()()(),e.j41(120,"div",173)(121,"div")(122,"div",209)(123,"div",210)(124,"div",211),e.qSk(),e.j41(125,"svg",188),e.nrm(126,"path",212),e.k0s()(),e.joV(),e.j41(127,"div",213)(128,"h3",178),e.EFF(129,"Warehouse Volume Details"),e.k0s(),e.j41(130,"p",179),e.EFF(131,"Detailed analysis of picked and delivered volume by warehouse"),e.k0s()()(),e.j41(132,"div",214)(133,"div",215)(134,"div",216),e.nrm(135,"div",217),e.j41(136,"span",218),e.EFF(137,"Above Avg"),e.k0s()(),e.j41(138,"div",216),e.nrm(139,"div",219),e.j41(140,"span",218),e.EFF(141,"Below Avg"),e.k0s()()(),e.j41(142,"div",220),e.EFF(143," Total: "),e.j41(144,"span",221),e.EFF(145),e.k0s(),e.EFF(146," warehouses "),e.DNE(147,vt,5,1,"span",222),e.k0s()()(),e.j41(148,"div",180),e.DNE(149,bt,5,0,"div",47)(150,xt,10,1,"div",223)(151,yt,10,0,"div",224),e.j41(152,"div",225)(153,"div",226)(154,"div",227)(155,"div",228)(156,"div",229),e.qSk(),e.j41(157,"svg",169),e.nrm(158,"path",230)(159,"path",231),e.k0s()(),e.joV(),e.j41(160,"div")(161,"h5",232),e.EFF(162,"Pick/Deliver Ratio"),e.k0s(),e.j41(163,"p",72),e.EFF(164,"Volume distribution"),e.k0s()()(),e.j41(165,"div",233),e.DNE(166,kt,5,0,"div",234),e.nrm(167,"canvas",235,0),e.k0s()()(),e.j41(169,"div",236)(170,"div",237)(171,"p-table",238),e.DNE(172,$t,21,5,"ng-template",239)(173,Nt,19,20,"ng-template",240)(174,Yt,9,3,"ng-template",241),e.k0s()()()()()()()()()}if(2&i){const t=e.XpG(2);e.R7$(9),e.Y8G("ngIf",t.loadingDemands),e.R7$(),e.Y8G("ngIf",t.demandsError&&!t.loadingDemands),e.R7$(9),e.JRh(e.bMT(20,39,t.totalPickAndDeliver)),e.R7$(10),e.JRh(e.bMT(30,41,t.totalPick)),e.R7$(10),e.JRh(e.bMT(40,43,t.totalDeliver)),e.R7$(17),e.Y8G("ngIf",t.loadingTimelineData),e.R7$(),e.Y8G("ngIf",!t.loadingTimelineData&&t.timelineDataError),e.R7$(),e.Y8G("ngIf",!t.loadingTimelineData&&!t.timelineDataError&&t.hasTimelineData),e.R7$(),e.Y8G("ngIf",!t.loadingTimelineData&&!t.timelineDataError),e.R7$(),e.Y8G("ngIf",!t.loadingTimelineData&&!t.timelineDataError&&t.availableTimelineWarehouses.length>1),e.R7$(),e.Y8G("ngIf",!t.selectedDatasetId||"demand"===t.selectedDatasetId),e.R7$(15),e.Y8G("ngClass",e.l_i(45,N,"bar"===t.chartType,"bar"!==t.chartType)),e.R7$(4),e.Y8G("ngClass",e.l_i(48,N,"line"===t.chartType,"line"!==t.chartType)),e.R7$(12),e.R50("ngModel",t.chartShowPick),e.R7$(6),e.R50("ngModel",t.chartShowDeliver),e.R7$(6),e.R50("ngModel",t.chartShowAvgPick),e.R7$(6),e.R50("ngModel",t.chartShowAvgDeliver),e.R7$(6),e.xc7("min-height",t.getChartHeight(),"px")("height",t.getChartHeight(),"px"),e.R7$(2),e.Y8G("ngStyle",e.eq3(51,he,t.getChartMinWidth()>100?t.getChartMinWidth()+"px":"100%")),e.R7$(),e.Y8G("type",t.getChartType())("data",t.getDemandsChartData("combined"))("options",t.chartOptions),e.R7$(26),e.JRh(t.demands.length),e.R7$(2),e.Y8G("ngIf",t.demandSearchQuery),e.R7$(2),e.Y8G("ngIf",t.loadingDemands),e.R7$(),e.Y8G("ngIf",t.demandsError&&!t.loadingDemands),e.R7$(),e.Y8G("ngIf",!t.loadingDemands&&!t.demandsError&&0===t.timelineWarehouses.length),e.R7$(15),e.Y8G("ngIf",!(t.selectedDemand||t.demands&&0!==t.demands.length)),e.R7$(),e.xc7("display",t.selectedDemand||t.demands&&0!==t.demands.length?"block":"none"),e.R7$(4),e.Y8G("value",t.filteredDemands)("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",e.lJ4(53,ce))("tableStyle",e.lJ4(54,ge))}}function zt(i,n){if(1&i){const t=e.RV6();e.j41(0,"div",364)(1,"div",365)(2,"h2",160),e.qSk(),e.j41(3,"svg",298),e.nrm(4,"path",366),e.k0s(),e.joV(),e.j41(5,"span"),e.EFF(6,"Dataset Details"),e.k0s()(),e.j41(7,"button",367),e.bIt("click",function(){e.eBV(t);const r=e.XpG(2);return e.Njj(r.closeDetails())}),e.qSk(),e.j41(8,"svg",368),e.nrm(9,"path",141),e.k0s(),e.joV(),e.j41(10,"span",369),e.EFF(11,"Close"),e.k0s()()(),e.j41(12,"div",370),e.nrm(13,"app-dataset-detail",371),e.k0s()()}if(2&i){const t=e.XpG(2);e.R7$(13),e.Y8G("datasetIdInput",t.selectedDatasetId)("embedded",!0)}}function Ht(i,n){if(1&i){const t=e.RV6();e.j41(0,"div",93)(1,"div",94)(2,"div",95)(3,"div",96)(4,"h2",97),e.qSk(),e.j41(5,"svg",98),e.nrm(6,"path",99),e.k0s(),e.joV(),e.j41(7,"span"),e.EFF(8,"Information"),e.k0s()(),e.j41(9,"button",100),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.openSettingsModal())}),e.qSk(),e.j41(10,"svg",101),e.nrm(11,"path",102),e.k0s()()()(),e.joV(),e.j41(12,"div",103),e.DNE(13,ze,27,8,"div",104)(14,Ke,20,7,"div",105),e.k0s()(),e.j41(15,"div",106),e.DNE(16,Xt,175,55,"div",107)(17,zt,14,2,"div",108),e.k0s()()}if(2&i){const t=e.XpG();e.R7$(13),e.Y8G("ngIf","demand"===t.selectedDatasetId),e.R7$(),e.Y8G("ngIf","demand"===t.selectedDatasetId),e.R7$(2),e.Y8G("ngIf","demand"===t.selectedDatasetId),e.R7$(),e.Y8G("ngIf",t.selectedDatasetId&&"demand"!==t.selectedDatasetId)}}function Lt(i,n){if(1&i&&(e.j41(0,"option",404),e.EFF(1),e.k0s()),2&i){const t=n.$implicit;e.Y8G("value",t.code),e.R7$(),e.Lme(" ",t.code," - ",t.name," ")}}function Ut(i,n){1&i&&(e.j41(0,"div",410)(1,"div",49),e.nrm(2,"div",411),e.j41(3,"p",412),e.EFF(4,"Loading warehouse list..."),e.k0s()()())}function qt(i,n){if(1&i&&(e.j41(0,"div",413)(1,"div",151),e.qSk(),e.j41(2,"svg",414),e.nrm(3,"path",55),e.k0s(),e.joV(),e.j41(4,"span",415),e.EFF(5),e.k0s()()()),2&i){const t=e.XpG(3);e.R7$(5),e.JRh(t.modalWarehousesError)}}function Jt(i,n){if(1&i){const t=e.RV6();e.j41(0,"div",416)(1,"div",53)(2,"div",417),e.EFF(3," Total: "),e.j41(4,"span",418),e.EFF(5),e.k0s()(),e.nrm(6,"div",419),e.j41(7,"div",420),e.EFF(8," Selected: "),e.j41(9,"span",421),e.EFF(10),e.k0s()()(),e.j41(11,"div",151)(12,"button",422),e.bIt("click",function(){e.eBV(t);const r=e.XpG(3);return e.Njj(r.selectAllWarehousesInModal())}),e.EFF(13," \u2713 All "),e.k0s(),e.j41(14,"button",423),e.bIt("click",function(){e.eBV(t);const r=e.XpG(3);return e.Njj(r.deselectAllWarehousesInModal())}),e.EFF(15," \u2715 Clear selection "),e.k0s()()()}if(2&i){const t=e.XpG(3);e.R7$(5),e.JRh(t.modalWarehouses.length),e.R7$(5),e.JRh(t.modalSelectedWarehouses.size),e.R7$(2),e.Y8G("disabled",t.modalSelectedWarehouses.size===t.modalWarehouses.length),e.R7$(2),e.Y8G("disabled",0===t.modalSelectedWarehouses.size)}}function Qt(i,n){if(1&i){const t=e.RV6();e.j41(0,"tr",432),e.bIt("click",function(){const r=e.eBV(t).$implicit,o=e.XpG(4);return e.Njj(o.toggleWarehouseSelection(r))}),e.j41(1,"td",433),e.bIt("click",function(r){return e.eBV(t),e.Njj(r.stopPropagation())}),e.j41(2,"input",271),e.bIt("change",function(){const r=e.eBV(t).$implicit,o=e.XpG(4);return e.Njj(o.toggleWarehouseSelection(r))}),e.k0s()(),e.j41(3,"td",434),e.EFF(4),e.k0s(),e.j41(5,"td",435)(6,"div",436),e.EFF(7),e.k0s()(),e.j41(8,"td",435)(9,"div",23),e.EFF(10),e.k0s()(),e.j41(11,"td",437),e.EFF(12),e.k0s()()}if(2&i){const t=n.$implicit,a=n.index,r=e.XpG(4);e.R7$(2),e.Y8G("checked",r.isWarehouseSelectedInModal(t)),e.R7$(2),e.JRh(a+1),e.R7$(3),e.JRh(t.warehouse_name),e.R7$(3),e.Lme("",t.district_name,", ",t.province_name,""),e.R7$(2),e.JRh(t.warehouse_id||t.id)}}function Kt(i,n){if(1&i){const t=e.RV6();e.j41(0,"div",424)(1,"table",268)(2,"thead",425)(3,"tr")(4,"th",426)(5,"input",271),e.bIt("change",function(){e.eBV(t);const r=e.XpG(3);return e.Njj(r.modalSelectedWarehouses.size===r.modalWarehouses.length?r.deselectAllWarehousesInModal():r.selectAllWarehousesInModal())}),e.k0s()(),e.j41(6,"th",427),e.EFF(7,"STT"),e.k0s(),e.j41(8,"th",428),e.EFF(9,"Warehouse Name"),e.k0s(),e.j41(10,"th",428),e.EFF(11,"Address"),e.k0s(),e.j41(12,"th",429),e.EFF(13,"ID"),e.k0s()()(),e.j41(14,"tbody",430),e.DNE(15,Qt,13,6,"tr",431),e.k0s()()()}if(2&i){const t=e.XpG(3);e.R7$(5),e.Y8G("checked",t.modalSelectedWarehouses.size===t.modalWarehouses.length&&t.modalWarehouses.length>0),e.R7$(10),e.Y8G("ngForOf",t.modalWarehouses)}}function Zt(i,n){1&i&&(e.j41(0,"div",438),e.qSk(),e.j41(1,"svg",439),e.nrm(2,"path",366),e.k0s(),e.joV(),e.j41(3,"p",440),e.EFF(4,"No warehouses available"),e.k0s()())}function ea(i,n){if(1&i&&(e.j41(0,"div",397),e.DNE(1,Ut,5,0,"div",405)(2,qt,6,1,"div",406)(3,Jt,16,4,"div",407)(4,Kt,16,2,"div",408)(5,Zt,5,0,"div",409),e.k0s()),2&i){const t=e.XpG(2);e.R7$(),e.Y8G("ngIf",t.loadingModalWarehouses),e.R7$(),e.Y8G("ngIf",t.modalWarehousesError&&!t.loadingModalWarehouses),e.R7$(),e.Y8G("ngIf",!t.loadingModalWarehouses&&!t.modalWarehousesError&&t.modalWarehouses.length>0),e.R7$(),e.Y8G("ngIf",!t.loadingModalWarehouses&&!t.modalWarehousesError&&t.modalWarehouses.length>0),e.R7$(),e.Y8G("ngIf",!t.loadingModalWarehouses&&!t.modalWarehousesError&&0===t.modalWarehouses.length)}}function ta(i,n){if(1&i&&(e.j41(0,"div",151),e.qSk(),e.j41(1,"svg",443),e.nrm(2,"path",55),e.k0s(),e.EFF(3),e.k0s()),2&i){const t=n.$implicit;e.R7$(3),e.SpI(" ",t," ")}}function aa(i,n){if(1&i&&(e.j41(0,"div",441),e.DNE(1,ta,4,1,"div",442),e.k0s()),2&i){const t=e.XpG(2);e.R7$(),e.Y8G("ngForOf",t.demandErrors)}}function ra(i,n){if(1&i&&(e.j41(0,"option",451),e.EFF(1),e.k0s()),2&i){const t=n.$implicit;e.Y8G("ngValue",t),e.R7$(),e.SpI("",t,":00")}}function ia(i,n){if(1&i&&(e.j41(0,"option",451),e.EFF(1),e.k0s()),2&i){const t=n.$implicit;e.Y8G("ngValue",t),e.R7$(),e.SpI("",t,":00")}}function oa(i,n){if(1&i){const t=e.RV6();e.j41(0,"div",444)(1,"div",445),e.EFF(2),e.k0s(),e.j41(3,"input",446),e.mxI("ngModelChange",function(r){const o=e.eBV(t).$implicit;return e.DH7(o.name,r)||(o.name=r),e.Njj(r)}),e.k0s(),e.j41(4,"select",447),e.mxI("ngModelChange",function(r){const o=e.eBV(t).$implicit;return e.DH7(o.start_hour,r)||(o.start_hour=r),e.Njj(r)}),e.DNE(5,ra,2,2,"option",448),e.k0s(),e.j41(6,"span",449),e.EFF(7,"\u2014"),e.k0s(),e.j41(8,"select",447),e.mxI("ngModelChange",function(r){const o=e.eBV(t).$implicit;return e.DH7(o.end_hour,r)||(o.end_hour=r),e.Njj(r)}),e.DNE(9,ia,2,2,"option",448),e.k0s(),e.j41(10,"button",450),e.bIt("click",function(){const r=e.eBV(t).index,o=e.XpG(2);return e.Njj(o.removeShift(r))}),e.qSk(),e.j41(11,"svg",368),e.nrm(12,"path",141),e.k0s()()()}if(2&i){const t=n.$implicit,a=n.index,r=e.XpG(2);e.R7$(2),e.SpI(" ",a+1," "),e.R7$(),e.R50("ngModel",t.name),e.R7$(),e.R50("ngModel",t.start_hour),e.R7$(),e.Y8G("ngForOf",r.hours),e.R7$(3),e.R50("ngModel",t.end_hour),e.R7$(),e.Y8G("ngForOf",r.hoursInclusive)}}function sa(i,n){if(1&i&&(e.j41(0,"div",151),e.qSk(),e.j41(1,"svg",443),e.nrm(2,"path",55),e.k0s(),e.EFF(3),e.k0s()),2&i){const t=n.$implicit;e.R7$(3),e.SpI(" ",t," ")}}function na(i,n){if(1&i&&(e.j41(0,"div",441),e.DNE(1,sa,4,1,"div",442),e.k0s()),2&i){const t=e.XpG(2);e.R7$(),e.Y8G("ngForOf",t.shiftErrors)}}function da(i,n){if(1&i){const t=e.RV6();e.j41(0,"div",372)(1,"div",373)(2,"div",374)(3,"div",53)(4,"div",375),e.qSk(),e.j41(5,"svg",169),e.nrm(6,"path",376),e.k0s()(),e.joV(),e.j41(7,"div")(8,"h3",377),e.EFF(9,"Information"),e.k0s(),e.j41(10,"p",15),e.EFF(11,"Select time range and configure shifts"),e.k0s()()(),e.j41(12,"button",378),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.closeSettingsModal())}),e.qSk(),e.j41(13,"svg",368),e.nrm(14,"path",141),e.k0s()()(),e.joV(),e.j41(15,"div",379)(16,"div",380)(17,"div",381)(18,"div",382),e.qSk(),e.j41(19,"svg",383),e.nrm(20,"path",384),e.k0s()(),e.joV(),e.j41(21,"h4",385),e.EFF(22,"Select region and warehouses"),e.k0s()(),e.j41(23,"div",386)(24,"div")(25,"label",387),e.EFF(26,"Region "),e.j41(27,"span",388),e.EFF(28,"*"),e.k0s()(),e.j41(29,"select",389),e.mxI("ngModelChange",function(r){e.eBV(t);const o=e.XpG();return e.DH7(o.modalSelectedRegion,r)||(o.modalSelectedRegion=r),e.Njj(r)}),e.bIt("change",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.onModalRegionChange())}),e.j41(30,"option",390),e.EFF(31,"-- Select region --"),e.k0s(),e.DNE(32,Lt,2,3,"option",391),e.k0s()(),e.DNE(33,ea,6,5,"div",392),e.k0s()(),e.j41(34,"div",380)(35,"div",381)(36,"div",382),e.qSk(),e.j41(37,"svg",383),e.nrm(38,"path",393),e.k0s()(),e.joV(),e.j41(39,"h4",385),e.EFF(40,"Time Range"),e.k0s()(),e.j41(41,"div",394)(42,"div")(43,"label",387),e.EFF(44,"From date"),e.k0s(),e.j41(45,"input",395),e.mxI("ngModelChange",function(r){e.eBV(t);const o=e.XpG();return e.DH7(o.demandStartDate,r)||(o.demandStartDate=r),e.Njj(r)}),e.bIt("ngModelChange",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.onDateRangeChange())}),e.k0s()(),e.j41(46,"div")(47,"label",387),e.EFF(48,"To date"),e.k0s(),e.j41(49,"input",395),e.mxI("ngModelChange",function(r){e.eBV(t);const o=e.XpG();return e.DH7(o.demandEndDate,r)||(o.demandEndDate=r),e.Njj(r)}),e.bIt("ngModelChange",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.onDateRangeChange())}),e.k0s()()(),e.DNE(50,aa,2,1,"div",396),e.k0s(),e.j41(51,"div",380)(52,"div",381)(53,"div",382),e.qSk(),e.j41(54,"svg",383),e.nrm(55,"path",127),e.k0s()(),e.joV(),e.j41(56,"h4",385),e.EFF(57,"Shift configuration"),e.k0s()(),e.j41(58,"div",397),e.DNE(59,oa,13,6,"div",398),e.j41(60,"button",399),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.addShift())}),e.qSk(),e.j41(61,"svg",368),e.nrm(62,"path",400),e.k0s(),e.EFF(63," Add shift "),e.k0s()(),e.DNE(64,na,2,1,"div",396),e.k0s()(),e.joV(),e.j41(65,"div",401)(66,"button",402),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.closeSettingsModal())}),e.EFF(67,"Cancel"),e.k0s(),e.j41(68,"button",403),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.applySettings())}),e.EFF(69,"Save and apply"),e.k0s()()()()}if(2&i){const t=e.XpG();e.R7$(29),e.R50("ngModel",t.modalSelectedRegion),e.R7$(3),e.Y8G("ngForOf",t.availableRegions),e.R7$(),e.Y8G("ngIf",t.modalSelectedRegion),e.R7$(12),e.R50("ngModel",t.demandStartDate),e.R7$(4),e.R50("ngModel",t.demandEndDate),e.R7$(),e.Y8G("ngIf",t.demandErrors&&t.demandErrors.length),e.R7$(9),e.Y8G("ngForOf",t.shifts),e.R7$(5),e.Y8G("ngIf",t.shiftErrors&&t.shiftErrors.length)}}let la=(()=>{class i{datasetService;router;cdr;http;platformId;retailBaseUrl=`${(0,K.Gi)()}/data-mesh/domains/retail`;state={size:12,offset:0,total:0,q:"",type:"",viewMode:"grid"};datasets=[];loading=!1;error=null;fallbackNotice=null;retailHealth={status:"unknown",service:"retail",timestamp:""};retailVersion={version:"N/A",adapter:"retail"};retailInventoryAnalytics={total_products:0,total_quantity:0,inventory_value:0,low_stock_products:0,out_of_stock_products:0};retailAlerts=[];loadingRetailOverview=!1;retailOverviewNotice=null;warehouses=[];loadingWarehouses=!1;warehousesError=null;warehouseSearchQuery="";warehousePageSize=10;warehouseCurrentPage=1;warehouseTotal=0;warehouseSearchSubject=new E.B;datasetSearchSubject=new E.B;warehouseSuggestions=[];warehouseAutoLoading=!1;warehouseAutoCompleteSubject=new E.B;warehouseAutoSub=null;warehouseRegionShortname="HNO";availableRegions=[{code:"HNO",name:"Ha Noi"},{code:"HCM",name:"Ho Chi Minh"},{code:"HPG",name:"Hai Phong"},{code:"DAD",name:"Da Nang"},{code:"CXR",name:"Can Tho"},{code:"HAN",name:"Ha Nam"},{code:"VPC",name:"Vinh Phuc"},{code:"HPH",name:"Hai Phong"},{code:"QNH",name:"Quang Ninh"},{code:"BNH",name:"Bac Ninh"}];get pagedWarehouses(){if(!this.warehouses)return[];const t=(this.warehouseCurrentPage-1)*this.warehousePageSize;return this.warehouses.slice(t,t+this.warehousePageSize)}updateCharts(){if(this.destroyCharts(),this.demands&&0!==this.demands.length||this.shiftRatios&&0!==this.shiftRatios.length){try{if(this.demandSummaryCanvas&&this.demandSummaryCanvas.nativeElement){const t=this.demandSummaryCanvas.nativeElement.getContext("2d");if(t){let a=0,r=0,o=[];if(this.selectedDemand?(a=this.selectedDemand.total_pick||0,r=this.selectedDemand.total_deliver||0,o=["Total Pick","Total Deliver"]):(a=this.demands.reduce((d,s)=>d+(s.total_pick||0),0),r=this.demands.reduce((d,s)=>d+(s.total_deliver||0),0),o=["Total Pick","Total Deliver"]),this.demandSummaryChart)try{this.demandSummaryChart.destroy()}catch(d){console.error("[Dataset] Error destroying existing summary chart",d)}this.demandSummaryChart=new R.A(t,{type:"doughnut",data:{labels:o,datasets:[{label:"Pick/Deliver Ratio",data:[a,r],backgroundColor:["rgba(249, 115, 22, 0.9)","rgba(0, 0, 0, 0.8)"],borderColor:["rgba(255, 255, 255, 1)","rgba(255, 255, 255, 1)"],borderWidth:3}]},options:{responsive:!1,maintainAspectRatio:!1,aspectRatio:void 0,plugins:{legend:{position:"bottom",labels:{font:{size:12,weight:"bold"},padding:15,usePointStyle:!0}},tooltip:{callbacks:{label:d=>{const s=d.label||"",h=d.parsed||0,l=a+r,c=l>0?(h/l*100).toFixed(1):"0";return`${s}: ${new Intl.NumberFormat("en-US").format(h)} (${c}%)`}}}},animation:{onComplete:()=>{const d=this.demandSummaryChart;if(!d)return;const s=d.ctx,h=d.chartArea,l=(h.left+h.right)/2,c=(h.top+h.bottom)/2;d.data.datasets.forEach(m=>{d.getDatasetMeta(0).data.forEach((x,u)=>{const g=x,b=m.data[u],f=m.data.reduce((v,k)=>v+k,0),y=f>0?(b/f*100).toFixed(1):"0",w=(g.startAngle+g.endAngle)/2,S=g.innerRadius+(g.outerRadius-g.innerRadius)/2,M=l+Math.cos(w)*S,D=c+Math.sin(w)*S;s.save(),s.font="bold 18px Arial",s.fillStyle="#ffffff",s.textAlign="center",s.textBaseline="middle",s.shadowColor="rgba(0, 0, 0, 0.7)",s.shadowBlur=4,s.shadowOffsetX=1,s.shadowOffsetY=1,s.fillText(`${y}%`,M,D),s.restore()})})}}}})}}}catch(t){console.error("[Dataset] Error creating demand summary chart",t)}try{let t=[],a=[],r=[];if(!(this.shiftRatios&&this.shiftRatios.length>0))return;if(t=this.shiftRatios.map(d=>d.shift_name||d.shift?.name||"Ca"),a=this.shiftRatios.map(d=>d.total_pick||0),r=this.shiftRatios.map(d=>d.pick_ratio?100*d.pick_ratio:0),!this.demandPickupTimeCanvas||!this.demandPickupTimeCanvas.nativeElement)return void console.warn("[Dataset] Pickup canvas not available");const o=this.demandPickupTimeCanvas.nativeElement.getContext("2d");if(o){if(this.demandPickupTimeChart)try{this.demandPickupTimeChart.destroy()}catch(s){console.error("[Dataset] Error destroying existing pickup chart",s)}const d=["rgba(249, 115, 22, 0.9)","rgba(251, 146, 60, 0.9)","rgba(234, 88, 12, 0.9)","rgba(194, 65, 12, 0.9)"];this.demandPickupTimeChart=new R.A(o,{type:"polarArea",data:{labels:t,datasets:[{label:"Total Pick (kg)",data:a,backgroundColor:t.map((s,h)=>d[h%d.length]),borderColor:"#ffffff",borderWidth:3}]},options:{responsive:!1,maintainAspectRatio:!1,aspectRatio:void 0,plugins:{legend:{position:"bottom",labels:{font:{size:12,weight:"bold"},padding:15,usePointStyle:!0}},tooltip:{callbacks:{label:s=>{const l=s.parsed||0,m=r[s.dataIndex]||0;return`${s.label||""}: ${new Intl.NumberFormat("en-US").format(l)} kg (${m.toFixed(1)}%)`}}}},scales:{r:{beginAtZero:!0,grid:{color:"rgba(0, 0, 0, 0.15)",lineWidth:1},pointLabels:{font:{size:12,weight:"bold"},color:"rgba(0, 0, 0, 0.8)",padding:8},ticks:{display:!0,stepSize:void 0,font:{size:10,weight:"normal"},color:"rgba(0, 0, 0, 0.6)",backdropColor:"rgba(255, 255, 255, 0.9)",backdropPadding:4,z:1,callback:function(s){return s>=1e6?(s/1e6).toFixed(1)+"M":s>=1e3?(s/1e3).toFixed(1)+"K":s.toString()}},angleLines:{display:!0,color:"rgba(0, 0, 0, 0.1)",lineWidth:1}}},animation:{onComplete:()=>{const s=this.demandPickupTimeChart;if(!s)return;const h=s.ctx,l=s.chartArea,c=(l.left+l.right)/2,m=(l.top+l.bottom)/2;s.getDatasetMeta(0).data.forEach((x,u)=>{const b=r[u]||0,f=(x.startAngle+x.endAngle)/2,y=.6*x.outerRadius,w=c+Math.cos(f)*y,S=m+Math.sin(f)*y;h.save(),h.font="bold 16px Arial",h.fillStyle="#ffffff",h.textAlign="center",h.textBaseline="middle",h.shadowColor="rgba(0, 0, 0, 0.7)",h.shadowBlur=4,h.shadowOffsetX=1,h.shadowOffsetY=1,h.fillText(`${b.toFixed(1)}%`,w,S),h.restore()})}}}})}else console.warn("[Dataset] Cannot get 2d context from pickup canvas")}catch(t){console.error("[Dataset] Error creating pickup time chart",t)}try{let t=[],a=[],r=[];if(!(this.shiftRatios&&this.shiftRatios.length>0))return void console.log("[Dataset] No data for delivery chart - shiftRatios:",this.shiftRatios?.length);if(t=this.shiftRatios.map(d=>d.shift_name||d.shift?.name||"Ca"),a=this.shiftRatios.map(d=>d.total_deliver||0),r=this.shiftRatios.map(d=>d.deliver_ratio?100*d.deliver_ratio:0),console.log("[Dataset] Creating delivery chart with labels:",t,"data:",a),!this.demandDeliveryTimeCanvas||!this.demandDeliveryTimeCanvas.nativeElement)return void console.warn("[Dataset] Delivery canvas not available");const o=this.demandDeliveryTimeCanvas.nativeElement.getContext("2d");if(o){if(this.demandDeliveryTimeChart)try{this.demandDeliveryTimeChart.destroy()}catch(s){console.error("[Dataset] Error destroying existing delivery chart",s)}const d=["rgba(75, 85, 99, 0.9)","rgba(107, 114, 128, 0.9)","rgba(55, 65, 81, 0.9)","rgba(107, 114, 128, 0.9)"];this.demandDeliveryTimeChart=new R.A(o,{type:"polarArea",data:{labels:t,datasets:[{label:"Total Deliver (kg)",data:a,backgroundColor:t.map((s,h)=>d[h%d.length]),borderColor:"#ffffff",borderWidth:3}]},options:{responsive:!1,maintainAspectRatio:!1,aspectRatio:void 0,plugins:{legend:{position:"bottom",labels:{font:{size:12,weight:"bold"},padding:15,usePointStyle:!0}},tooltip:{callbacks:{label:s=>{const l=s.parsed||0,m=r[s.dataIndex]||0;return`${s.label||""}: ${new Intl.NumberFormat("en-US").format(l)} kg (${m.toFixed(1)}%)`}}}},scales:{r:{beginAtZero:!0,grid:{color:"rgba(0, 0, 0, 0.15)",lineWidth:1},pointLabels:{font:{size:12,weight:"bold"},color:"rgba(0, 0, 0, 0.8)",padding:8},ticks:{display:!0,stepSize:void 0,font:{size:10,weight:"normal"},color:"rgba(0, 0, 0, 0.6)",backdropColor:"rgba(255, 255, 255, 0.9)",backdropPadding:4,z:1,callback:function(s){return s>=1e6?(s/1e6).toFixed(1)+"M":s>=1e3?(s/1e3).toFixed(1)+"K":s.toString()}},angleLines:{display:!0,color:"rgba(0, 0, 0, 0.1)",lineWidth:1}}},animation:{onComplete:()=>{const s=this.demandDeliveryTimeChart;if(!s)return;const h=s.ctx,l=s.chartArea,c=(l.left+l.right)/2,m=(l.top+l.bottom)/2;s.getDatasetMeta(0).data.forEach((x,u)=>{const b=r[u]||0,f=(x.startAngle+x.endAngle)/2,y=.6*x.outerRadius,w=c+Math.cos(f)*y,S=m+Math.sin(f)*y;h.save(),h.font="bold 16px Arial",h.fillStyle="#ffffff",h.textAlign="center",h.textBaseline="middle",h.shadowColor="rgba(0, 0, 0, 0.7)",h.shadowBlur=4,h.shadowOffsetX=1,h.shadowOffsetY=1,h.fillText(`${b.toFixed(1)}%`,w,S),h.restore()})}}}})}else console.warn("[Dataset] Cannot get 2d context from delivery canvas")}catch(t){console.error("[Dataset] Error creating delivery time chart",t)}this.chartsInitialized=!0}}destroyCharts(){try{if(this.demandSummaryChart){try{this.demandSummaryChart.destroy()}catch{}this.demandSummaryChart=null}if(this.demandPickupTimeChart){try{this.demandPickupTimeChart.destroy()}catch{}this.demandPickupTimeChart=null}if(this.demandDeliveryTimeChart){try{this.demandDeliveryTimeChart.destroy()}catch{}this.demandDeliveryTimeChart=null}if(this.demandTimelineAreaChart){try{this.demandTimelineAreaChart.destroy()}catch{}this.demandTimelineAreaChart=null}this.chartsInitialized=!1}catch(t){console.error("[Dataset] destroyCharts error",t)}}datasetDetails=null;loadingDetails=!1;detailsError=null;selectedWarehouse=null;selectedDemand=null;selectedDatasetId=null;demands=[];loadingDemands=!1;demandsError=null;demandSearchQuery="";demandSortField=null;demandSortOrder="desc";demandStartDate="";demandEndDate="";showSettingsModal=!1;loadingShiftRatio=!1;shiftRatioError=null;shiftRatios=[];showRegionSelectionModal=!1;modalSelectedRegion="";modalWarehouses=[];modalSelectedWarehouses=new Set;loadingModalWarehouses=!1;modalWarehousesError=null;regionRatios=[];loadingTimelineData=!1;timelineDataError=null;demandsByDays={};timelineChartType="column";selectedTimelineWarehouseIds=[];showTimelineAverage=!0;timelineWarehousePageSize=10;timelineWarehouseCurrentPage=1;get hasTimelineData(){return this.demandsByDays&&Object.keys(this.demandsByDays).length>0}get availableTimelineWarehouses(){const t=new Map;return Object.values(this.demandsByDays).forEach(a=>{Array.isArray(a)&&a.forEach(r=>{if(r&&r.warehouse_id){const o=String(r.warehouse_id);t.has(o)||t.set(o,{id:o,warehouse_id:r.warehouse_id,warehouse_name:r.warehouse_name||`Warehouse ${o}`})}})}),Array.from(t.values())}get timelineWarehouseTotalPages(){return Math.ceil(this.availableTimelineWarehouses.length/this.timelineWarehousePageSize)}get paginatedAvailableTimelineWarehouses(){const t=(this.timelineWarehouseCurrentPage-1)*this.timelineWarehousePageSize;return this.availableTimelineWarehouses.slice(t,t+this.timelineWarehousePageSize)}getTimelineWarehousePageStart(){return(this.timelineWarehouseCurrentPage-1)*this.timelineWarehousePageSize+1}getTimelineWarehousePageEnd(){return Math.min(this.timelineWarehouseCurrentPage*this.timelineWarehousePageSize,this.availableTimelineWarehouses.length)}goToTimelineWarehousePreviousPage(){this.timelineWarehouseCurrentPage>1&&(this.timelineWarehouseCurrentPage--,this.cdr.markForCheck())}goToTimelineWarehouseNextPage(){this.timelineWarehouseCurrentPage<this.timelineWarehouseTotalPages&&(this.timelineWarehouseCurrentPage++,this.cdr.markForCheck())}chartShowPick=!0;chartShowDeliver=!0;chartShowAvgPick=!0;chartShowAvgDeliver=!0;chartSize="large";chartType="bar";timelineWarehouses=[];timelinePageSize=10;timelineCurrentPage=1;get timelineTotalPages(){return Math.ceil(this.timelineWarehouses.length/this.timelinePageSize)}get paginatedTimelineWarehouses(){const t=(this.timelineCurrentPage-1)*this.timelinePageSize;return this.timelineWarehouses.slice(t,t+this.timelinePageSize)}getTimelinePageStart(){return(this.timelineCurrentPage-1)*this.timelinePageSize+1}getTimelinePageEnd(){return Math.min(this.timelineCurrentPage*this.timelinePageSize,this.timelineWarehouses.length)}goToTimelinePreviousPage(){this.timelineCurrentPage>1&&(this.timelineCurrentPage--,this.cdr.markForCheck())}goToTimelineNextPage(){this.timelineCurrentPage<this.timelineTotalPages&&(this.timelineCurrentPage++,this.cdr.markForCheck())}shifts=[{name:"morning",start_hour:6,end_hour:10},{name:"noon",start_hour:10,end_hour:14},{name:"afternoon",start_hour:14,end_hour:18},{name:"evening",start_hour:18,end_hour:22}];shiftErrors=[];hours=Array.from({length:24},(t,a)=>a);hoursInclusive=Array.from({length:25},(t,a)=>a);demandSummaryCanvas;demandPickupTimeCanvas;demandDeliveryTimeCanvas;demandTimelineAreaCanvas;demandSummaryChart=null;demandPickupTimeChart=null;demandDeliveryTimeChart=null;demandTimelineAreaChart=null;chartsInitialized=!1;warehouseIcons={hub:'<svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <defs>\n        <filter id="hubShadow" x="-50%" y="-50%" width="200%" height="200%">\n          <feDropShadow dx="0" dy="2" stdDeviation="3" flood-opacity="0.4"/>\n        </filter>\n        <linearGradient id="hubGradient" x1="0%" y1="0%" x2="100%" y2="100%">\n          <stop offset="0%" style="stop-color:#818cf8;stop-opacity:1" />\n          <stop offset="100%" style="stop-color:#4f46e5;stop-opacity:1" />\n        </linearGradient>\n        <radialGradient id="hubShine" cx="35%" cy="35%">\n          <stop offset="0%" style="stop-color:white;stop-opacity:0.4" />\n          <stop offset="100%" style="stop-color:white;stop-opacity:0" />\n        </radialGradient>\n      </defs>\n      <circle cx="20" cy="20" r="18" fill="url(#hubGradient)" filter="url(#hubShadow)"/>\n      <circle cx="20" cy="20" r="18" fill="url(#hubShine)"/>\n      <circle cx="20" cy="20" r="16" fill="none" stroke="white" stroke-width="2" opacity="0.5"/>\n      <path d="M13 11h14v16h-14z" fill="white" opacity="0.95" rx="2"/>\n      <path d="M15 18h10v8h-10z" fill="#4f46e5" opacity="0.8"/>\n      <circle cx="20" cy="20" r="2.5" fill="white"/>\n    </svg>',sorting:'<svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <defs>\n        <filter id="sortingShadow" x="-50%" y="-50%" width="200%" height="200%">\n          <feDropShadow dx="0" dy="2" stdDeviation="3" flood-opacity="0.4"/>\n        </filter>\n        <linearGradient id="sortingGradient" x1="0%" y1="0%" x2="100%" y2="100%">\n          <stop offset="0%" style="stop-color:#60a5fa;stop-opacity:1" />\n          <stop offset="100%" style="stop-color:#2563eb;stop-opacity:1" />\n        </linearGradient>\n        <radialGradient id="sortingShine" cx="35%" cy="35%">\n          <stop offset="0%" style="stop-color:white;stop-opacity:0.4" />\n          <stop offset="100%" style="stop-color:white;stop-opacity:0" />\n        </radialGradient>\n      </defs>\n      <circle cx="20" cy="20" r="18" fill="url(#sortingGradient)" filter="url(#sortingShadow)"/>\n      <circle cx="20" cy="20" r="18" fill="url(#sortingShine)"/>\n      <circle cx="20" cy="20" r="16" fill="none" stroke="white" stroke-width="2" opacity="0.5"/>\n      <rect x="11" y="12" width="18" height="12" rx="2" fill="white" opacity="0.95"/>\n      <rect x="13" y="14" width="14" height="8" fill="#2563eb" opacity="0.8" rx="1"/>\n      <circle cx="20" cy="20" r="1.5" fill="white"/>\n    </svg>',delivery:'<svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <defs>\n        <filter id="deliveryShadow" x="-50%" y="-50%" width="200%" height="200%">\n          <feDropShadow dx="0" dy="2" stdDeviation="3" flood-opacity="0.4"/>\n        </filter>\n        <linearGradient id="deliveryGradient" x1="0%" y1="0%" x2="100%" y2="100%">\n          <stop offset="0%" style="stop-color:#34d399;stop-opacity:1" />\n          <stop offset="100%" style="stop-color:#059669;stop-opacity:1" />\n        </linearGradient>\n        <radialGradient id="deliveryShine" cx="35%" cy="35%">\n          <stop offset="0%" style="stop-color:white;stop-opacity:0.4" />\n          <stop offset="100%" style="stop-color:white;stop-opacity:0" />\n        </radialGradient>\n      </defs>\n      <circle cx="20" cy="20" r="18" fill="url(#deliveryGradient)" filter="url(#deliveryShadow)"/>\n      <circle cx="20" cy="20" r="18" fill="url(#deliveryShine)"/>\n      <circle cx="20" cy="20" r="16" fill="none" stroke="white" stroke-width="2" opacity="0.5"/>\n      <path d="M11 20h18l-2.5-8h-13l-2.5 8z" fill="white" opacity="0.95"/>\n      <circle cx="14" cy="26" r="2.5" fill="white"/>\n      <circle cx="26" cy="26" r="2.5" fill="white"/>\n      <path d="M20 10v6" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>\n    </svg>',transit:'<svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <defs>\n        <filter id="transitShadow" x="-50%" y="-50%" width="200%" height="200%">\n          <feDropShadow dx="0" dy="2" stdDeviation="3" flood-opacity="0.4"/>\n        </filter>\n        <linearGradient id="transitGradient" x1="0%" y1="0%" x2="100%" y2="100%">\n          <stop offset="0%" style="stop-color:#fbbf24;stop-opacity:1" />\n          <stop offset="100%" style="stop-color:#d97706;stop-opacity:1" />\n        </linearGradient>\n        <radialGradient id="transitShine" cx="35%" cy="35%">\n          <stop offset="0%" style="stop-color:white;stop-opacity:0.4" />\n          <stop offset="100%" style="stop-color:white;stop-opacity:0" />\n        </radialGradient>\n      </defs>\n      <circle cx="20" cy="20" r="18" fill="url(#transitGradient)" filter="url(#transitShadow)"/>\n      <circle cx="20" cy="20" r="18" fill="url(#transitShine)"/>\n      <circle cx="20" cy="20" r="16" fill="none" stroke="white" stroke-width="2" opacity="0.5"/>\n      <rect x="12" y="12" width="16" height="12" rx="2" fill="white" opacity="0.95"/>\n      <rect x="14" y="15" width="12" height="8" fill="#d97706" opacity="0.8" rx="1"/>\n      <circle cx="20" cy="20" r="2" fill="white"/>\n    </svg>',ktc:'<svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <defs>\n        <filter id="ktcShadow" x="-50%" y="-50%" width="200%" height="200%">\n          <feDropShadow dx="0" dy="2" stdDeviation="3" flood-opacity="0.4"/>\n        </filter>\n        <linearGradient id="ktcGradient" x1="0%" y1="0%" x2="100%" y2="100%">\n          <stop offset="0%" style="stop-color:#c084fc;stop-opacity:1" />\n          <stop offset="100%" style="stop-color:#7c3aed;stop-opacity:1" />\n        </linearGradient>\n        <radialGradient id="ktcShine" cx="35%" cy="35%">\n          <stop offset="0%" style="stop-color:white;stop-opacity:0.4" />\n          <stop offset="100%" style="stop-color:white;stop-opacity:0" />\n        </radialGradient>\n      </defs>\n      <circle cx="20" cy="20" r="18" fill="url(#ktcGradient)" filter="url(#ktcShadow)"/>\n      <circle cx="20" cy="20" r="18" fill="url(#ktcShine)"/>\n      <circle cx="20" cy="20" r="16" fill="none" stroke="white" stroke-width="2" opacity="0.5"/>\n      <rect x="11" y="13" width="18" height="12" rx="2" fill="white" opacity="0.95"/>\n      <text x="20" y="23" text-anchor="middle" fill="#7c3aed" font-size="10" font-weight="bold" font-family="Arial">KTC</text>\n    </svg>',kct:'<svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <defs>\n        <filter id="kctShadow" x="-50%" y="-50%" width="200%" height="200%">\n          <feDropShadow dx="0" dy="2" stdDeviation="3" flood-opacity="0.4"/>\n        </filter>\n        <linearGradient id="kctGradient" x1="0%" y1="0%" x2="100%" y2="100%">\n          <stop offset="0%" style="stop-color:#f472b6;stop-opacity:1" />\n          <stop offset="100%" style="stop-color:#ec4899;stop-opacity:1" />\n        </linearGradient>\n        <radialGradient id="kctShine" cx="35%" cy="35%">\n          <stop offset="0%" style="stop-color:white;stop-opacity:0.4" />\n          <stop offset="100%" style="stop-color:white;stop-opacity:0" />\n        </radialGradient>\n      </defs>\n      <circle cx="20" cy="20" r="18" fill="url(#kctGradient)" filter="url(#kctShadow)"/>\n      <circle cx="20" cy="20" r="18" fill="url(#kctShine)"/>\n      <circle cx="20" cy="20" r="16" fill="none" stroke="white" stroke-width="2" opacity="0.5"/>\n      <rect x="11" y="13" width="18" height="12" rx="2" fill="white" opacity="0.95"/>\n      <text x="20" y="23" text-anchor="middle" fill="#ec4899" font-size="10" font-weight="bold" font-family="Arial">KCT</text>\n    </svg>',default:'<svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <defs>\n        <filter id="defaultShadow" x="-50%" y="-50%" width="200%" height="200%">\n          <feDropShadow dx="0" dy="2" stdDeviation="3" flood-opacity="0.4"/>\n        </filter>\n        <linearGradient id="defaultGradient" x1="0%" y1="0%" x2="100%" y2="100%">\n          <stop offset="0%" style="stop-color:#9ca3af;stop-opacity:1" />\n          <stop offset="100%" style="stop-color:#6b7280;stop-opacity:1" />\n        </linearGradient>\n        <radialGradient id="defaultShine" cx="35%" cy="35%">\n          <stop offset="0%" style="stop-color:white;stop-opacity:0.4" />\n          <stop offset="100%" style="stop-color:white;stop-opacity:0" />\n        </radialGradient>\n      </defs>\n      <circle cx="20" cy="20" r="18" fill="url(#defaultGradient)" filter="url(#defaultShadow)"/>\n      <circle cx="20" cy="20" r="18" fill="url(#defaultShine)"/>\n      <circle cx="20" cy="20" r="16" fill="none" stroke="white" stroke-width="2" opacity="0.5"/>\n      <rect x="12" y="12" width="16" height="14" rx="2" fill="white" opacity="0.9"/>\n      <circle cx="20" cy="20" r="3" fill="#6b7280"/>\n    </svg>'};selectWarehouse(t){this.selectedWarehouse=t,this.cdr.markForCheck()}addToTimeline(t){this.timelineWarehouses.find(a=>(a.warehouse_id||a.id)===(t.warehouse_id||t.id))||(this.timelineWarehouses.push(t),this.cdr.markForCheck(),this.loadDatasets(),"demand"===this.selectedDatasetId&&this.loadDemands(),this.validateShifts()&&this.runShiftsQuery())}addAllToTimeline(){let t=0;for(const a of this.warehouses)this.timelineWarehouses.find(r=>(r.warehouse_id||r.id)===(a.warehouse_id||a.id))||(this.timelineWarehouses.push(a),t++);t>0&&(this.cdr.markForCheck(),this.loadDatasets(),"demand"===this.selectedDatasetId&&(this.loadDemands(),this.timelineWarehouses.length>0&&(this.loadShiftRatios(),this.loadDemandsByDays())),console.log(`[Dataset] Added ${t} warehouses to timeline`))}removeFromTimeline(t){const a=this.timelineWarehouses.findIndex(r=>(r.warehouse_id||r.id)===(t.warehouse_id||t.id));if(a>-1){this.timelineWarehouses.splice(a,1);const r=Math.ceil(this.timelineWarehouses.length/this.timelinePageSize);this.timelineCurrentPage>r&&(this.timelineCurrentPage=r||1),this.cdr.markForCheck(),this.loadDatasets(),"demand"===this.selectedDatasetId&&this.loadDemands(),this.timelineWarehouses.length>0&&this.validateShifts()&&this.runShiftsQuery(),this.timelineWarehouses.length>0&&this.loadDemandsByDays()}}isInTimeline(t){return this.timelineWarehouses.some(a=>(a.warehouse_id||a.id)===(t.warehouse_id||t.id))}isWarehouseSelected(t){return!(!t||!this.selectedWarehouse)&&(t.warehouse_id||t.id)===(this.selectedWarehouse.warehouse_id||this.selectedWarehouse.id)}typeConfig={truck:{color:"orange",bgLight:"bg-orange-50",bgDark:"bg-orange-100",border:"border-orange-200",text:"text-orange-700",textDark:"text-orange-900",badge:"bg-orange-500",icon:'<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16V6a1 1 0 00-1-1H4a1 1 0 00-1 1v10a1 1 0 001 1h1m8-1a1 1 0 01-1 1H9m4-1V8a1 1 0 011-1h2.586a1 1 0 01.707.293l3.414 3.414a1 1 0 01.293.707V16a1 1 0 01-1 1h-1m-6-1a1 1 0 001 1h1M5 17a2 2 0 104 0m-4 0a2 2 0 114 0m6 0a2 2 0 104 0m-4 0a2 2 0 114 0"></path></svg>'},demand:{color:"orange",bgLight:"bg-orange-50",bgDark:"bg-orange-100",border:"border-orange-200",text:"text-orange-700",textDark:"text-orange-900",badge:"bg-orange-500",icon:'<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg>'},trip:{color:"orange",bgLight:"bg-orange-50",bgDark:"bg-orange-100",border:"border-orange-200",text:"text-orange-700",textDark:"text-orange-900",badge:"bg-orange-500",icon:'<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"></path></svg>'},hub:{color:"orange",bgLight:"bg-orange-50",bgDark:"bg-orange-100",border:"border-orange-200",text:"text-orange-700",textDark:"text-orange-900",badge:"bg-orange-500",icon:'<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path></svg>'},default:{color:"gray",bgLight:"bg-gray-50",bgDark:"bg-gray-100",border:"border-gray-200",text:"text-gray-700",textDark:"text-gray-900",badge:"bg-gray-500",icon:'<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"></path></svg>'}};constructor(t,a,r,o,d){this.datasetService=t,this.router=a,this.cdr=r,this.http=o,this.platformId=d}ngOnDestroy(){if(this.warehouseSearchSubject.unsubscribe(),this.warehouseAutoSub&&this.warehouseAutoSub.unsubscribe)try{this.warehouseAutoSub.unsubscribe()}catch{}this.dateChangeTimeout&&(clearTimeout(this.dateChangeTimeout),this.dateChangeTimeout=null)}ngOnInit(){this.selectedDatasetId=null;const{start:t,end:a}=this.getDefaultDateRange();this.demandStartDate=t,this.demandEndDate=a,this.warehouseRegionShortname="HNO",this.loadDatasets(),this.loadRetailOverview(),this.cdr.markForCheck(),console.log("[Dataset] ngOnInit - selectedDatasetId:",this.selectedDatasetId,"loading:",this.loading),this.warehouseSearchSubject.pipe((0,I.B)(300),(0,W.F)()).subscribe(r=>{this.warehouseSearchQuery=r,this.warehouseCurrentPage=1,this.loadWarehouses()}),this.datasetSearchSubject.pipe((0,I.B)(300),(0,W.F)()).subscribe(r=>{this.state.q=r,this.state.offset=0,this.loadDatasets()}),this.warehouseAutoSub=this.warehouseAutoCompleteSubject.pipe((0,I.B)(300),(0,W.F)(),(0,J.n)(r=>!r||r.length<1?(0,F.of)([]):(this.warehouseAutoLoading=!0,this.datasetService.getWarehouses({region_shortname:this.warehouseRegionShortname,size:5,search:r}).pipe((0,Q.T)(o=>{this.warehouseAutoLoading=!1;const d=o;return Array.isArray(d.data)?d.data:d.data?.data||[]}),(0,T.W)(o=>(console.error("[Dataset] warehouse autocomplete error",o),this.warehouseAutoLoading=!1,(0,F.of)([]))))))).subscribe(r=>{this.warehouseSuggestions=(r||[]).slice(0,5),this.cdr.markForCheck()})}ngAfterViewInit(){var t=this;return(0,A.A)(function*(){yield new Promise(a=>setTimeout(a,100)),null!==t.selectedDatasetId&&(console.warn("[Dataset] ngAfterViewInit - selectedDatasetId was set to:",t.selectedDatasetId,"resetting to null"),t.selectedDatasetId=null),t.cdr.markForCheck()})()}loadWarehouses(){this.loadingWarehouses=!0,this.warehousesError=null,this.datasetService.getWarehouses({region_shortname:this.warehouseRegionShortname,size:this.warehousePageSize,offset:(this.warehouseCurrentPage-1)*this.warehousePageSize,search:this.warehouseSearchQuery||""}).subscribe({next:a=>{if(console.log("[Dataset] Warehouses API Response:",a),a.ok&&a.data){const r=a,o=Array.isArray(r.data)?r.data:r.data?.data||[];this.warehouses=o||[],this.warehouseTotal=Array.isArray(r.data)?r.data.length:r.data?.meta?.total||this.warehouses.length,console.log("[Dataset] Loaded warehouses:",this.warehouses.length);const d=this.pagedWarehouses&&this.pagedWarehouses.length>0?this.pagedWarehouses[0]:this.warehouses[0]||null;!this.selectedWarehouse&&d&&(this.selectedWarehouse=d)}else this.warehousesError="Failed to load warehouses",console.error("[Dataset] Invalid warehouses response:",a);this.loadingWarehouses=!1,this.cdr.markForCheck()},error:a=>{this.warehousesError=a.message||"Failed to load warehouses",this.loadingWarehouses=!1,console.error("[Dataset] Load warehouses error:",a),this.cdr.markForCheck()}})}openDetails(t){!t||!t.id||(this.datasetDetails=null,this.loadingDetails=!0,this.detailsError=null,this.datasetService.getDataset(t.id).subscribe({next:a=>{a.ok&&a.data?this.datasetDetails=a.data.data||a.data:(this.detailsError="Failed to load Data Product details",console.error("[Dataset] getDataset invalid response:",a)),this.loadingDetails=!1,this.cdr.markForCheck()},error:a=>{this.detailsError=a?.message||"Failed to load details",this.loadingDetails=!1,this.cdr.markForCheck(),console.error("[Dataset] getDataset error:",a)}}))}closeDetails(){this.datasetDetails=null,this.detailsError=null,this.loadingDetails=!1,this.selectedDatasetId=null,this.demands=[],this.demandsError=null,this.loadingDemands=!1,this.chartsInitialized=!1,this.destroyCharts()}getTypeConfig(t){return this.typeConfig[t]||this.typeConfig.default}trackByDatasetId(t,a){return a.id}loadDatasets(){this.loading=!0,this.error=null,this.fallbackNotice=null,this.datasetService.getDatasets({size:this.state.size,offset:this.state.offset,q:this.state.q||void 0,type:this.state.type||void 0}).subscribe({next:a=>{console.log("[Dataset] API Response:",a),console.log("[Dataset] Response data:",a.data),a.ok&&a.data?(this.datasets=a.data.data||[],this.state.total=a.data.meta?.total||0,this.fallbackNotice=null,console.log("[Dataset] Loaded datasets:",this.datasets.length),console.log("[Dataset] selectedDatasetId:",this.selectedDatasetId,"should show list:",!this.selectedDatasetId)):(console.error("[Dataset] Invalid response, using fallback datasets:",a),this.applyDefaultDatasets("Unable to fetch datasets from API. Showing default data.")),this.loading=!1,this.cdr.markForCheck()},error:a=>{console.error("[Dataset] Load error, using fallback datasets:",a),this.applyDefaultDatasets("Dataset API unavailable. Showing default data."),this.loading=!1,this.cdr.markForCheck()}})}loadRetailOverview(){this.loadingRetailOverview=!0,this.retailOverviewNotice=null,(0,q.p)({health:this.http.get(`${this.retailBaseUrl}/health`).pipe((0,T.W)(()=>(0,F.of)(null))),version:this.http.get(`${this.retailBaseUrl}/version`).pipe((0,T.W)(()=>(0,F.of)(null))),analytics:this.http.get(`${this.retailBaseUrl}/analytics/inventory`).pipe((0,T.W)(()=>(0,F.of)(null))),alerts:this.http.get(`${this.retailBaseUrl}/analytics/alerts`).pipe((0,T.W)(()=>(0,F.of)(null)))}).subscribe({next:({health:t,version:a,analytics:r,alerts:o})=>{let d=!1;t?.status||t?.service||t?.timestamp?this.retailHealth={status:String(t?.status||"unknown"),service:String(t?.service||"retail"),timestamp:String(t?.timestamp||"")}:d=!0,a?.version||a?.adapter?this.retailVersion={version:String(a?.version||"N/A"),adapter:String(a?.adapter||"retail")}:d=!0;const s=r?.data;s&&"object"==typeof s?this.retailInventoryAnalytics={total_products:Number(s?.total_products||0),total_quantity:Number(s?.total_quantity||0),inventory_value:Number(s?.inventory_value||0),low_stock_products:Number(s?.low_stock_products||0),out_of_stock_products:Number(s?.out_of_stock_products||0)}:d=!0,Array.isArray(o?.data)?this.retailAlerts=o.data:(this.retailAlerts=[],d=!0),this.retailOverviewNotice=d?"Some Retail APIs are unavailable. Showing default values for missing sections.":null,this.loadingRetailOverview=!1,this.cdr.markForCheck()},error:()=>{this.loadingRetailOverview=!1,this.retailOverviewNotice="Retail APIs are unavailable. Showing default values.",this.cdr.markForCheck()}})}getHealthBadgeClass(t){const a=String(t||"").toLowerCase();return"healthy"===a?"bg-green-100 text-green-700":"degraded"===a?"bg-amber-100 text-amber-700":"bg-red-100 text-red-700"}getAlertTitle(t){return t&&"object"==typeof t?String(t.title||t.name||t.type||t._id||"Alert"):"Alert"}getAlertSubtitle(t){return t&&"object"==typeof t?String(t.message||t.severity||t.status||""):""}onSearch(){this.state.offset=0,this.loadDatasets()}onTypeFilter(t){this.state.type=t,this.state.offset=0,this.loadDatasets()}onPageChange(t){this.state.offset=(t-1)*this.state.size,this.loadDatasets()}toggleViewMode(){this.state.viewMode="grid"===this.state.viewMode?"table":"grid"}getQualityColor(t){return t>=80?"text-green-600":t>=60?"text-yellow-600":"text-red-600"}escapeHtml(t){const a=document.createElement("div");return a.textContent=t,a.innerHTML}createDataset(){this.router.navigate(["/dataset-form"])}viewDataset(t){"demand"===t.type?(this.selectedDatasetId="demand",this.loadDemands(),this.loadShiftRatios(),this.loadDemandsByDays()):this.selectedDatasetId=t.id,this.cdr.markForCheck()}viewDemandDataset(){this.selectedDatasetId="demand",this.loadDemands(),this.loadShiftRatios(),this.loadDemandsByDays(),this.cdr.markForCheck()}getRegionName(t){const a=this.availableRegions.find(r=>r.code===t);return a?a.name:t}getFormattedShifts(){return this.shifts&&0!==this.shifts.length?this.shifts.map(t=>{const a=String(Math.floor(t.start_hour)).padStart(2,"0"),r=String(Math.floor(t.end_hour)).padStart(2,"0");return`${t.name||"Ca"} (${a}:00 - ${r}:00)`}).join(", "):"-"}formatShiftTime(t){return`${String(Math.floor(t.start_hour)).padStart(2,"0")}:00 - ${String(Math.floor(t.end_hour)).padStart(2,"0")}:00`}onInfoTableRegionChange(){this.cdr.markForCheck()}addAllWarehousesFromRegion(){this.warehouseRegionShortname&&(this.loadingWarehouses=!0,this.warehousesError=null,this.datasetService.getWarehouses({region_shortname:this.warehouseRegionShortname,size:1e3,offset:0,search:""}).subscribe({next:a=>{try{const r=a,d=(Array.isArray(r.data)?r.data:r.data?.data||[])||[];let s=0;for(const h of d)this.isInTimeline(h)||(this.timelineWarehouses.push(h),s++);console.log(`[Dataset] Added ${s} warehouses from region ${this.warehouseRegionShortname}`),"demand"===this.selectedDatasetId&&s>0&&(this.loadDemands(),this.loadShiftRatios(),this.loadDemandsByDays())}catch(r){console.error("[Dataset] addAllWarehousesFromRegion error",r),this.warehousesError="Failed to load warehouse list"}this.loadingWarehouses=!1,this.cdr.markForCheck()},error:a=>{console.error("[Dataset] addAllWarehousesFromRegion error",a),this.warehousesError=a.message||"Failed to load warehouse list",this.loadingWarehouses=!1,this.cdr.markForCheck()}}))}openRegionSelectionModal(){this.showRegionSelectionModal=!0,this.modalSelectedRegion=this.warehouseRegionShortname||"",this.modalSelectedWarehouses.clear(),this.modalWarehouses=[],this.modalWarehousesError=null,this.modalSelectedRegion&&this.loadWarehousesForModal(),this.cdr.markForCheck()}closeRegionSelectionModal(){this.showRegionSelectionModal=!1,this.modalSelectedWarehouses.clear(),this.modalWarehouses=[],this.modalWarehousesError=null,this.cdr.markForCheck()}onModalRegionChange(){this.modalSelectedWarehouses.clear(),this.modalWarehouses=[],this.modalWarehousesError=null,this.modalSelectedRegion&&this.loadWarehousesForModal(),this.cdr.markForCheck()}loadWarehousesForModal(){this.modalSelectedRegion&&(this.loadingModalWarehouses=!0,this.modalWarehousesError=null,this.datasetService.getWarehouses({region_shortname:this.modalSelectedRegion,size:1e3,offset:0,search:""}).subscribe({next:a=>{try{const r=a,o=Array.isArray(r.data)?r.data:r.data?.data||[];this.modalWarehouses=o||[],this.modalSelectedWarehouses.clear();for(const d of this.modalWarehouses){const s=(d.warehouse_id||d.id)?.toString();s&&this.isInTimeline(d)&&this.modalSelectedWarehouses.add(s)}}catch(r){console.error("[Dataset] loadWarehousesForModal error",r),this.modalWarehousesError="Failed to load warehouse list"}this.loadingModalWarehouses=!1,this.cdr.markForCheck()},error:a=>{console.error("[Dataset] loadWarehousesForModal error",a),this.modalWarehousesError=a.message||"Failed to load warehouse list",this.loadingModalWarehouses=!1,this.cdr.markForCheck()}}))}toggleWarehouseSelection(t){const a=(t.warehouse_id||t.id)?.toString();a&&(this.modalSelectedWarehouses.has(a)?this.modalSelectedWarehouses.delete(a):this.modalSelectedWarehouses.add(a),this.cdr.markForCheck())}isWarehouseSelectedInModal(t){const a=(t.warehouse_id||t.id)?.toString();return!!a&&this.modalSelectedWarehouses.has(a)}selectAllWarehousesInModal(){this.modalSelectedWarehouses.clear();for(const t of this.modalWarehouses){const a=(t.warehouse_id||t.id)?.toString();a&&this.modalSelectedWarehouses.add(a)}this.cdr.markForCheck()}deselectAllWarehousesInModal(){this.modalSelectedWarehouses.clear(),this.cdr.markForCheck()}confirmModalSelection(){if(!this.modalSelectedRegion||0===this.modalSelectedWarehouses.size)return void console.warn("[Dataset] No region or warehouses selected");this.modalSelectedRegion!==this.warehouseRegionShortname&&(this.warehouseRegionShortname=this.modalSelectedRegion);const a=[];for(const d of this.timelineWarehouses){const s=(d.warehouse_id||d.id)?.toString();s&&this.modalWarehouses.some(l=>(l.warehouse_id||l.id)?.toString()===s)&&!this.modalSelectedWarehouses.has(s)&&a.push(d)}for(const d of a){const s=this.timelineWarehouses.findIndex(h=>(h.warehouse_id||h.id)?.toString()===(d.warehouse_id||d.id)?.toString());s>-1&&this.timelineWarehouses.splice(s,1)}let r=0;for(const d of this.modalWarehouses){const s=(d.warehouse_id||d.id)?.toString();s&&this.modalSelectedWarehouses.has(s)&&(this.isInTimeline(d)||(this.timelineWarehouses.push(d),r++))}console.log(`[Dataset] Updated timeline: ${r} added, ${a.length} removed, ${this.timelineWarehouses.length} total`),console.log(`[Dataset] confirmModalSelection - selectedDatasetId: ${this.selectedDatasetId}`);const o=Math.ceil(this.timelineWarehouses.length/this.timelinePageSize);this.timelineCurrentPage>o&&(this.timelineCurrentPage=o||1),"demand"===this.selectedDatasetId&&(this.loadDemands(),this.loadShiftRatios(),this.loadDemandsByDays()),this.cdr.markForCheck()}clearAllPoints(){this.timelineWarehouses=[],this.timelineCurrentPage=1,this.demands=[],this.demandsError=null,this.loadingDemands=!1,this.chartsInitialized=!1,this.destroyCharts(),this.cdr.markForCheck()}useDataset(t){console.log("Using dataset:",t),this.router.navigate(["/datasets",t.id])}trackByWarehouseId(t,a){return a.warehouse_id?.toString()||t.toString()}products(){return this.warehouses||[]}get totalPickAndDeliver(){return this.demands&&0!==this.demands.length?this.demands.reduce((t,a)=>t+(a.total_pick||0)+(a.total_deliver||0),0):0}get totalPick(){return this.demands&&0!==this.demands.length?this.demands.reduce((t,a)=>t+(a.total_pick||0),0):0}get totalDeliver(){return this.demands&&0!==this.demands.length?this.demands.reduce((t,a)=>t+(a.total_deliver||0),0):0}get filteredDemands(){let t=[...this.demands||[]];if(this.demandSearchQuery&&this.demandSearchQuery.trim()){const a=this.demandSearchQuery.toLowerCase().trim();t=t.filter(r=>(r.warehouse_name||"").toLowerCase().includes(a)||(r.warehouse_id?.toString()||"").includes(a))}return this.demandSortField&&t.sort((a,r)=>{let o=a[this.demandSortField],d=r[this.demandSortField];return null==o&&(o=0),null==d&&(d=0),"asc"===this.demandSortOrder?o>d?1:o<d?-1:0:o<d?1:o>d?-1:0}),t}sortDemands(t){this.demandSortField===t?this.demandSortOrder="asc"===this.demandSortOrder?"desc":"asc":(this.demandSortField=t,this.demandSortOrder="desc"),this.cdr.markForCheck()}triggerChangeDetection(){this.cdr.markForCheck()}clearSearch(){this.demandSearchQuery="",this.cdr.markForCheck()}get chartWidth(){return 100}get chartHeight(){return 650}getChartType(){return this.chartType}getDefaultDateRange(){return{start:"2025-12-01",end:"2025-12-14"}}openSettingsModal(){const{start:t,end:a}=this.getDefaultDateRange();this.demandStartDate=this.demandStartDate||t,this.demandEndDate=this.demandEndDate||a,this.modalSelectedRegion=this.warehouseRegionShortname||"",this.modalSelectedWarehouses.clear(),this.modalWarehouses=[],this.modalWarehousesError=null,this.modalSelectedRegion&&this.loadWarehousesForModal(),this.showSettingsModal=!0,this.shiftErrors=[],this.demandErrors=[],this.cdr.markForCheck()}closeSettingsModal(){this.showSettingsModal=!1,this.modalSelectedWarehouses.clear(),this.modalWarehouses=[],this.modalWarehousesError=null,this.cdr.markForCheck()}applySettings(){var t=this;return(0,A.A)(function*(){if(t.modalSelectedRegion&&t.modalSelectedWarehouses.size>0?t.confirmModalSelection():t.modalSelectedRegion&&t.modalSelectedRegion!==t.warehouseRegionShortname&&(t.warehouseRegionShortname=t.modalSelectedRegion),!t.validateShifts())return t.shiftErrors=t.shiftErrors.length?t.shiftErrors:["Invalid shift configuration"],void t.cdr.markForCheck();const{start:a,end:r}=t.getDefaultDateRange();t.demandStartDate=t.demandStartDate||a,t.demandEndDate=t.demandEndDate||r,t.closeSettingsModal(),t.loadDemands(),t.loadShiftRatios()})()}loadShiftRatios(){const t=new Date,a=t.toISOString(),r=new Date(t.getTime()-6048e5).toISOString(),o=this.demandStartDate?new Date(this.demandStartDate+"T00:00:00.000Z").toISOString():r,d=this.demandEndDate?new Date(this.demandEndDate+"T23:59:59.999Z").toISOString():a;let s=this.warehouseRegionShortname;if(this.timelineWarehouses&&this.timelineWarehouses.length>0){const l=this.timelineWarehouses[0];l.region_shortname&&(s=l.region_shortname)}this.loadingShiftRatio=!0,this.shiftRatioError=null;const h={region_shortname:s,shifts:this.shifts.map(l=>({name:l.name,start_hour:Number(l.start_hour),end_hour:Number(l.end_hour)})),time_range:{start:o,end:d}};console.log("[Dataset] Calling getDemandsShiftRatio with payload:",h),this.datasetService.getDemandsShiftRatio(h).subscribe({next:l=>{console.log("[Dataset] Raw shift ratio response:",l);let c=l;l&&"object"==typeof l&&("ok"in l&&l.ok&&"data"in l?(c=l.data,c&&"object"==typeof c&&"code"in c&&"data"in c&&(c=c.data)):"code"in l&&"data"in l?c=l.data:"data"in l?(c=l.data,c&&"object"==typeof c&&"data"in c&&(c=c.data)):Array.isArray(l)&&(c=l)),console.log("[Dataset] Extracted data after parsing:",c);const m=Array.isArray(c)?c:[];this.shiftRatios=m.map(_=>({shift_name:_.shift?.name||_.shift_name||"",shift:_.shift||{name:_.shift_name||""},pick_ratio:_.pick_ratio||0,deliver_ratio:_.deliver_ratio||0,total_pick:_.total_pick||0,total_deliver:_.total_deliver||0,avg_pick_per_day:_.avg_pick_per_day||0,avg_deliver_per_day:_.avg_deliver_per_day||0,active_days:_.active_days||0})),this.loadingShiftRatio=!1,this.shiftRatioError=null,console.log("[Dataset] Parsed shift ratios:",this.shiftRatios),console.log("[Dataset] shiftRatios length:",this.shiftRatios?.length),this.cdr.markForCheck(),this.chartsInitialized=!1,this.cdr.markForCheck(),setTimeout(()=>{this.shiftRatios&&this.shiftRatios.length>0?(console.log("[Dataset] Attempting to update charts, pickup canvas:",!!this.demandPickupTimeCanvas?.nativeElement,"delivery canvas:",!!this.demandDeliveryTimeCanvas?.nativeElement),this.demandPickupTimeCanvas?.nativeElement&&this.demandDeliveryTimeCanvas?.nativeElement?(console.log("[Dataset] Both canvases available, calling updateCharts()"),this.updateCharts(),this.cdr.markForCheck()):(console.log("[Dataset] Canvas not ready, waiting 200ms more"),setTimeout(()=>{this.demandPickupTimeCanvas?.nativeElement&&this.demandDeliveryTimeCanvas?.nativeElement?(console.log("[Dataset] Canvas ready after wait, calling updateCharts()"),this.updateCharts()):console.warn("[Dataset] Canvas still not available after wait"),this.cdr.markForCheck()},200))):console.log("[Dataset] No shiftRatios data, skipping chart update")},300)},error:l=>{console.error("[Dataset] Error loading shift ratios, using fallback:",l),this.shiftRatioError="Unable to load shift ratios from API, using default data",this.applyDefaultShiftRatios(),this.loadingShiftRatio=!1,setTimeout(()=>{this.updateCharts(),this.cdr.markForCheck()},100),this.cdr.markForCheck()}})}loadDemandsByDays(){if(!this.timelineWarehouses||0===this.timelineWarehouses.length)return void console.log("[Dataset] No timeline warehouses selected, skipping demands by days");const t=this.timelineWarehouses.map(l=>l.warehouse_id||l.id).map(l=>Number(l)).filter(l=>!isNaN(l));if(0===t.length)return void console.log("[Dataset] No valid warehouse IDs, skipping demands by days");const a=new Date,r=a.toISOString(),o=new Date(a.getTime()-25056e5).toISOString(),d=this.demandStartDate?new Date(this.demandStartDate+"T00:00:00").toISOString():o,s=this.demandEndDate?new Date(this.demandEndDate+"T23:59:59").toISOString():r;this.loadingTimelineData=!0,this.timelineDataError=null,this.cdr.markForCheck();const h={warehouse_ids:t,time_range:{start:d,end:s}};console.log("[Dataset] Loading demands by days with payload:",h),this.datasetService.getDemandsByDays(h).subscribe({next:l=>{console.log("[Dataset] Demands by days response:",l);let c=l;l&&"object"==typeof l&&("ok"in l&&l.ok&&"data"in l?(c=l.data,c&&"object"==typeof c&&"code"in c&&"data"in c&&(c=c.data)):"code"in l&&"data"in l?c=l.data:"data"in l&&(c=l.data,c&&"object"==typeof c&&"code"in c&&"data"in c&&(c=c.data))),(!c||"object"!=typeof c||Array.isArray(c))&&(console.warn("[Dataset] Invalid data format, using empty object"),c={}),this.demandsByDays=c,this.loadingTimelineData=!1,this.timelineDataError=null,console.log("[Dataset] Parsed demands by days:",this.demandsByDays),console.log("[Dataset] Number of dates:",Object.keys(this.demandsByDays).length),console.log("[Dataset] Sample dates:",Object.keys(this.demandsByDays).slice(0,5)),this.cdr.markForCheck();const m=(_=0)=>{if(!(_>5))return this.demandTimelineAreaCanvas&&this.demandTimelineAreaCanvas.nativeElement?(console.log("[Dataset] Canvas ready, rendering timeline chart..."),this.renderTimelineAreaChart(),void this.cdr.markForCheck()):(console.log(`[Dataset] Canvas not ready, attempt ${_+1}, retrying...`),void setTimeout(()=>m(_+1),200));console.error("[Dataset] Failed to render timeline chart after 5 attempts")};setTimeout(()=>m(),100)},error:l=>{this.timelineDataError=l?.message||"Failed to load timeline data",this.loadingTimelineData=!1,console.error("[Dataset] Error loading demands by days:",l),this.cdr.markForCheck()}})}renderTimelineAreaChart(){if(console.log("[Dataset] renderTimelineAreaChart called"),console.log("[Dataset] Canvas element:",!!this.demandTimelineAreaCanvas?.nativeElement),console.log("[Dataset] demandsByDays:",this.demandsByDays),!this.demandTimelineAreaCanvas||!this.demandTimelineAreaCanvas.nativeElement)return void console.warn("[Dataset] Timeline area canvas not available");const t=Object.keys(this.demandsByDays).sort(),a=t.filter(u=>{const g=this.demandsByDays[u];return Array.isArray(g)&&g.length>0}),r=t;console.log("[Dataset] Dates found with data:",a.length),console.log("[Dataset] All dates in demandsByDays:",t.length),console.log("[Dataset] Dates to render (all dates):",r.length),console.log("[Dataset] Sample dates:",r.slice(0,5),"...",r.slice(-5)),0===r.length&&(console.log("[Dataset] No dates found, creating empty chart with default data"),r.push((new Date).toISOString().split("T")[0]));const o=u=>this.selectedTimelineWarehouseIds&&0!==this.selectedTimelineWarehouseIds.length?u.filter(g=>{const b=String(g?.warehouse_id||"");return this.selectedTimelineWarehouseIds.includes(b)}):u,d=[],s=[],h=[],l=[];r.forEach(u=>{const g=this.demandsByDays[u];let b=[];Array.isArray(g)?b=g:g&&"object"==typeof g&&null!==g?b=[g]:(null==g||console.warn(`[Dataset] Unexpected dayData type for date ${u}:`,typeof g,g),b=[]);const f=o(b),y=f.reduce((D,v)=>{const k=v&&"object"==typeof v&&v.total_pick?Number(v.total_pick):0;return D+(isNaN(k)?0:k)},0),w=f.reduce((D,v)=>{const k=v&&"object"==typeof v&&v.total_deliver?Number(v.total_deliver):0;return D+(isNaN(k)?0:k)},0),S=f.length>0?f.reduce((D,v)=>{const k=v&&"object"==typeof v&&v.avg_pick_per_day?Number(v.avg_pick_per_day):0;return D+(isNaN(k)?0:k)},0)/f.length:0,M=f.length>0?f.reduce((D,v)=>{const k=v&&"object"==typeof v&&v.avg_deliver_per_day?Number(v.avg_deliver_per_day):0;return D+(isNaN(k)?0:k)},0)/f.length:0;d.push(y),s.push(w),h.push(S),l.push(M)});const c=r.map(u=>new Date(u).toLocaleDateString("en-US",{day:"2-digit",month:"2-digit",year:"numeric"})),m=this.demandTimelineAreaCanvas.nativeElement.getContext("2d");if(!m)return void console.error("[Dataset] Could not get 2d context for timeline area chart");if(this.demandTimelineAreaChart)try{this.demandTimelineAreaChart.destroy()}catch(u){console.error("[Dataset] Error destroying existing timeline area chart",u)}console.log("[Dataset] Creating chart with labels:",c.length,"pickData:",d.length,"deliverData:",s.length),console.log("[Dataset] Chart type:",this.timelineChartType),console.log("[Dataset] Selected warehouses:",this.selectedTimelineWarehouseIds.length),console.log("[Dataset] Sample pickData:",d.slice(0,5)),console.log("[Dataset] Sample deliverData:",s.slice(0,5)),!d.some(u=>u>0)&&!s.some(u=>u>0)&&r.length>0&&console.log("[Dataset] No data values found, rendering empty chart");const x=[];"column"===this.timelineChartType?(x.push({type:"bar",label:"Total Pick (kg)",data:d,backgroundColor:"rgba(249, 115, 22, 0.8)",borderColor:"rgba(249, 115, 22, 1)",borderWidth:1}),x.push({type:"bar",label:"Total Deliver (kg)",data:s,backgroundColor:"rgba(0, 0, 0, 0.8)",borderColor:"rgba(0, 0, 0, 1)",borderWidth:1}),this.showTimelineAverage&&(x.push({type:"line",label:"Average Pick (kg)",data:h,borderColor:"rgba(249, 115, 22, 0.6)",backgroundColor:"transparent",borderWidth:2,borderDash:[5,5],pointRadius:0,pointHoverRadius:4,fill:!1,tension:.4}),x.push({type:"line",label:"Average Deliver (kg)",data:l,borderColor:"rgba(0, 0, 0, 0.6)",backgroundColor:"transparent",borderWidth:2,borderDash:[5,5],pointRadius:0,pointHoverRadius:4,fill:!1,tension:.4}))):(x.push({type:"line",label:"Total Pick (kg)",data:d,borderColor:"rgba(249, 115, 22, 1)",backgroundColor:"rgba(249, 115, 22, 0.2)",fill:!0,tension:.4,pointRadius:3,pointHoverRadius:5,pointBackgroundColor:"rgba(249, 115, 22, 1)",pointBorderColor:"#ffffff",pointBorderWidth:2}),x.push({type:"line",label:"Total Deliver (kg)",data:s,borderColor:"rgba(0, 0, 0, 1)",backgroundColor:"rgba(0, 0, 0, 0.2)",fill:!0,tension:.4,pointRadius:3,pointHoverRadius:5,pointBackgroundColor:"rgba(0, 0, 0, 1)",pointBorderColor:"#ffffff",pointBorderWidth:2}),this.showTimelineAverage&&(x.push({type:"line",label:"Average Pick (kg)",data:h,borderColor:"rgba(249, 115, 22, 0.6)",backgroundColor:"transparent",borderWidth:2,borderDash:[5,5],pointRadius:0,pointHoverRadius:4,fill:!1,tension:.4}),x.push({type:"line",label:"Average Deliver (kg)",data:l,borderColor:"rgba(0, 0, 0, 0.6)",backgroundColor:"transparent",borderWidth:2,borderDash:[5,5],pointRadius:0,pointHoverRadius:4,fill:!1,tension:.4})));try{this.demandTimelineAreaChart=new R.A(m,{type:"column"===this.timelineChartType?"bar":"line",data:{labels:c,datasets:x},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"top",labels:{usePointStyle:!0,padding:15,font:{size:12,weight:"bold"}}},tooltip:{mode:"index",intersect:!1,callbacks:{label:u=>`${u.dataset.label||""}: ${(u.parsed.y||0).toLocaleString("en-US")} kg`}}},scales:"column"===this.timelineChartType?{x:{stacked:!1,display:!0,title:{display:!0,text:"Date",font:{size:12,weight:"bold"}},grid:{display:!0,color:"rgba(0, 0, 0, 0.05)"},ticks:{maxRotation:45,minRotation:45,font:{size:10}}},y:{stacked:!1,display:!0,title:{display:!0,text:"Volume (kg)",font:{size:12,weight:"bold"}},beginAtZero:!0,grid:{display:!0,color:"rgba(0, 0, 0, 0.05)"},ticks:{callback:u=>u.toLocaleString("en-US")+" kg"}}}:{x:{display:!0,title:{display:!0,text:"Date",font:{size:12,weight:"bold"}},grid:{display:!0,color:"rgba(0, 0, 0, 0.05)"},ticks:{maxRotation:45,minRotation:45,font:{size:10}}},y:{display:!0,title:{display:!0,text:"Volume (kg)",font:{size:12,weight:"bold"}},beginAtZero:!0,grid:{display:!0,color:"rgba(0, 0, 0, 0.05)"},ticks:{callback:u=>u.toLocaleString("en-US")+" kg"}}},interaction:{mode:"nearest",axis:"x",intersect:!1}}}),console.log("[Dataset] Timeline area chart created successfully")}catch(u){console.error("[Dataset] Error creating timeline area chart:",u),console.error("[Dataset] Error details:",u)}}updateTimelineChart(){this.demandTimelineAreaCanvas?.nativeElement&&(this.renderTimelineAreaChart(),this.cdr.markForCheck())}toggleTimelineWarehouse(t){const a=this.selectedTimelineWarehouseIds.indexOf(t);a>-1?this.selectedTimelineWarehouseIds.splice(a,1):this.selectedTimelineWarehouseIds.push(t),this.updateTimelineChart()}selectAllTimelineWarehouses(){this.selectedTimelineWarehouseIds=this.availableTimelineWarehouses.map(t=>String(t.warehouse_id||t.id)),this.updateTimelineChart()}deselectAllTimelineWarehouses(){this.selectedTimelineWarehouseIds=[],this.updateTimelineChart()}toString(t){return String(t||"")}onDateRangeChange(){console.log("[Dataset] Date range changed, reloading timeline chart"),console.log("[Dataset] demandStartDate:",this.demandStartDate,"demandEndDate:",this.demandEndDate),this.timelineWarehouses&&this.timelineWarehouses.length>0&&(this.dateChangeTimeout&&clearTimeout(this.dateChangeTimeout),this.dateChangeTimeout=setTimeout(()=>{this.loadDemandsByDays()},500))}dateChangeTimeout=null;calculateRegionRatios(){if(!this.demands||0===this.demands.length)return void(this.regionRatios=[]);const t=new Map;for(const o of this.demands){const d=this.timelineWarehouses.find(c=>c.warehouse_id?.toString()===o.warehouse_id?.toString()),s=d?.region_shortname||"Unknown",h=d?.region_fullname||s;t.has(s)||t.set(s,{total_pick:0,total_deliver:0,warehouse_count:0,region_fullname:h});const l=t.get(s);l.total_pick+=o.total_pick||0,l.total_deliver+=o.total_deliver||0,l.warehouse_count+=1}const a=Array.from(t.values()).reduce((o,d)=>o+d.total_pick,0),r=Array.from(t.values()).reduce((o,d)=>o+d.total_deliver,0);this.regionRatios=Array.from(t.entries()).map(([o,d])=>({region_shortname:o,region_fullname:d.region_fullname,total_pick:d.total_pick,total_deliver:d.total_deliver,warehouse_count:d.warehouse_count,pick_percentage:a>0?d.total_pick/a*100:0,deliver_percentage:r>0?d.total_deliver/r*100:0})).sort((o,d)=>d.total_pick-o.total_pick),this.cdr.markForCheck()}getAverage(t){return this.demands&&0!==this.demands.length?this.demands.reduce((r,o)=>r+(o[t]||0),0)/this.demands.length:0}isAboveAverage(t,a){return t>this.getAverage(a)}isBelowAverage(t,a){return t<this.getAverage(a)}selectDemand(t){this.selectedDemand=t,this.cdr.markForCheck(),this.updateCharts(),setTimeout(()=>{this.updateCharts()},100)}isDemandSelected(t){return!(!this.selectedDemand||!t)&&(this.selectedDemand.warehouse_id||this.selectedDemand.id)===(t.warehouse_id||t.id)}getSeverity(t){switch((t?.warehouse_type||t?.type||"").toString().toLowerCase()){case"hub":default:return"info";case"sorting":return"success";case"delivery":return"warning";case"transit":return"danger"}}viewWarehouse(t){const a=t?.warehouse_id||t?.id;if(a)try{this.router.navigate(["/warehouses",a])}catch{console.log("[Dataset] viewWarehouse:",a)}}getWarehouseTypeBadgeClass(t){switch(t?.toLowerCase()){case"hub":return"bg-indigo-100 text-indigo-800";case"sorting":return"bg-blue-100 text-blue-800";case"delivery":return"bg-green-100 text-green-800";case"transit":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}}onWarehouseSearch(){this.warehouseCurrentPage=1,this.loadWarehouses()}onWarehouseSearchInput(t){this.warehouseSearchSubject.next(t),this.warehouseAutoCompleteSubject.next(t)}onWarehouseAutoComplete(t){this.warehouseAutoCompleteSubject.next(t&&t.query?t.query:t||"")}onWarehouseAutoSelect(t){const a=t;a&&(this.warehouseSearchQuery=a.warehouse_name||"",this.warehouseSuggestions=[],this.selectWarehouse(a),this.addToTimeline(a),this.cdr.markForCheck())}onWarehouseResultClick(t){t&&(this.warehouseSearchQuery=t.warehouse_name||"",this.warehouseSuggestions=[],this.selectWarehouse(t),this.addToTimeline(t),this.cdr.markForCheck())}onSearchInput(t){this.datasetSearchSubject.next(t)}onStrategicSuggestion(t){if("demand"===t)return this.state.type="demand",this.selectedDatasetId="demand",this.demands=[],this.demandsError=null,this.loadingDemands=!1,this.loadDemands(),this.loadShiftRatios(),this.loadDemandsByDays(),void this.cdr.markForCheck();this.selectedDatasetId=null,this.state.type=t,this.state.offset=0,this.loadDatasets()}onStrategicWarehouseSearch(t){const a=this.availableRegions.find(r=>r.name===t);a&&(this.warehouseRegionShortname=a.code,this.warehouseCurrentPage=1,this.loadWarehouses())}loadDemands(){if(0===this.timelineWarehouses.length)return console.log("[Dataset] loadDemands: No warehouses in timeline, skipping"),this.loadingDemands=!1,this.demands=[],this.regionRatios=[],void this.cdr.markForCheck();console.log("[Dataset] loadDemands: Starting, timelineWarehouses.length:",this.timelineWarehouses.length),this.loadingDemands=!0,this.demandsError=null,this.cdr.markForCheck();const t=this.timelineWarehouses.map(l=>l.warehouse_id||l.id).map(l=>Number(l)).filter(l=>!isNaN(l)),a=new Date,r=a.toISOString().slice(0,10),o=new Date(a.getTime()-25056e5).toISOString().slice(0,10),h={warehouse_ids:t,time_range:{start:this.demandStartDate||o,end:this.demandEndDate||r}};console.log("[Dataset] loadDemands: Starting with payload:",h),this.datasetService.getDemandsWithTimeRange(h).subscribe({next:l=>{console.log("[Dataset] getDemandsWithTimeRange response:",l);try{let c=[];if(l&&"object"==typeof l)if("ok"in l&&l.ok&&"data"in l){const m=l.data;c=Array.isArray(m)?m:m&&(m.data||m)||[]}else if(Array.isArray(l))c=l;else if("data"in l){const m=l.data;c=Array.isArray(m)?m:[]}else c=[];else Array.isArray(l)&&(c=l);console.log("[Dataset] Parsed demands data:",c),this.demands=c,this.demandsError=null,!this.selectedDemand&&c.length>0&&(this.selectedDemand=c[0],setTimeout(()=>{this.updateCharts()},100)),this.calculateRegionRatios(),c.length>0&&(this.chartsInitialized=!1,setTimeout(()=>{this.updateCharts(),this.cdr.markForCheck()},100))}catch(c){console.error("[Dataset] Error parsing demands response:",c),this.demandsError="API parsing error, using default data",this.applyDefaultDemands()}this.loadingDemands=!1,this.cdr.markForCheck(),console.log("[Dataset] loadDemands completed. loadingDemands:",this.loadingDemands,"demands.length:",this.demands.length)},error:l=>{console.error("[Dataset] getDemandsWithTimeRange error, using fallback:",l),this.demandsError="Unable to load demands from API, using default data",this.applyDefaultDemands(),this.loadingDemands=!1,this.cdr.markForCheck()}})}applyDefaultDatasets(t){this.datasets=[{id:"demand",name:"Demand Dataset",type:"demand",description:"Default demand dataset for fallback mode",records:12450,created_at:(new Date).toISOString()},{id:"truck",name:"Truck Dataset",type:"truck",description:"Default fleet dataset for fallback mode",records:3200,created_at:(new Date).toISOString()},{id:"trip",name:"Trip Dataset",type:"trip",description:"Default trip dataset for fallback mode",records:5800,created_at:(new Date).toISOString()},{id:"hub",name:"Hub Dataset",type:"hub",description:"Default hub dataset for fallback mode",records:640,created_at:(new Date).toISOString()}],this.state.total=this.datasets.length,this.error=null,this.fallbackNotice=t}applyDefaultDemands(){this.demands=[{warehouse_id:1001,warehouse_name:"HNO Central Hub",province_name:"Ha Noi",district_name:"Cau Giay",total_pick:12840,total_deliver:11960,avg_pick_per_day:428,avg_deliver_per_day:398,active_days:30},{warehouse_id:1002,warehouse_name:"HNO West Station",province_name:"Ha Noi",district_name:"Nam Tu Liem",total_pick:9320,total_deliver:8740,avg_pick_per_day:311,avg_deliver_per_day:291,active_days:30},{warehouse_id:1003,warehouse_name:"HNO East Station",province_name:"Ha Noi",district_name:"Long Bien",total_pick:7640,total_deliver:7210,avg_pick_per_day:255,avg_deliver_per_day:240,active_days:30}],!this.selectedDemand&&this.demands.length>0&&(this.selectedDemand=this.demands[0]),this.calculateRegionRatios(),this.applyDefaultShiftRatios()}applyDefaultShiftRatios(){const t=this.shifts.length?this.shifts:[{name:"morning",start_hour:6,end_hour:10},{name:"noon",start_hour:10,end_hour:14},{name:"afternoon",start_hour:14,end_hour:18},{name:"evening",start_hour:18,end_hour:22}],a=[.33,.22,.28,.17],r=[.26,.31,.25,.18],o=this.demands.reduce((h,l)=>h+(l.total_pick||0),0)||29700,d=this.demands.reduce((h,l)=>h+(l.total_deliver||0),0)||27910;this.shiftRatios=t.map((h,l)=>{const c=a[l]??1/t.length,m=r[l]??1/t.length;return{shift_name:h.name,shift:{name:h.name,start_hour:h.start_hour,end_hour:h.end_hour},pick_ratio:c,deliver_ratio:m,total_pick:Math.round(o*c),total_deliver:Math.round(d*m),avg_pick_per_day:Math.round(o*c/30),avg_deliver_per_day:Math.round(d*m/30),active_days:30}})}addShift(){this.shifts.push({name:"new shift",start_hour:0,end_hour:1})}removeShift(t){t>=0&&t<this.shifts.length&&this.shifts.splice(t,1)}loadDefaultShifts(){this.shifts=[{name:"morning",start_hour:6,end_hour:10},{name:"noon",start_hour:10,end_hour:14},{name:"afternoon",start_hour:14,end_hour:18},{name:"evening",start_hour:18,end_hour:22}],this.timelineWarehouses&&this.timelineWarehouses.length>0&&this.validateShifts()&&this.runShiftsQuery()}validateShifts(){return this.shiftErrors=[],this.shifts.forEach((t,a)=>{t.start_hour>=t.end_hour&&this.shiftErrors.push(`Shift "${t.name||a+1}": start hour must be earlier than end hour.`),(t.start_hour<0||t.start_hour>23||t.end_hour<1||t.end_hour>24)&&this.shiftErrors.push(`Shift "${t.name||a+1}": invalid hour range (0-23/1-24).`)}),(!this.timelineWarehouses||0===this.timelineWarehouses.length)&&this.shiftErrors.push("Please select at least one warehouse in Timeline."),0===this.shiftErrors.length}buildShiftsPayload(){const t=this.timelineWarehouses.map(h=>h.warehouse_id||h.id).map(h=>Number(h)).filter(h=>!isNaN(h)),a=new Date,r=a.toISOString().slice(0,10),o=new Date(a.getTime()-25056e5).toISOString().slice(0,10),d=this.demandStartDate||o,s=this.demandEndDate||r;return{region_shortname:this.warehouseRegionShortname,warehouse_ids:t,shifts:this.shifts.map(h=>({name:h.name,start_hour:Math.floor(h.start_hour),end_hour:Math.floor(h.end_hour)})),time_range:{start:d,end:s}}}runShiftsQuery(){if(!this.validateShifts())return void this.cdr.markForCheck();const t=this.buildShiftsPayload();console.log("[Dataset] Calling getDemandsShiftRatio with payload:",t),this.datasetService.getDemandsShiftRatio(t).subscribe({next:a=>{if(a.ok&&a.data){const r=a.data,o=Array.isArray(r)?r:r&&(r.data||r);this.demands=o||[],setTimeout(()=>this.updateCharts(),50),console.log("[Dataset] Received shift ratio response",o)}else this.shiftErrors.push("Unable to fetch shift-based data"),console.error("[Dataset] runShiftsQuery invalid response:",a);this.cdr.markForCheck()},error:a=>{this.shiftErrors.push(a?.message||"Error while fetching shift-based data"),console.error("[Dataset] runShiftsQuery error:",a),this.cdr.markForCheck()}})}demandErrors=[];validateDemandRange(){return this.demandErrors=[],(!this.timelineWarehouses||0===this.timelineWarehouses.length)&&this.demandErrors.push("Please select at least one warehouse in Timeline."),(!this.demandStartDate||!this.demandEndDate)&&this.demandErrors.push("Please select both start and end dates."),this.demandStartDate&&this.demandEndDate&&this.demandStartDate>this.demandEndDate&&this.demandErrors.push('"From date" must be earlier than or equal to "To date".'),0===this.demandErrors.length}buildDemandsPayload(){return{warehouse_ids:this.timelineWarehouses.map(a=>a.warehouse_id||a.id).map(a=>Number(a)).filter(a=>!isNaN(a)),time_range:{start:this.demandStartDate||"",end:this.demandEndDate||""}}}applyDemandFilter(){if(this.demandErrors=[],!this.validateDemandRange())return void this.cdr.markForCheck();const t=this.buildDemandsPayload();console.log("[Dataset] Calling getDemandsWithTimeRange with payload:",t),this.loadingDemands=!0,this.datasetService.getDemandsWithTimeRange(t).subscribe({next:a=>{if(a.ok&&a.data){const r=a.data,o=Array.isArray(r)?r:r&&(r.data||r);this.demands=o||[],this.calculateRegionRatios(),this.loadShiftRatios(),this.loadDemandsByDays(),setTimeout(()=>this.updateCharts(),50)}else this.demandErrors.push("Unable to load volume data"),console.error("[Dataset] applyDemandFilter invalid response:",a);this.loadingDemands=!1,this.cdr.markForCheck()},error:a=>{this.demandErrors.push(a?.message||"Failed to load volume data"),this.loadingDemands=!1,console.error("[Dataset] applyDemandFilter error:",a),this.cdr.markForCheck()}})}onWarehouseRegionChange(t){this.warehouseRegionShortname=t,this.warehouseCurrentPage=1,this.loadingWarehouses=!0,this.warehousesError=null,this.datasetService.getWarehouses({region_shortname:this.warehouseRegionShortname,size:1e3,offset:0,search:""}).subscribe({next:r=>{try{const o=r,d=Array.isArray(o.data)?o.data:o.data?.data||[];this.warehouses=d||[],this.warehouseTotal=Array.isArray(o.data)?o.data.length:o.data?.meta?.total||this.warehouses.length;let s=0;for(const h of this.warehouses)this.timelineWarehouses.find(l=>(l.warehouse_id||l.id)===(h.warehouse_id||h.id))||(this.timelineWarehouses.push(h),s++);s>0&&(console.log(`[Dataset] Auto-added ${s} warehouses to timeline for region ${this.warehouseRegionShortname}`),this.loadDatasets(),"demand"===this.selectedDatasetId&&(this.loadDemands(),this.loadDemandsByDays(),this.loadShiftRatios()))}catch(o){console.error("[Dataset] onWarehouseRegionChange processing error",o),this.warehousesError="Error processing warehouse list"}this.loadingWarehouses=!1,this.cdr.markForCheck()},error:r=>{console.error("[Dataset] Load warehouses by region error:",r),this.warehousesError=r?.message||"Unable to load warehouses for this region",this.loadingWarehouses=!1,this.cdr.markForCheck()}})}onWarehousePageChange(t){this.warehouseCurrentPage=t,this.loadWarehouses()}onWarehousePageSizeChange(t){this.warehousePageSize=t,this.warehouseCurrentPage=1,this.loadWarehouses()}get warehouseTotalPages(){return Math.ceil(this.warehouseTotal/this.warehousePageSize)}get warehouseStartIndex(){return(this.warehouseCurrentPage-1)*this.warehousePageSize+1}get warehouseEndIndex(){return Math.min(this.warehouseCurrentPage*this.warehousePageSize,this.warehouseTotal)}getChartHeight(){return 1e3}getChartMinWidth(){const t=this.filteredDemands?.length||this.demands?.length||0;return t>30?1800:t>25?1600:t>20?1400:t>15?1200:100}get chartOptions(){const t=this.filteredDemands?.length||this.demands?.length||0,a="bar"===this.chartType;return{responsive:!1,maintainAspectRatio:!1,aspectRatio:void 0,interaction:{mode:"index",intersect:!1},layout:{padding:{right:40,left:40,top:30,bottom:t>20?80:t>15?70:50}},plugins:{legend:{position:"top",labels:{usePointStyle:!0,padding:20,font:{size:14,weight:"600"},boxWidth:15,boxHeight:15}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.85)",padding:16,titleFont:{size:15,weight:"bold"},bodyFont:{size:14},borderColor:"rgba(255, 255, 255, 0.1)",borderWidth:1,displayColors:!0,callbacks:{label:function(d){let s=d.dataset.label||"";return s&&(s+=": "),null!==d.parsed.y&&(s+=new Intl.NumberFormat("en-US").format(d.parsed.y)),s}}}},animation:{onComplete:()=>{const d=document.querySelector("p-chart canvas");if(!d)return;const s=R.A.getChart(d);if(!s)return;const h=s.ctx,l=s.data.datasets;h.save(),h.font="bold 11px Arial",h.textAlign="center",h.textBaseline="bottom",h.fillStyle="#374151",l.forEach((c,m)=>{const _=s.getDatasetMeta(m);!_||!_.data||_.data.forEach((x,u)=>{const g=c.data[u];if(null==g||0===g)return;let f,y;a?(f=x.x,y=x.y-5):(f=x.x,y=x.y-10);const w=new Intl.NumberFormat("en-US",{notation:"compact",maximumFractionDigits:1}).format(g);h.shadowColor="rgba(255, 255, 255, 0.8)",h.shadowBlur=4,h.fillText(w,f,y),h.shadowBlur=0})}),h.restore()}},scales:{x:{grid:{display:!1},ticks:{font:{size:t>25?10:t>20?11:t>15?12:13,weight:"500"},maxRotation:a?t>20?75:t>15?60:45:0,minRotation:a?t>20?75:t>15?60:45:0,autoSkip:t>15,maxTicksLimit:t>30?30:t>25?25:t>20?20:void 0,padding:t>20?15:10},...a&&{barThickness:t>5?t>25?30:t>20?35:t>15?40:t>10?45:50:void 0,categoryPercentage:t>20?.7:t>15?.75:t>10?.85:.9,barPercentage:t>20?.9:t>10?.95:1}},y:{beginAtZero:!0,title:{display:!0,text:"Total (kg)",font:{size:14,weight:"bold"},color:"rgba(249, 115, 22, 0.9)",padding:{top:10,bottom:10}},grid:{color:"rgba(249, 115, 22, 0.15)",lineWidth:1},ticks:{font:{size:12,weight:"500"},color:"rgba(249, 115, 22, 0.8)",padding:8,callback:function(d){return new Intl.NumberFormat("en-US").format(d)}}},y1:{beginAtZero:!0,position:"right",grid:{drawOnChartArea:!1},title:{display:!0,text:"Average/day (kg/day)",font:{size:14,weight:"bold"},color:"rgba(251, 146, 60, 0.9)",padding:{top:10,bottom:10}},ticks:{font:{size:12,weight:"500"},color:"rgba(251, 146, 60, 0.8)",padding:8,callback:function(d){return new Intl.NumberFormat("en-US",{minimumFractionDigits:1,maximumFractionDigits:1}).format(d)}}}}}}getDemandsChartData(t){if(!this.demands||0===this.demands.length)return{labels:[],datasets:[]};const a=this.filteredDemands.length>0?this.filteredDemands:this.demands,r=a.map(o=>o.warehouse_name||`Warehouse ${o.warehouse_id}`);if("combined"===t){const o=[],d="line"===this.chartType;return this.chartShowPick&&o.push(d?{type:"line",label:"Total Pick",data:a.map(s=>s.total_pick||0),borderColor:"rgba(59, 130, 246, 1)",backgroundColor:"rgba(59, 130, 246, 0.1)",borderWidth:3,tension:.4,yAxisID:"y",pointRadius:5,pointHoverRadius:7,pointBackgroundColor:"rgba(59, 130, 246, 1)",pointBorderColor:"#fff",pointBorderWidth:2,fill:!1}:{type:"bar",label:"Total Pick",data:a.map(s=>s.total_pick||0),backgroundColor:"rgba(59, 130, 246, 0.95)",borderColor:"rgba(59, 130, 246, 1)",borderWidth:2.5,borderRadius:8,yAxisID:"y"}),this.chartShowDeliver&&o.push(d?{type:"line",label:"Total Deliver",data:a.map(s=>s.total_deliver||0),borderColor:"rgba(16, 185, 129, 1)",backgroundColor:"rgba(16, 185, 129, 0.1)",borderWidth:3,tension:.4,yAxisID:"y",pointRadius:5,pointHoverRadius:7,pointBackgroundColor:"rgba(16, 185, 129, 1)",pointBorderColor:"#fff",pointBorderWidth:2,fill:!1}:{type:"bar",label:"Total Deliver",data:a.map(s=>s.total_deliver||0),backgroundColor:"rgba(16, 185, 129, 0.95)",borderColor:"rgba(16, 185, 129, 1)",borderWidth:2,borderRadius:6,yAxisID:"y"}),this.chartShowAvgPick&&o.push(d?{type:"line",label:"Avg Pick/Day",data:a.map(s=>s.avg_pick_per_day||0),borderColor:"rgba(249, 115, 22, 1)",backgroundColor:"rgba(249, 115, 22, 0.1)",borderWidth:3,tension:.4,yAxisID:"y1",pointRadius:5,pointHoverRadius:7,pointBackgroundColor:"rgba(249, 115, 22, 1)",pointBorderColor:"#fff",pointBorderWidth:2,fill:!1}:{type:"line",label:"Avg Pick/Day",data:a.map(s=>s.avg_pick_per_day||0),borderColor:"rgba(249, 115, 22, 1)",backgroundColor:"rgba(249, 115, 22, 0.1)",borderWidth:4,tension:.4,yAxisID:"y1",pointRadius:6,pointHoverRadius:8,pointBackgroundColor:"rgba(249, 115, 22, 1)",pointBorderColor:"#fff",pointBorderWidth:3,fill:!1}),this.chartShowAvgDeliver&&o.push(d?{type:"line",label:"Avg Deliver/Day",data:a.map(s=>s.avg_deliver_per_day||0),borderColor:"rgba(139, 92, 246, 1)",backgroundColor:"rgba(139, 92, 246, 0.1)",borderWidth:3,tension:.4,yAxisID:"y1",pointRadius:5,pointHoverRadius:7,pointBackgroundColor:"rgba(139, 92, 246, 1)",pointBorderColor:"#fff",pointBorderWidth:2,fill:!1}:{type:"line",label:"Avg Deliver/Day",data:a.map(s=>s.avg_deliver_per_day||0),borderColor:"rgba(139, 92, 246, 1)",backgroundColor:"rgba(139, 92, 246, 0.1)",borderWidth:4,tension:.4,yAxisID:"y1",pointRadius:6,pointHoverRadius:8,pointBackgroundColor:"rgba(139, 92, 246, 1)",pointBorderColor:"#fff",pointBorderWidth:3,fill:!1}),{labels:r,datasets:o}}return"total"===t?{labels:r,datasets:[{label:"Total Pick",data:this.demands.map(o=>o.total_pick),backgroundColor:"rgba(59, 130, 246, 0.8)",borderColor:"rgba(59, 130, 246, 1)",borderWidth:1},{label:"Total Deliver",data:this.demands.map(o=>o.total_deliver),backgroundColor:"rgba(16, 185, 129, 0.8)",borderColor:"rgba(16, 185, 129, 1)",borderWidth:1}]}:{labels:r,datasets:[{label:"Avg Pick/Day",data:this.demands.map(o=>o.avg_pick_per_day),borderColor:"rgba(139, 92, 246, 1)",backgroundColor:"rgba(139, 92, 246, 0.1)",tension:.4},{label:"Avg Deliver/Day",data:this.demands.map(o=>o.avg_deliver_per_day),borderColor:"rgba(245, 158, 11, 1)",backgroundColor:"rgba(245, 158, 11, 0.1)",tension:.4}]}}findDemandByWarehouseId(t){if(!t)return null;const a=t.toString();return this.demands&&0!==this.demands.length&&this.demands.find(r=>(r.warehouse_id||r.id||"").toString()===a)||null}viewProductivity(){if(0===this.timelineWarehouses.length)return void alert("No warehouse in timeline");const t=this.timelineWarehouses.map(r=>r.warehouse_name).join(", ");alert(`Volume for ${this.timelineWarehouses.length} warehouses:\n${t}\n\nDetailed volume view will be implemented in a future version.`),console.log("View productivity for warehouses:",this.timelineWarehouses)}static \u0275fac=function(a){return new(a||i)(e.rXU(Z.q),e.rXU(ee.Ix),e.rXU(e.gRc),e.rXU(te.Qq),e.rXU(e.Agw))};static \u0275cmp=e.VBU({type:i,selectors:[["app-dataset"]],viewQuery:function(a,r){if(1&a&&(e.GBs(re,5),e.GBs(ie,5),e.GBs(oe,5),e.GBs(se,5)),2&a){let o;e.mGM(o=e.lsd())&&(r.demandSummaryCanvas=o.first),e.mGM(o=e.lsd())&&(r.demandPickupTimeCanvas=o.first),e.mGM(o=e.lsd())&&(r.demandDeliveryTimeCanvas=o.first),e.mGM(o=e.lsd())&&(r.demandTimelineAreaCanvas=o.first)}},decls:8,vars:4,consts:[["demandSummaryCanvas",""],["demandTimelineAreaCanvas",""],["demandPickupTimeCanvas",""],["demandDeliveryTimeCanvas",""],["id","content-dataset",1,"tab-content","min-h-screen","bg-gray-50"],["title","Stochastic Dataset","subtitle","Manage and analyze stochastic datasets for forecasting","icon","\u{1f4ca}"],[1,"p-4"],["class","mb-6 bg-white border border-gray-200 rounded-xl shadow-sm p-5",4,"ngIf"],[1,"relative"],["class","w-full p-6",4,"ngIf"],["class","w-full h-full flex gap-4",4,"ngIf"],["class","fixed inset-0 z-[3000] bg-black/40 backdrop-blur-sm flex items-center justify-center px-4",4,"ngIf"],[1,"mb-6","bg-white","border","border-gray-200","rounded-xl","shadow-sm","p-5"],[1,"flex","flex-col","lg:flex-row","lg:items-center","lg:justify-between","gap-3","mb-4"],[1,"text-lg","font-bold","text-gray-900"],[1,"text-sm","text-gray-600"],["class","text-sm text-gray-500",4,"ngIf"],["class","mb-4 bg-amber-50 border border-amber-200 rounded-lg px-3 py-2 text-sm text-amber-700",4,"ngIf"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4","mb-4"],[1,"border","border-gray-200","rounded-lg","p-4"],[1,"text-xs","text-gray-500","mb-1"],[1,"flex","items-center","gap-2","mb-1"],[1,"inline-flex","items-center","px-2","py-0.5","rounded-full","text-xs","font-semibold",3,"ngClass"],[1,"text-xs","text-gray-600"],["class","text-xs text-gray-500 mt-1",4,"ngIf"],[1,"text-xl","font-bold","text-gray-900"],[1,"text-xs","text-gray-600","mt-1"],[1,"border","border-gray-200","rounded-lg"],[1,"px-4","py-3","border-b","border-gray-200","flex","items-center","justify-between"],[1,"font-semibold","text-gray-900"],[1,"text-xs","text-gray-500"],["class","px-4 py-6 text-sm text-gray-500",4,"ngIf"],["class","divide-y divide-gray-100",4,"ngIf"],[1,"text-sm","text-gray-500"],[1,"mb-4","bg-amber-50","border","border-amber-200","rounded-lg","px-3","py-2","text-sm","text-amber-700"],[1,"text-xs","text-gray-500","mt-1"],[1,"px-4","py-6","text-sm","text-gray-500"],[1,"divide-y","divide-gray-100"],["class","px-4 py-3",4,"ngFor","ngForOf"],[1,"px-4","py-3"],[1,"text-sm","font-medium","text-gray-900"],["class","text-xs text-gray-600",4,"ngIf"],[1,"w-full","p-6"],["class","flex items-center justify-center py-12",4,"ngIf"],["class","bg-red-50 border-2 border-red-200 rounded-xl p-6 mb-6",4,"ngIf"],["class","bg-amber-50 border-2 border-amber-200 rounded-xl p-4 mb-6",4,"ngIf"],["class","grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",4,"ngIf"],["class","flex items-center justify-center py-20",4,"ngIf"],[1,"flex","items-center","justify-center","py-12"],[1,"text-center"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-orange-500","mx-auto","mb-4"],[1,"text-gray-600","font-medium"],[1,"bg-red-50","border-2","border-red-200","rounded-xl","p-6","mb-6"],[1,"flex","items-center","gap-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-red-500","flex-shrink-0"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-red-800","font-bold","mb-1"],[1,"text-red-700"],[1,"bg-amber-50","border-2","border-amber-200","rounded-xl","p-4","mb-6"],[1,"flex","items-start","gap-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-amber-600","mt-0.5","flex-shrink-0"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M12 3l9 16H3l9-16z"],[1,"text-amber-800","font-semibold","mb-1"],[1,"text-amber-700","text-sm"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4"],["class","bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 p-5 text-left group",3,"ngClass","click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"bg-white","border","border-gray-200","rounded-xl","shadow-sm","hover:shadow-md","transition-all","duration-200","p-5","text-left","group",3,"click","ngClass"],[1,"flex","items-center","gap-3","mb-4"],[1,"w-12","h-12","rounded-xl","flex","items-center","justify-center","shadow-md","flex-shrink-0"],["class","w-6 h-6","fill","none","viewBox","0 0 24 24","xmlns","http://www.w3.org/2000/svg",4,"ngIf"],[1,"flex-1","min-w-0"],[1,"font-bold","text-gray-900","text-lg","truncate"],[1,"text-xs","text-gray-500","mt-0.5"],[1,"inline-flex","items-center","px-2","py-0.5","rounded-full","text-xs","font-medium",3,"ngClass"],["class","text-sm text-gray-600 line-clamp-2",4,"ngIf"],[1,"space-y-2"],[1,"flex","items-center","justify-between","text-sm"],[1,"text-gray-600"],["class","flex items-center justify-between text-sm",4,"ngIf"],["fill","none","viewBox","0 0 24 24","xmlns","http://www.w3.org/2000/svg",1,"w-6","h-6"],["stroke","#ffffff","stroke-width","2","stroke-linecap","round","stroke-linejoin","round","d","M13 16V6a1 1 0 00-1-1H4a1 1 0 00-1 1v10a1 1 0 001 1h1m8-1a1 1 0 01-1 1H9m4-1V8a1 1 0 011-1h2.586a1 1 0 01.707.293l3.414 3.414a1 1 0 01.293.707V16a1 1 0 01-1 1h-1m-6-1a1 1 0 001 1h1M5 17a2 2 0 104 0m-4 0a2 2 0 114 0m6 0a2 2 0 104 0m-4 0a2 2 0 114 0"],["stroke","#ffffff","stroke-width","2","stroke-linecap","round","stroke-linejoin","round","d","M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"],["stroke","#ffffff","stroke-width","2","stroke-linecap","round","stroke-linejoin","round","d","M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"],["stroke","#ffffff","stroke-width","2","stroke-linecap","round","stroke-linejoin","round","d","M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"],["stroke","#ffffff","stroke-width","2","stroke-linecap","round","stroke-linejoin","round","d","M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"],[1,"text-sm","text-gray-600","line-clamp-2"],[1,"font-medium","text-gray-700"],[1,"flex","items-center","justify-center","py-20"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-20","h-20","mx-auto","mb-4","text-gray-300"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"text-lg","font-semibold","text-gray-700","mb-2"],[1,"text-sm","text-gray-500","mb-4"],[1,"px-5","py-2.5","bg-orange-500","hover:bg-orange-600","text-white","rounded-lg","font-medium","shadow-sm","hover:shadow-md","transition-all","duration-200",3,"click"],[1,"w-full","h-full","flex","gap-4"],[1,"w-fit","min-w-[320px]","max-w-[400px]","sticky","top-4","self-start","max-h-[calc(100vh-2rem)]","overflow-y-auto","bg-white","rounded-xl","shadow-lg","border","border-gray-200","flex","flex-col"],[1,"bg-gray-50","border-b","border-gray-200","px-4","py-3","flex-shrink-0"],[1,"flex","items-center","justify-between"],[1,"text-base","font-bold","text-gray-900","flex","items-center","gap-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-gray-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],["title","Edit",1,"p-1.5","text-gray-400","hover:text-orange-600","hover:bg-orange-50","rounded-lg","transition-all",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],[1,"flex-1","overflow-y-auto","p-4","space-y-4"],["class","bg-white border border-gray-200 rounded-lg overflow-hidden",4,"ngIf"],["class","bg-gray-50 rounded-lg border border-gray-200 p-3 flex-1 flex flex-col min-h-0",4,"ngIf"],[1,"flex-1","min-w-0","h-full","overflow-y-auto"],["class","w-full h-full bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden flex flex-col",4,"ngIf"],["class","w-full h-full bg-white rounded-xl shadow-xl border-2 border-gray-200 overflow-hidden flex flex-col",4,"ngIf"],[1,"bg-white","border","border-gray-200","rounded-lg","overflow-hidden"],[1,"w-full","text-sm"],[1,"border-b","border-gray-200"],[1,"px-3","py-2.5","font-semibold","text-gray-700","bg-gray-50","w-1/3"],[1,"px-3","py-2.5","text-gray-900"],[4,"ngIf"],["class","text-gray-400",4,"ngIf"],["class","space-y-1",4,"ngIf"],[1,"text-gray-400"],[1,"space-y-1"],[1,"grid","grid-cols-2","gap-3","pb-1","border-b","border-gray-200","mb-1"],[1,"text-xs","font-semibold","text-gray-600","uppercase"],["class","grid grid-cols-2 gap-3 border-b border-gray-100 last:border-b-0 pb-1 last:pb-0",4,"ngFor","ngForOf"],[1,"grid","grid-cols-2","gap-3","border-b","border-gray-100","last:border-b-0","pb-1","last:pb-0"],[1,"bg-gray-50","rounded-lg","border","border-gray-200","p-3","flex-1","flex","flex-col","min-h-0"],[1,"flex","items-center","justify-between","mb-3","flex-shrink-0"],[1,"text-sm","font-bold","text-gray-900","flex","items-center","gap-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-orange-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"px-2","py-0.5","bg-orange-100","text-orange-700","rounded-full","text-xs","font-semibold"],["class","text-xs text-red-600 hover:text-red-700 font-medium",3,"click",4,"ngIf"],[1,"mb-3","flex-shrink-0"],[1,"absolute","inset-y-0","left-0","pl-2","flex","items-center","pointer-events-none"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"],["type","text","placeholder","Search by warehouse name or ID...",1,"w-full","pl-8","pr-8","py-2","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-orange-500","focus:border-orange-500","text-xs","bg-white",3,"ngModelChange","ngModel"],["class","absolute inset-y-0 right-0 pr-2 flex items-center text-gray-400 hover:text-gray-600",3,"click",4,"ngIf"],["class","flex-1 overflow-y-auto space-y-2 min-h-0",4,"ngIf"],["class","flex items-center justify-between mt-3 pt-3 border-t border-gray-200 flex-shrink-0",4,"ngIf"],["class","text-center py-6 text-gray-400",4,"ngIf"],[1,"text-xs","text-red-600","hover:text-red-700","font-medium",3,"click"],[1,"absolute","inset-y-0","right-0","pr-2","flex","items-center","text-gray-400","hover:text-gray-600",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"flex-1","overflow-y-auto","space-y-2","min-h-0"],["class","flex items-center gap-2 p-2 bg-white border border-orange-200 rounded-lg hover:shadow-sm transition-all group",4,"ngFor","ngForOf"],[1,"flex","items-center","gap-2","p-2","bg-white","border","border-orange-200","rounded-lg","hover:shadow-sm","transition-all","group"],[1,"flex","items-center","justify-center","w-6","h-6","bg-gradient-to-br","from-orange-500","to-orange-600","rounded-full","text-white","text-xs","font-bold","flex-shrink-0","shadow-sm"],[1,"font-semibold","text-gray-900","text-xs","mb-0.5","truncate"],[1,"text-xs","text-gray-600","truncate"],["title","Delete",1,"flex-shrink-0","p-1","text-red-500","hover:bg-red-100","rounded","transition-all","opacity-0","group-hover:opacity-100",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3.5","h-3.5"],[1,"flex","items-center","justify-between","mt-3","pt-3","border-t","border-gray-200","flex-shrink-0"],[1,"flex","items-center","gap-2"],[1,"px-2","py-1","text-xs","font-medium","text-gray-700","bg-white","border","border-gray-300","rounded","hover:bg-gray-50","disabled:opacity-50","disabled:cursor-not-allowed","transition-all",3,"click","disabled"],[1,"text-xs","text-gray-700","font-medium"],[1,"text-center","py-6","text-gray-400"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-10","h-10","mx-auto","mb-2","text-gray-300"],[1,"text-xs","font-medium","text-gray-500"],[1,"text-xs","text-gray-400","mt-0.5"],[1,"w-full","h-full","bg-white","rounded-xl","shadow-lg","border","border-gray-200","overflow-hidden","flex","flex-col"],[1,"bg-gray-50","border-b","border-gray-200","px-6","py-4","flex-shrink-0"],[1,"text-lg","font-bold","text-gray-900","flex","items-center","gap-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"],[1,"flex-1","overflow-y-auto","bg-white"],["class","bg-red-50 border-2 border-red-200 rounded-xl p-5 mb-6 shadow-sm mx-6 mt-6",4,"ngIf"],[1,"px-6","pt-6","pb-4"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"bg-white","border","border-gray-200","rounded-lg","shadow-sm","p-5","hover:shadow-md","transition-all","duration-200"],[1,"flex","items-center","justify-between","mb-4"],[1,"w-12","h-12","rounded-lg","bg-orange-500","flex","items-center","justify-center","shadow-sm"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-white"],[1,"text-3xl","font-bold","text-gray-900","mb-1"],[1,"text-gray-600","text-sm","font-medium"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"],[1,"mb-6","px-6"],[1,"bg-gray-50","border-b","border-gray-200","p-6"],[1,"flex","items-center","gap-4"],[1,"w-14","h-14","rounded-xl","bg-orange-500","flex","items-center","justify-center","shadow-sm"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-7","h-7","text-white"],[1,"text-2xl","font-bold","mb-1","text-gray-900"],[1,"text-gray-600","text-sm"],[1,"p-6"],["class","bg-orange-50 border-2 border-orange-200 rounded-lg p-8 text-center",4,"ngIf"],["class","bg-red-50 border-2 border-red-200 rounded-lg p-4 text-center",4,"ngIf"],["class","mb-4 space-y-4",4,"ngIf"],["class","bg-gradient-to-br from-white to-orange-50 border-2 border-orange-200 rounded-xl p-6 shadow-sm mb-4",4,"ngIf"],["class","bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden",4,"ngIf"],["class","mb-6 px-6 pt-6",4,"ngIf"],[1,"flex","items-center","justify-between","mb-6"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-white"],[1,"flex","items-center","gap-2","bg-gray-100","rounded-lg","p-1","border","border-gray-200"],[1,"px-4","py-2","rounded-md","text-sm","font-semibold","transition-all","duration-200",3,"click","ngClass"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","inline","mr-1.5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z"],[1,"p-4","bg-gray-50","rounded-lg","border","border-gray-200"],[1,"flex","items-center","gap-2","mb-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-gray-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"],[1,"text-sm","font-semibold","text-gray-700"],[1,"grid","grid-cols-2","md:grid-cols-4","gap-3"],[1,"flex","items-center","gap-2.5","cursor-pointer","group","bg-white","hover:bg-orange-50","rounded-lg","p-3","transition-all","border","border-gray-200","hover:border-orange-200"],["type","checkbox",1,"w-4","h-4","text-orange-500","rounded","focus:ring-2","focus:ring-orange-300",3,"ngModelChange","change","ngModel"],[1,"flex","items-center","gap-2","flex-1"],[1,"w-3","h-3","rounded-full","bg-orange-500","shadow-sm"],[1,"text-sm","font-medium","text-gray-700"],[1,"p-8","bg-gradient-to-br","from-gray-50","via-white","to-gray-50"],[1,"w-full","rounded-2xl","border-2","border-gray-200","bg-white","shadow-inner",2,"position","relative","background","linear-gradient(to bottom, #ffffff 0%, #f9fafb 100%)","padding","2rem"],[1,"overflow-x-auto","overflow-y-hidden",2,"position","relative","padding-top","1rem","height","936px","width","100%","-webkit-overflow-scrolling","touch","scrollbar-width","thin","scrollbar-color","rgba(156, 163, 175, 0.5) transparent"],[2,"height","936px","position","relative",3,"ngStyle"],[2,"display","block !important","width","100% !important","height","936px !important","min-height","936px !important",3,"type","data","options"],[1,"bg-white","border-b-2","border-orange-200","p-6"],[1,"flex","items-center","gap-4","mb-4"],[1,"w-14","h-14","rounded-2xl","bg-orange-500","flex","items-center","justify-center","shadow-sm"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"],[1,"flex-1"],[1,"flex","items-center","justify-between","mt-4","pt-4","border-t","border-orange-200"],[1,"flex","items-center","gap-3","text-xs"],[1,"flex","items-center","gap-1.5"],[1,"w-4","h-4","rounded","bg-green-100","border","border-green-300"],[1,"text-gray-700"],[1,"w-4","h-4","rounded","bg-red-100","border","border-red-300"],[1,"text-sm","text-gray-700","font-medium"],[1,"text-orange-600","font-bold"],["class","ml-2 text-gray-600",4,"ngIf"],["class","bg-red-50 border-2 border-red-200 rounded-xl p-5 mb-6 shadow-sm",4,"ngIf"],["class","bg-gradient-to-r from-orange-50 to-orange-100 border-2 border-orange-200 rounded-xl p-6 mb-6 shadow-sm",4,"ngIf"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-8"],[1,"lg:col-span-1","flex","flex-col"],[1,"bg-white","border","border-gray-200","rounded-lg","shadow-sm","p-6","flex-1","flex","flex-col","h-full"],[1,"flex","items-center","gap-3","mb-6"],[1,"w-10","h-10","rounded-lg","bg-orange-500","flex","items-center","justify-center"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z"],[1,"text-lg","font-semibold","text-gray-900"],[1,"flex-1","flex","items-center","justify-center",2,"min-height","400px","position","relative"],["class","text-center text-gray-400",4,"ngIf"],[2,"max-width","100%","max-height","100%"],[1,"lg:col-span-1"],[1,"bg-white","rounded-lg","border","border-gray-200","shadow-sm","overflow-hidden"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} warehouses","styleClass","p-datatable-striped",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","tableStyle"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-orange-400","mx-auto","mb-4"],[1,"text-sm","text-gray-600","font-medium"],[1,"bg-red-50","border-2","border-red-200","rounded-xl","p-5","mb-6","shadow-sm","mx-6","mt-6"],[1,"w-10","h-10","rounded-full","bg-red-100","flex","items-center","justify-center","flex-shrink-0"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-red-500"],[1,"bg-orange-50","border-2","border-orange-200","rounded-lg","p-8","text-center"],[1,"flex","items-center","justify-center"],[1,"animate-spin","rounded-full","h-8","w-8","border-b-2","border-orange-500","mr-3"],[1,"bg-red-50","border-2","border-red-200","rounded-lg","p-4","text-center"],[1,"text-sm","text-red-600"],[1,"mb-4","space-y-4"],[1,"flex","gap-2"],[1,"px-4","py-2","rounded-lg","text-sm","font-medium","transition-colors",3,"click","ngClass"],["type","checkbox","id","showTimelineAverage",1,"w-4","h-4","text-orange-600","rounded","focus:ring-2","focus:ring-orange-300",3,"ngModelChange","change","ngModel"],["for","showTimelineAverage",1,"text-sm","text-gray-700","cursor-pointer"],[1,"bg-gradient-to-br","from-white","to-orange-50","border-2","border-orange-200","rounded-xl","p-6","shadow-sm","mb-4"],[1,"flex","items-center","justify-center",2,"height","400px","position","relative"],[2,"display","block !important","max-width","100% !important","max-height","100% !important","height","400px !important","width","100% !important"],["class","mt-4 text-center",4,"ngIf"],[1,"mt-4","text-center"],[1,"text-sm","text-gray-500","italic"],[1,"bg-white","border","border-gray-200","rounded-lg","shadow-sm","overflow-hidden"],[1,"bg-orange-50","border-b","border-orange-200","px-4","py-3","flex","items-center","justify-between"],[1,"px-3","py-1","text-xs","bg-orange-100","text-orange-700","rounded","hover:bg-orange-200","transition-colors",3,"click"],[1,"px-3","py-1","text-xs","bg-gray-100","text-gray-700","rounded","hover:bg-gray-200","transition-colors",3,"click"],[1,"overflow-x-auto"],[1,"w-full"],[1,"bg-gray-50","border-b","border-gray-200"],[1,"px-4","py-2","text-left","w-12"],["type","checkbox",1,"w-4","h-4","text-orange-600","border-gray-400","rounded","focus:ring-2","focus:ring-orange-500","cursor-pointer",3,"change","checked"],[1,"px-4","py-2","text-left","text-xs","font-bold","text-gray-700","uppercase"],[1,"px-4","py-2","text-left","text-xs","font-bold","text-gray-700","uppercase","w-24"],[1,"divide-y","divide-gray-200"],["class","hover:bg-orange-50 transition-colors cursor-pointer",3,"click",4,"ngFor","ngForOf"],["class","bg-gray-50 border-t border-gray-200 px-4 py-3 flex items-center justify-between",4,"ngIf"],[1,"hover:bg-orange-50","transition-colors","cursor-pointer",3,"click"],[1,"px-4","py-3",3,"click"],["type","checkbox",1,"w-4","h-4","text-orange-600","rounded","focus:ring-2","focus:ring-orange-300","cursor-pointer",3,"change","checked"],[1,"px-4","py-3","text-sm","text-gray-900","font-medium"],[1,"px-4","py-3","text-xs","text-gray-500"],[1,"bg-gray-50","border-t","border-gray-200","px-4","py-3","flex","items-center","justify-between"],[1,"text-sm","text-gray-700"],[1,"font-semibold"],[1,"px-3","py-1","text-xs","rounded","transition-colors",3,"click","disabled","ngClass"],[1,"mb-6","px-6","pt-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],["class","bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg p-8 text-center mb-8",4,"ngIf"],["class","mb-8",4,"ngIf"],["class","grid grid-cols-1 md:grid-cols-2 gap-6 mt-8",4,"ngIf"],[1,"bg-gray-50","border-2","border-dashed","border-gray-300","rounded-lg","p-8","text-center","mb-8"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-12","w-12","text-gray-400","mb-4"],[1,"text-lg","font-medium","text-gray-900","mb-2"],["class","text-gray-500",4,"ngIf"],[1,"text-gray-500"],[1,"mb-8"],[1,"text-md","font-semibold","text-gray-800","mb-4","flex","items-center","gap-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-orange-600"],[1,"min-w-full","bg-white","border","border-gray-200","rounded-lg"],[1,"bg-gradient-to-r","from-orange-50","to-orange-100"],[1,"px-4","py-3","text-left","text-xs","font-bold","text-orange-800","uppercase","tracking-wider","border-b","border-gray-200"],[1,"px-4","py-3","text-center","text-xs","font-bold","text-orange-800","uppercase","tracking-wider","border-b","border-gray-200"],[1,"px-4","py-3","text-right","text-xs","font-bold","text-orange-800","uppercase","tracking-wider","border-b","border-gray-200"],["class","hover:bg-gray-50",4,"ngIf"],["class","hover:bg-orange-50 transition-colors",4,"ngFor","ngForOf"],[1,"hover:bg-gray-50"],["colspan","4",1,"px-4","py-8","text-center","text-sm","text-gray-500"],[1,"hover:bg-orange-50","transition-colors"],[1,"px-4","py-3","whitespace-nowrap"],[1,"flex","items-center"],[1,"w-8","h-8","rounded-full","bg-orange-100","flex","items-center","justify-center","mr-3"],[1,"text-xs","font-bold","text-orange-700"],[1,"text-sm","font-semibold","text-gray-900"],[1,"px-4","py-3","text-center","whitespace-nowrap"],[1,"inline-flex","items-center","px-3","py-1","rounded-full","text-xs","font-semibold","bg-orange-100","text-orange-700"],[1,"px-4","py-3","text-right","whitespace-nowrap"],[1,"flex","items-center","justify-end","gap-2"],[1,"text-sm","font-semibold","text-orange-800"],[1,"w-24","h-2","bg-gray-200","rounded-full","overflow-hidden"],[1,"h-full","bg-orange-600","rounded-full","transition-all"],[1,"text-sm","font-semibold","text-gray-800"],[1,"h-full","bg-gray-800","rounded-full","transition-all"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6","mt-8"],[1,"bg-gradient-to-br","from-orange-50","to-white","border-2","border-orange-200","rounded-xl","p-6","shadow-sm"],[1,"w-12","h-12","rounded-xl","bg-gradient-to-br","from-orange-500","to-orange-600","flex","items-center","justify-center","shadow-md"],[1,"flex","items-center","justify-center",2,"height","500px","position","relative"],[2,"display","block !important","max-width","100% !important","max-height","100% !important","height","500px !important","width","500px !important"],[1,"bg-gradient-to-br","from-gray-50","to-white","border-2","border-gray-200","rounded-xl","p-6","shadow-sm"],[1,"w-12","h-12","rounded-xl","bg-gradient-to-br","from-gray-600","to-gray-700","flex","items-center","justify-center","shadow-md"],[1,"ml-2","text-gray-600"],[1,"font-bold","text-orange-600"],[1,"bg-red-50","border-2","border-red-200","rounded-xl","p-5","mb-6","shadow-sm"],[1,"bg-gradient-to-r","from-orange-50","to-orange-100","border-2","border-orange-200","rounded-xl","p-6","mb-6","shadow-sm"],[1,"flex","items-start","gap-4"],[1,"w-12","h-12","rounded-full","bg-orange-500","flex","items-center","justify-center","flex-shrink-0","shadow-sm"],[1,"text-orange-800","font-bold","mb-1"],[1,"text-orange-700"],[1,"text-center","text-gray-400"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-16","h-16","mx-auto","mb-2"],[1,"text-sm"],[1,"bg-white","border-b-2","border-orange-200"],[1,"text-left","font-semibold","text-orange-600","py-4","px-6","border-b","border-orange-200"],[1,"flex","items-center","gap-2","hover:text-orange-100","transition-colors","text-white",3,"click"],["class","w-4 h-4 flex-shrink-0","fill","none","stroke","currentColor","viewBox","0 0 24 24","preserveAspectRatio","xMidYMid meet",4,"ngIf"],[1,"text-right","font-semibold","text-orange-600","py-4","px-6","border-b","border-orange-200"],[1,"flex","items-center","justify-end","gap-2","hover:text-orange-700","transition-colors","w-full","text-orange-600",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24","preserveAspectRatio","xMidYMid meet",1,"w-4","h-4","flex-shrink-0"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 15l7-7 7 7",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 15l7-7 7 7"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],[1,"cursor-pointer","transition-colors","border-b","border-gray-100",3,"click","ngClass"],[1,"py-4","px-6"],[1,"text-gray-900","font-medium","text-sm"],[1,"text-right","py-4","px-6","text-gray-700","font-medium"],[1,"text-right","py-4","px-6","text-orange-600","font-medium"],["colspan","5",1,"text-center","py-12"],[1,"flex","flex-col","items-center","gap-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-16","h-16","text-gray-300"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-gray-500","font-medium"],["class","px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors text-sm font-medium",3,"click",4,"ngIf"],[1,"px-4","py-2","bg-orange-500","text-white","rounded-lg","hover:bg-orange-600","transition-colors","text-sm","font-medium",3,"click"],[1,"w-full","h-full","bg-white","rounded-xl","shadow-xl","border-2","border-gray-200","overflow-hidden","flex","flex-col"],[1,"bg-white","border-b-2","border-orange-200","px-6","py-4","flex-shrink-0","flex","items-center","justify-between"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"],[1,"bg-white","hover:bg-gray-50","text-gray-700","border-2","border-gray-200","rounded-lg","px-4","py-2","shadow-sm","flex","items-center","gap-2","transition-all","hover:shadow-md","hover:border-gray-300",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],[1,"text-sm","font-semibold"],[1,"flex-1","overflow-y-auto"],[3,"datasetIdInput","embedded"],[1,"fixed","inset-0","z-[3000]","bg-black/40","backdrop-blur-sm","flex","items-center","justify-center","px-4"],[1,"bg-white","rounded-2xl","shadow-2xl","w-full","max-w-5xl","max-h-[90vh]","overflow-hidden"],[1,"flex","items-center","justify-between","px-6","py-4","border-b-2","border-orange-200","bg-white"],[1,"w-10","h-10","rounded-xl","bg-orange-500","flex","items-center","justify-center","shadow-sm"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5h2m-1-2v4m-7 4h2m-1-2v4m11-2h2m-1-2v4m-7 4h2m-1-2v4M4 4l16 16"],[1,"text-lg","font-bold","text-orange-600"],[1,"p-2","rounded-lg","bg-orange-50","hover:bg-orange-100","text-orange-600","transition","border","border-orange-200",3,"click"],[1,"p-6","overflow-y-auto","max-h-[70vh]","space-y-6"],[1,"bg-gray-50","rounded-xl","border","border-gray-200","p-5"],[1,"flex","items-center","gap-2","mb-4"],[1,"w-9","h-9","rounded-lg","bg-orange-500","flex","items-center","justify-center","shadow-sm"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-white"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"],[1,"text-base","font-bold","text-gray-900"],[1,"space-y-4"],[1,"text-sm","font-semibold","text-gray-700","mb-2","block"],[1,"text-red-500"],[1,"w-full","border-2","border-gray-300","rounded-lg","px-4","py-2.5","text-sm","focus:ring-2","focus:ring-orange-500","focus:border-orange-500","font-medium",3,"ngModelChange","change","ngModel"],["value","","disabled",""],[3,"value",4,"ngFor","ngForOf"],["class","space-y-3",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"],[1,"grid","grid-cols-1","sm:grid-cols-2","gap-4"],["type","date",1,"w-full","border-2","border-gray-300","rounded-lg","px-4","py-2.5","text-sm","focus:ring-2","focus:ring-orange-500","focus:border-orange-500","font-medium",3,"ngModelChange","ngModel"],["class","mt-3 text-sm text-red-600 bg-red-50 border border-red-200 rounded-lg p-3",4,"ngIf"],[1,"space-y-3"],["class","flex items-center gap-3 p-4 bg-white rounded-xl border border-gray-200",4,"ngFor","ngForOf"],[1,"w-full","px-4","py-3","bg-white","border-2","border-dashed","border-gray-300","rounded-xl","hover:border-orange-400","hover:bg-orange-50","text-sm","font-semibold","text-gray-700","transition-all","flex","items-center","justify-center","gap-2",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],[1,"flex","items-center","justify-end","gap-3","px-6","py-4","border-t","border-gray-200","bg-gray-50"],[1,"px-4","py-2","rounded-lg","border","border-gray-300","text-gray-700","hover:bg-gray-100","transition","text-sm","font-semibold",3,"click"],[1,"px-5","py-2","rounded-lg","bg-orange-600","text-white","hover:bg-orange-700","transition","shadow-md","text-sm","font-semibold",3,"click"],[3,"value"],["class","flex items-center justify-center py-8 bg-white rounded-lg border border-gray-200",4,"ngIf"],["class","bg-red-50 border-2 border-red-200 rounded-lg p-4",4,"ngIf"],["class","flex items-center justify-between bg-gradient-to-r from-gray-50 to-gray-50/50 rounded-lg px-4 py-2.5 border-2 border-gray-200",4,"ngIf"],["class","border-2 border-gray-200 rounded-xl overflow-hidden bg-white shadow-sm max-h-[400px] overflow-y-auto",4,"ngIf"],["class","bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",4,"ngIf"],[1,"flex","items-center","justify-center","py-8","bg-white","rounded-lg","border","border-gray-200"],[1,"animate-spin","rounded-full","h-8","w-8","border-3","border-orange-500","border-t-transparent","mx-auto","mb-2"],[1,"text-sm","font-medium","text-gray-600"],[1,"bg-red-50","border-2","border-red-200","rounded-lg","p-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-red-500","flex-shrink-0"],[1,"text-sm","text-red-700"],[1,"flex","items-center","justify-between","bg-gradient-to-r","from-gray-50","to-gray-50/50","rounded-lg","px-4","py-2.5","border-2","border-gray-200"],[1,"text-xs","font-semibold","text-gray-700"],[1,"text-gray-900","font-bold"],[1,"w-px","h-4","bg-gray-300"],[1,"text-xs","font-semibold","text-orange-600"],[1,"text-orange-700","font-bold"],["type","button",1,"px-3","py-1.5","text-xs","font-bold","bg-green-500","hover:bg-green-600","disabled:bg-gray-300","disabled:cursor-not-allowed","text-white","rounded-lg","transition-all","shadow-sm",3,"click","disabled"],["type","button",1,"px-3","py-1.5","text-xs","font-bold","bg-red-500","hover:bg-red-600","disabled:bg-gray-300","disabled:cursor-not-allowed","text-white","rounded-lg","transition-all","shadow-sm",3,"click","disabled"],[1,"border-2","border-gray-200","rounded-xl","overflow-hidden","bg-white","shadow-sm","max-h-[400px]","overflow-y-auto"],[1,"bg-gradient-to-r","from-gray-100","to-gray-50","sticky","top-0","z-10","border-b-2","border-gray-200"],[1,"px-3","py-2.5","text-left","w-12"],[1,"px-3","py-2.5","text-left","text-xs","font-bold","text-gray-700","uppercase","w-12"],[1,"px-3","py-2.5","text-left","text-xs","font-bold","text-gray-700","uppercase"],[1,"px-3","py-2.5","text-left","text-xs","font-bold","text-gray-700","uppercase","w-20"],[1,"divide-y","divide-gray-150"],["class","hover:bg-orange-50/50 transition-colors cursor-pointer border-b border-gray-100",3,"click",4,"ngFor","ngForOf"],[1,"hover:bg-orange-50/50","transition-colors","cursor-pointer","border-b","border-gray-100",3,"click"],[1,"px-3","py-2.5",3,"click"],[1,"px-3","py-2.5","text-sm","font-bold","text-gray-700"],[1,"px-3","py-2.5"],[1,"font-semibold","text-gray-900","text-sm"],[1,"px-3","py-2.5","text-xs","text-gray-500","font-mono"],[1,"bg-gray-50","border-2","border-dashed","border-gray-300","rounded-lg","p-8","text-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-10","w-10","text-gray-400","mb-3"],[1,"text-sm","font-medium","text-gray-500"],[1,"mt-3","text-sm","text-red-600","bg-red-50","border","border-red-200","rounded-lg","p-3"],["class","flex items-center gap-2",4,"ngFor","ngForOf"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","flex-shrink-0"],[1,"flex","items-center","gap-3","p-4","bg-white","rounded-xl","border","border-gray-200"],[1,"w-8","h-8","rounded-full","bg-gradient-to-br","from-orange-400","to-orange-600","text-white","flex","items-center","justify-center","font-bold","text-sm","flex-shrink-0"],["placeholder","Shift Name",1,"border-2","border-gray-300","rounded-lg","px-4","py-2","text-sm","w-36","focus:ring-2","focus:ring-orange-500","focus:border-orange-500","font-medium",3,"ngModelChange","ngModel"],[1,"border-2","border-gray-300","rounded-lg","px-4","py-2","text-sm","focus:ring-2","focus:ring-orange-500","focus:border-orange-500","font-medium",3,"ngModelChange","ngModel"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"text-gray-500","font-semibold"],["title","Delete ca",1,"ml-auto","text-red-500","hover:bg-red-50","px-3","py-2","rounded-lg","transition-colors","font-medium",3,"click"],[3,"ngValue"]],template:function(a,r){1&a&&(e.j41(0,"div",4),e.nrm(1,"app-page-header",5),e.j41(2,"div",6),e.DNE(3,ye,51,22,"div",7),e.j41(4,"div",8),e.DNE(5,Pe,6,5,"div",9)(6,Ht,18,4,"div",10),e.k0s(),e.DNE(7,da,70,8,"div",11),e.k0s()()),2&a&&(e.R7$(3),e.Y8G("ngIf",!r.selectedDatasetId),e.R7$(2),e.Y8G("ngIf",!r.selectedDatasetId),e.R7$(),e.Y8G("ngIf",r.selectedDatasetId),e.R7$(),e.Y8G("ngIf",r.showSettingsModal))},dependencies:[C.MD,C.YU,C.Sq,C.bT,C.B3,C.P9,C.QX,C.vh,j.YN,j.xH,j.y7,j.me,j.Zm,j.wz,j.BC,j.vS,V.KQ,ae.Ei,Y.$C,X.tm,G.Fr,G.X9,z.$$,H.Ph,$.bG,$.XI,L.DatasetDetailComponent,U.y],styles:['.custom-svg-marker[_ngcontent-%COMP%]{background:transparent!important;border:none!important;box-shadow:none!important;cursor:pointer;z-index:1000}.custom-svg-marker[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{filter:drop-shadow(0 4px 12px rgba(0,0,0,.3));transition:all .3s cubic-bezier(.4,0,.2,1)}.custom-svg-marker[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{transform:scale(1.2) translateY(-4px);filter:drop-shadow(0 8px 20px rgba(0,0,0,.4))}.custom-svg-marker.marker-selected[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_markerPulse 2s ease-in-out infinite}@keyframes _ngcontent-%COMP%_markerPulse{0%,to{transform:scale(1);filter:drop-shadow(0 4px 12px rgba(var(--p-primary-500),.5))}50%{transform:scale(1.1);filter:drop-shadow(0 6px 16px rgba(var(--p-primary-500),.8))}}.custom-svg-marker.marker-timeline[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{filter:drop-shadow(0 0 8px var(--p-primary-500)) drop-shadow(0 4px 12px rgba(0,0,0,.3))}.custom-marker[_ngcontent-%COMP%]{background:transparent!important;border:none!important}.custom-marker[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{position:relative}.custom-marker[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:-2px;left:50%;transform:translate(-50%);width:0;height:0;border-left:6px solid transparent;border-right:6px solid transparent;border-top:8px solid var(--p-primary-500);filter:drop-shadow(0 1px 2px rgba(0,0,0,.2))}.fallback-marker[_ngcontent-%COMP%]{background:transparent!important;border:none!important}.fallback-marker[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{border-radius:50%;border:2px solid white;box-shadow:0 2px 4px #0000004d}#warehouseMap[_ngcontent-%COMP%]{min-height:300px}.map-loading[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:100%;background:var(--p-surface-50);border-radius:8px}.map-loading[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:40px;height:40px;border:4px solid var(--p-surface-200);border-top:4px solid var(--p-primary-500);border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}[_nghost-%COMP%]     .leaflet-popup-content-wrapper{border-radius:12px;box-shadow:0 10px 40px #0003;padding:0;overflow:hidden}[_nghost-%COMP%]     .leaflet-popup-content{margin:0;min-width:240px}[_nghost-%COMP%]     .custom-popup-header{background:linear-gradient(135deg,var(--p-primary-500) 0%,var(--p-primary-600) 100%);padding:12px 16px;color:#fff}[_nghost-%COMP%]     .custom-popup-header.hub-type{background:linear-gradient(135deg,var(--p-primary-500) 0%,var(--p-primary-600) 100%)}[_nghost-%COMP%]     .custom-popup-header.sorting-type{background:linear-gradient(135deg,var(--p-primary-500) 0%,var(--p-primary-600) 100%)}[_nghost-%COMP%]     .custom-popup-header.delivery-type{background:linear-gradient(135deg,var(--p-primary-500) 0%,var(--p-primary-600) 100%)}[_nghost-%COMP%]     .custom-popup-header.transit-type{background:linear-gradient(135deg,var(--p-primary-500) 0%,var(--p-primary-600) 100%)}[_nghost-%COMP%]     .custom-popup-badge{display:inline-block;padding:2px 8px;border-radius:12px;font-size:10px;font-weight:600;text-transform:uppercase;background:#ffffff4d;backdrop-filter:blur(10px);margin-bottom:4px}[_nghost-%COMP%]     .custom-popup-title{font-size:14px;font-weight:700;margin:0}[_nghost-%COMP%]     .custom-popup-body{padding:12px 16px;background:#fff}[_nghost-%COMP%]     .custom-popup-info-row{display:flex;align-items:flex-start;gap:8px;margin-bottom:8px;font-size:12px;color:var(--p-surface-600)}[_nghost-%COMP%]     .custom-popup-info-row:last-child{margin-bottom:0}[_nghost-%COMP%]     .custom-popup-icon{font-size:14px;flex-shrink:0;margin-top:2px}[_nghost-%COMP%]     .custom-popup-btn{display:block;width:100%;padding:8px 16px;margin-top:8px;background:linear-gradient(135deg,var(--p-primary-500) 0%,var(--p-primary-600) 100%);color:#fff;border:none;border-radius:6px;font-size:12px;font-weight:600;cursor:pointer;transition:all .2s ease}[_nghost-%COMP%]     .custom-popup-btn:hover{transform:translateY(-1px);box-shadow:0 4px 12px rgba(var(--p-primary-500),.4)}[_nghost-%COMP%]     .leaflet-popup-tip{background:#fff}.relative.z-10[_ngcontent-%COMP%]{position:relative;z-index:10}[_nghost-%COMP%]     *{scrollbar-width:thin;scrollbar-color:rgba(var(--p-primary-500),.3) transparent}[_nghost-%COMP%]     *::-webkit-scrollbar{width:8px;height:8px}[_nghost-%COMP%]     *::-webkit-scrollbar-track{background:transparent;border-radius:4px}[_nghost-%COMP%]     *::-webkit-scrollbar-thumb{background-color:rgba(var(--p-primary-500),.3);border-radius:4px;border:2px solid transparent}[_nghost-%COMP%]     *::-webkit-scrollbar-thumb:hover{background-color:rgba(var(--p-primary-500),.5)}[_nghost-%COMP%]     button, [_nghost-%COMP%]     .cursor-pointer{transition:all .2s ease-in-out}.line-clamp-2[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}[_nghost-%COMP%]     .p-autocomplete .p-autocomplete-input{border:2px solid var(--p-primary-500)!important;border-radius:.5rem!important;padding:.5rem .75rem!important}[_nghost-%COMP%]     .p-autocomplete .p-autocomplete-input:focus{border-color:var(--p-primary-500)!important;box-shadow:0 0 0 3px rgba(var(--p-primary-500),.1)!important;outline:none!important}'],changeDetection:0})}return i})()}}]);