<div class="flex flex-col h-full bg-white dark:bg-gray-900 border-r border-gray-200 dark:border-gray-700">
  <!-- Header -->
  <div class="flex header items-center px-4 py-3 border-b border-gray-200 dark:border-gray-700 shrink-0 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20"
       [class.justify-center]="collapsed"
       [class.justify-between]="!collapsed">
    <div class="flex items-center gap-2" [class.justify-center]="collapsed">
      <div class="logo-container w-8 h-8 bg-gradient-to-br from-blue-500 via-purple-500 to-indigo-600 rounded-lg flex items-center justify-center shadow-lg">
        <i class="pi pi-sitemap text-white text-sm"></i>
      </div>
      <span class="text-lg font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent" [class.hidden]="collapsed">
        Data Management
      </span>
    </div>
    <button 
      class="lg:hidden p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors"
      [class.hidden]="collapsed"
      (click)="toggle.emit()">
      <i class="pi pi-times text-gray-600 dark:text-gray-300"></i>
    </button>
  </div>

  <!-- Navigation Menu -->
  <div class="overflow-y-auto flex-1 py-2 sidebar-nav" [class.collapsed]="collapsed" [class.expanded]="!collapsed">
    <ul class="list-none p-0 m-0 space-y-0.5">
  <!-- Top quick links (only shown for 'all' workspace) -->
  <ng-container *ngIf="appKey === 'all'">
        <!-- Dashboard & Overview -->
        <li class="menu-item">
          <a [routerLink]="'/dashboard'" class="flex items-center gap-3 p-3 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900 transition-all duration-200 group"
             [class.justify-center]="collapsed"
             [class.px-2]="collapsed">
            <i class="pi pi-home text-lg flex-shrink-0"></i>
            <span class="font-medium text-sm whitespace-nowrap transition-opacity duration-200"
                  [class.opacity-0]="collapsed"
                  [class.invisible]="collapsed"
                  [class.hidden]="collapsed">Dashboard</span>
          </a>
        </li>
        <!-- Retail Services -->
        <li class="menu-item">
          <a [routerLink]="'/retail'" class="flex items-center gap-3 p-3 rounded-lg hover:bg-orange-50 dark:hover:bg-orange-900 transition-all duration-200 group"
             [class.justify-center]="collapsed"
             [class.px-2]="collapsed">
            <i class="pi pi-shopping-bag text-lg flex-shrink-0"></i>
            <span class="font-medium text-sm whitespace-nowrap transition-opacity duration-200"
                  [class.opacity-0]="collapsed"
                  [class.invisible]="collapsed"
                  [class.hidden]="collapsed">Retail Overview</span>
          </a>
        </li>
      </ng-container>
  <!-- Accordion Menu Groups -->
  <li *ngFor="let group of visibleGroups; trackBy: trackByGroup" class="menu-group">
        <div class="flex items-center justify-between cursor-pointer p-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-all duration-200 group menu-group-header"
             [class.justify-center]="collapsed"
             [class.px-2]="collapsed"
             (click)="group.label !== 'Governance' && (group.expanded = !group.expanded)">
          <div class="flex items-center gap-3 min-w-0">
            <i [ngClass]="group.icon + ' text-lg flex-shrink-0'"></i>
            <span class="font-medium text-sm whitespace-nowrap transition-all duration-200"
                  [class.hidden]="collapsed"
                  [class.w-0]="collapsed"
                  [class.overflow-hidden]="collapsed">{{ group.label }}</span>
          </div>
          <i class="pi pi-chevron-down text-sm flex-shrink-0 transition-all duration-200"
             [class.rotate-180]="group.expanded"
             [class.hidden]="collapsed || group.label === 'Governance'"
             [class.w-0]="collapsed || group.label === 'Governance'"
             [class.overflow-hidden]="collapsed || group.label === 'Governance'"></i>
        </div>
        <!-- Submenu chỉ hiển thị khi không collapsed hoặc là Governance group -->
        <div *ngIf="(group.expanded || group.label === 'Governance') && !collapsed" class="submenu-container ml-2 pl-4 border-l-2 border-gray-200 dark:border-gray-700">
          <div *ngFor="let item of group.items" class="submenu-item">
            <!-- Subgroup with children -->
            <div *ngIf="item.children" class="subgroup mb-2">
              <div class="flex items-center gap-2 p-2 text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wide subgroup-header">
                <i [ngClass]="item.icon + ' text-sm flex-shrink-0'"></i>
                <span class="whitespace-nowrap">{{ item.label }}</span>
              </div>
              <div class="subgroup-children ml-2 pl-2 border-l border-gray-300 dark:border-gray-600">
                <a *ngFor="let subItem of item.children"
                   [routerLink]="subItem.url"
                   class="flex items-center gap-2 p-2 rounded hover:bg-blue-50 dark:hover:bg-blue-900 transition-all duration-200 text-sm group/subitem">
                  <i [ngClass]="subItem.icon + ' text-base flex-shrink-0'"></i>
                  <span class="whitespace-nowrap">{{ subItem.label }}</span>
                </a>
              </div>
            </div>
            <!-- Direct item -->
            <a *ngIf="!item.children"
               [routerLink]="item.url"
               class="flex items-center gap-2 p-2 rounded hover:bg-blue-50 dark:hover:bg-blue-900 transition-all duration-200 text-sm group/direct-item">
              <i [ngClass]="item.icon + ' text-base flex-shrink-0'"></i>
              <span class="whitespace-nowrap">{{ item.label }}</span>
            </a>
          </div>
        </div>
      </li>
    </ul>
  </div>
</div>

<!-- Info Dialog -->
<p-dialog 
  header="{{ selectedInfo?.title }}" 
  [(visible)]="infoDialogVisible" 
  [modal]="true" 
  [style]="{ width: '600px' }"
  [draggable]="false" 
  [resizable]="false"
  styleClass="info-dialog">
  
  <div *ngIf="selectedInfo" class="info-content">
    <!-- Description -->
    <div class="mb-4">
      <p class="text-gray-700 dark:text-gray-300 leading-relaxed">
        {{ selectedInfo.description }}
      </p>
    </div>

    <!-- Features -->
    <div class="mb-4">
      <h4 class="text-lg font-semibold text-gray-900 dark:text-white mb-2">
        <i class="pi pi-star text-blue-500 mr-2"></i>
        Key Features
      </h4>
      <ul class="space-y-2">
        <li *ngFor="let feature of selectedInfo.features" class="flex items-start gap-2">
          <i class="pi pi-check text-green-500 mt-0.5 text-sm"></i>
          <span class="text-gray-700 dark:text-gray-300 text-sm">{{ feature }}</span>
        </li>
      </ul>
    </div>

    <p-divider></p-divider>

    <!-- Usage -->
    <div class="mb-4">
      <h4 class="text-lg font-semibold text-gray-900 dark:text-white mb-2">
        <i class="pi pi-info-circle text-blue-500 mr-2"></i>
        How to Use
      </h4>
      <p class="text-gray-700 dark:text-gray-300 leading-relaxed">
        {{ selectedInfo.usage }}
      </p>
    </div>

    <!-- Tips -->
    <div *ngIf="selectedInfo.tips && selectedInfo.tips.length > 0" class="mb-4">
      <h4 class="text-lg font-semibold text-gray-900 dark:text-white mb-2">
        <i class="pi pi-lightbulb text-yellow-500 mr-2"></i>
        Pro Tips
      </h4>
      <ul class="space-y-2">
        <li *ngFor="let tip of selectedInfo.tips" class="flex items-start gap-2">
          <i class="pi pi-angle-right text-blue-500 mt-0.5 text-sm"></i>
          <span class="text-gray-700 dark:text-gray-300 text-sm">{{ tip }}</span>
        </li>
      </ul>
    </div>
  </div>

  <ng-template pTemplate="footer">
    <div class="flex justify-end gap-2">
      <button 
        pButton 
        pRipple 
        label="Got it!" 
        icon="pi pi-check"
        class="p-button-primary"
        (click)="hideInfo()">
      </button>
    </div>
  </ng-template>
</p-dialog>