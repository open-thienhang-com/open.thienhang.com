<!-- Sidebar Tree Component: Domain/Group/Type Navigation -->
<div class="bg-white dark:bg-gray-800 p-3 rounded-lg shadow h-full sticky top-6 z-10 flex flex-col gap-2 min-w-[180px] max-w-[220px]">
  <h2 class="text-base font-semibold text-gray-800 dark:text-gray-200 mb-1">Domains & Types</h2>
  <input type="text" pInputText class="w-full mb-1" placeholder="Filter..." [(ngModel)]="typeFilterQuery">
  <ul class="space-y-1 max-h-56 overflow-y-auto">
    <li class="flex items-center gap-2 cursor-pointer py-1 px-2 rounded hover:bg-green-50 dark:hover:bg-green-900 transition"
        (click)="selectGroup('marketplace'); selectSubGroup(null)"
        [ngClass]="{'bg-green-100 dark:bg-green-900': selectedGroup === 'marketplace'}">
      <i class="pi pi-shopping-cart text-lg text-green-600"></i>
      <span class="font-semibold text-sm">Marketplace</span>
    </li>
    <li class="flex items-center gap-2 cursor-pointer py-1 px-2 rounded hover:bg-purple-50 dark:hover:bg-purple-900 transition"
        (click)="selectGroup('discovery'); selectSubGroup(null)"
        [ngClass]="{'bg-purple-100 dark:bg-purple-900': selectedGroup === 'discovery'}">
      <i class="pi pi-search text-lg text-purple-600"></i>
      <span class="font-semibold text-sm">Data Discovery</span>
    </li>
    <li class="flex items-center gap-2 cursor-pointer py-1 px-2 rounded hover:bg-blue-50 dark:hover:bg-blue-900 transition"
        [ngClass]="{'bg-blue-100 dark:bg-blue-900': !selectedGroup && !selectedSubGroup}"
        (click)="selectGroup(null); selectSubGroup(null)">
      <i class="pi pi-list text-lg text-gray-400"></i>
      <span class="font-semibold text-sm">All</span>
      <span class="ml-auto text-xs px-2 py-1 rounded bg-gray-100 dark:bg-gray-900/30 text-gray-700 dark:text-gray-300">{{ dataSources.length }}</span>
    </li>
    <li class="flex items-center gap-2 cursor-pointer py-1 px-2 rounded hover:bg-blue-50 dark:hover:bg-blue-900 transition"
        (click)="selectGroup('database'); selectSubGroup(null)"
        [ngClass]="{'bg-blue-100 dark:bg-blue-900': selectedGroup === 'database'}">
      <i class="pi pi-database text-lg text-blue-600"></i>
      <span class="font-semibold text-sm">Database</span>
    </li>
    <li class="flex items-center gap-2 cursor-pointer py-1 px-2 rounded hover:bg-green-50 dark:hover:bg-green-900 transition"
        (click)="selectGroup('pipeline'); selectSubGroup(null)"
        [ngClass]="{'bg-green-100 dark:bg-green-900': selectedGroup === 'pipeline'}">
      <i class="pi pi-directions text-lg text-green-600"></i>
      <span class="font-semibold text-sm">Pipelines</span>
    </li>
    <li class="flex items-center gap-2 cursor-pointer py-1 px-2 rounded hover:bg-orange-50 dark:hover:bg-orange-900 transition"
        (click)="selectGroup('topic'); selectSubGroup(null)"
        [ngClass]="{'bg-orange-100 dark:bg-orange-900': selectedGroup === 'topic'}">
      <i class="pi pi-telegram text-lg text-orange-600"></i>
      <span class="font-semibold text-sm">Topics</span>
    </li>
    <li class="flex items-center gap-2 cursor-pointer py-1 px-2 rounded hover:bg-purple-50 dark:hover:bg-purple-900 transition"
        (click)="selectGroup('mlmodel'); selectSubGroup(null)"
        [ngClass]="{'bg-purple-100 dark:bg-purple-900': selectedGroup === 'mlmodel'}">
      <i class="pi pi-chart-line text-lg text-purple-600"></i>
      <span class="font-semibold text-sm">ML Models</span>
    </li>
    <li class="flex items-center gap-2 cursor-pointer py-1 px-2 rounded hover:bg-yellow-50 dark:hover:bg-yellow-900 transition"
        (click)="selectGroup('container'); selectSubGroup(null)"
        [ngClass]="{'bg-yellow-100 dark:bg-yellow-900': selectedGroup === 'container'}">
      <i class="pi pi-box text-lg text-yellow-600"></i>
      <span class="font-semibold text-sm">Container</span>
    </li>
    <li class="flex items-center gap-2 cursor-pointer py-1 px-2 rounded hover:bg-indigo-50 dark:hover:bg-indigo-900 transition"
        (click)="selectGroup('api'); selectSubGroup(null)"
        [ngClass]="{'bg-indigo-100 dark:bg-indigo-900': selectedGroup === 'api'}">
      <i class="pi pi-globe text-lg text-indigo-600"></i>
      <span class="font-semibold text-sm">APIs</span>
    </li>
    <li class="flex items-center gap-2 cursor-pointer py-1 px-2 rounded hover:bg-red-50 dark:hover:bg-red-900 transition"
        (click)="selectGroup('search'); selectSubGroup(null)"
        [ngClass]="{'bg-red-100 dark:bg-red-900': selectedGroup === 'search'}">
      <i class="pi pi-search text-lg text-red-600"></i>
      <span class="font-semibold text-sm">Search</span>
    </li>
    <li *ngFor="let group of assetGroups | filterType:typeFilterQuery" class="flex flex-col">
      <div class="flex items-center gap-2 cursor-pointer py-1 px-2 rounded hover:bg-blue-50 dark:hover:bg-blue-900 transition"
           [ngClass]="{'bg-blue-100 dark:bg-blue-900': selectedGroup === group.name}"
           (click)="selectGroup(group.name); selectSubGroup(null)">
        <i [ngClass]="group.icon" class="text-lg"></i>
        <span class="font-semibold text-sm">{{ group.label }}</span>
        <span class="ml-auto text-xs px-2 py-1 rounded bg-gray-100 dark:bg-gray-900/30 text-gray-700 dark:text-gray-300">{{ group.count }}</span>
        <span *ngIf="group.status" class="ml-2 text-xs px-2 py-1 rounded"
          [ngClass]="{
            'bg-green-100 text-green-700': group.status==='online',
            'bg-yellow-100 text-yellow-700': group.status==='warning',
            'bg-red-100 text-red-700': group.status==='offline'
          }">
          <i class="pi pi-circle-on text-xs"></i> {{ group.status }}
        </span>
      </div>
      <div *ngIf="group.owner || group.health || group.description" class="ml-7 mb-1 text-xs text-gray-500 dark:text-gray-400 flex flex-col gap-1">
        <span *ngIf="group.owner"><i class="pi pi-user mr-1"></i>Owner: {{ group.owner }}</span>
        <span *ngIf="group.health"><i class="pi pi-heart mr-1"></i>Health: {{ group.health }}%</span>
        <span *ngIf="group.description">{{ group.description }}</span>
      </div>
      <div *ngIf="group.expanded" class="ml-7 mt-1 flex flex-wrap gap-1">
        <button pButton class="p-button-xs p-button-text" icon="pi pi-list" label="Catalog" (click)="$event.stopPropagation(); selectGroup(group.name); selectSubGroup('catalog')"></button>
        <button pButton class="p-button-xs p-button-text" icon="pi pi-search" label="Discovery" (click)="$event.stopPropagation(); selectGroup(group.name); selectSubGroup('discovery')"></button>
        <button pButton class="p-button-xs p-button-text" icon="pi pi-database" label="Assets" (click)="$event.stopPropagation(); selectGroup(group.name); selectSubGroup('assets')"></button>
        <button pButton class="p-button-xs p-button-text" icon="pi pi-share-alt" label="Lineage" (click)="$event.stopPropagation(); selectGroup(group.name); selectSubGroup('lineage')"></button>
        <button pButton class="p-button-xs p-button-text" icon="pi pi-lock" label="Policies" (click)="$event.stopPropagation(); selectGroup(group.name); selectSubGroup('policies')"></button>
        <button pButton class="p-button-xs p-button-text" icon="pi pi-chart-line" label="Monitoring" (click)="$event.stopPropagation(); selectGroup(group.name); selectSubGroup('monitoring')"></button>
      </div>
      <ul *ngIf="group.expanded && group.children?.length" class="ml-5 mt-1 space-y-1">
        <li *ngFor="let child of group.children" class="flex items-center gap-2 cursor-pointer py-1 px-2 rounded hover:bg-blue-50 dark:hover:bg-blue-900 transition"
            [ngClass]="{'bg-blue-200 dark:bg-blue-900': selectedSubGroup === child.name}"
            (click)="selectSubGroup(child.name)">
          <i [ngClass]="child.icon" class="text-base"></i>
          <span class="text-sm">{{ child.label }}</span>
          <span class="ml-auto text-xs px-2 py-1 rounded bg-gray-100 dark:bg-gray-900/30 text-gray-700 dark:text-gray-300">{{ child.count }}</span>
          <span *ngIf="child.status" class="ml-2 text-xs px-2 py-1 rounded"
            [ngClass]="{
              'bg-green-100 text-green-700': child.status==='online',
              'bg-yellow-100 text-yellow-700': child.status==='warning',
              'bg-red-100 text-red-700': child.status==='offline'
            }">
            <i class="pi pi-circle-on text-xs"></i> {{ child.status }}
          </span>
        </li>
        <div *ngIf="child.owner || child.health || child.description" class="ml-7 mb-1 text-xs text-gray-500 dark:text-gray-400 flex flex-col gap-1">
          <span *ngIf="child.owner"><i class="pi pi-user mr-1"></i>Owner: {{ child.owner }}</span>
          <span *ngIf="child.health"><i class="pi pi-heart mr-1"></i>Health: {{ child.health }}%</span>
          <span *ngIf="child.description">{{ child.description }}</span>
        </div>
      </ul>
    </li>
  </ul>
  <div class="flex justify-center mt-1">
    <p-paginator [rows]="8" [totalRecords]="(assetGroups | filterType:typeFilterQuery).length" [(first)]="typePageFirst" styleClass="p-paginator-sm"></p-paginator>
  </div>
  <!-- Bulk actions, mobile toggle, etc. có thể bổ sung thêm ở đây -->
</div>
