<p-dialog 
  [(visible)]="visible" 
  [modal]="true" 
  [style]="{ width: '90vw', maxWidth: '800px' }"
  [closable]="!loading"
  [draggable]="false"
  [resizable]="false"
  class="asset-dialog">
  
  <ng-template #header>
    <div class="inline-flex items-center justify-center gap-2">
      <div class="w-8 h-8 bg-gradient-to-br from-green-500 to-emerald-600 rounded-lg flex items-center justify-center">
        <i class="pi pi-database text-white text-sm"></i>
      </div>
      <span class="font-bold whitespace-nowrap text-lg">{{ title }}</span>
    </div>
  </ng-template>

  <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">
    <!-- Asset Name -->
    <div class="md:col-span-1">
      <p-floatlabel>
        <input 
          class="w-full" 
          pInputText 
          id="name" 
          [(ngModel)]="asset.name" 
          autocomplete="off"
          [class.p-invalid]="formErrors.name"
          [disabled]="loading" />
        <label for="name">Asset Name *</label>
      </p-floatlabel>
      <small class="p-error" *ngIf="formErrors.name">{{ formErrors.name }}</small>
    </div>

    <!-- Asset Type -->
    <div class="md:col-span-1">
      <p-floatlabel>
        <p-dropdown 
          id="type"
          [(ngModel)]="asset.type"
          [options]="typeOptions"
          optionLabel="label"
          optionValue="value"
          placeholder="Select Type"
          [class.p-invalid]="formErrors.type"
          [disabled]="loading"
          class="w-full">
        </p-dropdown>
        <label for="type">Asset Type *</label>
      </p-floatlabel>
      <small class="p-error" *ngIf="formErrors.type">{{ formErrors.type }}</small>
    </div>

    <!-- Source -->
    <div class="md:col-span-1">
      <p-floatlabel>
        <input 
          class="w-full" 
          pInputText 
          id="source" 
          [(ngModel)]="asset.source" 
          autocomplete="off"
          [disabled]="loading" />
        <label for="source">Source System</label>
      </p-floatlabel>
    </div>

    <!-- Location -->
    <div class="md:col-span-1">
      <p-floatlabel>
        <input 
          class="w-full" 
          pInputText 
          id="location" 
          [(ngModel)]="asset.location" 
          autocomplete="off"
          [disabled]="loading" />
        <label for="location">Location</label>
      </p-floatlabel>
    </div>

    <!-- Owner -->
    <div class="md:col-span-1">
      <p-floatlabel>
        <input 
          class="w-full" 
          pInputText 
          id="owner" 
          [(ngModel)]="asset.owner" 
          autocomplete="off"
          [disabled]="loading" />
        <label for="owner">Owner</label>
      </p-floatlabel>
    </div>

    <!-- Sensitivity -->
    <div class="md:col-span-1">
      <p-floatlabel>
        <p-dropdown 
          id="sensitivity"
          [(ngModel)]="asset.sensitivity"
          [options]="sensitivityOptions"
          optionLabel="label"
          optionValue="value"
          placeholder="Select Sensitivity"
          [class.p-invalid]="formErrors.sensitivity"
          [disabled]="loading"
          class="w-full">
        </p-dropdown>
        <label for="sensitivity">Sensitivity Level *</label>
      </p-floatlabel>
      <small class="p-error" *ngIf="formErrors.sensitivity">{{ formErrors.sensitivity }}</small>
    </div>

    <!-- Status -->
    <div class="md:col-span-1">
      <p-floatlabel>
        <p-dropdown 
          id="status"
          [(ngModel)]="asset.status"
          [options]="statusOptions"
          optionLabel="label"
          optionValue="value"
          placeholder="Select Status"
          [disabled]="loading"
          class="w-full">
        </p-dropdown>
        <label for="status">Status</label>
      </p-floatlabel>
    </div>

    <!-- Category -->
    <div class="md:col-span-1">
      <p-floatlabel>
        <p-dropdown 
          id="category"
          [(ngModel)]="asset.category"
          [options]="categoryOptions"
          optionLabel="label"
          optionValue="value"
          placeholder="Select Category"
          [disabled]="loading"
          class="w-full">
        </p-dropdown>
        <label for="category">Category</label>
      </p-floatlabel>
    </div>

    <!-- Tags -->
    <div class="md:col-span-2">
      <p-floatlabel>
        <p-chips 
          id="tags"
          [(ngModel)]="asset.tags"
          placeholder="Add tags..."
          [disabled]="loading"
          class="w-full">
        </p-chips>
        <label for="tags">Tags</label>
      </p-floatlabel>
    </div>

    <!-- Description -->
    <div class="md:col-span-2">
      <p-floatlabel>
        <textarea 
          pTextarea 
          id="description" 
          [(ngModel)]="asset.description" 
          rows="4" 
          cols="30" 
          style="resize: vertical" 
          class="w-full"
          [disabled]="loading"></textarea>
        <label for="description">Description</label>
      </p-floatlabel>
    </div>
  </div>

  <ng-template #footer>
    <div class="flex justify-end gap-3">
      <p-button 
        label="Cancel" 
        [text]="true" 
        severity="secondary" 
        (click)="cancel()"
        [disabled]="loading" />
      <p-button 
        [label]="isEditMode ? 'Update' : 'Create'" 
        [icon]="loading ? 'pi pi-spin pi-spinner' : (isEditMode ? 'pi pi-check' : 'pi pi-plus')"
        severity="primary" 
        (click)="save()"
        [disabled]="loading" />
    </div>
  </ng-template>
</p-dialog>
