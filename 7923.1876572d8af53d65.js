"use strict";(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[7923],{935:(te,$,m)=>{m.d($,{$C:()=>O,vw:()=>A});var I=m(2881),e=m(1360),j=m(5779),F=m(3491),X=m(6263);const L=["icon"],z=["*"];function N(g,B){if(1&g&&e.nrm(0,"span",4),2&g){const f=e.XpG(2);e.Y8G("ngClass",f.icon)}}function H(g,B){if(1&g&&(e.qex(0),e.DNE(1,N,1,1,"span",3),e.bVm()),2&g){const f=e.XpG();e.R7$(),e.Y8G("ngIf",f.icon)}}function K(g,B){}function W(g,B){1&g&&e.DNE(0,K,0,0,"ng-template")}function V(g,B){if(1&g&&(e.j41(0,"span",5),e.DNE(1,W,1,0,null,6),e.k0s()),2&g){const f=e.XpG();e.R7$(),e.Y8G("ngTemplateOutlet",f.iconTemplate||f._iconTemplate)}}const U=({dt:g})=>`\n.p-tag {\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n    background: ${g("tag.primary.background")};\n    color: ${g("tag.primary.color")};\n    font-size: ${g("tag.font.size")};\n    font-weight: ${g("tag.font.weight")};\n    padding: ${g("tag.padding")};\n    border-radius: ${g("tag.border.radius")};\n    gap: ${g("tag.gap")};\n}\n\n.p-tag-icon {\n    font-size: ${g("tag.icon.size")};\n    width: ${g("tag.icon.size")};\n    height:${g("tag.icon.size")};\n}\n\n.p-tag-rounded {\n    border-radius: ${g("tag.rounded.border.radius")};\n}\n\n.p-tag-success {\n    background: ${g("tag.success.background")};\n    color: ${g("tag.success.color")};\n}\n\n.p-tag-info {\n    background: ${g("tag.info.background")};\n    color: ${g("tag.info.color")};\n}\n\n.p-tag-warn {\n    background: ${g("tag.warn.background")};\n    color: ${g("tag.warn.color")};\n}\n\n.p-tag-danger {\n    background: ${g("tag.danger.background")};\n    color: ${g("tag.danger.color")};\n}\n\n.p-tag-secondary {\n    background: ${g("tag.secondary.background")};\n    color: ${g("tag.secondary.color")};\n}\n\n.p-tag-contrast {\n    background: ${g("tag.contrast.background")};\n    color: ${g("tag.contrast.color")};\n}\n`,q={root:({props:g})=>["p-tag p-component",{"p-tag-info":"info"===g.severity,"p-tag-success":"success"===g.severity,"p-tag-warn":"warn"===g.severity,"p-tag-danger":"danger"===g.severity,"p-tag-secondary":"secondary"===g.severity,"p-tag-contrast":"contrast"===g.severity,"p-tag-rounded":g.rounded}],icon:"p-tag-icon",label:"p-tag-label"};let M=(()=>{class g extends X.j{name="tag";theme=U;classes=q;static \u0275fac=(()=>{let f;return function(k){return(f||(f=e.xGo(g)))(k||g)}})();static \u0275prov=e.jDH({token:g,factory:g.\u0275fac})}return g})(),A=(()=>{class g extends F.${get style(){return this._style}set style(f){this._style=f,this.cd.markForCheck()}styleClass;severity;value;icon;rounded;iconTemplate;templates;_iconTemplate;_style;_componentStyle=(0,e.WQX)(M);ngAfterContentInit(){this.templates?.forEach(f=>{"icon"===f.getType()&&(this._iconTemplate=f.template)})}containerClass(){let f="p-tag p-component";return this.severity&&(f+=` p-tag-${this.severity}`),this.rounded&&(f+=" p-tag-rounded"),this.styleClass&&(f+=` ${this.styleClass}`),f}static \u0275fac=(()=>{let f;return function(k){return(f||(f=e.xGo(g)))(k||g)}})();static \u0275cmp=e.VBU({type:g,selectors:[["p-tag"]],contentQueries:function(E,k,Y){if(1&E&&(e.wni(Y,L,4),e.wni(Y,j.Ei,4)),2&E){let G;e.mGM(G=e.lsd())&&(k.iconTemplate=G.first),e.mGM(G=e.lsd())&&(k.templates=G)}},hostVars:4,hostBindings:function(E,k){2&E&&(e.Aen(k.style),e.HbH(k.containerClass()))},inputs:{style:"style",styleClass:"styleClass",severity:"severity",value:"value",icon:"icon",rounded:[2,"rounded","rounded",e.L39]},features:[e.Jv_([M]),e.Vt3],ngContentSelectors:z,decls:5,vars:3,consts:[[4,"ngIf"],["class","p-tag-icon",4,"ngIf"],[1,"p-tag-label"],["class","p-tag-icon",3,"ngClass",4,"ngIf"],[1,"p-tag-icon",3,"ngClass"],[1,"p-tag-icon"],[4,"ngTemplateOutlet"]],template:function(E,k){1&E&&(e.NAR(),e.SdG(0),e.DNE(1,H,2,1,"ng-container",0)(2,V,2,1,"span",1),e.j41(3,"span",2),e.EFF(4),e.k0s()),2&E&&(e.R7$(),e.Y8G("ngIf",!k.iconTemplate&&!k._iconTemplate),e.R7$(),e.Y8G("ngIf",k.iconTemplate||k._iconTemplate),e.R7$(2),e.JRh(k.value))},dependencies:[I.MD,I.YU,I.bT,I.T3,j.Gg],encapsulation:2,changeDetection:0})}return g})(),O=(()=>{class g{static \u0275fac=function(E){return new(E||g)};static \u0275mod=e.$C({type:g});static \u0275inj=e.G2t({imports:[A,j.Gg,j.Gg]})}return g})()},7923:(te,$,m)=>{m.r($),m.d($,{DatasetComponent:()=>Qt});var I=m(467),e=m(1360),j=m(2881),F=m(9417),X=m(6502),L=m(935),z=m(1141),N=m(8559),H=m(8537),K=m(1570),W=m(3792),V=m(6221),U=m(4381),q=m(1823),M=m(1413),P=m(152),A=m(3294),O=m(7673),g=m(5558),B=m(6354),f=m(9437),E=m(8512),k=m(1910),Y=m(5779);const G=["demandSummaryCanvas"],ae=["demandPickupTimeCanvas"],re=["demandDeliveryTimeCanvas"],ie=["demandTimelineAreaCanvas"],oe=(i,n)=>({"border-orange-300 bg-orange-50/50 ring-1 ring-orange-200":i,"hover:border-orange-200 hover:bg-gray-50":n}),ne=()=>["demand","truck","trip","hub"],se=(i,n,t,r,a)=>({"bg-orange-100 text-orange-700":i,"bg-blue-100 text-blue-700":n,"bg-green-100 text-green-700":t,"bg-purple-100 text-purple-700":r,"bg-gray-100 text-gray-700":a}),Q=(i,n)=>({"bg-orange-500 text-white shadow-sm":i,"text-gray-600 hover:bg-gray-200":n}),de=i=>({"min-width":i}),le=()=>[5,10,25,50],he=()=>({"min-width":"100%"}),Z=(i,n)=>({"bg-orange-600 text-white":i,"bg-gray-200 text-gray-700 hover:bg-gray-300":n}),ee=(i,n)=>({"bg-orange-100 text-orange-700 hover:bg-orange-200 cursor-pointer":i,"bg-gray-100 text-gray-400 cursor-not-allowed":n}),ce=(i,n)=>({"bg-orange-50":i,"hover:bg-gray-50":n});function ge(i,n){1&i&&(e.j41(0,"div",16)(1,"div",17),e.nrm(2,"div",18),e.j41(3,"span",19),e.EFF(4,"\u0110ang t\u1ea3i datasets..."),e.k0s()()())}function ue(i,n){if(1&i&&(e.j41(0,"div",20)(1,"div",21),e.qSk(),e.j41(2,"svg",22),e.nrm(3,"path",23),e.k0s(),e.joV(),e.j41(4,"div")(5,"h4",24),e.EFF(6,"L\u1ed7i t\u1ea3i d\u1eef li\u1ec7u"),e.k0s(),e.j41(7,"span",25),e.EFF(8),e.k0s()()()()),2&i){const t=e.XpG(2);e.R7$(8),e.JRh(t.error)}}function me(i,n){1&i&&(e.qSk(),e.j41(0,"svg",42),e.nrm(1,"path",43),e.k0s())}function pe(i,n){1&i&&(e.qSk(),e.j41(0,"svg",42),e.nrm(1,"path",44),e.k0s())}function _e(i,n){1&i&&(e.qSk(),e.j41(0,"svg",42),e.nrm(1,"path",45),e.k0s())}function fe(i,n){1&i&&(e.qSk(),e.j41(0,"svg",42),e.nrm(1,"path",46),e.k0s())}function ve(i,n){1&i&&(e.qSk(),e.j41(0,"svg",42),e.nrm(1,"path",47),e.k0s())}function be(i,n){if(1&i&&(e.j41(0,"p",48),e.EFF(1),e.k0s()),2&i){const t=e.XpG().$implicit;e.R7$(),e.JRh(t.description)}}function xe(i,n){if(1&i&&(e.j41(0,"div",38)(1,"span",39),e.EFF(2,"Ng\xe0y t\u1ea1o:"),e.k0s(),e.j41(3,"span",49),e.EFF(4),e.nI1(5,"date"),e.k0s()()),2&i){const t=e.XpG().$implicit;e.R7$(4),e.JRh(e.i5U(5,1,t.created_at,"short"))}}function ye(i,n){if(1&i){const t=e.RV6();e.j41(0,"button",28),e.bIt("click",function(){const a=e.eBV(t).$implicit,o=e.XpG(3);return e.Njj(o.viewDataset(a))}),e.j41(1,"div",29)(2,"div",30),e.DNE(3,me,2,0,"svg",31)(4,pe,2,0,"svg",31)(5,_e,2,0,"svg",31)(6,fe,2,0,"svg",31)(7,ve,2,0,"svg",31),e.k0s(),e.j41(8,"div",32)(9,"h4",33),e.EFF(10),e.k0s(),e.j41(11,"p",34)(12,"span",35),e.EFF(13),e.k0s()()()(),e.DNE(14,be,2,1,"p",36),e.j41(15,"div",37)(16,"div",38)(17,"span",39),e.EFF(18,"B\u1ea3n ghi:"),e.k0s(),e.j41(19,"span",40),e.EFF(20),e.nI1(21,"number"),e.k0s()(),e.DNE(22,xe,6,4,"div",41),e.k0s()()}if(2&i){const t=n.$implicit,r=e.XpG(3);e.Y8G("ngClass",e.l_i(16,oe,r.selectedDatasetId===t.id,r.selectedDatasetId!==t.id)),e.R7$(2),e.xc7("background","demand"===t.type?"linear-gradient(to bottom right, #fb923c, #ea580c)":"truck"===t.type?"linear-gradient(to bottom right, #60a5fa, #3b82f6)":"trip"===t.type?"linear-gradient(to bottom right, #4ade80, #22c55e)":"hub"===t.type?"linear-gradient(to bottom right, #a78bfa, #8b5cf6)":"linear-gradient(to bottom right, #6b7280, #374151)"),e.R7$(),e.Y8G("ngIf","truck"===t.type),e.R7$(),e.Y8G("ngIf","demand"===t.type),e.R7$(),e.Y8G("ngIf","trip"===t.type),e.R7$(),e.Y8G("ngIf","hub"===t.type),e.R7$(),e.Y8G("ngIf",!t.type||"truck"!==t.type&&"demand"!==t.type&&"trip"!==t.type&&"hub"!==t.type),e.R7$(3),e.JRh(t.name||"Unnamed Dataset"),e.R7$(2),e.Y8G("ngClass",e.s1E(20,se,"demand"===t.type,"truck"===t.type,"trip"===t.type,"hub"===t.type,!e.lJ4(19,ne).includes(t.type||""))),e.R7$(),e.SpI(" ",t.type||"unknown"," "),e.R7$(),e.Y8G("ngIf",t.description),e.R7$(6),e.JRh(e.bMT(21,14,t.records||0)),e.R7$(2),e.Y8G("ngIf",t.created_at)}}function ke(i,n){if(1&i&&(e.j41(0,"div",26),e.DNE(1,ye,23,26,"button",27),e.k0s()),2&i){const t=e.XpG(2);e.R7$(),e.Y8G("ngForOf",t.datasets)("ngForTrackBy",t.trackByDatasetId)}}function De(i,n){if(1&i){const t=e.RV6();e.j41(0,"div",50)(1,"div",17),e.qSk(),e.j41(2,"svg",51),e.nrm(3,"path",52),e.k0s(),e.joV(),e.j41(4,"h3",53),e.EFF(5,"Ch\u01b0a c\xf3 dataset n\xe0o"),e.k0s(),e.j41(6,"p",54),e.EFF(7,"T\u1ea1o dataset m\u1edbi \u0111\u1ec3 b\u1eaft \u0111\u1ea7u ph\xe2n t\xedch d\u1eef li\u1ec7u"),e.k0s(),e.j41(8,"button",55),e.bIt("click",function(){e.eBV(t);const a=e.XpG(2);return e.Njj(a.createDataset())}),e.EFF(9," T\u1ea1o Dataset M\u1edbi "),e.k0s()()()}}function Ee(i,n){if(1&i&&(e.j41(0,"div",11),e.DNE(1,ge,5,0,"div",12)(2,ue,9,1,"div",13)(3,ke,2,2,"div",14)(4,De,10,0,"div",15),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.Y8G("ngIf",t.loading),e.R7$(),e.Y8G("ngIf",t.error&&!t.loading),e.R7$(),e.Y8G("ngIf",!t.loading&&!t.error&&t.datasets.length>0),e.R7$(),e.Y8G("ngIf",!t.loading&&!t.error&&0===t.datasets.length)}}function we(i,n){if(1&i&&(e.j41(0,"span"),e.EFF(1),e.nI1(2,"date"),e.nI1(3,"date"),e.k0s()),2&i){const t=e.XpG(3);e.R7$(),e.Lme(" ",e.i5U(2,2,t.demandStartDate,"dd/MM/yyyy")," - ",e.i5U(3,5,t.demandEndDate,"dd/MM/yyyy")," ")}}function Ce(i,n){1&i&&(e.j41(0,"span",80),e.EFF(1,"Ch\u01b0a ch\u1ecdn"),e.k0s())}function je(i,n){if(1&i&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&i){const t=e.XpG(3);e.R7$(),e.Lme(" ",t.warehouseRegionShortname," - ",t.getRegionName(t.warehouseRegionShortname)," ")}}function Fe(i,n){1&i&&(e.j41(0,"span",80),e.EFF(1,"-"),e.k0s())}function Te(i,n){if(1&i&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&i){const t=e.XpG(3);e.R7$(),e.SpI(" ",t.timelineWarehouses[0].province_name," ")}}function Se(i,n){1&i&&(e.j41(0,"span",80),e.EFF(1,"-"),e.k0s())}function Re(i,n){if(1&i&&(e.j41(0,"div",85)(1,"div",49),e.EFF(2),e.k0s(),e.j41(3,"div",39),e.EFF(4),e.k0s()()),2&i){const t=n.$implicit,r=e.XpG(4);e.R7$(2),e.JRh(t.name||"Ca"),e.R7$(2),e.JRh(r.formatShiftTime(t))}}function Ie(i,n){if(1&i&&(e.j41(0,"div",81)(1,"div",82)(2,"div",83),e.EFF(3,"T\xean ca"),e.k0s(),e.j41(4,"div",83),e.EFF(5,"Kho\u1ea3ng th\u1eddi gian"),e.k0s()(),e.DNE(6,Re,5,2,"div",84),e.k0s()),2&i){const t=e.XpG(3);e.R7$(6),e.Y8G("ngForOf",t.shifts)}}function We(i,n){1&i&&(e.j41(0,"span",80),e.EFF(1,"-"),e.k0s())}function Me(i,n){if(1&i&&(e.j41(0,"div",72)(1,"table",73)(2,"tbody")(3,"tr",74)(4,"td",75),e.EFF(5,"Th\u1eddi gian:"),e.k0s(),e.j41(6,"td",76),e.DNE(7,we,4,8,"span",77)(8,Ce,2,0,"span",78),e.k0s()(),e.j41(9,"tr",74)(10,"td",75),e.EFF(11,"V\xf9ng:"),e.k0s(),e.j41(12,"td",76),e.DNE(13,je,2,2,"span",77)(14,Fe,2,0,"span",78),e.k0s()(),e.j41(15,"tr",74)(16,"td",75),e.EFF(17,"T\u1ec9nh:"),e.k0s(),e.j41(18,"td",76),e.DNE(19,Te,2,1,"span",77)(20,Se,2,0,"span",78),e.k0s()(),e.j41(21,"tr")(22,"td",75),e.EFF(23,"Ca l\xe0m vi\u1ec7c:"),e.k0s(),e.j41(24,"td",76),e.DNE(25,Ie,7,1,"div",79)(26,We,2,0,"span",78),e.k0s()()()()()),2&i){const t=e.XpG(2);e.R7$(7),e.Y8G("ngIf",t.demandStartDate&&t.demandEndDate),e.R7$(),e.Y8G("ngIf",!t.demandStartDate||!t.demandEndDate),e.R7$(5),e.Y8G("ngIf",t.warehouseRegionShortname),e.R7$(),e.Y8G("ngIf",!t.warehouseRegionShortname),e.R7$(5),e.Y8G("ngIf",t.timelineWarehouses.length>0&&t.timelineWarehouses[0].province_name),e.R7$(),e.Y8G("ngIf",0===t.timelineWarehouses.length||!t.timelineWarehouses[0].province_name),e.R7$(5),e.Y8G("ngIf",t.shifts&&t.shifts.length>0),e.R7$(),e.Y8G("ngIf",!t.shifts||0===t.shifts.length)}}function Ae(i,n){if(1&i){const t=e.RV6();e.j41(0,"button",102),e.bIt("click",function(){e.eBV(t);const a=e.XpG(3);return e.Njj(a.clearAllPoints())}),e.EFF(1," X\xf3a t\u1ea5t c\u1ea3 "),e.k0s()}}function Be(i,n){if(1&i){const t=e.RV6();e.j41(0,"button",103),e.bIt("click",function(){e.eBV(t);const a=e.XpG(3);return e.Njj(a.clearSearch())}),e.qSk(),e.j41(1,"svg",64),e.nrm(2,"path",104),e.k0s()()}}function Ge(i,n){if(1&i){const t=e.RV6();e.j41(0,"div",107)(1,"div",108),e.EFF(2),e.k0s(),e.j41(3,"div",32)(4,"div",109),e.EFF(5),e.k0s(),e.j41(6,"div",110),e.EFF(7),e.k0s()(),e.j41(8,"button",111),e.bIt("click",function(){const a=e.eBV(t).$implicit,o=e.XpG(4);return e.Njj(o.removeFromTimeline(a))}),e.qSk(),e.j41(9,"svg",112),e.nrm(10,"path",104),e.k0s()()()}if(2&i){const t=n.$implicit,r=n.index,a=e.XpG(4);e.R7$(2),e.SpI(" ",(a.timelineCurrentPage-1)*a.timelinePageSize+r+1," "),e.R7$(3),e.JRh(t.warehouse_name),e.R7$(2),e.Lme("",t.district_name,", ",t.province_name,"")}}function Pe(i,n){if(1&i&&(e.j41(0,"div",105),e.DNE(1,Ge,11,4,"div",106),e.k0s()),2&i){const t=e.XpG(3);e.R7$(),e.Y8G("ngForOf",t.paginatedTimelineWarehouses)}}function $e(i,n){if(1&i){const t=e.RV6();e.j41(0,"div",113)(1,"div",114),e.EFF(2),e.k0s(),e.j41(3,"div",115)(4,"button",116),e.bIt("click",function(){e.eBV(t);const a=e.XpG(3);return e.Njj(a.goToTimelinePreviousPage())}),e.EFF(5," Tr\u01b0\u1edbc "),e.k0s(),e.j41(6,"span",117),e.EFF(7),e.k0s(),e.j41(8,"button",116),e.bIt("click",function(){e.eBV(t);const a=e.XpG(3);return e.Njj(a.goToTimelineNextPage())}),e.EFF(9," Sau "),e.k0s()()()}if(2&i){const t=e.XpG(3);e.R7$(2),e.E5c(" Hi\u1ec3n th\u1ecb ",t.getTimelinePageStart(),"-",t.getTimelinePageEnd()," / ",t.timelineWarehouses.length," "),e.R7$(2),e.Y8G("disabled",1===t.timelineCurrentPage),e.R7$(3),e.Lme(" ",t.timelineCurrentPage," / ",t.timelineTotalPages," "),e.R7$(),e.Y8G("disabled",t.timelineCurrentPage===t.timelineTotalPages)}}function Ne(i,n){1&i&&(e.j41(0,"div",118),e.qSk(),e.j41(1,"svg",119),e.nrm(2,"path",90),e.k0s(),e.joV(),e.j41(3,"p",120),e.EFF(4,"Ch\u01b0a c\xf3 b\u01b0u c\u1ee5c n\xe0o"),e.k0s(),e.j41(5,"p",121),e.EFF(6,"Ch\u1ecdn v\xf9ng v\xe0 b\u01b0u c\u1ee5c \u0111\u1ec3 th\xeam v\xe0o danh s\xe1ch"),e.k0s()())}function Ve(i,n){if(1&i){const t=e.RV6();e.j41(0,"div",86)(1,"div",87)(2,"h3",88),e.qSk(),e.j41(3,"svg",89),e.nrm(4,"path",90),e.k0s(),e.joV(),e.j41(5,"span"),e.EFF(6,"Danh s\xe1ch b\u01b0u c\u1ee5c"),e.k0s(),e.j41(7,"span",91),e.EFF(8),e.k0s()(),e.DNE(9,Ae,2,0,"button",92),e.k0s(),e.j41(10,"div",93)(11,"div",7)(12,"div",94),e.qSk(),e.j41(13,"svg",95),e.nrm(14,"path",96),e.k0s()(),e.joV(),e.j41(15,"input",97),e.mxI("ngModelChange",function(a){e.eBV(t);const o=e.XpG(2);return e.DH7(o.demandSearchQuery,a)||(o.demandSearchQuery=a),e.Njj(a)}),e.bIt("ngModelChange",function(){e.eBV(t);const a=e.XpG(2);return e.Njj(a.triggerChangeDetection())}),e.k0s(),e.DNE(16,Be,3,0,"button",98),e.k0s()(),e.DNE(17,Pe,2,1,"div",99)(18,$e,10,7,"div",100)(19,Ne,7,0,"div",101),e.k0s()}if(2&i){const t=e.XpG(2);e.R7$(8),e.JRh(t.timelineWarehouses.length),e.R7$(),e.Y8G("ngIf",t.timelineWarehouses.length>0),e.R7$(6),e.R50("ngModel",t.demandSearchQuery),e.R7$(),e.Y8G("ngIf",t.demandSearchQuery),e.R7$(),e.Y8G("ngIf",t.timelineWarehouses.length>0),e.R7$(),e.Y8G("ngIf",t.timelineWarehouses.length>t.timelinePageSize),e.R7$(),e.Y8G("ngIf",0===t.timelineWarehouses.length)}}function Oe(i,n){1&i&&(e.j41(0,"div",50)(1,"div",17),e.nrm(2,"div",206),e.j41(3,"span",207),e.EFF(4,"\u0110ang t\u1ea3i d\u1eef li\u1ec7u demands..."),e.k0s()()())}function Ye(i,n){if(1&i&&(e.j41(0,"div",208)(1,"div",21)(2,"div",209),e.qSk(),e.j41(3,"svg",210),e.nrm(4,"path",23),e.k0s()(),e.joV(),e.j41(5,"div")(6,"h4",24),e.EFF(7,"L\u1ed7i t\u1ea3i d\u1eef li\u1ec7u"),e.k0s(),e.j41(8,"span",25),e.EFF(9),e.k0s()()()()),2&i){const t=e.XpG(3);e.R7$(9),e.JRh(t.demandsError)}}function Xe(i,n){1&i&&(e.j41(0,"div",211)(1,"div",212),e.nrm(2,"div",213),e.j41(3,"span",207),e.EFF(4,"\u0110ang t\u1ea3i d\u1eef li\u1ec7u timeline..."),e.k0s()()())}function Le(i,n){if(1&i&&(e.j41(0,"div",214)(1,"p",215),e.EFF(2),e.k0s()()),2&i){const t=e.XpG(3);e.R7$(2),e.JRh(t.timelineDataError)}}function ze(i,n){if(1&i){const t=e.RV6();e.j41(0,"div",216)(1,"div",139)(2,"label",161),e.EFF(3,"Lo\u1ea1i bi\u1ec3u \u0111\u1ed3:"),e.k0s(),e.j41(4,"div",217)(5,"button",218),e.bIt("click",function(){e.eBV(t);const a=e.XpG(3);return a.timelineChartType="column",e.Njj(a.updateTimelineChart())}),e.EFF(6," C\u1ed9t "),e.k0s(),e.j41(7,"button",218),e.bIt("click",function(){e.eBV(t);const a=e.XpG(3);return a.timelineChartType="line",e.Njj(a.updateTimelineChart())}),e.EFF(8," \u0110\u01b0\u1eddng "),e.k0s()()(),e.j41(9,"div",115)(10,"input",219),e.mxI("ngModelChange",function(a){e.eBV(t);const o=e.XpG(3);return e.DH7(o.showTimelineAverage,a)||(o.showTimelineAverage=a),e.Njj(a)}),e.bIt("change",function(){e.eBV(t);const a=e.XpG(3);return e.Njj(a.updateTimelineChart())}),e.k0s(),e.j41(11,"label",220),e.EFF(12," Hi\u1ec3n th\u1ecb \u0111\u01b0\u1eddng trung b\xecnh "),e.k0s()()()}if(2&i){const t=e.XpG(3);e.R7$(5),e.Y8G("ngClass",e.l_i(3,Z,"column"===t.timelineChartType,"column"!==t.timelineChartType)),e.R7$(2),e.Y8G("ngClass",e.l_i(6,Z,"line"===t.timelineChartType,"line"!==t.timelineChartType)),e.R7$(3),e.R50("ngModel",t.showTimelineAverage)}}function He(i,n){1&i&&(e.j41(0,"div",225)(1,"p",226),e.EFF(2,"Kh\xf4ng c\xf3 d\u1eef li\u1ec7u \u0111\u1ec3 hi\u1ec3n th\u1ecb"),e.k0s()())}function Ke(i,n){if(1&i&&(e.j41(0,"div",221)(1,"div",222),e.nrm(2,"canvas",223,1),e.k0s(),e.DNE(4,He,3,0,"div",224),e.k0s()),2&i){const t=e.XpG(3);e.R7$(4),e.Y8G("ngIf",!t.hasTimelineData)}}function Ue(i,n){if(1&i){const t=e.RV6();e.j41(0,"tr",241),e.bIt("click",function(){const a=e.eBV(t).$implicit,o=e.XpG(4);return e.Njj(o.toggleTimelineWarehouse(o.toString(a.warehouse_id||a.id)))}),e.j41(1,"td",242),e.bIt("click",function(a){return e.eBV(t),e.Njj(a.stopPropagation())}),e.j41(2,"input",243),e.bIt("change",function(){const a=e.eBV(t).$implicit,o=e.XpG(4);return e.Njj(o.toggleTimelineWarehouse(o.toString(a.warehouse_id||a.id)))}),e.k0s()(),e.j41(3,"td",244),e.EFF(4),e.k0s(),e.j41(5,"td",245),e.EFF(6),e.k0s()()}if(2&i){const t=n.$implicit,r=e.XpG(4);e.R7$(2),e.Y8G("checked",0===r.selectedTimelineWarehouseIds.length||r.selectedTimelineWarehouseIds.includes(r.toString(t.warehouse_id||t.id))),e.R7$(2),e.JRh(t.warehouse_name),e.R7$(2),e.JRh(t.warehouse_id)}}function qe(i,n){if(1&i){const t=e.RV6();e.j41(0,"div",246)(1,"div",247),e.EFF(2," Hi\u1ec3n th\u1ecb "),e.j41(3,"span",248),e.EFF(4),e.k0s(),e.EFF(5," \u0111\u1ebfn "),e.j41(6,"span",248),e.EFF(7),e.k0s(),e.EFF(8," trong t\u1ed5ng s\u1ed1 "),e.j41(9,"span",248),e.EFF(10),e.k0s(),e.EFF(11," b\u01b0u c\u1ee5c "),e.k0s(),e.j41(12,"div",115)(13,"button",249),e.bIt("click",function(){e.eBV(t);const a=e.XpG(4);return e.Njj(a.goToTimelineWarehousePreviousPage())}),e.EFF(14," Tr\u01b0\u1edbc "),e.k0s(),e.j41(15,"span",247),e.EFF(16," Trang "),e.j41(17,"span",248),e.EFF(18),e.k0s(),e.EFF(19," / "),e.j41(20,"span",248),e.EFF(21),e.k0s()(),e.j41(22,"button",249),e.bIt("click",function(){e.eBV(t);const a=e.XpG(4);return e.Njj(a.goToTimelineWarehouseNextPage())}),e.EFF(23," Sau "),e.k0s()()()}if(2&i){const t=e.XpG(4);e.R7$(4),e.JRh(t.getTimelineWarehousePageStart()),e.R7$(3),e.JRh(t.getTimelineWarehousePageEnd()),e.R7$(3),e.JRh(t.availableTimelineWarehouses.length),e.R7$(3),e.Y8G("disabled",1===t.timelineWarehouseCurrentPage)("ngClass",e.l_i(9,ee,t.timelineWarehouseCurrentPage>1,1===t.timelineWarehouseCurrentPage)),e.R7$(5),e.JRh(t.timelineWarehouseCurrentPage),e.R7$(3),e.JRh(t.timelineWarehouseTotalPages),e.R7$(),e.Y8G("disabled",t.timelineWarehouseCurrentPage===t.timelineWarehouseTotalPages)("ngClass",e.l_i(12,ee,t.timelineWarehouseCurrentPage<t.timelineWarehouseTotalPages,t.timelineWarehouseCurrentPage===t.timelineWarehouseTotalPages))}}function Je(i,n){if(1&i){const t=e.RV6();e.j41(0,"div",227)(1,"div",228)(2,"label",161),e.EFF(3),e.k0s(),e.j41(4,"div",217)(5,"button",229),e.bIt("click",function(){e.eBV(t);const a=e.XpG(3);return e.Njj(a.selectAllTimelineWarehouses())}),e.EFF(6," Ch\u1ecdn t\u1ea5t c\u1ea3 "),e.k0s(),e.j41(7,"button",230),e.bIt("click",function(){e.eBV(t);const a=e.XpG(3);return e.Njj(a.deselectAllTimelineWarehouses())}),e.EFF(8," B\u1ecf ch\u1ecdn "),e.k0s()()(),e.j41(9,"div",231)(10,"table",232)(11,"thead",233)(12,"tr")(13,"th",234)(14,"input",235),e.bIt("change",function(){e.eBV(t);const a=e.XpG(3);return e.Njj(a.selectedTimelineWarehouseIds.length===a.availableTimelineWarehouses.length?a.deselectAllTimelineWarehouses():a.selectAllTimelineWarehouses())}),e.k0s()(),e.j41(15,"th",236),e.EFF(16,"T\xean b\u01b0u c\u1ee5c"),e.k0s(),e.j41(17,"th",237),e.EFF(18,"ID"),e.k0s()()(),e.j41(19,"tbody",238),e.DNE(20,Ue,7,3,"tr",239),e.k0s()()(),e.DNE(21,qe,24,15,"div",240),e.k0s()}if(2&i){const t=e.XpG(3);e.R7$(3),e.SpI(" Ch\u1ecdn B\u01b0u c\u1ee5c (",0===t.selectedTimelineWarehouseIds.length?"T\u1ea5t c\u1ea3":t.selectedTimelineWarehouseIds.length+" \u0111\xe3 ch\u1ecdn",") "),e.R7$(11),e.Y8G("checked",t.selectedTimelineWarehouseIds.length===t.availableTimelineWarehouses.length&&t.availableTimelineWarehouses.length>0),e.R7$(6),e.Y8G("ngForOf",t.paginatedAvailableTimelineWarehouses),e.R7$(),e.Y8G("ngIf",t.timelineWarehouseTotalPages>1)}}function Qe(i,n){1&i&&(e.j41(0,"div",211)(1,"div",212),e.nrm(2,"div",213),e.j41(3,"span",207),e.EFF(4,"\u0110ang t\u1ea3i d\u1eef li\u1ec7u t\u1ec9 l\u1ec7 ca..."),e.k0s()()())}function Ze(i,n){if(1&i&&(e.j41(0,"p",259),e.EFF(1),e.k0s()),2&i){const t=e.XpG(5);e.R7$(),e.JRh(t.shiftRatioError)}}function et(i,n){1&i&&(e.j41(0,"p",259),e.EFF(1,"Kh\xf4ng t\xecm th\u1ea5y d\u1eef li\u1ec7u ph\xe2n t\xedch theo v\xf9ng"),e.k0s())}function tt(i,n){if(1&i&&(e.j41(0,"div",255),e.qSk(),e.j41(1,"svg",256),e.nrm(2,"path",251),e.k0s(),e.joV(),e.j41(3,"h3",257),e.EFF(4,"Kh\xf4ng c\xf3 d\u1eef li\u1ec7u"),e.k0s(),e.DNE(5,Ze,2,1,"p",258)(6,et,2,0,"p",258),e.k0s()),2&i){const t=e.XpG(4);e.R7$(5),e.Y8G("ngIf",t.shiftRatioError),e.R7$(),e.Y8G("ngIf",!t.shiftRatioError)}}function at(i,n){1&i&&(e.j41(0,"tr",270)(1,"td",271),e.EFF(2," Kh\xf4ng c\xf3 d\u1eef li\u1ec7u "),e.k0s()())}function rt(i,n){if(1&i&&(e.j41(0,"tr",272)(1,"td",273)(2,"div",274)(3,"div",275)(4,"span",276),e.EFF(5),e.k0s()(),e.j41(6,"div")(7,"div",277),e.EFF(8),e.k0s()()()(),e.j41(9,"td",278)(10,"span",279),e.EFF(11),e.k0s()(),e.j41(12,"td",280)(13,"div",281)(14,"span",282),e.EFF(15),e.k0s(),e.j41(16,"div",283),e.nrm(17,"div",284),e.k0s()()(),e.j41(18,"td",280)(19,"div",281)(20,"span",285),e.EFF(21),e.k0s(),e.j41(22,"div",283),e.nrm(23,"div",286),e.k0s()()()()),2&i){const t=n.$implicit,r=n.index,a=e.XpG(5);e.R7$(5),e.JRh(r+1),e.R7$(3),e.JRh(t.shift_name||(null==t.shift?null:t.shift.name)||(null==a.shifts[r]?null:a.shifts[r].name)||"Ca "+(r+1)),e.R7$(3),e.Lme(" ",void 0!==(null==t.shift?null:t.shift.start_hour)?t.shift.start_hour:(null==a.shifts[r]?null:a.shifts[r].start_hour)||0,":00 - ",void 0!==(null==t.shift?null:t.shift.end_hour)?t.shift.end_hour:(null==a.shifts[r]?null:a.shifts[r].end_hour)||0,":00 "),e.R7$(4),e.SpI("",(100*(t.pick_ratio||0)).toFixed(1),"%"),e.R7$(2),e.xc7("width",100*(t.pick_ratio||0),"%"),e.R7$(4),e.SpI("",(100*(t.deliver_ratio||0)).toFixed(1),"%"),e.R7$(2),e.xc7("width",100*(t.deliver_ratio||0),"%")}}function it(i,n){if(1&i&&(e.j41(0,"div",260)(1,"h4",261),e.qSk(),e.j41(2,"svg",262),e.nrm(3,"path",90),e.k0s(),e.EFF(4," B\u1ea3ng T\u1ec9 l\u1ec7 S\u1ea3n l\u01b0\u1ee3ng theo Ca "),e.k0s(),e.joV(),e.j41(5,"div",231)(6,"table",263)(7,"thead",264)(8,"tr")(9,"th",265),e.EFF(10,"Ca"),e.k0s(),e.j41(11,"th",266),e.EFF(12,"Khung gi\u1edd"),e.k0s(),e.j41(13,"th",267),e.EFF(14,"T\u1ec9 l\u1ec7 L\u1ea5y (%)"),e.k0s(),e.j41(15,"th",267),e.EFF(16,"T\u1ec9 l\u1ec7 Giao (%)"),e.k0s()()(),e.j41(17,"tbody",238),e.DNE(18,at,3,0,"tr",268)(19,rt,24,10,"tr",269),e.k0s()()()()),2&i){const t=e.XpG(4);e.R7$(18),e.Y8G("ngIf",!t.shiftRatios||0===t.shiftRatios.length),e.R7$(),e.Y8G("ngForOf",t.shiftRatios)}}function ot(i,n){if(1&i&&(e.j41(0,"div",287)(1,"div",288)(2,"div",29)(3,"div",289),e.qSk(),e.j41(4,"svg",133),e.nrm(5,"path",136),e.k0s()(),e.joV(),e.j41(6,"div")(7,"h5",290),e.EFF(8,"Ph\xe2n b\u1ed5 L\u1ea5y theo gi\u1edd"),e.k0s(),e.j41(9,"p",114),e.EFF(10,"T\u1ed5ng s\u1ea3n l\u01b0\u1ee3ng l\u1ea5y theo ca"),e.k0s()()(),e.j41(11,"div",291),e.nrm(12,"canvas",292,2),e.k0s()(),e.j41(14,"div",293)(15,"div",29)(16,"div",294),e.qSk(),e.j41(17,"svg",133),e.nrm(18,"path",136),e.k0s()(),e.joV(),e.j41(19,"div")(20,"h5",290),e.EFF(21,"Ph\xe2n b\u1ed5 Giao theo gi\u1edd"),e.k0s(),e.j41(22,"p",114),e.EFF(23,"T\u1ed5ng s\u1ea3n l\u01b0\u1ee3ng giao theo ca"),e.k0s()()(),e.j41(24,"div",291),e.nrm(25,"canvas",292,3),e.k0s()()()),2&i){const t=e.XpG(4);e.R7$(12),e.xc7("display",t.shiftRatios&&0!==t.shiftRatios.length?"block":"none"),e.R7$(13),e.xc7("display",t.shiftRatios&&0!==t.shiftRatios.length?"block":"none")}}function nt(i,n){if(1&i&&(e.j41(0,"div",250)(1,"div")(2,"div",138)(3,"div",139)(4,"div",140),e.qSk(),e.j41(5,"svg",141),e.nrm(6,"path",251),e.k0s()(),e.joV(),e.j41(7,"div")(8,"h3",142),e.EFF(9,"Ph\xe2n t\xedch s\u1ea3n l\u01b0\u1ee3ng theo ca"),e.k0s(),e.j41(10,"p",143),e.EFF(11,"Ph\xe2n t\xedch t\u1ec9 l\u1ec7 s\u1ea3n l\u01b0\u1ee3ng theo ca v\xe0 khung gi\u1edd"),e.k0s()()()(),e.j41(12,"div",144),e.DNE(13,Qe,5,0,"div",145)(14,tt,7,2,"div",252)(15,it,20,2,"div",253)(16,ot,27,4,"div",254),e.k0s()()()),2&i){const t=e.XpG(3);e.R7$(13),e.Y8G("ngIf",t.loadingShiftRatio),e.R7$(),e.Y8G("ngIf",!t.loadingShiftRatio&&(t.shiftRatioError||!t.shiftRatios||0===t.shiftRatios.length)),e.R7$(),e.Y8G("ngIf",!t.loadingShiftRatio),e.R7$(),e.Y8G("ngIf",!t.loadingShiftRatio&&t.shiftRatios&&t.shiftRatios.length>0)}}function st(i,n){if(1&i&&(e.j41(0,"span",295),e.EFF(1," (Hi\u1ec3n th\u1ecb: "),e.j41(2,"span",296),e.EFF(3),e.k0s(),e.EFF(4,") "),e.k0s()),2&i){const t=e.XpG(3);e.R7$(3),e.JRh(t.filteredDemands.length)}}function dt(i,n){1&i&&(e.j41(0,"div",50)(1,"div",17),e.nrm(2,"div",18),e.j41(3,"span",207),e.EFF(4,"\u0110ang t\u1ea3i d\u1eef li\u1ec7u demands..."),e.k0s()()())}function lt(i,n){if(1&i&&(e.j41(0,"div",297)(1,"div",21)(2,"div",209),e.qSk(),e.j41(3,"svg",210),e.nrm(4,"path",23),e.k0s()(),e.joV(),e.j41(5,"div")(6,"h4",24),e.EFF(7,"L\u1ed7i t\u1ea3i d\u1eef li\u1ec7u"),e.k0s(),e.j41(8,"span",25),e.EFF(9),e.k0s()()()()),2&i){const t=e.XpG(3);e.R7$(9),e.JRh(t.demandsError)}}function ht(i,n){1&i&&(e.j41(0,"div",298)(1,"div",299)(2,"div",300),e.qSk(),e.j41(3,"svg",133),e.nrm(4,"path",62),e.k0s()(),e.joV(),e.j41(5,"div")(6,"h4",301),e.EFF(7,"Ch\u01b0a c\xf3 b\u01b0u c\u1ee5c"),e.k0s(),e.j41(8,"p",302),e.EFF(9,"Vui l\xf2ng th\xeam b\u01b0u c\u1ee5c v\xe0o timeline \u0111\u1ec3 xem d\u1eef li\u1ec7u demands."),e.k0s()()()())}function ct(i,n){1&i&&(e.j41(0,"div",303),e.qSk(),e.j41(1,"svg",304),e.nrm(2,"path",125),e.k0s(),e.joV(),e.j41(3,"p",305),e.EFF(4,"Ch\u1ecdn b\u01b0u c\u1ee5c \u0111\u1ec3 xem chi ti\u1ebft"),e.k0s()())}function gt(i,n){1&i&&(e.qSk(),e.nrm(0,"path",315))}function ut(i,n){1&i&&(e.qSk(),e.nrm(0,"path",316))}function mt(i,n){if(1&i&&(e.qSk(),e.j41(0,"svg",312),e.DNE(1,gt,1,0,"path",313)(2,ut,1,0,"path",314),e.k0s()),2&i){const t=e.XpG(4);e.R7$(),e.Y8G("ngIf","asc"===t.demandSortOrder),e.R7$(),e.Y8G("ngIf","desc"===t.demandSortOrder)}}function pt(i,n){1&i&&(e.qSk(),e.nrm(0,"path",315))}function _t(i,n){1&i&&(e.qSk(),e.nrm(0,"path",316))}function ft(i,n){if(1&i&&(e.qSk(),e.j41(0,"svg",312),e.DNE(1,pt,1,0,"path",313)(2,_t,1,0,"path",314),e.k0s()),2&i){const t=e.XpG(4);e.R7$(),e.Y8G("ngIf","asc"===t.demandSortOrder),e.R7$(),e.Y8G("ngIf","desc"===t.demandSortOrder)}}function vt(i,n){1&i&&(e.qSk(),e.nrm(0,"path",315))}function bt(i,n){1&i&&(e.qSk(),e.nrm(0,"path",316))}function xt(i,n){if(1&i&&(e.qSk(),e.j41(0,"svg",312),e.DNE(1,vt,1,0,"path",313)(2,bt,1,0,"path",314),e.k0s()),2&i){const t=e.XpG(4);e.R7$(),e.Y8G("ngIf","asc"===t.demandSortOrder),e.R7$(),e.Y8G("ngIf","desc"===t.demandSortOrder)}}function yt(i,n){1&i&&(e.qSk(),e.nrm(0,"path",315))}function kt(i,n){1&i&&(e.qSk(),e.nrm(0,"path",316))}function Dt(i,n){if(1&i&&(e.qSk(),e.j41(0,"svg",312),e.DNE(1,yt,1,0,"path",313)(2,kt,1,0,"path",314),e.k0s()),2&i){const t=e.XpG(4);e.R7$(),e.Y8G("ngIf","asc"===t.demandSortOrder),e.R7$(),e.Y8G("ngIf","desc"===t.demandSortOrder)}}function Et(i,n){1&i&&(e.qSk(),e.nrm(0,"path",315))}function wt(i,n){1&i&&(e.qSk(),e.nrm(0,"path",316))}function Ct(i,n){if(1&i&&(e.qSk(),e.j41(0,"svg",312),e.DNE(1,Et,1,0,"path",313)(2,wt,1,0,"path",314),e.k0s()),2&i){const t=e.XpG(4);e.R7$(),e.Y8G("ngIf","asc"===t.demandSortOrder),e.R7$(),e.Y8G("ngIf","desc"===t.demandSortOrder)}}function jt(i,n){if(1&i){const t=e.RV6();e.j41(0,"tr",306)(1,"th",307)(2,"button",308),e.bIt("click",function(){e.eBV(t);const a=e.XpG(3);return e.Njj(a.sortDemands("warehouse_name"))}),e.EFF(3," B\u01b0u c\u1ee5c "),e.DNE(4,mt,3,2,"svg",309),e.k0s()(),e.j41(5,"th",310)(6,"button",311),e.bIt("click",function(){e.eBV(t);const a=e.XpG(3);return e.Njj(a.sortDemands("total_pick"))}),e.EFF(7," T\u1ed5ng L\u1ea5y "),e.DNE(8,ft,3,2,"svg",309),e.k0s()(),e.j41(9,"th",310)(10,"button",311),e.bIt("click",function(){e.eBV(t);const a=e.XpG(3);return e.Njj(a.sortDemands("total_deliver"))}),e.EFF(11," T\u1ed5ng Giao "),e.DNE(12,xt,3,2,"svg",309),e.k0s()(),e.j41(13,"th",310)(14,"button",311),e.bIt("click",function(){e.eBV(t);const a=e.XpG(3);return e.Njj(a.sortDemands("avg_pick_per_day"))}),e.EFF(15," TB L\u1ea5y/Ng\xe0y "),e.DNE(16,Dt,3,2,"svg",309),e.k0s()(),e.j41(17,"th",310)(18,"button",311),e.bIt("click",function(){e.eBV(t);const a=e.XpG(3);return e.Njj(a.sortDemands("avg_deliver_per_day"))}),e.EFF(19," TB Giao/Ng\xe0y "),e.DNE(20,Ct,3,2,"svg",309),e.k0s()()()}if(2&i){const t=e.XpG(3);e.R7$(4),e.Y8G("ngIf","warehouse_name"===t.demandSortField),e.R7$(4),e.Y8G("ngIf","total_pick"===t.demandSortField),e.R7$(4),e.Y8G("ngIf","total_deliver"===t.demandSortField),e.R7$(4),e.Y8G("ngIf","avg_pick_per_day"===t.demandSortField),e.R7$(4),e.Y8G("ngIf","avg_deliver_per_day"===t.demandSortField)}}function Ft(i,n){if(1&i){const t=e.RV6();e.j41(0,"tr",317),e.bIt("click",function(){const a=e.eBV(t).$implicit,o=e.XpG(3);return e.Njj(o.selectDemand(a))}),e.j41(1,"td",318)(2,"div")(3,"div",319),e.EFF(4),e.k0s(),e.j41(5,"div",34),e.EFF(6),e.k0s()()(),e.j41(7,"td",320),e.EFF(8),e.nI1(9,"number"),e.k0s(),e.j41(10,"td",320),e.EFF(11),e.nI1(12,"number"),e.k0s(),e.j41(13,"td",321),e.EFF(14),e.nI1(15,"number"),e.k0s(),e.j41(16,"td",321),e.EFF(17),e.nI1(18,"number"),e.k0s()()}if(2&i){const t=n.$implicit,r=e.XpG(3);e.Y8G("ngClass",e.l_i(17,ce,r.isDemandSelected(t),!r.isDemandSelected(t))),e.R7$(4),e.JRh(t.warehouse_name||"\u2014"),e.R7$(2),e.SpI("ID: ",t.warehouse_id,""),e.R7$(2),e.SpI(" ",e.bMT(9,7,t.total_pick)," "),e.R7$(3),e.SpI(" ",e.bMT(12,9,t.total_deliver)," "),e.R7$(3),e.SpI(" ",e.i5U(15,11,t.avg_pick_per_day,"1.1-1")," "),e.R7$(3),e.SpI(" ",e.i5U(18,14,t.avg_deliver_per_day,"1.1-1")," ")}}function Tt(i,n){if(1&i&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&i){const t=e.XpG(4);e.R7$(),e.SpI('Kh\xf4ng t\xecm th\u1ea5y k\u1ebft qu\u1ea3 cho "',t.demandSearchQuery,'"')}}function St(i,n){1&i&&(e.j41(0,"span"),e.EFF(1,"Kh\xf4ng c\xf3 d\u1eef li\u1ec7u"),e.k0s())}function Rt(i,n){if(1&i){const t=e.RV6();e.j41(0,"button",328),e.bIt("click",function(){e.eBV(t);const a=e.XpG(4);return e.Njj(a.clearSearch())}),e.EFF(1," X\xf3a b\u1ed9 l\u1ecdc "),e.k0s()}}function It(i,n){if(1&i&&(e.j41(0,"tr")(1,"td",322)(2,"div",323),e.qSk(),e.j41(3,"svg",324),e.nrm(4,"path",325),e.k0s(),e.joV(),e.j41(5,"div",326),e.DNE(6,Tt,2,1,"span",77)(7,St,2,0,"span",77),e.k0s(),e.DNE(8,Rt,2,0,"button",327),e.k0s()()()),2&i){const t=e.XpG(3);e.R7$(6),e.Y8G("ngIf",t.demandSearchQuery),e.R7$(),e.Y8G("ngIf",!t.demandSearchQuery),e.R7$(),e.Y8G("ngIf",t.demandSearchQuery)}}function Wt(i,n){if(1&i){const t=e.RV6();e.j41(0,"div",122)(1,"div",123)(2,"div",59)(3,"h2",124),e.qSk(),e.j41(4,"svg",61),e.nrm(5,"path",125),e.k0s(),e.joV(),e.j41(6,"span"),e.EFF(7,"Qu\u1ea3n l\xed s\u1ea3n l\u01b0\u1ee3ng"),e.k0s()()()(),e.j41(8,"div",126),e.DNE(9,Oe,5,0,"div",15)(10,Ye,10,1,"div",127),e.j41(11,"div",128)(12,"div",129)(13,"div",130)(14,"div",131)(15,"div",132),e.qSk(),e.j41(16,"svg",133),e.nrm(17,"path",125),e.k0s()()(),e.joV(),e.j41(18,"div",134),e.EFF(19),e.nI1(20,"number"),e.k0s(),e.j41(21,"div",135),e.EFF(22,"T\u1ed5ng L\u1ea5y/Giao"),e.k0s()(),e.j41(23,"div",130)(24,"div",131)(25,"div",132),e.qSk(),e.j41(26,"svg",133),e.nrm(27,"path",136),e.k0s()()(),e.joV(),e.j41(28,"div",134),e.EFF(29),e.nI1(30,"number"),e.k0s(),e.j41(31,"div",135),e.EFF(32,"T\u1ed5ng L\u1ea5y"),e.k0s()(),e.j41(33,"div",130)(34,"div",131)(35,"div",132),e.qSk(),e.j41(36,"svg",133),e.nrm(37,"path",136),e.k0s()()(),e.joV(),e.j41(38,"div",134),e.EFF(39),e.nI1(40,"number"),e.k0s(),e.j41(41,"div",135),e.EFF(42,"T\u1ed5ng Giao"),e.k0s()()()(),e.j41(43,"div",137)(44,"div")(45,"div",138)(46,"div",139)(47,"div",140),e.qSk(),e.j41(48,"svg",141),e.nrm(49,"path",125),e.k0s()(),e.joV(),e.j41(50,"div")(51,"h3",142),e.EFF(52,"Bi\u1ec3u \u0111\u1ed3 S\u1ea3n l\u01b0\u1ee3ng theo th\u1eddi gian"),e.k0s(),e.j41(53,"p",143),e.EFF(54,"S\u1ea3n l\u01b0\u1ee3ng theo Ng\xe0y - T\u1ed5ng s\u1ea3n l\u01b0\u1ee3ng l\u1ea5y v\xe0 giao theo t\u1eeb ng\xe0y \u0111\u1ebfn ng\xe0y (L\u1ea5y t\u1eeb th\u1eddi gian c\u1ee7a Th\xf4ng tin)"),e.k0s()()()(),e.j41(55,"div",144),e.DNE(56,Xe,5,0,"div",145)(57,Le,3,1,"div",146)(58,ze,13,9,"div",147)(59,Ke,5,1,"div",148)(60,Je,22,4,"div",149),e.k0s()()(),e.DNE(61,nt,17,4,"div",150),e.j41(62,"div",137)(63,"div")(64,"div",138)(65,"div",151)(66,"div",139)(67,"div",140),e.qSk(),e.j41(68,"svg",152),e.nrm(69,"path",125),e.k0s()(),e.joV(),e.j41(70,"div")(71,"h3",142),e.EFF(72,"Bi\u1ec3u \u0111\u1ed3 S\u1ea3n l\u01b0\u1ee3ng theo B\u01b0u c\u1ee5c"),e.k0s(),e.j41(73,"p",143),e.EFF(74,"Ph\xe2n t\xedch v\xe0 so s\xe1nh s\u1ea3n l\u01b0\u1ee3ng gi\u1eefa c\xe1c b\u01b0u c\u1ee5c"),e.k0s()()(),e.j41(75,"div",153)(76,"button",154),e.bIt("click",function(){e.eBV(t);const a=e.XpG(2);return a.chartType="bar",e.Njj(a.triggerChangeDetection())}),e.qSk(),e.j41(77,"svg",155),e.nrm(78,"path",125),e.k0s(),e.EFF(79," C\u1ed9t "),e.k0s(),e.joV(),e.j41(80,"button",154),e.bIt("click",function(){e.eBV(t);const a=e.XpG(2);return a.chartType="line",e.Njj(a.triggerChangeDetection())}),e.qSk(),e.j41(81,"svg",155),e.nrm(82,"path",156),e.k0s(),e.EFF(83," \u0110\u01b0\u1eddng "),e.k0s()()(),e.joV(),e.j41(84,"div",157)(85,"div",158),e.qSk(),e.j41(86,"svg",159),e.nrm(87,"path",160),e.k0s(),e.joV(),e.j41(88,"span",161),e.EFF(89,"Hi\u1ec3n th\u1ecb d\u1eef li\u1ec7u:"),e.k0s()(),e.j41(90,"div",162)(91,"label",163)(92,"input",164),e.mxI("ngModelChange",function(a){e.eBV(t);const o=e.XpG(2);return e.DH7(o.chartShowPick,a)||(o.chartShowPick=a),e.Njj(a)}),e.bIt("change",function(){e.eBV(t);const a=e.XpG(2);return e.Njj(a.triggerChangeDetection())}),e.k0s(),e.j41(93,"div",165),e.nrm(94,"div",166),e.j41(95,"span",167),e.EFF(96,"T\u1ed5ng L\u1ea5y"),e.k0s()()(),e.j41(97,"label",163)(98,"input",164),e.mxI("ngModelChange",function(a){e.eBV(t);const o=e.XpG(2);return e.DH7(o.chartShowDeliver,a)||(o.chartShowDeliver=a),e.Njj(a)}),e.bIt("change",function(){e.eBV(t);const a=e.XpG(2);return e.Njj(a.triggerChangeDetection())}),e.k0s(),e.j41(99,"div",165),e.nrm(100,"div",166),e.j41(101,"span",167),e.EFF(102,"T\u1ed5ng Giao"),e.k0s()()(),e.j41(103,"label",163)(104,"input",164),e.mxI("ngModelChange",function(a){e.eBV(t);const o=e.XpG(2);return e.DH7(o.chartShowAvgPick,a)||(o.chartShowAvgPick=a),e.Njj(a)}),e.bIt("change",function(){e.eBV(t);const a=e.XpG(2);return e.Njj(a.triggerChangeDetection())}),e.k0s(),e.j41(105,"div",165),e.nrm(106,"div",166),e.j41(107,"span",167),e.EFF(108,"TB L\u1ea5y/Ng\xe0y"),e.k0s()()(),e.j41(109,"label",163)(110,"input",164),e.mxI("ngModelChange",function(a){e.eBV(t);const o=e.XpG(2);return e.DH7(o.chartShowAvgDeliver,a)||(o.chartShowAvgDeliver=a),e.Njj(a)}),e.bIt("change",function(){e.eBV(t);const a=e.XpG(2);return e.Njj(a.triggerChangeDetection())}),e.k0s(),e.j41(111,"div",165),e.nrm(112,"div",166),e.j41(113,"span",167),e.EFF(114,"TB Giao/Ng\xe0y"),e.k0s()()()()()(),e.j41(115,"div",168)(116,"div",169)(117,"div",170)(118,"div",171),e.nrm(119,"p-chart",172),e.k0s()()()()()(),e.j41(120,"div",137)(121,"div")(122,"div",173)(123,"div",174)(124,"div",175),e.qSk(),e.j41(125,"svg",152),e.nrm(126,"path",176),e.k0s()(),e.joV(),e.j41(127,"div",177)(128,"h3",142),e.EFF(129,"Chi ti\u1ebft S\u1ea3n l\u01b0\u1ee3ng theo B\u01b0u c\u1ee5c"),e.k0s(),e.j41(130,"p",143),e.EFF(131,"Ph\xe2n t\xedch chi ti\u1ebft s\u1ea3n l\u01b0\u1ee3ng l\u1ea5y v\xe0 giao theo t\u1eebng b\u01b0u c\u1ee5c"),e.k0s()()(),e.j41(132,"div",178)(133,"div",179)(134,"div",180),e.nrm(135,"div",181),e.j41(136,"span",182),e.EFF(137,"Cao h\u01a1n TB"),e.k0s()(),e.j41(138,"div",180),e.nrm(139,"div",183),e.j41(140,"span",182),e.EFF(141,"Th\u1ea5p h\u01a1n TB"),e.k0s()()(),e.j41(142,"div",184),e.EFF(143," T\u1ed5ng: "),e.j41(144,"span",185),e.EFF(145),e.k0s(),e.EFF(146," b\u01b0u c\u1ee5c "),e.DNE(147,st,5,1,"span",186),e.k0s()()(),e.j41(148,"div",144),e.DNE(149,dt,5,0,"div",15)(150,lt,10,1,"div",187)(151,ht,10,0,"div",188),e.j41(152,"div",189)(153,"div",190)(154,"div",191)(155,"div",192)(156,"div",193),e.qSk(),e.j41(157,"svg",133),e.nrm(158,"path",194)(159,"path",195),e.k0s()(),e.joV(),e.j41(160,"div")(161,"h5",196),e.EFF(162,"T\u1ec9 l\u1ec7 L\u1ea5y/Giao"),e.k0s(),e.j41(163,"p",34),e.EFF(164,"Ph\xe2n b\u1ed5 s\u1ea3n l\u01b0\u1ee3ng"),e.k0s()()(),e.j41(165,"div",197),e.DNE(166,ct,5,0,"div",198),e.nrm(167,"canvas",199,0),e.k0s()()(),e.j41(169,"div",200)(170,"div",201)(171,"p-table",202),e.DNE(172,jt,21,5,"ng-template",203)(173,Ft,19,20,"ng-template",204)(174,It,9,3,"ng-template",205),e.k0s()()()()()()()()()}if(2&i){const t=e.XpG(2);e.R7$(9),e.Y8G("ngIf",t.loadingDemands),e.R7$(),e.Y8G("ngIf",t.demandsError&&!t.loadingDemands),e.R7$(9),e.JRh(e.bMT(20,39,t.totalPickAndDeliver)),e.R7$(10),e.JRh(e.bMT(30,41,t.totalPick)),e.R7$(10),e.JRh(e.bMT(40,43,t.totalDeliver)),e.R7$(17),e.Y8G("ngIf",t.loadingTimelineData),e.R7$(),e.Y8G("ngIf",!t.loadingTimelineData&&t.timelineDataError),e.R7$(),e.Y8G("ngIf",!t.loadingTimelineData&&!t.timelineDataError&&t.hasTimelineData),e.R7$(),e.Y8G("ngIf",!t.loadingTimelineData&&!t.timelineDataError),e.R7$(),e.Y8G("ngIf",!t.loadingTimelineData&&!t.timelineDataError&&t.availableTimelineWarehouses.length>1),e.R7$(),e.Y8G("ngIf",!t.selectedDatasetId||"demand"===t.selectedDatasetId),e.R7$(15),e.Y8G("ngClass",e.l_i(45,Q,"bar"===t.chartType,"bar"!==t.chartType)),e.R7$(4),e.Y8G("ngClass",e.l_i(48,Q,"line"===t.chartType,"line"!==t.chartType)),e.R7$(12),e.R50("ngModel",t.chartShowPick),e.R7$(6),e.R50("ngModel",t.chartShowDeliver),e.R7$(6),e.R50("ngModel",t.chartShowAvgPick),e.R7$(6),e.R50("ngModel",t.chartShowAvgDeliver),e.R7$(6),e.xc7("min-height",t.getChartHeight(),"px")("height",t.getChartHeight(),"px"),e.R7$(2),e.Y8G("ngStyle",e.eq3(51,de,t.getChartMinWidth()>100?t.getChartMinWidth()+"px":"100%")),e.R7$(),e.Y8G("type",t.getChartType())("data",t.getDemandsChartData("combined"))("options",t.chartOptions),e.R7$(26),e.JRh(t.demands.length),e.R7$(2),e.Y8G("ngIf",t.demandSearchQuery),e.R7$(2),e.Y8G("ngIf",t.loadingDemands),e.R7$(),e.Y8G("ngIf",t.demandsError&&!t.loadingDemands),e.R7$(),e.Y8G("ngIf",!t.loadingDemands&&!t.demandsError&&0===t.timelineWarehouses.length),e.R7$(15),e.Y8G("ngIf",!(t.selectedDemand||t.demands&&0!==t.demands.length)),e.R7$(),e.xc7("display",t.selectedDemand||t.demands&&0!==t.demands.length?"block":"none"),e.R7$(4),e.Y8G("value",t.filteredDemands)("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",e.lJ4(53,le))("tableStyle",e.lJ4(54,he))}}function Mt(i,n){if(1&i){const t=e.RV6();e.j41(0,"div",329)(1,"div",330)(2,"h2",124),e.qSk(),e.j41(3,"svg",262),e.nrm(4,"path",331),e.k0s(),e.joV(),e.j41(5,"span"),e.EFF(6,"Chi ti\u1ebft Dataset"),e.k0s()(),e.j41(7,"button",332),e.bIt("click",function(){e.eBV(t);const a=e.XpG(2);return e.Njj(a.closeDetails())}),e.qSk(),e.j41(8,"svg",333),e.nrm(9,"path",104),e.k0s(),e.joV(),e.j41(10,"span",334),e.EFF(11,"\u0110\xf3ng"),e.k0s()()(),e.j41(12,"div",335),e.nrm(13,"app-dataset-detail",336),e.k0s()()}if(2&i){const t=e.XpG(2);e.R7$(13),e.Y8G("datasetIdInput",t.selectedDatasetId)("embedded",!0)}}function At(i,n){if(1&i){const t=e.RV6();e.j41(0,"div",56)(1,"div",57)(2,"div",58)(3,"div",59)(4,"h2",60),e.qSk(),e.j41(5,"svg",61),e.nrm(6,"path",62),e.k0s(),e.joV(),e.j41(7,"span"),e.EFF(8,"Th\xf4ng tin"),e.k0s()(),e.j41(9,"button",63),e.bIt("click",function(){e.eBV(t);const a=e.XpG();return e.Njj(a.openSettingsModal())}),e.qSk(),e.j41(10,"svg",64),e.nrm(11,"path",65),e.k0s()()()(),e.joV(),e.j41(12,"div",66),e.DNE(13,Me,27,8,"div",67)(14,Ve,20,7,"div",68),e.k0s()(),e.j41(15,"div",69),e.DNE(16,Wt,175,55,"div",70)(17,Mt,14,2,"div",71),e.k0s()()}if(2&i){const t=e.XpG();e.R7$(13),e.Y8G("ngIf","demand"===t.selectedDatasetId),e.R7$(),e.Y8G("ngIf","demand"===t.selectedDatasetId),e.R7$(2),e.Y8G("ngIf","demand"===t.selectedDatasetId),e.R7$(),e.Y8G("ngIf",t.selectedDatasetId&&"demand"!==t.selectedDatasetId)}}function Bt(i,n){if(1&i&&(e.j41(0,"option",370),e.EFF(1),e.k0s()),2&i){const t=n.$implicit;e.Y8G("value",t.code),e.R7$(),e.Lme(" ",t.code," - ",t.name," ")}}function Gt(i,n){1&i&&(e.j41(0,"div",376)(1,"div",17),e.nrm(2,"div",377),e.j41(3,"p",378),e.EFF(4,"\u0110ang t\u1ea3i danh s\xe1ch b\u01b0u c\u1ee5c..."),e.k0s()()())}function Pt(i,n){if(1&i&&(e.j41(0,"div",379)(1,"div",115),e.qSk(),e.j41(2,"svg",380),e.nrm(3,"path",23),e.k0s(),e.joV(),e.j41(4,"span",381),e.EFF(5),e.k0s()()()),2&i){const t=e.XpG(3);e.R7$(5),e.JRh(t.modalWarehousesError)}}function $t(i,n){if(1&i){const t=e.RV6();e.j41(0,"div",382)(1,"div",21)(2,"div",383),e.EFF(3," T\u1ed5ng: "),e.j41(4,"span",384),e.EFF(5),e.k0s()(),e.nrm(6,"div",385),e.j41(7,"div",386),e.EFF(8," \u0110\xe3 ch\u1ecdn: "),e.j41(9,"span",387),e.EFF(10),e.k0s()()(),e.j41(11,"div",115)(12,"button",388),e.bIt("click",function(){e.eBV(t);const a=e.XpG(3);return e.Njj(a.selectAllWarehousesInModal())}),e.EFF(13," \u2713 T\u1ea5t c\u1ea3 "),e.k0s(),e.j41(14,"button",389),e.bIt("click",function(){e.eBV(t);const a=e.XpG(3);return e.Njj(a.deselectAllWarehousesInModal())}),e.EFF(15," \u2715 B\u1ecf ch\u1ecdn "),e.k0s()()()}if(2&i){const t=e.XpG(3);e.R7$(5),e.JRh(t.modalWarehouses.length),e.R7$(5),e.JRh(t.modalSelectedWarehouses.size),e.R7$(2),e.Y8G("disabled",t.modalSelectedWarehouses.size===t.modalWarehouses.length),e.R7$(2),e.Y8G("disabled",0===t.modalSelectedWarehouses.size)}}function Nt(i,n){if(1&i){const t=e.RV6();e.j41(0,"tr",398),e.bIt("click",function(){const a=e.eBV(t).$implicit,o=e.XpG(4);return e.Njj(o.toggleWarehouseSelection(a))}),e.j41(1,"td",399),e.bIt("click",function(a){return e.eBV(t),e.Njj(a.stopPropagation())}),e.j41(2,"input",235),e.bIt("change",function(){const a=e.eBV(t).$implicit,o=e.XpG(4);return e.Njj(o.toggleWarehouseSelection(a))}),e.k0s()(),e.j41(3,"td",400),e.EFF(4),e.k0s(),e.j41(5,"td",401)(6,"div",402),e.EFF(7),e.k0s()(),e.j41(8,"td",401)(9,"div",114),e.EFF(10),e.k0s()(),e.j41(11,"td",403),e.EFF(12),e.k0s()()}if(2&i){const t=n.$implicit,r=n.index,a=e.XpG(4);e.R7$(2),e.Y8G("checked",a.isWarehouseSelectedInModal(t)),e.R7$(2),e.JRh(r+1),e.R7$(3),e.JRh(t.warehouse_name),e.R7$(3),e.Lme("",t.district_name,", ",t.province_name,""),e.R7$(2),e.JRh(t.warehouse_id||t.id)}}function Vt(i,n){if(1&i){const t=e.RV6();e.j41(0,"div",390)(1,"table",232)(2,"thead",391)(3,"tr")(4,"th",392)(5,"input",235),e.bIt("change",function(){e.eBV(t);const a=e.XpG(3);return e.Njj(a.modalSelectedWarehouses.size===a.modalWarehouses.length?a.deselectAllWarehousesInModal():a.selectAllWarehousesInModal())}),e.k0s()(),e.j41(6,"th",393),e.EFF(7,"STT"),e.k0s(),e.j41(8,"th",394),e.EFF(9,"T\xean b\u01b0u c\u1ee5c"),e.k0s(),e.j41(10,"th",394),e.EFF(11,"\u0110\u1ecba ch\u1ec9"),e.k0s(),e.j41(12,"th",395),e.EFF(13,"ID"),e.k0s()()(),e.j41(14,"tbody",396),e.DNE(15,Nt,13,6,"tr",397),e.k0s()()()}if(2&i){const t=e.XpG(3);e.R7$(5),e.Y8G("checked",t.modalSelectedWarehouses.size===t.modalWarehouses.length&&t.modalWarehouses.length>0),e.R7$(10),e.Y8G("ngForOf",t.modalWarehouses)}}function Ot(i,n){1&i&&(e.j41(0,"div",404),e.qSk(),e.j41(1,"svg",405),e.nrm(2,"path",331),e.k0s(),e.joV(),e.j41(3,"p",406),e.EFF(4,"Kh\xf4ng c\xf3 b\u01b0u c\u1ee5c n\xe0o"),e.k0s()())}function Yt(i,n){if(1&i&&(e.j41(0,"div",363),e.DNE(1,Gt,5,0,"div",371)(2,Pt,6,1,"div",372)(3,$t,16,4,"div",373)(4,Vt,16,2,"div",374)(5,Ot,5,0,"div",375),e.k0s()),2&i){const t=e.XpG(2);e.R7$(),e.Y8G("ngIf",t.loadingModalWarehouses),e.R7$(),e.Y8G("ngIf",t.modalWarehousesError&&!t.loadingModalWarehouses),e.R7$(),e.Y8G("ngIf",!t.loadingModalWarehouses&&!t.modalWarehousesError&&t.modalWarehouses.length>0),e.R7$(),e.Y8G("ngIf",!t.loadingModalWarehouses&&!t.modalWarehousesError&&t.modalWarehouses.length>0),e.R7$(),e.Y8G("ngIf",!t.loadingModalWarehouses&&!t.modalWarehousesError&&0===t.modalWarehouses.length)}}function Xt(i,n){if(1&i&&(e.j41(0,"div",115),e.qSk(),e.j41(1,"svg",409),e.nrm(2,"path",23),e.k0s(),e.EFF(3),e.k0s()),2&i){const t=n.$implicit;e.R7$(3),e.SpI(" ",t," ")}}function Lt(i,n){if(1&i&&(e.j41(0,"div",407),e.DNE(1,Xt,4,1,"div",408),e.k0s()),2&i){const t=e.XpG(2);e.R7$(),e.Y8G("ngForOf",t.demandErrors)}}function zt(i,n){if(1&i&&(e.j41(0,"option",417),e.EFF(1),e.k0s()),2&i){const t=n.$implicit;e.Y8G("ngValue",t),e.R7$(),e.SpI("",t,":00")}}function Ht(i,n){if(1&i&&(e.j41(0,"option",417),e.EFF(1),e.k0s()),2&i){const t=n.$implicit;e.Y8G("ngValue",t),e.R7$(),e.SpI("",t,":00")}}function Kt(i,n){if(1&i){const t=e.RV6();e.j41(0,"div",410)(1,"div",411),e.EFF(2),e.k0s(),e.j41(3,"input",412),e.mxI("ngModelChange",function(a){const o=e.eBV(t).$implicit;return e.DH7(o.name,a)||(o.name=a),e.Njj(a)}),e.k0s(),e.j41(4,"select",413),e.mxI("ngModelChange",function(a){const o=e.eBV(t).$implicit;return e.DH7(o.start_hour,a)||(o.start_hour=a),e.Njj(a)}),e.DNE(5,zt,2,2,"option",414),e.k0s(),e.j41(6,"span",415),e.EFF(7,"\u2014"),e.k0s(),e.j41(8,"select",413),e.mxI("ngModelChange",function(a){const o=e.eBV(t).$implicit;return e.DH7(o.end_hour,a)||(o.end_hour=a),e.Njj(a)}),e.DNE(9,Ht,2,2,"option",414),e.k0s(),e.j41(10,"button",416),e.bIt("click",function(){const a=e.eBV(t).index,o=e.XpG(2);return e.Njj(o.removeShift(a))}),e.qSk(),e.j41(11,"svg",333),e.nrm(12,"path",104),e.k0s()()()}if(2&i){const t=n.$implicit,r=n.index,a=e.XpG(2);e.R7$(2),e.SpI(" ",r+1," "),e.R7$(),e.R50("ngModel",t.name),e.R7$(),e.R50("ngModel",t.start_hour),e.R7$(),e.Y8G("ngForOf",a.hours),e.R7$(3),e.R50("ngModel",t.end_hour),e.R7$(),e.Y8G("ngForOf",a.hoursInclusive)}}function Ut(i,n){if(1&i&&(e.j41(0,"div",115),e.qSk(),e.j41(1,"svg",409),e.nrm(2,"path",23),e.k0s(),e.EFF(3),e.k0s()),2&i){const t=n.$implicit;e.R7$(3),e.SpI(" ",t," ")}}function qt(i,n){if(1&i&&(e.j41(0,"div",407),e.DNE(1,Ut,4,1,"div",408),e.k0s()),2&i){const t=e.XpG(2);e.R7$(),e.Y8G("ngForOf",t.shiftErrors)}}function Jt(i,n){if(1&i){const t=e.RV6();e.j41(0,"div",337)(1,"div",338)(2,"div",339)(3,"div",21)(4,"div",340),e.qSk(),e.j41(5,"svg",133),e.nrm(6,"path",341),e.k0s()(),e.joV(),e.j41(7,"div")(8,"h3",342),e.EFF(9,"Th\xf4ng tin"),e.k0s(),e.j41(10,"p",343),e.EFF(11,"Ch\u1ecdn kho\u1ea3ng th\u1eddi gian v\xe0 c\u1ea5u h\xecnh ca l\xe0m vi\u1ec7c"),e.k0s()()(),e.j41(12,"button",344),e.bIt("click",function(){e.eBV(t);const a=e.XpG();return e.Njj(a.closeSettingsModal())}),e.qSk(),e.j41(13,"svg",333),e.nrm(14,"path",104),e.k0s()()(),e.joV(),e.j41(15,"div",345)(16,"div",346)(17,"div",347)(18,"div",348),e.qSk(),e.j41(19,"svg",349),e.nrm(20,"path",350),e.k0s()(),e.joV(),e.j41(21,"h4",351),e.EFF(22,"Ch\u1ecdn v\xf9ng v\xe0 b\u01b0u c\u1ee5c"),e.k0s()(),e.j41(23,"div",352)(24,"div")(25,"label",353),e.EFF(26,"V\xf9ng "),e.j41(27,"span",354),e.EFF(28,"*"),e.k0s()(),e.j41(29,"select",355),e.mxI("ngModelChange",function(a){e.eBV(t);const o=e.XpG();return e.DH7(o.modalSelectedRegion,a)||(o.modalSelectedRegion=a),e.Njj(a)}),e.bIt("change",function(){e.eBV(t);const a=e.XpG();return e.Njj(a.onModalRegionChange())}),e.j41(30,"option",356),e.EFF(31,"-- Ch\u1ecdn v\xf9ng --"),e.k0s(),e.DNE(32,Bt,2,3,"option",357),e.k0s()(),e.DNE(33,Yt,6,5,"div",358),e.k0s()(),e.j41(34,"div",346)(35,"div",347)(36,"div",348),e.qSk(),e.j41(37,"svg",349),e.nrm(38,"path",359),e.k0s()(),e.joV(),e.j41(39,"h4",351),e.EFF(40,"Kho\u1ea3ng th\u1eddi gian"),e.k0s()(),e.j41(41,"div",360)(42,"div")(43,"label",353),e.EFF(44,"T\u1eeb ng\xe0y"),e.k0s(),e.j41(45,"input",361),e.mxI("ngModelChange",function(a){e.eBV(t);const o=e.XpG();return e.DH7(o.demandStartDate,a)||(o.demandStartDate=a),e.Njj(a)}),e.bIt("ngModelChange",function(){e.eBV(t);const a=e.XpG();return e.Njj(a.onDateRangeChange())}),e.k0s()(),e.j41(46,"div")(47,"label",353),e.EFF(48,"\u0110\u1ebfn ng\xe0y"),e.k0s(),e.j41(49,"input",361),e.mxI("ngModelChange",function(a){e.eBV(t);const o=e.XpG();return e.DH7(o.demandEndDate,a)||(o.demandEndDate=a),e.Njj(a)}),e.bIt("ngModelChange",function(){e.eBV(t);const a=e.XpG();return e.Njj(a.onDateRangeChange())}),e.k0s()()(),e.DNE(50,Lt,2,1,"div",362),e.k0s(),e.j41(51,"div",346)(52,"div",347)(53,"div",348),e.qSk(),e.j41(54,"svg",349),e.nrm(55,"path",90),e.k0s()(),e.joV(),e.j41(56,"h4",351),e.EFF(57,"C\u1ea5u h\xecnh ca l\xe0m vi\u1ec7c"),e.k0s()(),e.j41(58,"div",363),e.DNE(59,Kt,13,6,"div",364),e.j41(60,"button",365),e.bIt("click",function(){e.eBV(t);const a=e.XpG();return e.Njj(a.addShift())}),e.qSk(),e.j41(61,"svg",333),e.nrm(62,"path",366),e.k0s(),e.EFF(63," Th\xeam ca l\xe0m vi\u1ec7c "),e.k0s()(),e.DNE(64,qt,2,1,"div",362),e.k0s()(),e.joV(),e.j41(65,"div",367)(66,"button",368),e.bIt("click",function(){e.eBV(t);const a=e.XpG();return e.Njj(a.closeSettingsModal())}),e.EFF(67,"H\u1ee7y"),e.k0s(),e.j41(68,"button",369),e.bIt("click",function(){e.eBV(t);const a=e.XpG();return e.Njj(a.applySettings())}),e.EFF(69,"L\u01b0u v\xe0 \xe1p d\u1ee5ng"),e.k0s()()()()}if(2&i){const t=e.XpG();e.R7$(29),e.R50("ngModel",t.modalSelectedRegion),e.R7$(3),e.Y8G("ngForOf",t.availableRegions),e.R7$(),e.Y8G("ngIf",t.modalSelectedRegion),e.R7$(12),e.R50("ngModel",t.demandStartDate),e.R7$(4),e.R50("ngModel",t.demandEndDate),e.R7$(),e.Y8G("ngIf",t.demandErrors&&t.demandErrors.length),e.R7$(9),e.Y8G("ngForOf",t.shifts),e.R7$(5),e.Y8G("ngIf",t.shiftErrors&&t.shiftErrors.length)}}let Qt=(()=>{class i{datasetService;router;cdr;platformId;state={size:12,offset:0,total:0,q:"",type:"",viewMode:"grid"};datasets=[];loading=!1;error=null;warehouses=[];loadingWarehouses=!1;warehousesError=null;warehouseSearchQuery="";warehousePageSize=10;warehouseCurrentPage=1;warehouseTotal=0;warehouseSearchSubject=new M.B;datasetSearchSubject=new M.B;warehouseSuggestions=[];warehouseAutoLoading=!1;warehouseAutoCompleteSubject=new M.B;warehouseAutoSub=null;warehouseRegionShortname="HNO";availableRegions=[{code:"HNO",name:"H\xe0 N\u1ed9i"},{code:"HCM",name:"H\u1ed3 Ch\xed Minh"},{code:"HPG",name:"H\u1ea3i Ph\xf2ng"},{code:"DAD",name:"\u0110\xe0 N\u1eb5ng"},{code:"CXR",name:"C\u1ea7n Th\u01a1"},{code:"HAN",name:"H\xe0 Nam"},{code:"VPC",name:"V\u0129nh Ph\xfac"},{code:"HPH",name:"H\u1ea3i Ph\xf2ng"},{code:"QNH",name:"Qu\u1ea3ng Ninh"},{code:"BNH",name:"B\u1eafc Ninh"}];get pagedWarehouses(){if(!this.warehouses)return[];const t=(this.warehouseCurrentPage-1)*this.warehousePageSize;return this.warehouses.slice(t,t+this.warehousePageSize)}updateCharts(){if(this.destroyCharts(),this.demands&&0!==this.demands.length||this.shiftRatios&&0!==this.shiftRatios.length){try{if(this.demandSummaryCanvas&&this.demandSummaryCanvas.nativeElement){const t=this.demandSummaryCanvas.nativeElement.getContext("2d");if(t){let r=0,a=0,o=[];if(this.selectedDemand?(r=this.selectedDemand.total_pick||0,a=this.selectedDemand.total_deliver||0,o=["T\u1ed5ng L\u1ea5y","T\u1ed5ng Giao"]):(r=this.demands.reduce((d,s)=>d+(s.total_pick||0),0),a=this.demands.reduce((d,s)=>d+(s.total_deliver||0),0),o=["T\u1ed5ng L\u1ea5y","T\u1ed5ng Giao"]),this.demandSummaryChart)try{this.demandSummaryChart.destroy()}catch(d){console.error("[Dataset] Error destroying existing summary chart",d)}this.demandSummaryChart=new W.A(t,{type:"doughnut",data:{labels:o,datasets:[{label:"T\u1ec9 l\u1ec7 L\u1ea5y/Giao",data:[r,a],backgroundColor:["rgba(249, 115, 22, 0.9)","rgba(0, 0, 0, 0.8)"],borderColor:["rgba(255, 255, 255, 1)","rgba(255, 255, 255, 1)"],borderWidth:3}]},options:{responsive:!1,maintainAspectRatio:!1,aspectRatio:void 0,plugins:{legend:{position:"bottom",labels:{font:{size:12,weight:"bold"},padding:15,usePointStyle:!0}},tooltip:{callbacks:{label:d=>{const s=d.label||"",h=d.parsed||0,l=r+a,c=l>0?(h/l*100).toFixed(1):"0";return`${s}: ${new Intl.NumberFormat("vi-VN").format(h)} (${c}%)`}}}},animation:{onComplete:()=>{const d=this.demandSummaryChart;if(!d)return;const s=d.ctx,h=d.chartArea,l=(h.left+h.right)/2,c=(h.top+h.bottom)/2;d.data.datasets.forEach(_=>{d.getDatasetMeta(0).data.forEach((D,p)=>{const u=D,y=_.data[p],b=_.data.reduce((x,C)=>x+C,0),w=b>0?(y/b*100).toFixed(1):"0",T=(u.startAngle+u.endAngle)/2,R=u.innerRadius+(u.outerRadius-u.innerRadius)/2,J=l+Math.cos(T)*R,S=c+Math.sin(T)*R;s.save(),s.font="bold 18px Arial",s.fillStyle="#ffffff",s.textAlign="center",s.textBaseline="middle",s.shadowColor="rgba(0, 0, 0, 0.7)",s.shadowBlur=4,s.shadowOffsetX=1,s.shadowOffsetY=1,s.fillText(`${w}%`,J,S),s.restore()})})}}}})}}}catch(t){console.error("[Dataset] Error creating demand summary chart",t)}try{let t=[],r=[],a=[];if(!(this.shiftRatios&&this.shiftRatios.length>0))return;if(t=this.shiftRatios.map(d=>d.shift_name||d.shift?.name||"Ca"),r=this.shiftRatios.map(d=>d.total_pick||0),a=this.shiftRatios.map(d=>d.pick_ratio?100*d.pick_ratio:0),!this.demandPickupTimeCanvas||!this.demandPickupTimeCanvas.nativeElement)return void console.warn("[Dataset] Pickup canvas not available");const o=this.demandPickupTimeCanvas.nativeElement.getContext("2d");if(o){if(this.demandPickupTimeChart)try{this.demandPickupTimeChart.destroy()}catch(s){console.error("[Dataset] Error destroying existing pickup chart",s)}const d=["rgba(249, 115, 22, 0.9)","rgba(251, 146, 60, 0.9)","rgba(234, 88, 12, 0.9)","rgba(194, 65, 12, 0.9)"];this.demandPickupTimeChart=new W.A(o,{type:"polarArea",data:{labels:t,datasets:[{label:"T\u1ed5ng L\u1ea5y (kg)",data:r,backgroundColor:t.map((s,h)=>d[h%d.length]),borderColor:"#ffffff",borderWidth:3}]},options:{responsive:!1,maintainAspectRatio:!1,aspectRatio:void 0,plugins:{legend:{position:"bottom",labels:{font:{size:12,weight:"bold"},padding:15,usePointStyle:!0}},tooltip:{callbacks:{label:s=>{const l=s.parsed||0,_=a[s.dataIndex]||0;return`${s.label||""}: ${new Intl.NumberFormat("vi-VN").format(l)} kg (${_.toFixed(1)}%)`}}}},scales:{r:{beginAtZero:!0,grid:{color:"rgba(0, 0, 0, 0.15)",lineWidth:1},pointLabels:{font:{size:12,weight:"bold"},color:"rgba(0, 0, 0, 0.8)",padding:8},ticks:{display:!0,stepSize:void 0,font:{size:10,weight:"normal"},color:"rgba(0, 0, 0, 0.6)",backdropColor:"rgba(255, 255, 255, 0.9)",backdropPadding:4,z:1,callback:function(s){return s>=1e6?(s/1e6).toFixed(1)+"M":s>=1e3?(s/1e3).toFixed(1)+"K":s.toString()}},angleLines:{display:!0,color:"rgba(0, 0, 0, 0.1)",lineWidth:1}}},animation:{onComplete:()=>{const s=this.demandPickupTimeChart;if(!s)return;const h=s.ctx,l=s.chartArea,c=(l.left+l.right)/2,_=(l.top+l.bottom)/2;s.getDatasetMeta(0).data.forEach((D,p)=>{const y=a[p]||0,b=(D.startAngle+D.endAngle)/2,w=.6*D.outerRadius,T=c+Math.cos(b)*w,R=_+Math.sin(b)*w;h.save(),h.font="bold 16px Arial",h.fillStyle="#ffffff",h.textAlign="center",h.textBaseline="middle",h.shadowColor="rgba(0, 0, 0, 0.7)",h.shadowBlur=4,h.shadowOffsetX=1,h.shadowOffsetY=1,h.fillText(`${y.toFixed(1)}%`,T,R),h.restore()})}}}})}else console.warn("[Dataset] Cannot get 2d context from pickup canvas")}catch(t){console.error("[Dataset] Error creating pickup time chart",t)}try{let t=[],r=[],a=[];if(!(this.shiftRatios&&this.shiftRatios.length>0))return void console.log("[Dataset] No data for delivery chart - shiftRatios:",this.shiftRatios?.length);if(t=this.shiftRatios.map(d=>d.shift_name||d.shift?.name||"Ca"),r=this.shiftRatios.map(d=>d.total_deliver||0),a=this.shiftRatios.map(d=>d.deliver_ratio?100*d.deliver_ratio:0),console.log("[Dataset] Creating delivery chart with labels:",t,"data:",r),!this.demandDeliveryTimeCanvas||!this.demandDeliveryTimeCanvas.nativeElement)return void console.warn("[Dataset] Delivery canvas not available");const o=this.demandDeliveryTimeCanvas.nativeElement.getContext("2d");if(o){if(this.demandDeliveryTimeChart)try{this.demandDeliveryTimeChart.destroy()}catch(s){console.error("[Dataset] Error destroying existing delivery chart",s)}const d=["rgba(75, 85, 99, 0.9)","rgba(107, 114, 128, 0.9)","rgba(55, 65, 81, 0.9)","rgba(107, 114, 128, 0.9)"];this.demandDeliveryTimeChart=new W.A(o,{type:"polarArea",data:{labels:t,datasets:[{label:"T\u1ed5ng Giao (kg)",data:r,backgroundColor:t.map((s,h)=>d[h%d.length]),borderColor:"#ffffff",borderWidth:3}]},options:{responsive:!1,maintainAspectRatio:!1,aspectRatio:void 0,plugins:{legend:{position:"bottom",labels:{font:{size:12,weight:"bold"},padding:15,usePointStyle:!0}},tooltip:{callbacks:{label:s=>{const l=s.parsed||0,_=a[s.dataIndex]||0;return`${s.label||""}: ${new Intl.NumberFormat("vi-VN").format(l)} kg (${_.toFixed(1)}%)`}}}},scales:{r:{beginAtZero:!0,grid:{color:"rgba(0, 0, 0, 0.15)",lineWidth:1},pointLabels:{font:{size:12,weight:"bold"},color:"rgba(0, 0, 0, 0.8)",padding:8},ticks:{display:!0,stepSize:void 0,font:{size:10,weight:"normal"},color:"rgba(0, 0, 0, 0.6)",backdropColor:"rgba(255, 255, 255, 0.9)",backdropPadding:4,z:1,callback:function(s){return s>=1e6?(s/1e6).toFixed(1)+"M":s>=1e3?(s/1e3).toFixed(1)+"K":s.toString()}},angleLines:{display:!0,color:"rgba(0, 0, 0, 0.1)",lineWidth:1}}},animation:{onComplete:()=>{const s=this.demandDeliveryTimeChart;if(!s)return;const h=s.ctx,l=s.chartArea,c=(l.left+l.right)/2,_=(l.top+l.bottom)/2;s.getDatasetMeta(0).data.forEach((D,p)=>{const y=a[p]||0,b=(D.startAngle+D.endAngle)/2,w=.6*D.outerRadius,T=c+Math.cos(b)*w,R=_+Math.sin(b)*w;h.save(),h.font="bold 16px Arial",h.fillStyle="#ffffff",h.textAlign="center",h.textBaseline="middle",h.shadowColor="rgba(0, 0, 0, 0.7)",h.shadowBlur=4,h.shadowOffsetX=1,h.shadowOffsetY=1,h.fillText(`${y.toFixed(1)}%`,T,R),h.restore()})}}}})}else console.warn("[Dataset] Cannot get 2d context from delivery canvas")}catch(t){console.error("[Dataset] Error creating delivery time chart",t)}this.chartsInitialized=!0}}destroyCharts(){try{if(this.demandSummaryChart){try{this.demandSummaryChart.destroy()}catch{}this.demandSummaryChart=null}if(this.demandPickupTimeChart){try{this.demandPickupTimeChart.destroy()}catch{}this.demandPickupTimeChart=null}if(this.demandDeliveryTimeChart){try{this.demandDeliveryTimeChart.destroy()}catch{}this.demandDeliveryTimeChart=null}if(this.demandTimelineAreaChart){try{this.demandTimelineAreaChart.destroy()}catch{}this.demandTimelineAreaChart=null}this.chartsInitialized=!1}catch(t){console.error("[Dataset] destroyCharts error",t)}}datasetDetails=null;loadingDetails=!1;detailsError=null;selectedWarehouse=null;selectedDemand=null;selectedDatasetId=null;demands=[];loadingDemands=!1;demandsError=null;demandSearchQuery="";demandSortField=null;demandSortOrder="desc";demandStartDate="";demandEndDate="";showSettingsModal=!1;loadingShiftRatio=!1;shiftRatioError=null;shiftRatios=[];showRegionSelectionModal=!1;modalSelectedRegion="";modalWarehouses=[];modalSelectedWarehouses=new Set;loadingModalWarehouses=!1;modalWarehousesError=null;regionRatios=[];loadingTimelineData=!1;timelineDataError=null;demandsByDays={};timelineChartType="column";selectedTimelineWarehouseIds=[];showTimelineAverage=!0;timelineWarehousePageSize=10;timelineWarehouseCurrentPage=1;get hasTimelineData(){return this.demandsByDays&&Object.keys(this.demandsByDays).length>0}get availableTimelineWarehouses(){const t=new Map;return Object.values(this.demandsByDays).forEach(r=>{Array.isArray(r)&&r.forEach(a=>{if(a&&a.warehouse_id){const o=String(a.warehouse_id);t.has(o)||t.set(o,{id:o,warehouse_id:a.warehouse_id,warehouse_name:a.warehouse_name||`Warehouse ${o}`})}})}),Array.from(t.values())}get timelineWarehouseTotalPages(){return Math.ceil(this.availableTimelineWarehouses.length/this.timelineWarehousePageSize)}get paginatedAvailableTimelineWarehouses(){const t=(this.timelineWarehouseCurrentPage-1)*this.timelineWarehousePageSize;return this.availableTimelineWarehouses.slice(t,t+this.timelineWarehousePageSize)}getTimelineWarehousePageStart(){return(this.timelineWarehouseCurrentPage-1)*this.timelineWarehousePageSize+1}getTimelineWarehousePageEnd(){return Math.min(this.timelineWarehouseCurrentPage*this.timelineWarehousePageSize,this.availableTimelineWarehouses.length)}goToTimelineWarehousePreviousPage(){this.timelineWarehouseCurrentPage>1&&(this.timelineWarehouseCurrentPage--,this.cdr.markForCheck())}goToTimelineWarehouseNextPage(){this.timelineWarehouseCurrentPage<this.timelineWarehouseTotalPages&&(this.timelineWarehouseCurrentPage++,this.cdr.markForCheck())}chartShowPick=!0;chartShowDeliver=!0;chartShowAvgPick=!0;chartShowAvgDeliver=!0;chartSize="large";chartType="bar";timelineWarehouses=[];timelinePageSize=10;timelineCurrentPage=1;get timelineTotalPages(){return Math.ceil(this.timelineWarehouses.length/this.timelinePageSize)}get paginatedTimelineWarehouses(){const t=(this.timelineCurrentPage-1)*this.timelinePageSize;return this.timelineWarehouses.slice(t,t+this.timelinePageSize)}getTimelinePageStart(){return(this.timelineCurrentPage-1)*this.timelinePageSize+1}getTimelinePageEnd(){return Math.min(this.timelineCurrentPage*this.timelinePageSize,this.timelineWarehouses.length)}goToTimelinePreviousPage(){this.timelineCurrentPage>1&&(this.timelineCurrentPage--,this.cdr.markForCheck())}goToTimelineNextPage(){this.timelineCurrentPage<this.timelineTotalPages&&(this.timelineCurrentPage++,this.cdr.markForCheck())}shifts=[{name:"s\xe1ng",start_hour:6,end_hour:10},{name:"tr\u01b0a",start_hour:10,end_hour:14},{name:"chi\u1ec1u",start_hour:14,end_hour:18},{name:"t\u1ed1i",start_hour:18,end_hour:22}];shiftErrors=[];hours=Array.from({length:24},(t,r)=>r);hoursInclusive=Array.from({length:25},(t,r)=>r);demandSummaryCanvas;demandPickupTimeCanvas;demandDeliveryTimeCanvas;demandTimelineAreaCanvas;demandSummaryChart=null;demandPickupTimeChart=null;demandDeliveryTimeChart=null;demandTimelineAreaChart=null;chartsInitialized=!1;warehouseIcons={hub:'<svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <defs>\n        <filter id="hubShadow" x="-50%" y="-50%" width="200%" height="200%">\n          <feDropShadow dx="0" dy="2" stdDeviation="3" flood-opacity="0.4"/>\n        </filter>\n        <linearGradient id="hubGradient" x1="0%" y1="0%" x2="100%" y2="100%">\n          <stop offset="0%" style="stop-color:#818cf8;stop-opacity:1" />\n          <stop offset="100%" style="stop-color:#4f46e5;stop-opacity:1" />\n        </linearGradient>\n        <radialGradient id="hubShine" cx="35%" cy="35%">\n          <stop offset="0%" style="stop-color:white;stop-opacity:0.4" />\n          <stop offset="100%" style="stop-color:white;stop-opacity:0" />\n        </radialGradient>\n      </defs>\n      <circle cx="20" cy="20" r="18" fill="url(#hubGradient)" filter="url(#hubShadow)"/>\n      <circle cx="20" cy="20" r="18" fill="url(#hubShine)"/>\n      <circle cx="20" cy="20" r="16" fill="none" stroke="white" stroke-width="2" opacity="0.5"/>\n      <path d="M13 11h14v16h-14z" fill="white" opacity="0.95" rx="2"/>\n      <path d="M15 18h10v8h-10z" fill="#4f46e5" opacity="0.8"/>\n      <circle cx="20" cy="20" r="2.5" fill="white"/>\n    </svg>',sorting:'<svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <defs>\n        <filter id="sortingShadow" x="-50%" y="-50%" width="200%" height="200%">\n          <feDropShadow dx="0" dy="2" stdDeviation="3" flood-opacity="0.4"/>\n        </filter>\n        <linearGradient id="sortingGradient" x1="0%" y1="0%" x2="100%" y2="100%">\n          <stop offset="0%" style="stop-color:#60a5fa;stop-opacity:1" />\n          <stop offset="100%" style="stop-color:#2563eb;stop-opacity:1" />\n        </linearGradient>\n        <radialGradient id="sortingShine" cx="35%" cy="35%">\n          <stop offset="0%" style="stop-color:white;stop-opacity:0.4" />\n          <stop offset="100%" style="stop-color:white;stop-opacity:0" />\n        </radialGradient>\n      </defs>\n      <circle cx="20" cy="20" r="18" fill="url(#sortingGradient)" filter="url(#sortingShadow)"/>\n      <circle cx="20" cy="20" r="18" fill="url(#sortingShine)"/>\n      <circle cx="20" cy="20" r="16" fill="none" stroke="white" stroke-width="2" opacity="0.5"/>\n      <rect x="11" y="12" width="18" height="12" rx="2" fill="white" opacity="0.95"/>\n      <rect x="13" y="14" width="14" height="8" fill="#2563eb" opacity="0.8" rx="1"/>\n      <circle cx="20" cy="20" r="1.5" fill="white"/>\n    </svg>',delivery:'<svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <defs>\n        <filter id="deliveryShadow" x="-50%" y="-50%" width="200%" height="200%">\n          <feDropShadow dx="0" dy="2" stdDeviation="3" flood-opacity="0.4"/>\n        </filter>\n        <linearGradient id="deliveryGradient" x1="0%" y1="0%" x2="100%" y2="100%">\n          <stop offset="0%" style="stop-color:#34d399;stop-opacity:1" />\n          <stop offset="100%" style="stop-color:#059669;stop-opacity:1" />\n        </linearGradient>\n        <radialGradient id="deliveryShine" cx="35%" cy="35%">\n          <stop offset="0%" style="stop-color:white;stop-opacity:0.4" />\n          <stop offset="100%" style="stop-color:white;stop-opacity:0" />\n        </radialGradient>\n      </defs>\n      <circle cx="20" cy="20" r="18" fill="url(#deliveryGradient)" filter="url(#deliveryShadow)"/>\n      <circle cx="20" cy="20" r="18" fill="url(#deliveryShine)"/>\n      <circle cx="20" cy="20" r="16" fill="none" stroke="white" stroke-width="2" opacity="0.5"/>\n      <path d="M11 20h18l-2.5-8h-13l-2.5 8z" fill="white" opacity="0.95"/>\n      <circle cx="14" cy="26" r="2.5" fill="white"/>\n      <circle cx="26" cy="26" r="2.5" fill="white"/>\n      <path d="M20 10v6" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>\n    </svg>',transit:'<svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <defs>\n        <filter id="transitShadow" x="-50%" y="-50%" width="200%" height="200%">\n          <feDropShadow dx="0" dy="2" stdDeviation="3" flood-opacity="0.4"/>\n        </filter>\n        <linearGradient id="transitGradient" x1="0%" y1="0%" x2="100%" y2="100%">\n          <stop offset="0%" style="stop-color:#fbbf24;stop-opacity:1" />\n          <stop offset="100%" style="stop-color:#d97706;stop-opacity:1" />\n        </linearGradient>\n        <radialGradient id="transitShine" cx="35%" cy="35%">\n          <stop offset="0%" style="stop-color:white;stop-opacity:0.4" />\n          <stop offset="100%" style="stop-color:white;stop-opacity:0" />\n        </radialGradient>\n      </defs>\n      <circle cx="20" cy="20" r="18" fill="url(#transitGradient)" filter="url(#transitShadow)"/>\n      <circle cx="20" cy="20" r="18" fill="url(#transitShine)"/>\n      <circle cx="20" cy="20" r="16" fill="none" stroke="white" stroke-width="2" opacity="0.5"/>\n      <rect x="12" y="12" width="16" height="12" rx="2" fill="white" opacity="0.95"/>\n      <rect x="14" y="15" width="12" height="8" fill="#d97706" opacity="0.8" rx="1"/>\n      <circle cx="20" cy="20" r="2" fill="white"/>\n    </svg>',ktc:'<svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <defs>\n        <filter id="ktcShadow" x="-50%" y="-50%" width="200%" height="200%">\n          <feDropShadow dx="0" dy="2" stdDeviation="3" flood-opacity="0.4"/>\n        </filter>\n        <linearGradient id="ktcGradient" x1="0%" y1="0%" x2="100%" y2="100%">\n          <stop offset="0%" style="stop-color:#c084fc;stop-opacity:1" />\n          <stop offset="100%" style="stop-color:#7c3aed;stop-opacity:1" />\n        </linearGradient>\n        <radialGradient id="ktcShine" cx="35%" cy="35%">\n          <stop offset="0%" style="stop-color:white;stop-opacity:0.4" />\n          <stop offset="100%" style="stop-color:white;stop-opacity:0" />\n        </radialGradient>\n      </defs>\n      <circle cx="20" cy="20" r="18" fill="url(#ktcGradient)" filter="url(#ktcShadow)"/>\n      <circle cx="20" cy="20" r="18" fill="url(#ktcShine)"/>\n      <circle cx="20" cy="20" r="16" fill="none" stroke="white" stroke-width="2" opacity="0.5"/>\n      <rect x="11" y="13" width="18" height="12" rx="2" fill="white" opacity="0.95"/>\n      <text x="20" y="23" text-anchor="middle" fill="#7c3aed" font-size="10" font-weight="bold" font-family="Arial">KTC</text>\n    </svg>',kct:'<svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <defs>\n        <filter id="kctShadow" x="-50%" y="-50%" width="200%" height="200%">\n          <feDropShadow dx="0" dy="2" stdDeviation="3" flood-opacity="0.4"/>\n        </filter>\n        <linearGradient id="kctGradient" x1="0%" y1="0%" x2="100%" y2="100%">\n          <stop offset="0%" style="stop-color:#f472b6;stop-opacity:1" />\n          <stop offset="100%" style="stop-color:#ec4899;stop-opacity:1" />\n        </linearGradient>\n        <radialGradient id="kctShine" cx="35%" cy="35%">\n          <stop offset="0%" style="stop-color:white;stop-opacity:0.4" />\n          <stop offset="100%" style="stop-color:white;stop-opacity:0" />\n        </radialGradient>\n      </defs>\n      <circle cx="20" cy="20" r="18" fill="url(#kctGradient)" filter="url(#kctShadow)"/>\n      <circle cx="20" cy="20" r="18" fill="url(#kctShine)"/>\n      <circle cx="20" cy="20" r="16" fill="none" stroke="white" stroke-width="2" opacity="0.5"/>\n      <rect x="11" y="13" width="18" height="12" rx="2" fill="white" opacity="0.95"/>\n      <text x="20" y="23" text-anchor="middle" fill="#ec4899" font-size="10" font-weight="bold" font-family="Arial">KCT</text>\n    </svg>',default:'<svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <defs>\n        <filter id="defaultShadow" x="-50%" y="-50%" width="200%" height="200%">\n          <feDropShadow dx="0" dy="2" stdDeviation="3" flood-opacity="0.4"/>\n        </filter>\n        <linearGradient id="defaultGradient" x1="0%" y1="0%" x2="100%" y2="100%">\n          <stop offset="0%" style="stop-color:#9ca3af;stop-opacity:1" />\n          <stop offset="100%" style="stop-color:#6b7280;stop-opacity:1" />\n        </linearGradient>\n        <radialGradient id="defaultShine" cx="35%" cy="35%">\n          <stop offset="0%" style="stop-color:white;stop-opacity:0.4" />\n          <stop offset="100%" style="stop-color:white;stop-opacity:0" />\n        </radialGradient>\n      </defs>\n      <circle cx="20" cy="20" r="18" fill="url(#defaultGradient)" filter="url(#defaultShadow)"/>\n      <circle cx="20" cy="20" r="18" fill="url(#defaultShine)"/>\n      <circle cx="20" cy="20" r="16" fill="none" stroke="white" stroke-width="2" opacity="0.5"/>\n      <rect x="12" y="12" width="16" height="14" rx="2" fill="white" opacity="0.9"/>\n      <circle cx="20" cy="20" r="3" fill="#6b7280"/>\n    </svg>'};selectWarehouse(t){this.selectedWarehouse=t,this.cdr.markForCheck()}addToTimeline(t){this.timelineWarehouses.find(r=>(r.warehouse_id||r.id)===(t.warehouse_id||t.id))||(this.timelineWarehouses.push(t),this.cdr.markForCheck(),this.loadDatasets(),"demand"===this.selectedDatasetId&&this.loadDemands(),this.validateShifts()&&this.runShiftsQuery())}addAllToTimeline(){let t=0;for(const r of this.warehouses)this.timelineWarehouses.find(a=>(a.warehouse_id||a.id)===(r.warehouse_id||r.id))||(this.timelineWarehouses.push(r),t++);t>0&&(this.cdr.markForCheck(),this.loadDatasets(),"demand"===this.selectedDatasetId&&(this.loadDemands(),this.timelineWarehouses.length>0&&(this.loadShiftRatios(),this.loadDemandsByDays())),console.log(`[Dataset] Added ${t} warehouses to timeline`))}removeFromTimeline(t){const r=this.timelineWarehouses.findIndex(a=>(a.warehouse_id||a.id)===(t.warehouse_id||t.id));if(r>-1){this.timelineWarehouses.splice(r,1);const a=Math.ceil(this.timelineWarehouses.length/this.timelinePageSize);this.timelineCurrentPage>a&&(this.timelineCurrentPage=a||1),this.cdr.markForCheck(),this.loadDatasets(),"demand"===this.selectedDatasetId&&this.loadDemands(),this.timelineWarehouses.length>0&&this.validateShifts()&&this.runShiftsQuery(),this.timelineWarehouses.length>0&&this.loadDemandsByDays()}}isInTimeline(t){return this.timelineWarehouses.some(r=>(r.warehouse_id||r.id)===(t.warehouse_id||t.id))}isWarehouseSelected(t){return!(!t||!this.selectedWarehouse)&&(t.warehouse_id||t.id)===(this.selectedWarehouse.warehouse_id||this.selectedWarehouse.id)}typeConfig={truck:{color:"orange",bgLight:"bg-orange-50",bgDark:"bg-orange-100",border:"border-orange-200",text:"text-orange-700",textDark:"text-orange-900",badge:"bg-orange-500",icon:'<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16V6a1 1 0 00-1-1H4a1 1 0 00-1 1v10a1 1 0 001 1h1m8-1a1 1 0 01-1 1H9m4-1V8a1 1 0 011-1h2.586a1 1 0 01.707.293l3.414 3.414a1 1 0 01.293.707V16a1 1 0 01-1 1h-1m-6-1a1 1 0 001 1h1M5 17a2 2 0 104 0m-4 0a2 2 0 114 0m6 0a2 2 0 104 0m-4 0a2 2 0 114 0"></path></svg>'},demand:{color:"orange",bgLight:"bg-orange-50",bgDark:"bg-orange-100",border:"border-orange-200",text:"text-orange-700",textDark:"text-orange-900",badge:"bg-orange-500",icon:'<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg>'},trip:{color:"orange",bgLight:"bg-orange-50",bgDark:"bg-orange-100",border:"border-orange-200",text:"text-orange-700",textDark:"text-orange-900",badge:"bg-orange-500",icon:'<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"></path></svg>'},hub:{color:"orange",bgLight:"bg-orange-50",bgDark:"bg-orange-100",border:"border-orange-200",text:"text-orange-700",textDark:"text-orange-900",badge:"bg-orange-500",icon:'<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path></svg>'},default:{color:"gray",bgLight:"bg-gray-50",bgDark:"bg-gray-100",border:"border-gray-200",text:"text-gray-700",textDark:"text-gray-900",badge:"bg-gray-500",icon:'<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"></path></svg>'}};constructor(t,r,a,o){this.datasetService=t,this.router=r,this.cdr=a,this.platformId=o}ngOnDestroy(){if(this.warehouseSearchSubject.unsubscribe(),this.warehouseAutoSub&&this.warehouseAutoSub.unsubscribe)try{this.warehouseAutoSub.unsubscribe()}catch{}this.dateChangeTimeout&&(clearTimeout(this.dateChangeTimeout),this.dateChangeTimeout=null)}ngOnInit(){this.selectedDatasetId=null;const{start:t,end:r}=this.getDefaultDateRange();this.demandStartDate=t,this.demandEndDate=r,this.warehouseRegionShortname="HNO",this.loadDatasets(),this.cdr.markForCheck(),console.log("[Dataset] ngOnInit - selectedDatasetId:",this.selectedDatasetId,"loading:",this.loading),this.warehouseSearchSubject.pipe((0,P.B)(300),(0,A.F)()).subscribe(a=>{this.warehouseSearchQuery=a,this.warehouseCurrentPage=1,this.loadWarehouses()}),this.datasetSearchSubject.pipe((0,P.B)(300),(0,A.F)()).subscribe(a=>{this.state.q=a,this.state.offset=0,this.loadDatasets()}),this.warehouseAutoSub=this.warehouseAutoCompleteSubject.pipe((0,P.B)(300),(0,A.F)(),(0,g.n)(a=>!a||a.length<1?(0,O.of)([]):(this.warehouseAutoLoading=!0,this.datasetService.getWarehouses({region_shortname:this.warehouseRegionShortname,size:5,search:a}).pipe((0,B.T)(o=>{this.warehouseAutoLoading=!1;const d=o;return Array.isArray(d.data)?d.data:d.data?.data||[]}),(0,f.W)(o=>(console.error("[Dataset] warehouse autocomplete error",o),this.warehouseAutoLoading=!1,(0,O.of)([]))))))).subscribe(a=>{this.warehouseSuggestions=(a||[]).slice(0,5),this.cdr.markForCheck()})}ngAfterViewInit(){var t=this;return(0,I.A)(function*(){yield new Promise(r=>setTimeout(r,100)),null!==t.selectedDatasetId&&(console.warn("[Dataset] ngAfterViewInit - selectedDatasetId was set to:",t.selectedDatasetId,"resetting to null"),t.selectedDatasetId=null),t.cdr.markForCheck()})()}loadWarehouses(){this.loadingWarehouses=!0,this.warehousesError=null,this.datasetService.getWarehouses({region_shortname:this.warehouseRegionShortname,size:this.warehousePageSize,offset:(this.warehouseCurrentPage-1)*this.warehousePageSize,search:this.warehouseSearchQuery||""}).subscribe({next:r=>{if(console.log("[Dataset] Warehouses API Response:",r),r.ok&&r.data){const a=r,o=Array.isArray(a.data)?a.data:a.data?.data||[];this.warehouses=o||[],this.warehouseTotal=Array.isArray(a.data)?a.data.length:a.data?.meta?.total||this.warehouses.length,console.log("[Dataset] Loaded warehouses:",this.warehouses.length);const d=this.pagedWarehouses&&this.pagedWarehouses.length>0?this.pagedWarehouses[0]:this.warehouses[0]||null;!this.selectedWarehouse&&d&&(this.selectedWarehouse=d)}else this.warehousesError="Failed to load warehouses",console.error("[Dataset] Invalid warehouses response:",r);this.loadingWarehouses=!1,this.cdr.markForCheck()},error:r=>{this.warehousesError=r.message||"Failed to load warehouses",this.loadingWarehouses=!1,console.error("[Dataset] Load warehouses error:",r),this.cdr.markForCheck()}})}openDetails(t){!t||!t.id||(this.datasetDetails=null,this.loadingDetails=!0,this.detailsError=null,this.datasetService.getDataset(t.id).subscribe({next:r=>{r.ok&&r.data?this.datasetDetails=r.data.data||r.data:(this.detailsError="Kh\xf4ng th\u1ec3 t\u1ea3i chi ti\u1ebft Data Product",console.error("[Dataset] getDataset invalid response:",r)),this.loadingDetails=!1,this.cdr.markForCheck()},error:r=>{this.detailsError=r?.message||"L\u1ed7i khi t\u1ea3i chi ti\u1ebft",this.loadingDetails=!1,this.cdr.markForCheck(),console.error("[Dataset] getDataset error:",r)}}))}closeDetails(){this.datasetDetails=null,this.detailsError=null,this.loadingDetails=!1,this.selectedDatasetId=null,this.demands=[],this.demandsError=null,this.loadingDemands=!1,this.chartsInitialized=!1,this.destroyCharts()}getTypeConfig(t){return this.typeConfig[t]||this.typeConfig.default}trackByDatasetId(t,r){return r.id}loadDatasets(){this.loading=!0,this.error=null,this.datasetService.getDatasets({size:this.state.size,offset:this.state.offset,q:this.state.q||void 0,type:this.state.type||void 0}).subscribe({next:r=>{console.log("[Dataset] API Response:",r),console.log("[Dataset] Response data:",r.data),r.ok&&r.data?(this.datasets=r.data.data||[],this.state.total=r.data.meta?.total||0,console.log("[Dataset] Loaded datasets:",this.datasets.length),console.log("[Dataset] selectedDatasetId:",this.selectedDatasetId,"should show list:",!this.selectedDatasetId)):(this.error="Failed to load datasets",console.error("[Dataset] Invalid response:",r)),this.loading=!1,this.cdr.markForCheck()},error:r=>{this.error=r.message||"Failed to load datasets",this.loading=!1,console.error("[Dataset] Load error:",r),this.cdr.markForCheck()}})}onSearch(){this.state.offset=0,this.loadDatasets()}onTypeFilter(t){this.state.type=t,this.state.offset=0,this.loadDatasets()}onPageChange(t){this.state.offset=(t-1)*this.state.size,this.loadDatasets()}toggleViewMode(){this.state.viewMode="grid"===this.state.viewMode?"table":"grid"}getQualityColor(t){return t>=80?"text-green-600":t>=60?"text-yellow-600":"text-red-600"}escapeHtml(t){const r=document.createElement("div");return r.textContent=t,r.innerHTML}createDataset(){this.router.navigate(["/dataset-form"])}viewDataset(t){"demand"===t.type?(this.selectedDatasetId="demand",this.loadDemands(),this.loadShiftRatios(),this.loadDemandsByDays()):this.selectedDatasetId=t.id,this.cdr.markForCheck()}viewDemandDataset(){this.selectedDatasetId="demand",this.loadDemands(),this.loadShiftRatios(),this.loadDemandsByDays(),this.cdr.markForCheck()}getRegionName(t){const r=this.availableRegions.find(a=>a.code===t);return r?r.name:t}getFormattedShifts(){return this.shifts&&0!==this.shifts.length?this.shifts.map(t=>{const r=String(Math.floor(t.start_hour)).padStart(2,"0"),a=String(Math.floor(t.end_hour)).padStart(2,"0");return`${t.name||"Ca"} (${r}:00 - ${a}:00)`}).join(", "):"-"}formatShiftTime(t){return`${String(Math.floor(t.start_hour)).padStart(2,"0")}:00 - ${String(Math.floor(t.end_hour)).padStart(2,"0")}:00`}onInfoTableRegionChange(){this.cdr.markForCheck()}addAllWarehousesFromRegion(){this.warehouseRegionShortname&&(this.loadingWarehouses=!0,this.warehousesError=null,this.datasetService.getWarehouses({region_shortname:this.warehouseRegionShortname,size:1e3,offset:0,search:""}).subscribe({next:r=>{try{const a=r,d=(Array.isArray(a.data)?a.data:a.data?.data||[])||[];let s=0;for(const h of d)this.isInTimeline(h)||(this.timelineWarehouses.push(h),s++);console.log(`[Dataset] Added ${s} warehouses from region ${this.warehouseRegionShortname}`),"demand"===this.selectedDatasetId&&s>0&&(this.loadDemands(),this.loadShiftRatios(),this.loadDemandsByDays())}catch(a){console.error("[Dataset] addAllWarehousesFromRegion error",a),this.warehousesError="L\u1ed7i khi t\u1ea3i danh s\xe1ch b\u01b0u c\u1ee5c"}this.loadingWarehouses=!1,this.cdr.markForCheck()},error:r=>{console.error("[Dataset] addAllWarehousesFromRegion error",r),this.warehousesError=r.message||"L\u1ed7i khi t\u1ea3i danh s\xe1ch b\u01b0u c\u1ee5c",this.loadingWarehouses=!1,this.cdr.markForCheck()}}))}openRegionSelectionModal(){this.showRegionSelectionModal=!0,this.modalSelectedRegion=this.warehouseRegionShortname||"",this.modalSelectedWarehouses.clear(),this.modalWarehouses=[],this.modalWarehousesError=null,this.modalSelectedRegion&&this.loadWarehousesForModal(),this.cdr.markForCheck()}closeRegionSelectionModal(){this.showRegionSelectionModal=!1,this.modalSelectedWarehouses.clear(),this.modalWarehouses=[],this.modalWarehousesError=null,this.cdr.markForCheck()}onModalRegionChange(){this.modalSelectedWarehouses.clear(),this.modalWarehouses=[],this.modalWarehousesError=null,this.modalSelectedRegion&&this.loadWarehousesForModal(),this.cdr.markForCheck()}loadWarehousesForModal(){this.modalSelectedRegion&&(this.loadingModalWarehouses=!0,this.modalWarehousesError=null,this.datasetService.getWarehouses({region_shortname:this.modalSelectedRegion,size:1e3,offset:0,search:""}).subscribe({next:r=>{try{const a=r,o=Array.isArray(a.data)?a.data:a.data?.data||[];this.modalWarehouses=o||[],this.modalSelectedWarehouses.clear();for(const d of this.modalWarehouses){const s=(d.warehouse_id||d.id)?.toString();s&&this.isInTimeline(d)&&this.modalSelectedWarehouses.add(s)}}catch(a){console.error("[Dataset] loadWarehousesForModal error",a),this.modalWarehousesError="L\u1ed7i khi t\u1ea3i danh s\xe1ch b\u01b0u c\u1ee5c"}this.loadingModalWarehouses=!1,this.cdr.markForCheck()},error:r=>{console.error("[Dataset] loadWarehousesForModal error",r),this.modalWarehousesError=r.message||"L\u1ed7i khi t\u1ea3i danh s\xe1ch b\u01b0u c\u1ee5c",this.loadingModalWarehouses=!1,this.cdr.markForCheck()}}))}toggleWarehouseSelection(t){const r=(t.warehouse_id||t.id)?.toString();r&&(this.modalSelectedWarehouses.has(r)?this.modalSelectedWarehouses.delete(r):this.modalSelectedWarehouses.add(r),this.cdr.markForCheck())}isWarehouseSelectedInModal(t){const r=(t.warehouse_id||t.id)?.toString();return!!r&&this.modalSelectedWarehouses.has(r)}selectAllWarehousesInModal(){this.modalSelectedWarehouses.clear();for(const t of this.modalWarehouses){const r=(t.warehouse_id||t.id)?.toString();r&&this.modalSelectedWarehouses.add(r)}this.cdr.markForCheck()}deselectAllWarehousesInModal(){this.modalSelectedWarehouses.clear(),this.cdr.markForCheck()}confirmModalSelection(){if(!this.modalSelectedRegion||0===this.modalSelectedWarehouses.size)return void console.warn("[Dataset] No region or warehouses selected");this.modalSelectedRegion!==this.warehouseRegionShortname&&(this.warehouseRegionShortname=this.modalSelectedRegion);const r=[];for(const d of this.timelineWarehouses){const s=(d.warehouse_id||d.id)?.toString();s&&this.modalWarehouses.some(l=>(l.warehouse_id||l.id)?.toString()===s)&&!this.modalSelectedWarehouses.has(s)&&r.push(d)}for(const d of r){const s=this.timelineWarehouses.findIndex(h=>(h.warehouse_id||h.id)?.toString()===(d.warehouse_id||d.id)?.toString());s>-1&&this.timelineWarehouses.splice(s,1)}let a=0;for(const d of this.modalWarehouses){const s=(d.warehouse_id||d.id)?.toString();s&&this.modalSelectedWarehouses.has(s)&&(this.isInTimeline(d)||(this.timelineWarehouses.push(d),a++))}console.log(`[Dataset] Updated timeline: ${a} added, ${r.length} removed, ${this.timelineWarehouses.length} total`),console.log(`[Dataset] confirmModalSelection - selectedDatasetId: ${this.selectedDatasetId}`);const o=Math.ceil(this.timelineWarehouses.length/this.timelinePageSize);this.timelineCurrentPage>o&&(this.timelineCurrentPage=o||1),"demand"===this.selectedDatasetId&&(this.loadDemands(),this.loadShiftRatios(),this.loadDemandsByDays()),this.cdr.markForCheck()}clearAllPoints(){this.timelineWarehouses=[],this.timelineCurrentPage=1,this.demands=[],this.demandsError=null,this.loadingDemands=!1,this.chartsInitialized=!1,this.destroyCharts(),this.cdr.markForCheck()}useDataset(t){console.log("Using dataset:",t),this.router.navigate(["/datasets",t.id])}trackByWarehouseId(t,r){return r.warehouse_id?.toString()||t.toString()}products(){return this.warehouses||[]}get totalPickAndDeliver(){return this.demands&&0!==this.demands.length?this.demands.reduce((t,r)=>t+(r.total_pick||0)+(r.total_deliver||0),0):0}get totalPick(){return this.demands&&0!==this.demands.length?this.demands.reduce((t,r)=>t+(r.total_pick||0),0):0}get totalDeliver(){return this.demands&&0!==this.demands.length?this.demands.reduce((t,r)=>t+(r.total_deliver||0),0):0}get filteredDemands(){let t=[...this.demands||[]];if(this.demandSearchQuery&&this.demandSearchQuery.trim()){const r=this.demandSearchQuery.toLowerCase().trim();t=t.filter(a=>(a.warehouse_name||"").toLowerCase().includes(r)||(a.warehouse_id?.toString()||"").includes(r))}return this.demandSortField&&t.sort((r,a)=>{let o=r[this.demandSortField],d=a[this.demandSortField];return null==o&&(o=0),null==d&&(d=0),"asc"===this.demandSortOrder?o>d?1:o<d?-1:0:o<d?1:o>d?-1:0}),t}sortDemands(t){this.demandSortField===t?this.demandSortOrder="asc"===this.demandSortOrder?"desc":"asc":(this.demandSortField=t,this.demandSortOrder="desc"),this.cdr.markForCheck()}triggerChangeDetection(){this.cdr.markForCheck()}clearSearch(){this.demandSearchQuery="",this.cdr.markForCheck()}get chartWidth(){return 100}get chartHeight(){return 650}getChartType(){return this.chartType}getDefaultDateRange(){return{start:"2025-12-01",end:"2025-12-14"}}openSettingsModal(){const{start:t,end:r}=this.getDefaultDateRange();this.demandStartDate=this.demandStartDate||t,this.demandEndDate=this.demandEndDate||r,this.modalSelectedRegion=this.warehouseRegionShortname||"",this.modalSelectedWarehouses.clear(),this.modalWarehouses=[],this.modalWarehousesError=null,this.modalSelectedRegion&&this.loadWarehousesForModal(),this.showSettingsModal=!0,this.shiftErrors=[],this.demandErrors=[],this.cdr.markForCheck()}closeSettingsModal(){this.showSettingsModal=!1,this.modalSelectedWarehouses.clear(),this.modalWarehouses=[],this.modalWarehousesError=null,this.cdr.markForCheck()}applySettings(){var t=this;return(0,I.A)(function*(){if(t.modalSelectedRegion&&t.modalSelectedWarehouses.size>0?t.confirmModalSelection():t.modalSelectedRegion&&t.modalSelectedRegion!==t.warehouseRegionShortname&&(t.warehouseRegionShortname=t.modalSelectedRegion),!t.validateShifts())return t.shiftErrors=t.shiftErrors.length?t.shiftErrors:["C\u1ea5u h\xecnh ca ch\u01b0a h\u1ee3p l\u1ec7"],void t.cdr.markForCheck();const{start:r,end:a}=t.getDefaultDateRange();t.demandStartDate=t.demandStartDate||r,t.demandEndDate=t.demandEndDate||a,t.closeSettingsModal(),t.loadDemands(),t.loadShiftRatios()})()}loadShiftRatios(){const t=new Date,r=t.toISOString(),a=new Date(t.getTime()-6048e5).toISOString(),o=this.demandStartDate?new Date(this.demandStartDate+"T00:00:00.000Z").toISOString():a,d=this.demandEndDate?new Date(this.demandEndDate+"T23:59:59.999Z").toISOString():r;let s=this.warehouseRegionShortname;if(this.timelineWarehouses&&this.timelineWarehouses.length>0){const l=this.timelineWarehouses[0];l.region_shortname&&(s=l.region_shortname)}this.loadingShiftRatio=!0,this.shiftRatioError=null;const h={region_shortname:s,shifts:this.shifts.map(l=>({name:l.name,start_hour:Number(l.start_hour),end_hour:Number(l.end_hour)})),time_range:{start:o,end:d}};console.log("[Dataset] Calling getDemandsShiftRatio with payload:",h),this.datasetService.getDemandsShiftRatio(h).subscribe({next:l=>{console.log("[Dataset] Raw shift ratio response:",l);let c=l;l&&"object"==typeof l&&("ok"in l&&l.ok&&"data"in l?(c=l.data,c&&"object"==typeof c&&"code"in c&&"data"in c&&(c=c.data)):"code"in l&&"data"in l?c=l.data:"data"in l?(c=l.data,c&&"object"==typeof c&&"data"in c&&(c=c.data)):Array.isArray(l)&&(c=l)),console.log("[Dataset] Extracted data after parsing:",c);const _=Array.isArray(c)?c:[];this.shiftRatios=_.map(v=>({shift_name:v.shift?.name||v.shift_name||"",shift:v.shift||{name:v.shift_name||""},pick_ratio:v.pick_ratio||0,deliver_ratio:v.deliver_ratio||0,total_pick:v.total_pick||0,total_deliver:v.total_deliver||0,avg_pick_per_day:v.avg_pick_per_day||0,avg_deliver_per_day:v.avg_deliver_per_day||0,active_days:v.active_days||0})),this.loadingShiftRatio=!1,this.shiftRatioError=null,console.log("[Dataset] Parsed shift ratios:",this.shiftRatios),console.log("[Dataset] shiftRatios length:",this.shiftRatios?.length),this.cdr.markForCheck(),this.chartsInitialized=!1,this.cdr.markForCheck(),setTimeout(()=>{this.shiftRatios&&this.shiftRatios.length>0?(console.log("[Dataset] Attempting to update charts, pickup canvas:",!!this.demandPickupTimeCanvas?.nativeElement,"delivery canvas:",!!this.demandDeliveryTimeCanvas?.nativeElement),this.demandPickupTimeCanvas?.nativeElement&&this.demandDeliveryTimeCanvas?.nativeElement?(console.log("[Dataset] Both canvases available, calling updateCharts()"),this.updateCharts(),this.cdr.markForCheck()):(console.log("[Dataset] Canvas not ready, waiting 200ms more"),setTimeout(()=>{this.demandPickupTimeCanvas?.nativeElement&&this.demandDeliveryTimeCanvas?.nativeElement?(console.log("[Dataset] Canvas ready after wait, calling updateCharts()"),this.updateCharts()):console.warn("[Dataset] Canvas still not available after wait"),this.cdr.markForCheck()},200))):console.log("[Dataset] No shiftRatios data, skipping chart update")},300)},error:l=>{this.shiftRatioError=l?.message||"L\u1ed7i khi t\u1ea3i t\u1ec9 l\u1ec7 ca",this.loadingShiftRatio=!1,console.error("[Dataset] Error loading shift ratios:",l),this.cdr.markForCheck()}})}loadDemandsByDays(){if(!this.timelineWarehouses||0===this.timelineWarehouses.length)return void console.log("[Dataset] No timeline warehouses selected, skipping demands by days");const t=this.timelineWarehouses.map(l=>l.warehouse_id||l.id).map(l=>Number(l)).filter(l=>!isNaN(l));if(0===t.length)return void console.log("[Dataset] No valid warehouse IDs, skipping demands by days");const r=new Date,a=r.toISOString(),o=new Date(r.getTime()-25056e5).toISOString(),d=this.demandStartDate?new Date(this.demandStartDate+"T00:00:00").toISOString():o,s=this.demandEndDate?new Date(this.demandEndDate+"T23:59:59").toISOString():a;this.loadingTimelineData=!0,this.timelineDataError=null,this.cdr.markForCheck();const h={warehouse_ids:t,time_range:{start:d,end:s}};console.log("[Dataset] Loading demands by days with payload:",h),this.datasetService.getDemandsByDays(h).subscribe({next:l=>{console.log("[Dataset] Demands by days response:",l);let c=l;l&&"object"==typeof l&&("ok"in l&&l.ok&&"data"in l?(c=l.data,c&&"object"==typeof c&&"code"in c&&"data"in c&&(c=c.data)):"code"in l&&"data"in l?c=l.data:"data"in l&&(c=l.data,c&&"object"==typeof c&&"code"in c&&"data"in c&&(c=c.data))),(!c||"object"!=typeof c||Array.isArray(c))&&(console.warn("[Dataset] Invalid data format, using empty object"),c={}),this.demandsByDays=c,this.loadingTimelineData=!1,this.timelineDataError=null,console.log("[Dataset] Parsed demands by days:",this.demandsByDays),console.log("[Dataset] Number of dates:",Object.keys(this.demandsByDays).length),console.log("[Dataset] Sample dates:",Object.keys(this.demandsByDays).slice(0,5)),this.cdr.markForCheck();const _=(v=0)=>{if(!(v>5))return this.demandTimelineAreaCanvas&&this.demandTimelineAreaCanvas.nativeElement?(console.log("[Dataset] Canvas ready, rendering timeline chart..."),this.renderTimelineAreaChart(),void this.cdr.markForCheck()):(console.log(`[Dataset] Canvas not ready, attempt ${v+1}, retrying...`),void setTimeout(()=>_(v+1),200));console.error("[Dataset] Failed to render timeline chart after 5 attempts")};setTimeout(()=>_(),100)},error:l=>{this.timelineDataError=l?.message||"L\u1ed7i khi t\u1ea3i d\u1eef li\u1ec7u timeline",this.loadingTimelineData=!1,console.error("[Dataset] Error loading demands by days:",l),this.cdr.markForCheck()}})}renderTimelineAreaChart(){if(console.log("[Dataset] renderTimelineAreaChart called"),console.log("[Dataset] Canvas element:",!!this.demandTimelineAreaCanvas?.nativeElement),console.log("[Dataset] demandsByDays:",this.demandsByDays),!this.demandTimelineAreaCanvas||!this.demandTimelineAreaCanvas.nativeElement)return void console.warn("[Dataset] Timeline area canvas not available");const t=Object.keys(this.demandsByDays).sort(),r=t.filter(p=>{const u=this.demandsByDays[p];return Array.isArray(u)&&u.length>0}),a=t;console.log("[Dataset] Dates found with data:",r.length),console.log("[Dataset] All dates in demandsByDays:",t.length),console.log("[Dataset] Dates to render (all dates):",a.length),console.log("[Dataset] Sample dates:",a.slice(0,5),"...",a.slice(-5)),0===a.length&&(console.log("[Dataset] No dates found, creating empty chart with default data"),a.push((new Date).toISOString().split("T")[0]));const o=p=>this.selectedTimelineWarehouseIds&&0!==this.selectedTimelineWarehouseIds.length?p.filter(u=>{const y=String(u?.warehouse_id||"");return this.selectedTimelineWarehouseIds.includes(y)}):p,d=[],s=[],h=[],l=[];a.forEach(p=>{const u=this.demandsByDays[p];let y=[];Array.isArray(u)?y=u:u&&"object"==typeof u&&null!==u?y=[u]:(null==u||console.warn(`[Dataset] Unexpected dayData type for date ${p}:`,typeof u,u),y=[]);const b=o(y),w=b.reduce((S,x)=>{const C=x&&"object"==typeof x&&x.total_pick?Number(x.total_pick):0;return S+(isNaN(C)?0:C)},0),T=b.reduce((S,x)=>{const C=x&&"object"==typeof x&&x.total_deliver?Number(x.total_deliver):0;return S+(isNaN(C)?0:C)},0),R=b.length>0?b.reduce((S,x)=>{const C=x&&"object"==typeof x&&x.avg_pick_per_day?Number(x.avg_pick_per_day):0;return S+(isNaN(C)?0:C)},0)/b.length:0,J=b.length>0?b.reduce((S,x)=>{const C=x&&"object"==typeof x&&x.avg_deliver_per_day?Number(x.avg_deliver_per_day):0;return S+(isNaN(C)?0:C)},0)/b.length:0;d.push(w),s.push(T),h.push(R),l.push(J)});const c=a.map(p=>new Date(p).toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"})),_=this.demandTimelineAreaCanvas.nativeElement.getContext("2d");if(!_)return void console.error("[Dataset] Could not get 2d context for timeline area chart");if(this.demandTimelineAreaChart)try{this.demandTimelineAreaChart.destroy()}catch(p){console.error("[Dataset] Error destroying existing timeline area chart",p)}console.log("[Dataset] Creating chart with labels:",c.length,"pickData:",d.length,"deliverData:",s.length),console.log("[Dataset] Chart type:",this.timelineChartType),console.log("[Dataset] Selected warehouses:",this.selectedTimelineWarehouseIds.length),console.log("[Dataset] Sample pickData:",d.slice(0,5)),console.log("[Dataset] Sample deliverData:",s.slice(0,5)),!d.some(p=>p>0)&&!s.some(p=>p>0)&&a.length>0&&console.log("[Dataset] No data values found, rendering empty chart");const D=[];"column"===this.timelineChartType?(D.push({type:"bar",label:"T\u1ed5ng L\u1ea5y (kg)",data:d,backgroundColor:"rgba(249, 115, 22, 0.8)",borderColor:"rgba(249, 115, 22, 1)",borderWidth:1}),D.push({type:"bar",label:"T\u1ed5ng Giao (kg)",data:s,backgroundColor:"rgba(0, 0, 0, 0.8)",borderColor:"rgba(0, 0, 0, 1)",borderWidth:1}),this.showTimelineAverage&&(D.push({type:"line",label:"Trung b\xecnh L\u1ea5y (kg)",data:h,borderColor:"rgba(249, 115, 22, 0.6)",backgroundColor:"transparent",borderWidth:2,borderDash:[5,5],pointRadius:0,pointHoverRadius:4,fill:!1,tension:.4}),D.push({type:"line",label:"Trung b\xecnh Giao (kg)",data:l,borderColor:"rgba(0, 0, 0, 0.6)",backgroundColor:"transparent",borderWidth:2,borderDash:[5,5],pointRadius:0,pointHoverRadius:4,fill:!1,tension:.4}))):(D.push({type:"line",label:"T\u1ed5ng L\u1ea5y (kg)",data:d,borderColor:"rgba(249, 115, 22, 1)",backgroundColor:"rgba(249, 115, 22, 0.2)",fill:!0,tension:.4,pointRadius:3,pointHoverRadius:5,pointBackgroundColor:"rgba(249, 115, 22, 1)",pointBorderColor:"#ffffff",pointBorderWidth:2}),D.push({type:"line",label:"T\u1ed5ng Giao (kg)",data:s,borderColor:"rgba(0, 0, 0, 1)",backgroundColor:"rgba(0, 0, 0, 0.2)",fill:!0,tension:.4,pointRadius:3,pointHoverRadius:5,pointBackgroundColor:"rgba(0, 0, 0, 1)",pointBorderColor:"#ffffff",pointBorderWidth:2}),this.showTimelineAverage&&(D.push({type:"line",label:"Trung b\xecnh L\u1ea5y (kg)",data:h,borderColor:"rgba(249, 115, 22, 0.6)",backgroundColor:"transparent",borderWidth:2,borderDash:[5,5],pointRadius:0,pointHoverRadius:4,fill:!1,tension:.4}),D.push({type:"line",label:"Trung b\xecnh Giao (kg)",data:l,borderColor:"rgba(0, 0, 0, 0.6)",backgroundColor:"transparent",borderWidth:2,borderDash:[5,5],pointRadius:0,pointHoverRadius:4,fill:!1,tension:.4})));try{this.demandTimelineAreaChart=new W.A(_,{type:"column"===this.timelineChartType?"bar":"line",data:{labels:c,datasets:D},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"top",labels:{usePointStyle:!0,padding:15,font:{size:12,weight:"bold"}}},tooltip:{mode:"index",intersect:!1,callbacks:{label:p=>`${p.dataset.label||""}: ${(p.parsed.y||0).toLocaleString("vi-VN")} kg`}}},scales:"column"===this.timelineChartType?{x:{stacked:!1,display:!0,title:{display:!0,text:"Ng\xe0y",font:{size:12,weight:"bold"}},grid:{display:!0,color:"rgba(0, 0, 0, 0.05)"},ticks:{maxRotation:45,minRotation:45,font:{size:10}}},y:{stacked:!1,display:!0,title:{display:!0,text:"S\u1ea3n l\u01b0\u1ee3ng (kg)",font:{size:12,weight:"bold"}},beginAtZero:!0,grid:{display:!0,color:"rgba(0, 0, 0, 0.05)"},ticks:{callback:p=>p.toLocaleString("vi-VN")+" kg"}}}:{x:{display:!0,title:{display:!0,text:"Ng\xe0y",font:{size:12,weight:"bold"}},grid:{display:!0,color:"rgba(0, 0, 0, 0.05)"},ticks:{maxRotation:45,minRotation:45,font:{size:10}}},y:{display:!0,title:{display:!0,text:"S\u1ea3n l\u01b0\u1ee3ng (kg)",font:{size:12,weight:"bold"}},beginAtZero:!0,grid:{display:!0,color:"rgba(0, 0, 0, 0.05)"},ticks:{callback:p=>p.toLocaleString("vi-VN")+" kg"}}},interaction:{mode:"nearest",axis:"x",intersect:!1}}}),console.log("[Dataset] Timeline area chart created successfully")}catch(p){console.error("[Dataset] Error creating timeline area chart:",p),console.error("[Dataset] Error details:",p)}}updateTimelineChart(){this.demandTimelineAreaCanvas?.nativeElement&&(this.renderTimelineAreaChart(),this.cdr.markForCheck())}toggleTimelineWarehouse(t){const r=this.selectedTimelineWarehouseIds.indexOf(t);r>-1?this.selectedTimelineWarehouseIds.splice(r,1):this.selectedTimelineWarehouseIds.push(t),this.updateTimelineChart()}selectAllTimelineWarehouses(){this.selectedTimelineWarehouseIds=this.availableTimelineWarehouses.map(t=>String(t.warehouse_id||t.id)),this.updateTimelineChart()}deselectAllTimelineWarehouses(){this.selectedTimelineWarehouseIds=[],this.updateTimelineChart()}toString(t){return String(t||"")}onDateRangeChange(){console.log("[Dataset] Date range changed, reloading timeline chart"),console.log("[Dataset] demandStartDate:",this.demandStartDate,"demandEndDate:",this.demandEndDate),this.timelineWarehouses&&this.timelineWarehouses.length>0&&(this.dateChangeTimeout&&clearTimeout(this.dateChangeTimeout),this.dateChangeTimeout=setTimeout(()=>{this.loadDemandsByDays()},500))}dateChangeTimeout=null;calculateRegionRatios(){if(!this.demands||0===this.demands.length)return void(this.regionRatios=[]);const t=new Map;for(const o of this.demands){const d=this.timelineWarehouses.find(c=>c.warehouse_id?.toString()===o.warehouse_id?.toString()),s=d?.region_shortname||"Unknown",h=d?.region_fullname||s;t.has(s)||t.set(s,{total_pick:0,total_deliver:0,warehouse_count:0,region_fullname:h});const l=t.get(s);l.total_pick+=o.total_pick||0,l.total_deliver+=o.total_deliver||0,l.warehouse_count+=1}const r=Array.from(t.values()).reduce((o,d)=>o+d.total_pick,0),a=Array.from(t.values()).reduce((o,d)=>o+d.total_deliver,0);this.regionRatios=Array.from(t.entries()).map(([o,d])=>({region_shortname:o,region_fullname:d.region_fullname,total_pick:d.total_pick,total_deliver:d.total_deliver,warehouse_count:d.warehouse_count,pick_percentage:r>0?d.total_pick/r*100:0,deliver_percentage:a>0?d.total_deliver/a*100:0})).sort((o,d)=>d.total_pick-o.total_pick),this.cdr.markForCheck()}getAverage(t){return this.demands&&0!==this.demands.length?this.demands.reduce((a,o)=>a+(o[t]||0),0)/this.demands.length:0}isAboveAverage(t,r){return t>this.getAverage(r)}isBelowAverage(t,r){return t<this.getAverage(r)}selectDemand(t){this.selectedDemand=t,this.cdr.markForCheck(),this.updateCharts(),setTimeout(()=>{this.updateCharts()},100)}isDemandSelected(t){return!(!this.selectedDemand||!t)&&(this.selectedDemand.warehouse_id||this.selectedDemand.id)===(t.warehouse_id||t.id)}getSeverity(t){switch((t?.warehouse_type||t?.type||"").toString().toLowerCase()){case"hub":default:return"info";case"sorting":return"success";case"delivery":return"warning";case"transit":return"danger"}}viewWarehouse(t){const r=t?.warehouse_id||t?.id;if(r)try{this.router.navigate(["/warehouses",r])}catch{console.log("[Dataset] viewWarehouse:",r)}}getWarehouseTypeBadgeClass(t){switch(t?.toLowerCase()){case"hub":return"bg-indigo-100 text-indigo-800";case"sorting":return"bg-blue-100 text-blue-800";case"delivery":return"bg-green-100 text-green-800";case"transit":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}}onWarehouseSearch(){this.warehouseCurrentPage=1,this.loadWarehouses()}onWarehouseSearchInput(t){this.warehouseSearchSubject.next(t),this.warehouseAutoCompleteSubject.next(t)}onWarehouseAutoComplete(t){this.warehouseAutoCompleteSubject.next(t&&t.query?t.query:t||"")}onWarehouseAutoSelect(t){const r=t;r&&(this.warehouseSearchQuery=r.warehouse_name||"",this.warehouseSuggestions=[],this.selectWarehouse(r),this.addToTimeline(r),this.cdr.markForCheck())}onWarehouseResultClick(t){t&&(this.warehouseSearchQuery=t.warehouse_name||"",this.warehouseSuggestions=[],this.selectWarehouse(t),this.addToTimeline(t),this.cdr.markForCheck())}onSearchInput(t){this.datasetSearchSubject.next(t)}onStrategicSuggestion(t){if("demand"===t)return this.state.type="demand",this.selectedDatasetId="demand",this.demands=[],this.demandsError=null,this.loadingDemands=!1,this.loadDemands(),this.loadShiftRatios(),this.loadDemandsByDays(),void this.cdr.markForCheck();this.selectedDatasetId=null,this.state.type=t,this.state.offset=0,this.loadDatasets()}onStrategicWarehouseSearch(t){const r=this.availableRegions.find(a=>a.name===t);r&&(this.warehouseRegionShortname=r.code,this.warehouseCurrentPage=1,this.loadWarehouses())}loadDemands(){if(0===this.timelineWarehouses.length)return console.log("[Dataset] loadDemands: No warehouses in timeline, skipping"),this.loadingDemands=!1,this.demands=[],this.regionRatios=[],void this.cdr.markForCheck();console.log("[Dataset] loadDemands: Starting, timelineWarehouses.length:",this.timelineWarehouses.length),this.loadingDemands=!0,this.demandsError=null,this.cdr.markForCheck();const t=this.timelineWarehouses.map(l=>l.warehouse_id||l.id).map(l=>Number(l)).filter(l=>!isNaN(l)),r=new Date,a=r.toISOString().slice(0,10),o=new Date(r.getTime()-25056e5).toISOString().slice(0,10),h={warehouse_ids:t,time_range:{start:this.demandStartDate||o,end:this.demandEndDate||a}};console.log("[Dataset] loadDemands: Starting with payload:",h),this.datasetService.getDemandsWithTimeRange(h).subscribe({next:l=>{console.log("[Dataset] getDemandsWithTimeRange response:",l);try{let c=[];if(l&&"object"==typeof l)if("ok"in l&&l.ok&&"data"in l){const _=l.data;c=Array.isArray(_)?_:_&&(_.data||_)||[]}else if(Array.isArray(l))c=l;else if("data"in l){const _=l.data;c=Array.isArray(_)?_:[]}else c=[];else Array.isArray(l)&&(c=l);console.log("[Dataset] Parsed demands data:",c),this.demands=c,this.demandsError=null,!this.selectedDemand&&c.length>0&&(this.selectedDemand=c[0],setTimeout(()=>{this.updateCharts()},100)),this.calculateRegionRatios(),c.length>0&&(this.chartsInitialized=!1,setTimeout(()=>{this.updateCharts(),this.cdr.markForCheck()},100))}catch(c){console.error("[Dataset] Error parsing demands response:",c),this.demandsError="L\u1ed7i khi x\u1eed l\xfd d\u1eef li\u1ec7u demands",this.demands=[],this.regionRatios=[]}this.loadingDemands=!1,this.cdr.markForCheck(),console.log("[Dataset] loadDemands completed. loadingDemands:",this.loadingDemands,"demands.length:",this.demands.length)},error:l=>{console.error("[Dataset] getDemandsWithTimeRange error:",l),this.demandsError=l?.message||"L\u1ed7i khi t\u1ea3i demands",this.demands=[],this.regionRatios=[],this.loadingDemands=!1,this.cdr.markForCheck()}})}addShift(){this.shifts.push({name:"ca m\u1edbi",start_hour:0,end_hour:1})}removeShift(t){t>=0&&t<this.shifts.length&&this.shifts.splice(t,1)}loadDefaultShifts(){this.shifts=[{name:"s\xe1ng",start_hour:6,end_hour:10},{name:"tr\u01b0a",start_hour:10,end_hour:14},{name:"chi\u1ec1u",start_hour:14,end_hour:18},{name:"t\u1ed1i",start_hour:18,end_hour:22}],this.timelineWarehouses&&this.timelineWarehouses.length>0&&this.validateShifts()&&this.runShiftsQuery()}validateShifts(){return this.shiftErrors=[],this.shifts.forEach((t,r)=>{t.start_hour>=t.end_hour&&this.shiftErrors.push(`Ca "${t.name||r+1}": gi\u1edd b\u1eaft \u0111\u1ea7u ph\u1ea3i nh\u1ecf h\u01a1n gi\u1edd k\u1ebft th\xfac.`),(t.start_hour<0||t.start_hour>23||t.end_hour<1||t.end_hour>24)&&this.shiftErrors.push(`Ca "${t.name||r+1}": gi\u1edd kh\xf4ng h\u1ee3p l\u1ec7 (0-23/1-24).`)}),(!this.timelineWarehouses||0===this.timelineWarehouses.length)&&this.shiftErrors.push("Vui l\xf2ng ch\u1ecdn \xedt nh\u1ea5t 1 b\u01b0u c\u1ee5c trong Timeline."),0===this.shiftErrors.length}buildShiftsPayload(){const t=this.timelineWarehouses.map(h=>h.warehouse_id||h.id).map(h=>Number(h)).filter(h=>!isNaN(h)),r=new Date,a=r.toISOString().slice(0,10),o=new Date(r.getTime()-25056e5).toISOString().slice(0,10),d=this.demandStartDate||o,s=this.demandEndDate||a;return{region_shortname:this.warehouseRegionShortname,warehouse_ids:t,shifts:this.shifts.map(h=>({name:h.name,start_hour:Math.floor(h.start_hour),end_hour:Math.floor(h.end_hour)})),time_range:{start:d,end:s}}}runShiftsQuery(){if(!this.validateShifts())return void this.cdr.markForCheck();const t=this.buildShiftsPayload();console.log("[Dataset] Calling getDemandsShiftRatio with payload:",t),this.datasetService.getDemandsShiftRatio(t).subscribe({next:r=>{if(r.ok&&r.data){const a=r.data,o=Array.isArray(a)?a:a&&(a.data||a);this.demands=o||[],setTimeout(()=>this.updateCharts(),50),console.log("[Dataset] Received shift ratio response",o)}else this.shiftErrors.push("Kh\xf4ng th\u1ec3 l\u1ea5y d\u1eef li\u1ec7u theo ca"),console.error("[Dataset] runShiftsQuery invalid response:",r);this.cdr.markForCheck()},error:r=>{this.shiftErrors.push(r?.message||"L\u1ed7i khi l\u1ea5y d\u1eef li\u1ec7u theo ca"),console.error("[Dataset] runShiftsQuery error:",r),this.cdr.markForCheck()}})}demandErrors=[];validateDemandRange(){return this.demandErrors=[],(!this.timelineWarehouses||0===this.timelineWarehouses.length)&&this.demandErrors.push("Vui l\xf2ng ch\u1ecdn \xedt nh\u1ea5t 1 b\u01b0u c\u1ee5c trong Timeline."),(!this.demandStartDate||!this.demandEndDate)&&this.demandErrors.push("Vui l\xf2ng ch\u1ecdn t\u1eeb ng\xe0y v\xe0 \u0111\u1ebfn ng\xe0y."),this.demandStartDate&&this.demandEndDate&&this.demandStartDate>this.demandEndDate&&this.demandErrors.push('"T\u1eeb ng\xe0y" ph\u1ea3i nh\u1ecf h\u01a1n ho\u1eb7c b\u1eb1ng "\u0110\u1ebfn ng\xe0y".'),0===this.demandErrors.length}buildDemandsPayload(){return{warehouse_ids:this.timelineWarehouses.map(r=>r.warehouse_id||r.id).map(r=>Number(r)).filter(r=>!isNaN(r)),time_range:{start:this.demandStartDate||"",end:this.demandEndDate||""}}}applyDemandFilter(){if(this.demandErrors=[],!this.validateDemandRange())return void this.cdr.markForCheck();const t=this.buildDemandsPayload();console.log("[Dataset] Calling getDemandsWithTimeRange with payload:",t),this.loadingDemands=!0,this.datasetService.getDemandsWithTimeRange(t).subscribe({next:r=>{if(r.ok&&r.data){const a=r.data,o=Array.isArray(a)?a:a&&(a.data||a);this.demands=o||[],this.calculateRegionRatios(),this.loadShiftRatios(),this.loadDemandsByDays(),setTimeout(()=>this.updateCharts(),50)}else this.demandErrors.push("Kh\xf4ng th\u1ec3 t\u1ea3i d\u1eef li\u1ec7u S\u1ea3n l\u01b0\u1ee3ng"),console.error("[Dataset] applyDemandFilter invalid response:",r);this.loadingDemands=!1,this.cdr.markForCheck()},error:r=>{this.demandErrors.push(r?.message||"L\u1ed7i khi t\u1ea3i s\u1ea3n l\u01b0\u1ee3ng"),this.loadingDemands=!1,console.error("[Dataset] applyDemandFilter error:",r),this.cdr.markForCheck()}})}onWarehouseRegionChange(t){this.warehouseRegionShortname=t,this.warehouseCurrentPage=1,this.loadingWarehouses=!0,this.warehousesError=null,this.datasetService.getWarehouses({region_shortname:this.warehouseRegionShortname,size:1e3,offset:0,search:""}).subscribe({next:a=>{try{const o=a,d=Array.isArray(o.data)?o.data:o.data?.data||[];this.warehouses=d||[],this.warehouseTotal=Array.isArray(o.data)?o.data.length:o.data?.meta?.total||this.warehouses.length;let s=0;for(const h of this.warehouses)this.timelineWarehouses.find(l=>(l.warehouse_id||l.id)===(h.warehouse_id||h.id))||(this.timelineWarehouses.push(h),s++);s>0&&(console.log(`[Dataset] Auto-added ${s} warehouses to timeline for region ${this.warehouseRegionShortname}`),this.loadDatasets(),"demand"===this.selectedDatasetId&&(this.loadDemands(),this.loadDemandsByDays(),this.loadShiftRatios()))}catch(o){console.error("[Dataset] onWarehouseRegionChange processing error",o),this.warehousesError="L\u1ed7i khi x\u1eed l\xfd danh s\xe1ch b\u01b0u c\u1ee5c"}this.loadingWarehouses=!1,this.cdr.markForCheck()},error:a=>{console.error("[Dataset] Load warehouses by region error:",a),this.warehousesError=a?.message||"Kh\xf4ng th\u1ec3 t\u1ea3i b\u01b0u c\u1ee5c cho v\xf9ng n\xe0y",this.loadingWarehouses=!1,this.cdr.markForCheck()}})}onWarehousePageChange(t){this.warehouseCurrentPage=t,this.loadWarehouses()}onWarehousePageSizeChange(t){this.warehousePageSize=t,this.warehouseCurrentPage=1,this.loadWarehouses()}get warehouseTotalPages(){return Math.ceil(this.warehouseTotal/this.warehousePageSize)}get warehouseStartIndex(){return(this.warehouseCurrentPage-1)*this.warehousePageSize+1}get warehouseEndIndex(){return Math.min(this.warehouseCurrentPage*this.warehousePageSize,this.warehouseTotal)}getChartHeight(){return 1e3}getChartMinWidth(){const t=this.filteredDemands?.length||this.demands?.length||0;return t>30?1800:t>25?1600:t>20?1400:t>15?1200:100}get chartOptions(){const t=this.filteredDemands?.length||this.demands?.length||0,r="bar"===this.chartType;return{responsive:!1,maintainAspectRatio:!1,aspectRatio:void 0,interaction:{mode:"index",intersect:!1},layout:{padding:{right:40,left:40,top:30,bottom:t>20?80:t>15?70:50}},plugins:{legend:{position:"top",labels:{usePointStyle:!0,padding:20,font:{size:14,weight:"600"},boxWidth:15,boxHeight:15}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.85)",padding:16,titleFont:{size:15,weight:"bold"},bodyFont:{size:14},borderColor:"rgba(255, 255, 255, 0.1)",borderWidth:1,displayColors:!0,callbacks:{label:function(d){let s=d.dataset.label||"";return s&&(s+=": "),null!==d.parsed.y&&(s+=new Intl.NumberFormat("vi-VN").format(d.parsed.y)),s}}}},animation:{onComplete:()=>{const d=document.querySelector("p-chart canvas");if(!d)return;const s=W.A.getChart(d);if(!s)return;const h=s.ctx,l=s.data.datasets;h.save(),h.font="bold 11px Arial",h.textAlign="center",h.textBaseline="bottom",h.fillStyle="#374151",l.forEach((c,_)=>{const v=s.getDatasetMeta(_);!v||!v.data||v.data.forEach((D,p)=>{const u=c.data[p];if(null==u||0===u)return;let b,w;r?(b=D.x,w=D.y-5):(b=D.x,w=D.y-10);const T=new Intl.NumberFormat("vi-VN",{notation:"compact",maximumFractionDigits:1}).format(u);h.shadowColor="rgba(255, 255, 255, 0.8)",h.shadowBlur=4,h.fillText(T,b,w),h.shadowBlur=0})}),h.restore()}},scales:{x:{grid:{display:!1},ticks:{font:{size:t>25?10:t>20?11:t>15?12:13,weight:"500"},maxRotation:r?t>20?75:t>15?60:45:0,minRotation:r?t>20?75:t>15?60:45:0,autoSkip:t>15,maxTicksLimit:t>30?30:t>25?25:t>20?20:void 0,padding:t>20?15:10},...r&&{barThickness:t>5?t>25?30:t>20?35:t>15?40:t>10?45:50:void 0,categoryPercentage:t>20?.7:t>15?.75:t>10?.85:.9,barPercentage:t>20?.9:t>10?.95:1}},y:{beginAtZero:!0,title:{display:!0,text:"T\u1ed5ng (kg)",font:{size:14,weight:"bold"},color:"rgba(249, 115, 22, 0.9)",padding:{top:10,bottom:10}},grid:{color:"rgba(249, 115, 22, 0.15)",lineWidth:1},ticks:{font:{size:12,weight:"500"},color:"rgba(249, 115, 22, 0.8)",padding:8,callback:function(d){return new Intl.NumberFormat("vi-VN").format(d)}}},y1:{beginAtZero:!0,position:"right",grid:{drawOnChartArea:!1},title:{display:!0,text:"Trung b\xecnh/ng\xe0y (kg/ng\xe0y)",font:{size:14,weight:"bold"},color:"rgba(251, 146, 60, 0.9)",padding:{top:10,bottom:10}},ticks:{font:{size:12,weight:"500"},color:"rgba(251, 146, 60, 0.8)",padding:8,callback:function(d){return new Intl.NumberFormat("vi-VN",{minimumFractionDigits:1,maximumFractionDigits:1}).format(d)}}}}}}getDemandsChartData(t){if(!this.demands||0===this.demands.length)return{labels:[],datasets:[]};const r=this.filteredDemands.length>0?this.filteredDemands:this.demands,a=r.map(o=>o.warehouse_name||`B\u01b0u c\u1ee5c ${o.warehouse_id}`);if("combined"===t){const o=[],d="line"===this.chartType;return this.chartShowPick&&o.push(d?{type:"line",label:"T\u1ed5ng L\u1ea5y",data:r.map(s=>s.total_pick||0),borderColor:"rgba(59, 130, 246, 1)",backgroundColor:"rgba(59, 130, 246, 0.1)",borderWidth:3,tension:.4,yAxisID:"y",pointRadius:5,pointHoverRadius:7,pointBackgroundColor:"rgba(59, 130, 246, 1)",pointBorderColor:"#fff",pointBorderWidth:2,fill:!1}:{type:"bar",label:"T\u1ed5ng L\u1ea5y",data:r.map(s=>s.total_pick||0),backgroundColor:"rgba(59, 130, 246, 0.95)",borderColor:"rgba(59, 130, 246, 1)",borderWidth:2.5,borderRadius:8,yAxisID:"y"}),this.chartShowDeliver&&o.push(d?{type:"line",label:"T\u1ed5ng Giao",data:r.map(s=>s.total_deliver||0),borderColor:"rgba(16, 185, 129, 1)",backgroundColor:"rgba(16, 185, 129, 0.1)",borderWidth:3,tension:.4,yAxisID:"y",pointRadius:5,pointHoverRadius:7,pointBackgroundColor:"rgba(16, 185, 129, 1)",pointBorderColor:"#fff",pointBorderWidth:2,fill:!1}:{type:"bar",label:"T\u1ed5ng Giao",data:r.map(s=>s.total_deliver||0),backgroundColor:"rgba(16, 185, 129, 0.95)",borderColor:"rgba(16, 185, 129, 1)",borderWidth:2,borderRadius:6,yAxisID:"y"}),this.chartShowAvgPick&&o.push(d?{type:"line",label:"TB L\u1ea5y/Ng\xe0y",data:r.map(s=>s.avg_pick_per_day||0),borderColor:"rgba(249, 115, 22, 1)",backgroundColor:"rgba(249, 115, 22, 0.1)",borderWidth:3,tension:.4,yAxisID:"y1",pointRadius:5,pointHoverRadius:7,pointBackgroundColor:"rgba(249, 115, 22, 1)",pointBorderColor:"#fff",pointBorderWidth:2,fill:!1}:{type:"line",label:"TB L\u1ea5y/Ng\xe0y",data:r.map(s=>s.avg_pick_per_day||0),borderColor:"rgba(249, 115, 22, 1)",backgroundColor:"rgba(249, 115, 22, 0.1)",borderWidth:4,tension:.4,yAxisID:"y1",pointRadius:6,pointHoverRadius:8,pointBackgroundColor:"rgba(249, 115, 22, 1)",pointBorderColor:"#fff",pointBorderWidth:3,fill:!1}),this.chartShowAvgDeliver&&o.push(d?{type:"line",label:"TB Giao/Ng\xe0y",data:r.map(s=>s.avg_deliver_per_day||0),borderColor:"rgba(139, 92, 246, 1)",backgroundColor:"rgba(139, 92, 246, 0.1)",borderWidth:3,tension:.4,yAxisID:"y1",pointRadius:5,pointHoverRadius:7,pointBackgroundColor:"rgba(139, 92, 246, 1)",pointBorderColor:"#fff",pointBorderWidth:2,fill:!1}:{type:"line",label:"TB Giao/Ng\xe0y",data:r.map(s=>s.avg_deliver_per_day||0),borderColor:"rgba(139, 92, 246, 1)",backgroundColor:"rgba(139, 92, 246, 0.1)",borderWidth:4,tension:.4,yAxisID:"y1",pointRadius:6,pointHoverRadius:8,pointBackgroundColor:"rgba(139, 92, 246, 1)",pointBorderColor:"#fff",pointBorderWidth:3,fill:!1}),{labels:a,datasets:o}}return"total"===t?{labels:a,datasets:[{label:"T\u1ed5ng L\u1ea5y",data:this.demands.map(o=>o.total_pick),backgroundColor:"rgba(59, 130, 246, 0.8)",borderColor:"rgba(59, 130, 246, 1)",borderWidth:1},{label:"T\u1ed5ng Giao",data:this.demands.map(o=>o.total_deliver),backgroundColor:"rgba(16, 185, 129, 0.8)",borderColor:"rgba(16, 185, 129, 1)",borderWidth:1}]}:{labels:a,datasets:[{label:"TB L\u1ea5y/Ng\xe0y",data:this.demands.map(o=>o.avg_pick_per_day),borderColor:"rgba(139, 92, 246, 1)",backgroundColor:"rgba(139, 92, 246, 0.1)",tension:.4},{label:"TB Giao/Ng\xe0y",data:this.demands.map(o=>o.avg_deliver_per_day),borderColor:"rgba(245, 158, 11, 1)",backgroundColor:"rgba(245, 158, 11, 0.1)",tension:.4}]}}findDemandByWarehouseId(t){if(!t)return null;const r=t.toString();return this.demands&&0!==this.demands.length&&this.demands.find(a=>(a.warehouse_id||a.id||"").toString()===r)||null}viewProductivity(){if(0===this.timelineWarehouses.length)return void alert("Ch\u01b0a c\xf3 b\u01b0u c\u1ee5c n\xe0o trong timeline");const t=this.timelineWarehouses.map(a=>a.warehouse_name).join(", ");alert(`S\u1ea3n l\u01b0\u1ee3ng cho ${this.timelineWarehouses.length} b\u01b0u c\u1ee5c:\n${t}\n\nT\xednh n\u0103ng xem s\u1ea3n l\u01b0\u1ee3ng chi ti\u1ebft s\u1ebd \u0111\u01b0\u1ee3c tri\u1ec3n khai trong phi\xean b\u1ea3n ti\u1ebfp theo.`),console.log("View productivity for warehouses:",this.timelineWarehouses)}static \u0275fac=function(r){return new(r||i)(e.rXU(E.q),e.rXU(k.Ix),e.rXU(e.gRc),e.rXU(e.Agw))};static \u0275cmp=e.VBU({type:i,selectors:[["app-dataset"]],viewQuery:function(r,a){if(1&r&&(e.GBs(G,5),e.GBs(ae,5),e.GBs(re,5),e.GBs(ie,5)),2&r){let o;e.mGM(o=e.lsd())&&(a.demandSummaryCanvas=o.first),e.mGM(o=e.lsd())&&(a.demandPickupTimeCanvas=o.first),e.mGM(o=e.lsd())&&(a.demandDeliveryTimeCanvas=o.first),e.mGM(o=e.lsd())&&(a.demandTimelineAreaCanvas=o.first)}},decls:7,vars:3,consts:[["demandSummaryCanvas",""],["demandTimelineAreaCanvas",""],["demandPickupTimeCanvas",""],["demandDeliveryTimeCanvas",""],["id","content-dataset",1,"tab-content","min-h-screen","bg-gray-50"],["title","Stochastic Dataset","subtitle","Qu\u1ea3n l\xfd v\xe0 ph\xe2n t\xedch d\u1eef li\u1ec7u stochastic cho d\u1ef1 \u0111o\xe1n","icon","\u{1f4ca}"],[1,"p-4"],[1,"relative"],["class","w-full p-6",4,"ngIf"],["class","w-full h-full flex gap-4",4,"ngIf"],["class","fixed inset-0 z-[3000] bg-black/40 backdrop-blur-sm flex items-center justify-center px-4",4,"ngIf"],[1,"w-full","p-6"],["class","flex items-center justify-center py-12",4,"ngIf"],["class","bg-red-50 border-2 border-red-200 rounded-xl p-6 mb-6",4,"ngIf"],["class","grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",4,"ngIf"],["class","flex items-center justify-center py-20",4,"ngIf"],[1,"flex","items-center","justify-center","py-12"],[1,"text-center"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-orange-500","mx-auto","mb-4"],[1,"text-gray-600","font-medium"],[1,"bg-red-50","border-2","border-red-200","rounded-xl","p-6","mb-6"],[1,"flex","items-center","gap-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-red-500","flex-shrink-0"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-red-800","font-bold","mb-1"],[1,"text-red-700"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4"],["class","bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 p-5 text-left group",3,"ngClass","click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"bg-white","border","border-gray-200","rounded-xl","shadow-sm","hover:shadow-md","transition-all","duration-200","p-5","text-left","group",3,"click","ngClass"],[1,"flex","items-center","gap-3","mb-4"],[1,"w-12","h-12","rounded-xl","flex","items-center","justify-center","shadow-md","flex-shrink-0"],["class","w-6 h-6","fill","none","viewBox","0 0 24 24","xmlns","http://www.w3.org/2000/svg",4,"ngIf"],[1,"flex-1","min-w-0"],[1,"font-bold","text-gray-900","text-lg","truncate"],[1,"text-xs","text-gray-500","mt-0.5"],[1,"inline-flex","items-center","px-2","py-0.5","rounded-full","text-xs","font-medium",3,"ngClass"],["class","text-sm text-gray-600 line-clamp-2",4,"ngIf"],[1,"space-y-2"],[1,"flex","items-center","justify-between","text-sm"],[1,"text-gray-600"],[1,"font-semibold","text-gray-900"],["class","flex items-center justify-between text-sm",4,"ngIf"],["fill","none","viewBox","0 0 24 24","xmlns","http://www.w3.org/2000/svg",1,"w-6","h-6"],["stroke","#ffffff","stroke-width","2","stroke-linecap","round","stroke-linejoin","round","d","M13 16V6a1 1 0 00-1-1H4a1 1 0 00-1 1v10a1 1 0 001 1h1m8-1a1 1 0 01-1 1H9m4-1V8a1 1 0 011-1h2.586a1 1 0 01.707.293l3.414 3.414a1 1 0 01.293.707V16a1 1 0 01-1 1h-1m-6-1a1 1 0 001 1h1M5 17a2 2 0 104 0m-4 0a2 2 0 114 0m6 0a2 2 0 104 0m-4 0a2 2 0 114 0"],["stroke","#ffffff","stroke-width","2","stroke-linecap","round","stroke-linejoin","round","d","M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"],["stroke","#ffffff","stroke-width","2","stroke-linecap","round","stroke-linejoin","round","d","M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"],["stroke","#ffffff","stroke-width","2","stroke-linecap","round","stroke-linejoin","round","d","M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"],["stroke","#ffffff","stroke-width","2","stroke-linecap","round","stroke-linejoin","round","d","M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"],[1,"text-sm","text-gray-600","line-clamp-2"],[1,"font-medium","text-gray-700"],[1,"flex","items-center","justify-center","py-20"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-20","h-20","mx-auto","mb-4","text-gray-300"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"text-lg","font-semibold","text-gray-700","mb-2"],[1,"text-sm","text-gray-500","mb-4"],[1,"px-5","py-2.5","bg-orange-500","hover:bg-orange-600","text-white","rounded-lg","font-medium","shadow-sm","hover:shadow-md","transition-all","duration-200",3,"click"],[1,"w-full","h-full","flex","gap-4"],[1,"w-fit","min-w-[320px]","max-w-[400px]","sticky","top-4","self-start","max-h-[calc(100vh-2rem)]","overflow-y-auto","bg-white","rounded-xl","shadow-lg","border","border-gray-200","flex","flex-col"],[1,"bg-gray-50","border-b","border-gray-200","px-4","py-3","flex-shrink-0"],[1,"flex","items-center","justify-between"],[1,"text-base","font-bold","text-gray-900","flex","items-center","gap-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-gray-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],["title","Ch\u1ec9nh s\u1eeda",1,"p-1.5","text-gray-400","hover:text-orange-600","hover:bg-orange-50","rounded-lg","transition-all",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],[1,"flex-1","overflow-y-auto","p-4","space-y-4"],["class","bg-white border border-gray-200 rounded-lg overflow-hidden",4,"ngIf"],["class","bg-gray-50 rounded-lg border border-gray-200 p-3 flex-1 flex flex-col min-h-0",4,"ngIf"],[1,"flex-1","min-w-0","h-full","overflow-y-auto"],["class","w-full h-full bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden flex flex-col",4,"ngIf"],["class","w-full h-full bg-white rounded-xl shadow-xl border-2 border-gray-200 overflow-hidden flex flex-col",4,"ngIf"],[1,"bg-white","border","border-gray-200","rounded-lg","overflow-hidden"],[1,"w-full","text-sm"],[1,"border-b","border-gray-200"],[1,"px-3","py-2.5","font-semibold","text-gray-700","bg-gray-50","w-1/3"],[1,"px-3","py-2.5","text-gray-900"],[4,"ngIf"],["class","text-gray-400",4,"ngIf"],["class","space-y-1",4,"ngIf"],[1,"text-gray-400"],[1,"space-y-1"],[1,"grid","grid-cols-2","gap-3","pb-1","border-b","border-gray-200","mb-1"],[1,"text-xs","font-semibold","text-gray-600","uppercase"],["class","grid grid-cols-2 gap-3 border-b border-gray-100 last:border-b-0 pb-1 last:pb-0",4,"ngFor","ngForOf"],[1,"grid","grid-cols-2","gap-3","border-b","border-gray-100","last:border-b-0","pb-1","last:pb-0"],[1,"bg-gray-50","rounded-lg","border","border-gray-200","p-3","flex-1","flex","flex-col","min-h-0"],[1,"flex","items-center","justify-between","mb-3","flex-shrink-0"],[1,"text-sm","font-bold","text-gray-900","flex","items-center","gap-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-orange-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"px-2","py-0.5","bg-orange-100","text-orange-700","rounded-full","text-xs","font-semibold"],["class","text-xs text-red-600 hover:text-red-700 font-medium",3,"click",4,"ngIf"],[1,"mb-3","flex-shrink-0"],[1,"absolute","inset-y-0","left-0","pl-2","flex","items-center","pointer-events-none"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"],["type","text","placeholder","T\xecm ki\u1ebfm theo t\xean ho\u1eb7c ID b\u01b0u c\u1ee5c...",1,"w-full","pl-8","pr-8","py-2","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-orange-500","focus:border-orange-500","text-xs","bg-white",3,"ngModelChange","ngModel"],["class","absolute inset-y-0 right-0 pr-2 flex items-center text-gray-400 hover:text-gray-600",3,"click",4,"ngIf"],["class","flex-1 overflow-y-auto space-y-2 min-h-0",4,"ngIf"],["class","flex items-center justify-between mt-3 pt-3 border-t border-gray-200 flex-shrink-0",4,"ngIf"],["class","text-center py-6 text-gray-400",4,"ngIf"],[1,"text-xs","text-red-600","hover:text-red-700","font-medium",3,"click"],[1,"absolute","inset-y-0","right-0","pr-2","flex","items-center","text-gray-400","hover:text-gray-600",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"flex-1","overflow-y-auto","space-y-2","min-h-0"],["class","flex items-center gap-2 p-2 bg-white border border-orange-200 rounded-lg hover:shadow-sm transition-all group",4,"ngFor","ngForOf"],[1,"flex","items-center","gap-2","p-2","bg-white","border","border-orange-200","rounded-lg","hover:shadow-sm","transition-all","group"],[1,"flex","items-center","justify-center","w-6","h-6","bg-gradient-to-br","from-orange-500","to-orange-600","rounded-full","text-white","text-xs","font-bold","flex-shrink-0","shadow-sm"],[1,"font-semibold","text-gray-900","text-xs","mb-0.5","truncate"],[1,"text-xs","text-gray-600","truncate"],["title","X\xf3a",1,"flex-shrink-0","p-1","text-red-500","hover:bg-red-100","rounded","transition-all","opacity-0","group-hover:opacity-100",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3.5","h-3.5"],[1,"flex","items-center","justify-between","mt-3","pt-3","border-t","border-gray-200","flex-shrink-0"],[1,"text-xs","text-gray-600"],[1,"flex","items-center","gap-2"],[1,"px-2","py-1","text-xs","font-medium","text-gray-700","bg-white","border","border-gray-300","rounded","hover:bg-gray-50","disabled:opacity-50","disabled:cursor-not-allowed","transition-all",3,"click","disabled"],[1,"text-xs","text-gray-700","font-medium"],[1,"text-center","py-6","text-gray-400"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-10","h-10","mx-auto","mb-2","text-gray-300"],[1,"text-xs","font-medium","text-gray-500"],[1,"text-xs","text-gray-400","mt-0.5"],[1,"w-full","h-full","bg-white","rounded-xl","shadow-lg","border","border-gray-200","overflow-hidden","flex","flex-col"],[1,"bg-gray-50","border-b","border-gray-200","px-6","py-4","flex-shrink-0"],[1,"text-lg","font-bold","text-gray-900","flex","items-center","gap-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"],[1,"flex-1","overflow-y-auto","bg-white"],["class","bg-red-50 border-2 border-red-200 rounded-xl p-5 mb-6 shadow-sm mx-6 mt-6",4,"ngIf"],[1,"px-6","pt-6","pb-4"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"bg-white","border","border-gray-200","rounded-lg","shadow-sm","p-5","hover:shadow-md","transition-all","duration-200"],[1,"flex","items-center","justify-between","mb-4"],[1,"w-12","h-12","rounded-lg","bg-orange-500","flex","items-center","justify-center","shadow-sm"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-white"],[1,"text-3xl","font-bold","text-gray-900","mb-1"],[1,"text-gray-600","text-sm","font-medium"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"],[1,"mb-6","px-6"],[1,"bg-gray-50","border-b","border-gray-200","p-6"],[1,"flex","items-center","gap-4"],[1,"w-14","h-14","rounded-xl","bg-orange-500","flex","items-center","justify-center","shadow-sm"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-7","h-7","text-white"],[1,"text-2xl","font-bold","mb-1","text-gray-900"],[1,"text-gray-600","text-sm"],[1,"p-6"],["class","bg-orange-50 border-2 border-orange-200 rounded-lg p-8 text-center",4,"ngIf"],["class","bg-red-50 border-2 border-red-200 rounded-lg p-4 text-center",4,"ngIf"],["class","mb-4 space-y-4",4,"ngIf"],["class","bg-gradient-to-br from-white to-orange-50 border-2 border-orange-200 rounded-xl p-6 shadow-sm mb-4",4,"ngIf"],["class","bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden",4,"ngIf"],["class","mb-6 px-6 pt-6",4,"ngIf"],[1,"flex","items-center","justify-between","mb-6"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-white"],[1,"flex","items-center","gap-2","bg-gray-100","rounded-lg","p-1","border","border-gray-200"],[1,"px-4","py-2","rounded-md","text-sm","font-semibold","transition-all","duration-200",3,"click","ngClass"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","inline","mr-1.5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z"],[1,"p-4","bg-gray-50","rounded-lg","border","border-gray-200"],[1,"flex","items-center","gap-2","mb-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-gray-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"],[1,"text-sm","font-semibold","text-gray-700"],[1,"grid","grid-cols-2","md:grid-cols-4","gap-3"],[1,"flex","items-center","gap-2.5","cursor-pointer","group","bg-white","hover:bg-orange-50","rounded-lg","p-3","transition-all","border","border-gray-200","hover:border-orange-200"],["type","checkbox",1,"w-4","h-4","text-orange-500","rounded","focus:ring-2","focus:ring-orange-300",3,"ngModelChange","change","ngModel"],[1,"flex","items-center","gap-2","flex-1"],[1,"w-3","h-3","rounded-full","bg-orange-500","shadow-sm"],[1,"text-sm","font-medium","text-gray-700"],[1,"p-8","bg-gradient-to-br","from-gray-50","via-white","to-gray-50"],[1,"w-full","rounded-2xl","border-2","border-gray-200","bg-white","shadow-inner",2,"position","relative","background","linear-gradient(to bottom, #ffffff 0%, #f9fafb 100%)","padding","2rem"],[1,"overflow-x-auto","overflow-y-hidden",2,"position","relative","padding-top","1rem","height","936px","width","100%","-webkit-overflow-scrolling","touch","scrollbar-width","thin","scrollbar-color","rgba(156, 163, 175, 0.5) transparent"],[2,"height","936px","position","relative",3,"ngStyle"],[2,"display","block !important","width","100% !important","height","936px !important","min-height","936px !important",3,"type","data","options"],[1,"bg-white","border-b-2","border-orange-200","p-6"],[1,"flex","items-center","gap-4","mb-4"],[1,"w-14","h-14","rounded-2xl","bg-orange-500","flex","items-center","justify-center","shadow-sm"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"],[1,"flex-1"],[1,"flex","items-center","justify-between","mt-4","pt-4","border-t","border-orange-200"],[1,"flex","items-center","gap-3","text-xs"],[1,"flex","items-center","gap-1.5"],[1,"w-4","h-4","rounded","bg-green-100","border","border-green-300"],[1,"text-gray-700"],[1,"w-4","h-4","rounded","bg-red-100","border","border-red-300"],[1,"text-sm","text-gray-700","font-medium"],[1,"text-orange-600","font-bold"],["class","ml-2 text-gray-600",4,"ngIf"],["class","bg-red-50 border-2 border-red-200 rounded-xl p-5 mb-6 shadow-sm",4,"ngIf"],["class","bg-gradient-to-r from-orange-50 to-orange-100 border-2 border-orange-200 rounded-xl p-6 mb-6 shadow-sm",4,"ngIf"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-8"],[1,"lg:col-span-1","flex","flex-col"],[1,"bg-white","border","border-gray-200","rounded-lg","shadow-sm","p-6","flex-1","flex","flex-col","h-full"],[1,"flex","items-center","gap-3","mb-6"],[1,"w-10","h-10","rounded-lg","bg-orange-500","flex","items-center","justify-center"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z"],[1,"text-lg","font-semibold","text-gray-900"],[1,"flex-1","flex","items-center","justify-center",2,"min-height","400px","position","relative"],["class","text-center text-gray-400",4,"ngIf"],[2,"max-width","100%","max-height","100%"],[1,"lg:col-span-1"],[1,"bg-white","rounded-lg","border","border-gray-200","shadow-sm","overflow-hidden"],["currentPageReportTemplate","Hi\u1ec3n th\u1ecb {first} \u0111\u1ebfn {last} c\u1ee7a {totalRecords} b\u01b0u c\u1ee5c","styleClass","p-datatable-striped",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","tableStyle"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-orange-400","mx-auto","mb-4"],[1,"text-sm","text-gray-600","font-medium"],[1,"bg-red-50","border-2","border-red-200","rounded-xl","p-5","mb-6","shadow-sm","mx-6","mt-6"],[1,"w-10","h-10","rounded-full","bg-red-100","flex","items-center","justify-center","flex-shrink-0"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-red-500"],[1,"bg-orange-50","border-2","border-orange-200","rounded-lg","p-8","text-center"],[1,"flex","items-center","justify-center"],[1,"animate-spin","rounded-full","h-8","w-8","border-b-2","border-orange-500","mr-3"],[1,"bg-red-50","border-2","border-red-200","rounded-lg","p-4","text-center"],[1,"text-sm","text-red-600"],[1,"mb-4","space-y-4"],[1,"flex","gap-2"],[1,"px-4","py-2","rounded-lg","text-sm","font-medium","transition-colors",3,"click","ngClass"],["type","checkbox","id","showTimelineAverage",1,"w-4","h-4","text-orange-600","rounded","focus:ring-2","focus:ring-orange-300",3,"ngModelChange","change","ngModel"],["for","showTimelineAverage",1,"text-sm","text-gray-700","cursor-pointer"],[1,"bg-gradient-to-br","from-white","to-orange-50","border-2","border-orange-200","rounded-xl","p-6","shadow-sm","mb-4"],[1,"flex","items-center","justify-center",2,"height","400px","position","relative"],[2,"display","block !important","max-width","100% !important","max-height","100% !important","height","400px !important","width","100% !important"],["class","mt-4 text-center",4,"ngIf"],[1,"mt-4","text-center"],[1,"text-sm","text-gray-500","italic"],[1,"bg-white","border","border-gray-200","rounded-lg","shadow-sm","overflow-hidden"],[1,"bg-orange-50","border-b","border-orange-200","px-4","py-3","flex","items-center","justify-between"],[1,"px-3","py-1","text-xs","bg-orange-100","text-orange-700","rounded","hover:bg-orange-200","transition-colors",3,"click"],[1,"px-3","py-1","text-xs","bg-gray-100","text-gray-700","rounded","hover:bg-gray-200","transition-colors",3,"click"],[1,"overflow-x-auto"],[1,"w-full"],[1,"bg-gray-50","border-b","border-gray-200"],[1,"px-4","py-2","text-left","w-12"],["type","checkbox",1,"w-4","h-4","text-orange-600","border-gray-400","rounded","focus:ring-2","focus:ring-orange-500","cursor-pointer",3,"change","checked"],[1,"px-4","py-2","text-left","text-xs","font-bold","text-gray-700","uppercase"],[1,"px-4","py-2","text-left","text-xs","font-bold","text-gray-700","uppercase","w-24"],[1,"divide-y","divide-gray-200"],["class","hover:bg-orange-50 transition-colors cursor-pointer",3,"click",4,"ngFor","ngForOf"],["class","bg-gray-50 border-t border-gray-200 px-4 py-3 flex items-center justify-between",4,"ngIf"],[1,"hover:bg-orange-50","transition-colors","cursor-pointer",3,"click"],[1,"px-4","py-3",3,"click"],["type","checkbox",1,"w-4","h-4","text-orange-600","rounded","focus:ring-2","focus:ring-orange-300","cursor-pointer",3,"change","checked"],[1,"px-4","py-3","text-sm","text-gray-900","font-medium"],[1,"px-4","py-3","text-xs","text-gray-500"],[1,"bg-gray-50","border-t","border-gray-200","px-4","py-3","flex","items-center","justify-between"],[1,"text-sm","text-gray-700"],[1,"font-semibold"],[1,"px-3","py-1","text-xs","rounded","transition-colors",3,"click","disabled","ngClass"],[1,"mb-6","px-6","pt-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],["class","bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg p-8 text-center mb-8",4,"ngIf"],["class","mb-8",4,"ngIf"],["class","grid grid-cols-1 md:grid-cols-2 gap-6 mt-8",4,"ngIf"],[1,"bg-gray-50","border-2","border-dashed","border-gray-300","rounded-lg","p-8","text-center","mb-8"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-12","w-12","text-gray-400","mb-4"],[1,"text-lg","font-medium","text-gray-900","mb-2"],["class","text-gray-500",4,"ngIf"],[1,"text-gray-500"],[1,"mb-8"],[1,"text-md","font-semibold","text-gray-800","mb-4","flex","items-center","gap-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-orange-600"],[1,"min-w-full","bg-white","border","border-gray-200","rounded-lg"],[1,"bg-gradient-to-r","from-orange-50","to-orange-100"],[1,"px-4","py-3","text-left","text-xs","font-bold","text-orange-800","uppercase","tracking-wider","border-b","border-gray-200"],[1,"px-4","py-3","text-center","text-xs","font-bold","text-orange-800","uppercase","tracking-wider","border-b","border-gray-200"],[1,"px-4","py-3","text-right","text-xs","font-bold","text-orange-800","uppercase","tracking-wider","border-b","border-gray-200"],["class","hover:bg-gray-50",4,"ngIf"],["class","hover:bg-orange-50 transition-colors",4,"ngFor","ngForOf"],[1,"hover:bg-gray-50"],["colspan","4",1,"px-4","py-8","text-center","text-sm","text-gray-500"],[1,"hover:bg-orange-50","transition-colors"],[1,"px-4","py-3","whitespace-nowrap"],[1,"flex","items-center"],[1,"w-8","h-8","rounded-full","bg-orange-100","flex","items-center","justify-center","mr-3"],[1,"text-xs","font-bold","text-orange-700"],[1,"text-sm","font-semibold","text-gray-900"],[1,"px-4","py-3","text-center","whitespace-nowrap"],[1,"inline-flex","items-center","px-3","py-1","rounded-full","text-xs","font-semibold","bg-orange-100","text-orange-700"],[1,"px-4","py-3","text-right","whitespace-nowrap"],[1,"flex","items-center","justify-end","gap-2"],[1,"text-sm","font-semibold","text-orange-800"],[1,"w-24","h-2","bg-gray-200","rounded-full","overflow-hidden"],[1,"h-full","bg-orange-600","rounded-full","transition-all"],[1,"text-sm","font-semibold","text-gray-800"],[1,"h-full","bg-gray-800","rounded-full","transition-all"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6","mt-8"],[1,"bg-gradient-to-br","from-orange-50","to-white","border-2","border-orange-200","rounded-xl","p-6","shadow-sm"],[1,"w-12","h-12","rounded-xl","bg-gradient-to-br","from-orange-500","to-orange-600","flex","items-center","justify-center","shadow-md"],[1,"text-lg","font-bold","text-gray-900"],[1,"flex","items-center","justify-center",2,"height","500px","position","relative"],[2,"display","block !important","max-width","100% !important","max-height","100% !important","height","500px !important","width","500px !important"],[1,"bg-gradient-to-br","from-gray-50","to-white","border-2","border-gray-200","rounded-xl","p-6","shadow-sm"],[1,"w-12","h-12","rounded-xl","bg-gradient-to-br","from-gray-600","to-gray-700","flex","items-center","justify-center","shadow-md"],[1,"ml-2","text-gray-600"],[1,"font-bold","text-orange-600"],[1,"bg-red-50","border-2","border-red-200","rounded-xl","p-5","mb-6","shadow-sm"],[1,"bg-gradient-to-r","from-orange-50","to-orange-100","border-2","border-orange-200","rounded-xl","p-6","mb-6","shadow-sm"],[1,"flex","items-start","gap-4"],[1,"w-12","h-12","rounded-full","bg-orange-500","flex","items-center","justify-center","flex-shrink-0","shadow-sm"],[1,"text-orange-800","font-bold","mb-1"],[1,"text-orange-700"],[1,"text-center","text-gray-400"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-16","h-16","mx-auto","mb-2"],[1,"text-sm"],[1,"bg-white","border-b-2","border-orange-200"],[1,"text-left","font-semibold","text-orange-600","py-4","px-6","border-b","border-orange-200"],[1,"flex","items-center","gap-2","hover:text-orange-100","transition-colors","text-white",3,"click"],["class","w-4 h-4 flex-shrink-0","fill","none","stroke","currentColor","viewBox","0 0 24 24","preserveAspectRatio","xMidYMid meet",4,"ngIf"],[1,"text-right","font-semibold","text-orange-600","py-4","px-6","border-b","border-orange-200"],[1,"flex","items-center","justify-end","gap-2","hover:text-orange-700","transition-colors","w-full","text-orange-600",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24","preserveAspectRatio","xMidYMid meet",1,"w-4","h-4","flex-shrink-0"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 15l7-7 7 7",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 15l7-7 7 7"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],[1,"cursor-pointer","transition-colors","border-b","border-gray-100",3,"click","ngClass"],[1,"py-4","px-6"],[1,"text-gray-900","font-medium","text-sm"],[1,"text-right","py-4","px-6","text-gray-700","font-medium"],[1,"text-right","py-4","px-6","text-orange-600","font-medium"],["colspan","5",1,"text-center","py-12"],[1,"flex","flex-col","items-center","gap-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-16","h-16","text-gray-300"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-gray-500","font-medium"],["class","px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors text-sm font-medium",3,"click",4,"ngIf"],[1,"px-4","py-2","bg-orange-500","text-white","rounded-lg","hover:bg-orange-600","transition-colors","text-sm","font-medium",3,"click"],[1,"w-full","h-full","bg-white","rounded-xl","shadow-xl","border-2","border-gray-200","overflow-hidden","flex","flex-col"],[1,"bg-white","border-b-2","border-orange-200","px-6","py-4","flex-shrink-0","flex","items-center","justify-between"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"],[1,"bg-white","hover:bg-gray-50","text-gray-700","border-2","border-gray-200","rounded-lg","px-4","py-2","shadow-sm","flex","items-center","gap-2","transition-all","hover:shadow-md","hover:border-gray-300",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],[1,"text-sm","font-semibold"],[1,"flex-1","overflow-y-auto"],[3,"datasetIdInput","embedded"],[1,"fixed","inset-0","z-[3000]","bg-black/40","backdrop-blur-sm","flex","items-center","justify-center","px-4"],[1,"bg-white","rounded-2xl","shadow-2xl","w-full","max-w-5xl","max-h-[90vh]","overflow-hidden"],[1,"flex","items-center","justify-between","px-6","py-4","border-b-2","border-orange-200","bg-white"],[1,"w-10","h-10","rounded-xl","bg-orange-500","flex","items-center","justify-center","shadow-sm"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5h2m-1-2v4m-7 4h2m-1-2v4m11-2h2m-1-2v4m-7 4h2m-1-2v4M4 4l16 16"],[1,"text-lg","font-bold","text-orange-600"],[1,"text-sm","text-gray-600"],[1,"p-2","rounded-lg","bg-orange-50","hover:bg-orange-100","text-orange-600","transition","border","border-orange-200",3,"click"],[1,"p-6","overflow-y-auto","max-h-[70vh]","space-y-6"],[1,"bg-gray-50","rounded-xl","border","border-gray-200","p-5"],[1,"flex","items-center","gap-2","mb-4"],[1,"w-9","h-9","rounded-lg","bg-orange-500","flex","items-center","justify-center","shadow-sm"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-white"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"],[1,"text-base","font-bold","text-gray-900"],[1,"space-y-4"],[1,"text-sm","font-semibold","text-gray-700","mb-2","block"],[1,"text-red-500"],[1,"w-full","border-2","border-gray-300","rounded-lg","px-4","py-2.5","text-sm","focus:ring-2","focus:ring-orange-500","focus:border-orange-500","font-medium",3,"ngModelChange","change","ngModel"],["value","","disabled",""],[3,"value",4,"ngFor","ngForOf"],["class","space-y-3",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"],[1,"grid","grid-cols-1","sm:grid-cols-2","gap-4"],["type","date",1,"w-full","border-2","border-gray-300","rounded-lg","px-4","py-2.5","text-sm","focus:ring-2","focus:ring-orange-500","focus:border-orange-500","font-medium",3,"ngModelChange","ngModel"],["class","mt-3 text-sm text-red-600 bg-red-50 border border-red-200 rounded-lg p-3",4,"ngIf"],[1,"space-y-3"],["class","flex items-center gap-3 p-4 bg-white rounded-xl border border-gray-200",4,"ngFor","ngForOf"],[1,"w-full","px-4","py-3","bg-white","border-2","border-dashed","border-gray-300","rounded-xl","hover:border-orange-400","hover:bg-orange-50","text-sm","font-semibold","text-gray-700","transition-all","flex","items-center","justify-center","gap-2",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],[1,"flex","items-center","justify-end","gap-3","px-6","py-4","border-t","border-gray-200","bg-gray-50"],[1,"px-4","py-2","rounded-lg","border","border-gray-300","text-gray-700","hover:bg-gray-100","transition","text-sm","font-semibold",3,"click"],[1,"px-5","py-2","rounded-lg","bg-orange-600","text-white","hover:bg-orange-700","transition","shadow-md","text-sm","font-semibold",3,"click"],[3,"value"],["class","flex items-center justify-center py-8 bg-white rounded-lg border border-gray-200",4,"ngIf"],["class","bg-red-50 border-2 border-red-200 rounded-lg p-4",4,"ngIf"],["class","flex items-center justify-between bg-gradient-to-r from-gray-50 to-gray-50/50 rounded-lg px-4 py-2.5 border-2 border-gray-200",4,"ngIf"],["class","border-2 border-gray-200 rounded-xl overflow-hidden bg-white shadow-sm max-h-[400px] overflow-y-auto",4,"ngIf"],["class","bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",4,"ngIf"],[1,"flex","items-center","justify-center","py-8","bg-white","rounded-lg","border","border-gray-200"],[1,"animate-spin","rounded-full","h-8","w-8","border-3","border-orange-500","border-t-transparent","mx-auto","mb-2"],[1,"text-sm","font-medium","text-gray-600"],[1,"bg-red-50","border-2","border-red-200","rounded-lg","p-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-red-500","flex-shrink-0"],[1,"text-sm","text-red-700"],[1,"flex","items-center","justify-between","bg-gradient-to-r","from-gray-50","to-gray-50/50","rounded-lg","px-4","py-2.5","border-2","border-gray-200"],[1,"text-xs","font-semibold","text-gray-700"],[1,"text-gray-900","font-bold"],[1,"w-px","h-4","bg-gray-300"],[1,"text-xs","font-semibold","text-orange-600"],[1,"text-orange-700","font-bold"],["type","button",1,"px-3","py-1.5","text-xs","font-bold","bg-green-500","hover:bg-green-600","disabled:bg-gray-300","disabled:cursor-not-allowed","text-white","rounded-lg","transition-all","shadow-sm",3,"click","disabled"],["type","button",1,"px-3","py-1.5","text-xs","font-bold","bg-red-500","hover:bg-red-600","disabled:bg-gray-300","disabled:cursor-not-allowed","text-white","rounded-lg","transition-all","shadow-sm",3,"click","disabled"],[1,"border-2","border-gray-200","rounded-xl","overflow-hidden","bg-white","shadow-sm","max-h-[400px]","overflow-y-auto"],[1,"bg-gradient-to-r","from-gray-100","to-gray-50","sticky","top-0","z-10","border-b-2","border-gray-200"],[1,"px-3","py-2.5","text-left","w-12"],[1,"px-3","py-2.5","text-left","text-xs","font-bold","text-gray-700","uppercase","w-12"],[1,"px-3","py-2.5","text-left","text-xs","font-bold","text-gray-700","uppercase"],[1,"px-3","py-2.5","text-left","text-xs","font-bold","text-gray-700","uppercase","w-20"],[1,"divide-y","divide-gray-150"],["class","hover:bg-orange-50/50 transition-colors cursor-pointer border-b border-gray-100",3,"click",4,"ngFor","ngForOf"],[1,"hover:bg-orange-50/50","transition-colors","cursor-pointer","border-b","border-gray-100",3,"click"],[1,"px-3","py-2.5",3,"click"],[1,"px-3","py-2.5","text-sm","font-bold","text-gray-700"],[1,"px-3","py-2.5"],[1,"font-semibold","text-gray-900","text-sm"],[1,"px-3","py-2.5","text-xs","text-gray-500","font-mono"],[1,"bg-gray-50","border-2","border-dashed","border-gray-300","rounded-lg","p-8","text-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-10","w-10","text-gray-400","mb-3"],[1,"text-sm","font-medium","text-gray-500"],[1,"mt-3","text-sm","text-red-600","bg-red-50","border","border-red-200","rounded-lg","p-3"],["class","flex items-center gap-2",4,"ngFor","ngForOf"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","flex-shrink-0"],[1,"flex","items-center","gap-3","p-4","bg-white","rounded-xl","border","border-gray-200"],[1,"w-8","h-8","rounded-full","bg-gradient-to-br","from-orange-400","to-orange-600","text-white","flex","items-center","justify-center","font-bold","text-sm","flex-shrink-0"],["placeholder","T\xean ca",1,"border-2","border-gray-300","rounded-lg","px-4","py-2","text-sm","w-36","focus:ring-2","focus:ring-orange-500","focus:border-orange-500","font-medium",3,"ngModelChange","ngModel"],[1,"border-2","border-gray-300","rounded-lg","px-4","py-2","text-sm","focus:ring-2","focus:ring-orange-500","focus:border-orange-500","font-medium",3,"ngModelChange","ngModel"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"text-gray-500","font-semibold"],["title","X\xf3a ca",1,"ml-auto","text-red-500","hover:bg-red-50","px-3","py-2","rounded-lg","transition-colors","font-medium",3,"click"],[3,"ngValue"]],template:function(r,a){1&r&&(e.j41(0,"div",4),e.nrm(1,"app-page-header",5),e.j41(2,"div",6)(3,"div",7),e.DNE(4,Ee,5,4,"div",8)(5,At,18,4,"div",9),e.k0s(),e.DNE(6,Jt,70,8,"div",10),e.k0s()()),2&r&&(e.R7$(4),e.Y8G("ngIf",!a.selectedDatasetId),e.R7$(),e.Y8G("ngIf",a.selectedDatasetId),e.R7$(),e.Y8G("ngIf",a.showSettingsModal))},dependencies:[j.MD,j.YU,j.Sq,j.bT,j.B3,j.QX,j.vh,F.YN,F.xH,F.y7,F.me,F.Zm,F.wz,F.BC,F.vS,X.KQ,Y.Ei,L.$C,z.tm,N.Fr,N.X9,H.$$,K.Ph,V.bG,V.XI,U.DatasetDetailComponent,q.y],styles:['.custom-svg-marker[_ngcontent-%COMP%]{background:transparent!important;border:none!important;box-shadow:none!important;cursor:pointer;z-index:1000}.custom-svg-marker[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{filter:drop-shadow(0 4px 12px rgba(0,0,0,.3));transition:all .3s cubic-bezier(.4,0,.2,1)}.custom-svg-marker[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{transform:scale(1.2) translateY(-4px);filter:drop-shadow(0 8px 20px rgba(0,0,0,.4))}.custom-svg-marker.marker-selected[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_markerPulse 2s ease-in-out infinite}@keyframes _ngcontent-%COMP%_markerPulse{0%,to{transform:scale(1);filter:drop-shadow(0 4px 12px rgba(var(--p-primary-500),.5))}50%{transform:scale(1.1);filter:drop-shadow(0 6px 16px rgba(var(--p-primary-500),.8))}}.custom-svg-marker.marker-timeline[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{filter:drop-shadow(0 0 8px var(--p-primary-500)) drop-shadow(0 4px 12px rgba(0,0,0,.3))}.custom-marker[_ngcontent-%COMP%]{background:transparent!important;border:none!important}.custom-marker[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{position:relative}.custom-marker[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:-2px;left:50%;transform:translate(-50%);width:0;height:0;border-left:6px solid transparent;border-right:6px solid transparent;border-top:8px solid var(--p-primary-500);filter:drop-shadow(0 1px 2px rgba(0,0,0,.2))}.fallback-marker[_ngcontent-%COMP%]{background:transparent!important;border:none!important}.fallback-marker[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{border-radius:50%;border:2px solid white;box-shadow:0 2px 4px #0000004d}#warehouseMap[_ngcontent-%COMP%]{min-height:300px}.map-loading[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:100%;background:var(--p-surface-50);border-radius:8px}.map-loading[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:40px;height:40px;border:4px solid var(--p-surface-200);border-top:4px solid var(--p-primary-500);border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}[_nghost-%COMP%]     .leaflet-popup-content-wrapper{border-radius:12px;box-shadow:0 10px 40px #0003;padding:0;overflow:hidden}[_nghost-%COMP%]     .leaflet-popup-content{margin:0;min-width:240px}[_nghost-%COMP%]     .custom-popup-header{background:linear-gradient(135deg,var(--p-primary-500) 0%,var(--p-primary-600) 100%);padding:12px 16px;color:#fff}[_nghost-%COMP%]     .custom-popup-header.hub-type{background:linear-gradient(135deg,var(--p-primary-500) 0%,var(--p-primary-600) 100%)}[_nghost-%COMP%]     .custom-popup-header.sorting-type{background:linear-gradient(135deg,var(--p-primary-500) 0%,var(--p-primary-600) 100%)}[_nghost-%COMP%]     .custom-popup-header.delivery-type{background:linear-gradient(135deg,var(--p-primary-500) 0%,var(--p-primary-600) 100%)}[_nghost-%COMP%]     .custom-popup-header.transit-type{background:linear-gradient(135deg,var(--p-primary-500) 0%,var(--p-primary-600) 100%)}[_nghost-%COMP%]     .custom-popup-badge{display:inline-block;padding:2px 8px;border-radius:12px;font-size:10px;font-weight:600;text-transform:uppercase;background:#ffffff4d;backdrop-filter:blur(10px);margin-bottom:4px}[_nghost-%COMP%]     .custom-popup-title{font-size:14px;font-weight:700;margin:0}[_nghost-%COMP%]     .custom-popup-body{padding:12px 16px;background:#fff}[_nghost-%COMP%]     .custom-popup-info-row{display:flex;align-items:flex-start;gap:8px;margin-bottom:8px;font-size:12px;color:var(--p-surface-600)}[_nghost-%COMP%]     .custom-popup-info-row:last-child{margin-bottom:0}[_nghost-%COMP%]     .custom-popup-icon{font-size:14px;flex-shrink:0;margin-top:2px}[_nghost-%COMP%]     .custom-popup-btn{display:block;width:100%;padding:8px 16px;margin-top:8px;background:linear-gradient(135deg,var(--p-primary-500) 0%,var(--p-primary-600) 100%);color:#fff;border:none;border-radius:6px;font-size:12px;font-weight:600;cursor:pointer;transition:all .2s ease}[_nghost-%COMP%]     .custom-popup-btn:hover{transform:translateY(-1px);box-shadow:0 4px 12px rgba(var(--p-primary-500),.4)}[_nghost-%COMP%]     .leaflet-popup-tip{background:#fff}.relative.z-10[_ngcontent-%COMP%]{position:relative;z-index:10}[_nghost-%COMP%]     *{scrollbar-width:thin;scrollbar-color:rgba(var(--p-primary-500),.3) transparent}[_nghost-%COMP%]     *::-webkit-scrollbar{width:8px;height:8px}[_nghost-%COMP%]     *::-webkit-scrollbar-track{background:transparent;border-radius:4px}[_nghost-%COMP%]     *::-webkit-scrollbar-thumb{background-color:rgba(var(--p-primary-500),.3);border-radius:4px;border:2px solid transparent}[_nghost-%COMP%]     *::-webkit-scrollbar-thumb:hover{background-color:rgba(var(--p-primary-500),.5)}[_nghost-%COMP%]     button, [_nghost-%COMP%]     .cursor-pointer{transition:all .2s ease-in-out}.line-clamp-2[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}[_nghost-%COMP%]     .p-autocomplete .p-autocomplete-input{border:2px solid var(--p-primary-500)!important;border-radius:.5rem!important;padding:.5rem .75rem!important}[_nghost-%COMP%]     .p-autocomplete .p-autocomplete-input:focus{border-color:var(--p-primary-500)!important;box-shadow:0 0 0 3px rgba(var(--p-primary-500),.1)!important;outline:none!important}'],changeDetection:0})}return i})()}}]);