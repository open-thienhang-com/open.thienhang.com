import{v as xe,r as o,A as V,B as Q,j as e,w,x as D,C as W,y as H,z as he,D as q}from"./index-JbP_4Lsp.js";import{a as t,c as d}from"./index.esm-CyKLJB-2.js";import{C as g,a as p}from"./CRow-VH0aKeGn.js";import{C as me,a as je,b as J,c as h,d as pe,e as m}from"./CTable-DN3UWjCh.js";import{a as n,c as ge}from"./DefaultLayout-RO6sj_XT.js";import{c as ue,a as ye}from"./cil-location-pin-DgNdO3OW.js";import{c as fe}from"./cil-user-Dlmw-Gem.js";import{c as K}from"./cil-trash-CBbKHhHb.js";import{C as O,a as X,b as Y,c as Z,d as ee}from"./CModalTitle-DQi2nAew.js";import{c as Ce,a as Ne}from"./cil-phone-DE2e6Wm2.js";const Se=()=>{var E,B,F,M,I,$,U,R,L,G;const u=xe(),[y,k]=o.useState([]),[se,z]=o.useState(!0),[A,f]=o.useState(null),[r,re]=o.useState(null),[le,C]=o.useState(!1),[ae,N]=o.useState(!1),[a,v]=o.useState(null),[b,P]=o.useState(!1);o.useEffect(()=>{_()},[]);const _=async()=>{var s,i;z(!0),f(null);try{let l;try{console.log("üè® Fetching hotels via proxy..."),l=await V.get("/services/hotel/apartment/apartments")}catch{console.log("‚ö†Ô∏è Proxy failed, trying direct API..."),l=await Q.get("/services/hotel/apartment/apartments")}console.log("‚úÖ Hotels API response:",l.data),l.data&&l.data.data?k(l.data.data):f("Invalid response format")}catch(l){console.error("‚ùå Error fetching hotels:",l),f(((i=(s=l.response)==null?void 0:s.data)==null?void 0:i.message)||l.message||"Failed to fetch hotels")}finally{z(!1)}},ie=s=>{re(s),C(!0)},ne=s=>{u(`/hotels/${s}`)},ce=s=>{v(s),N(!0)},te=async()=>{var s,i,l,j;if(a){P(!0);try{let c;try{console.log("üóëÔ∏è Deleting hotel via proxy...",a._id),c=await V.delete(`/services/hotel/apartment/apartment/${a._id}`)}catch{console.log("‚ö†Ô∏è Proxy failed, trying direct API..."),c=await Q.delete(`/services/hotel/apartment/apartment/${a._id}`)}console.log("‚úÖ Hotel deleted successfully:",c.data),q.success(c.data.message||`Hotel "${a.title}" deleted successfully!`),k(x=>x.filter(de=>de._id!==a._id)),N(!1),v(null)}catch(c){console.error("‚ùå Error deleting hotel:",c);const x=((i=(s=c.response)==null?void 0:s.data)==null?void 0:i.message)||((j=(l=c.response)==null?void 0:l.data)==null?void 0:j.error)||`Failed to delete hotel "${a.title}". Please try again.`;q.error(x)}finally{P(!1)}}},S=()=>{N(!1),v(null)},T=(s,i="USD")=>new Intl.NumberFormat("en-US",{style:"currency",currency:i}).format(s),oe=s=>s.is_active?s.is_booked?e.jsx(n,{color:"warning",children:"Booked"}):e.jsx(n,{color:"success",children:"Available"}):e.jsx(n,{color:"secondary",children:"Inactive"});return se?e.jsx(g,{children:e.jsx(p,{xs:12,children:e.jsx(w,{children:e.jsxs(D,{className:"text-center py-5",children:[e.jsx(W,{color:"primary",variant:"grow"}),e.jsx("div",{className:"mt-3",children:"Loading hotels..."})]})})})}):A?e.jsx(g,{children:e.jsx(p,{xs:12,children:e.jsx(w,{children:e.jsx(D,{children:e.jsxs(H,{color:"danger",children:[e.jsx("strong",{children:"Error:"})," ",A,e.jsx("div",{className:"mt-2",children:e.jsx(t,{color:"primary",size:"sm",onClick:_,children:"Retry"})})]})})})})}):e.jsxs(e.Fragment,{children:[e.jsx(g,{children:e.jsx(p,{xs:12,children:e.jsxs(w,{children:[e.jsx(he,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"üè® Hotel Apartments"}),e.jsxs("small",{className:"ms-2",children:["Total: ",y.length," apartments"]})]}),e.jsxs("div",{children:[e.jsx(t,{color:"success",size:"sm",className:"me-2",onClick:()=>u("/hotels/create"),children:"Create Hotel"}),e.jsx(t,{color:"primary",size:"sm",onClick:_,children:"Refresh"})]})]})}),e.jsx(D,{children:y.length===0?e.jsx(H,{color:"info",children:"No apartments found."}):e.jsxs(me,{hover:!0,responsive:!0,children:[e.jsx(je,{children:e.jsxs(J,{children:[e.jsx(h,{children:"Title"}),e.jsx(h,{children:"Property"}),e.jsx(h,{children:"Location"}),e.jsx(h,{children:"Price/Day"}),e.jsx(h,{children:"Details"}),e.jsx(h,{children:"Status"}),e.jsx(h,{children:"Actions"})]})}),e.jsx(pe,{children:y.map(s=>{var i,l,j,c,x;return e.jsxs(J,{children:[e.jsx(m,{children:e.jsxs("div",{children:[e.jsx("strong",{children:s.title||"N/A"}),s.description&&e.jsx("div",{className:"text-muted small",children:s.description.length>50?`${s.description.substring(0,50)}...`:s.description})]})}),e.jsx(m,{children:e.jsxs("div",{children:[e.jsx("strong",{children:((i=s.property)==null?void 0:i.name)||"Unknown Property"}),((l=s.property)==null?void 0:l.has_pool)&&e.jsx(n,{color:"info",className:"ms-1",children:"Pool"}),((j=s.property)==null?void 0:j.has_elevator)&&e.jsx(n,{color:"secondary",className:"ms-1",children:"Elevator"})]})}),e.jsx(m,{children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(d,{icon:ue,size:"sm",className:"me-1"}),e.jsxs("small",{children:[((c=s.address)==null?void 0:c.city)||"Unknown",","," ",((x=s.address)==null?void 0:x.country)||"Unknown"]})]})}),e.jsx(m,{children:e.jsx("strong",{className:"text-success",children:T(s.price_per_day,s.currency)})}),e.jsxs(m,{children:[e.jsxs("div",{className:"d-flex gap-2",children:[e.jsxs("span",{className:"d-flex align-items-center",children:[e.jsx(d,{icon:ge,size:"sm",className:"me-1"}),s.bedrooms||0]}),e.jsxs("span",{className:"d-flex align-items-center",children:[e.jsx(d,{icon:ye,size:"sm",className:"me-1"}),s.bathrooms||0]}),e.jsxs("span",{className:"d-flex align-items-center",children:[e.jsx(d,{icon:fe,size:"sm",className:"me-1"}),s.total_area||0,"m¬≤"]})]}),e.jsxs("div",{className:"mt-1",children:[s.is_furnished&&e.jsx(n,{color:"primary",className:"me-1",children:"Furnished"}),s.is_garage&&e.jsx(n,{color:"info",className:"me-1",children:"Garage"})]})]}),e.jsx(m,{children:oe(s)}),e.jsx(m,{children:e.jsxs("div",{className:"d-flex gap-1 flex-wrap",children:[e.jsx(t,{color:"primary",variant:"outline",size:"sm",onClick:()=>ie(s),children:"Quick View"}),e.jsx(t,{color:"success",size:"sm",onClick:()=>ne(s._id),children:"Details"}),e.jsx(t,{color:"warning",variant:"outline",size:"sm",onClick:()=>u(`/hotels/${s._id}/edit`),children:"Edit"}),e.jsx(t,{color:"danger",variant:"outline",size:"sm",onClick:()=>ce(s),children:e.jsx(d,{icon:K,size:"sm"})})]})})]},s._id)})})]})})]})})}),e.jsxs(O,{visible:le,onClose:()=>C(!1),size:"lg",children:[e.jsx(X,{children:e.jsx(Y,{children:"üè® Hotel Details"})}),e.jsx(Z,{children:r&&e.jsxs(g,{children:[e.jsxs(p,{md:6,children:[e.jsx("h5",{children:r.title}),e.jsx("p",{className:"text-muted",children:r.description}),e.jsx("h6",{className:"mt-4",children:"üìç Address"}),e.jsxs("p",{children:[(E=r.address)==null?void 0:E.street," ",(B=r.address)==null?void 0:B.house_number,e.jsx("br",{}),(F=r.address)==null?void 0:F.city,", ",(M=r.address)==null?void 0:M.country]}),e.jsx("h6",{className:"mt-3",children:"üìû Contact"}),e.jsxs("p",{children:[e.jsx(d,{icon:Ce,className:"me-2"}),r.hotline||"N/A",e.jsx("br",{}),e.jsx(d,{icon:Ne,className:"me-2"}),r.email||"N/A"]})]}),e.jsxs(p,{md:6,children:[e.jsx("h6",{children:"üè¢ Property Details"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Name:"})," ",(I=r.property)==null?void 0:I.name,e.jsx("br",{}),e.jsx("strong",{children:"Description:"})," ",($=r.property)==null?void 0:$.description,e.jsx("br",{}),e.jsx("strong",{children:"Total Apartments:"})," ",(U=r.property)==null?void 0:U.total_apartments]}),e.jsx("h6",{className:"mt-3",children:"üí∞ Pricing & Details"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Price per day:"})," ",T(r.price_per_day,r.currency),e.jsx("br",{}),e.jsx("strong",{children:"Total area:"})," ",r.total_area,"m¬≤",e.jsx("br",{}),e.jsx("strong",{children:"Bedrooms:"})," ",r.bedrooms,e.jsx("br",{}),e.jsx("strong",{children:"Bathrooms:"})," ",r.bathrooms]}),e.jsx("h6",{className:"mt-3",children:"‚ú® Amenities"}),e.jsxs("div",{className:"d-flex flex-wrap gap-1",children:[((R=r.property)==null?void 0:R.has_pool)&&e.jsx(n,{color:"info",children:"Pool"}),((L=r.property)==null?void 0:L.has_elevator)&&e.jsx(n,{color:"secondary",children:"Elevator"}),r.is_furnished&&e.jsx(n,{color:"primary",children:"Furnished"}),r.is_garage&&e.jsx(n,{color:"success",children:"Garage"}),(G=r.amenities)==null?void 0:G.map((s,i)=>s.is_available&&e.jsx(n,{color:"warning",children:s.name},i))]})]})]})}),e.jsx(ee,{children:e.jsx(t,{color:"secondary",onClick:()=>C(!1),children:"Close"})})]}),e.jsxs(O,{visible:ae,onClose:S,size:"sm",children:[e.jsx(X,{children:e.jsx(Y,{children:"üóëÔ∏è Confirm Delete"})}),e.jsx(Z,{children:a&&e.jsxs("div",{children:[e.jsx("p",{children:"Are you sure you want to delete this hotel?"}),e.jsxs("div",{className:"bg-light p-3 rounded",children:[e.jsx("strong",{children:a.title}),e.jsx("br",{}),e.jsxs("small",{className:"text-muted",children:["ID: ",a._id]}),a.address&&e.jsx("div",{className:"mt-2",children:e.jsxs("small",{children:["üìç ",a.address.city,", ",a.address.country]})})]}),e.jsxs(H,{color:"warning",className:"mt-3 mb-0",children:[e.jsx("strong",{children:"Warning:"})," This action cannot be undone!"]})]})}),e.jsxs(ee,{children:[e.jsx(t,{color:"secondary",onClick:S,disabled:b,children:"Cancel"}),e.jsx(t,{color:"danger",onClick:te,disabled:b,children:b?e.jsxs(e.Fragment,{children:[e.jsx(W,{size:"sm",className:"me-2"}),"Deleting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(d,{icon:K,className:"me-2"}),"Delete Hotel"]})})]})]})]})};export{Se as default};
