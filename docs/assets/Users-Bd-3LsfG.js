import{v as b,r as l,A as k,B as z,j as e,w as h,x,C as _,y as u,z as A}from"./index-B0tKwzjh.js";import{a,c as R}from"./index.esm-K9u9fo5J.js";import{C as j,a as m}from"./CRow-BCx5Pu7f.js";import{C as B,a as I,b as y,c as n,d as F,e as i}from"./CTable-BjeKGvus.js";import{a as C}from"./DefaultLayout-3qL1Ic3U.js";import{c as M}from"./cil-trash-CBbKHhHb.js";import"./cil-user-Dlmw-Gem.js";const Z=()=>{const g=b(),[o,v]=l.useState([]),[w,p]=l.useState(!0),[f,c]=l.useState(null),[P,U]=l.useState(null),[H,N]=l.useState(!1),[L,S]=l.useState(!1),[V,T]=l.useState(null),[$,q]=l.useState(!1);l.useEffect(()=>{d()},[]);const d=async()=>{var s,t;p(!0),c(null);try{let r;try{console.log("🏨 Fetching Users via proxy..."),r=await k.get("/governance/users")}catch{console.log("⚠️ Proxy failed, trying direct API..."),r=await z.get("/governance/users")}console.log("✅ Users API response:",r.data),r.data&&r.data.data?v(r.data.data):c("Invalid response format")}catch(r){console.error("❌ Error fetching Users:",r),c(((t=(s=r.response)==null?void 0:s.data)==null?void 0:t.message)||r.message||"Failed to fetch Users")}finally{p(!1)}},D=s=>{U(s),N(!0)},E=s=>{T(s),S(!0)};return w?e.jsx(j,{children:e.jsx(m,{xs:12,children:e.jsx(h,{children:e.jsxs(x,{className:"text-center py-5",children:[e.jsx(_,{color:"primary",variant:"grow"}),e.jsx("div",{className:"mt-3",children:"Loading Users..."})]})})})}):f?e.jsx(j,{children:e.jsx(m,{xs:12,children:e.jsx(h,{children:e.jsx(x,{children:e.jsxs(u,{color:"danger",children:[e.jsx("strong",{children:"Error:"})," ",f,e.jsx("div",{className:"mt-2",children:e.jsx(a,{color:"primary",size:"sm",onClick:d,children:"Retry"})})]})})})})}):e.jsx(e.Fragment,{children:e.jsx(j,{children:e.jsx(m,{xs:12,children:e.jsxs(h,{children:[e.jsx(A,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"👤 Users"}),e.jsxs("small",{className:"ms-2",children:["Total: ",o.length," users"]})]}),e.jsxs("div",{children:[e.jsx(a,{color:"success",size:"sm",className:"me-2",onClick:()=>g("/user/create"),children:"Create User"}),e.jsx(a,{color:"primary",size:"sm",onClick:d,children:"Refresh"})]})]})}),e.jsx(x,{children:o.length===0?e.jsx(u,{color:"info",children:"No users found."}):e.jsxs(B,{hover:!0,responsive:!0,children:[e.jsx(I,{children:e.jsxs(y,{children:[e.jsx(n,{children:"Full Name"}),e.jsx(n,{children:"Email"}),e.jsx(n,{children:"Company"}),e.jsx(n,{children:"Role"}),e.jsx(n,{children:"Policy IDs"}),e.jsx(n,{children:"Actions"})]})}),e.jsx(F,{children:o.map(s=>e.jsxs(y,{children:[e.jsxs(i,{children:[s.first_name," ",s.last_name]}),e.jsx(i,{children:s.email}),e.jsx(i,{children:s.company}),e.jsx(i,{children:e.jsx(C,{color:"dark",children:s.role})}),e.jsx(i,{children:s.policy_id&&s.policy_id.length>0?s.policy_id.map(t=>e.jsxs(C,{color:"secondary",className:"me-1",children:["#",t]},t)):e.jsx(C,{color:"light",children:"None"})}),e.jsx(i,{children:e.jsxs("div",{className:"d-flex gap-1 flex-wrap",children:[e.jsx(a,{color:"primary",size:"sm",variant:"outline",onClick:()=>D(s),children:"View"}),e.jsx(a,{color:"warning",size:"sm",variant:"outline",onClick:()=>g(`/user/${s._id}/edit`),children:"Edit"}),e.jsx(a,{color:"danger",size:"sm",variant:"outline",onClick:()=>E(s),children:e.jsx(R,{icon:M,size:"sm"})})]})})]},s._id))})]})})]})})})})};export{Z as default};
