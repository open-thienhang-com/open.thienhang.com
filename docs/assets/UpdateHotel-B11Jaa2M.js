import{v as me,E as he,r as F,A as re,B as pe,j as e,w as A,x as D,C as ae,y as xe,z as ue,D as te}from"./index-JbP_4Lsp.js";import{b as q,a as _,c as ie}from"./index.esm-CyKLJB-2.js";import{C as m,a}from"./CRow-VH0aKeGn.js";import{c as je}from"./cil-arrow-left-D66Kb3Zq.js";import{C as ye}from"./CForm-B9xNwQm4.js";import{C as o}from"./CFormLabel-yeMoF64O.js";import{C as d}from"./CFormInput-B4hSc71z.js";import{C as ne}from"./CFormTextarea-BFzHGVfu.js";import{C as be,a as _e}from"./CInputGroupText-CSkY6xeg.js";import{C as g}from"./CFormCheck-BROyYyvW.js";import{c as ge}from"./cil-save-CHBg7z_U.js";import"./CFormControlWrapper-MU2aDS0W.js";import"./CFormControlValidation-BKM9zoHi.js";const Ee=()=>{const f=me(),{id:y}=he(),[H,S]=F.useState(!1),[oe,$]=F.useState(!0),[E,w]=F.useState(null),[s,v]=F.useState({_id:"",title:"",description:"",price_per_day:0,total_area:0,bedrooms:0,bathrooms:0,hotline:"",email:"",currency:"USD",is_furnished:!1,is_garage:!1,is_booked:!1,is_active:!0,property:{id:"",name:"",description:"",has_pool:!1,has_elevator:!1,total_apartments:0},address:{country:"",city:"",street:"",house_number:"",latitude:0,longitude:0},propertyAddress:{country:"",city:"",street:"",house_number:"",latitude:0,longitude:0},amenities:[]});F.useEffect(()=>{y&&P()},[y]);const P=async()=>{var t,n,l,h,b,c,p,j,C,x,N,k,I,B,z,L,U,T,R,G,V,M,J,K,O,Q,W,X,Y,Z,ee,se;$(!0),w(null);try{let u;try{console.log("ðŸ¨ Fetching hotel data via proxy..."),u=await re.get(`/services/hotel/apartment/apartment/${y}`)}catch{console.log("âš ï¸ Proxy failed, trying direct API..."),u=await pe.get(`/services/hotel/apartment/apartment/${y}`)}if(console.log("âœ… Hotel data API response:",u.data),u.data&&u.data.data){const r=u.data.data;v({_id:r._id||"",title:r.title||"",description:r.description||"",price_per_day:r.price_per_day||0,total_area:r.total_area||0,bedrooms:r.bedrooms||0,bathrooms:r.bathrooms||0,hotline:r.hotline||"",email:r.email||"",currency:r.currency||"USD",is_furnished:r.is_furnished||!1,is_garage:r.is_garage||!1,is_booked:r.is_booked||!1,is_active:r.is_active!==!1,property:{id:((t=r.property)==null?void 0:t.id)||"",name:((n=r.property)==null?void 0:n.name)||"",description:((l=r.property)==null?void 0:l.description)||"",has_pool:((h=r.property)==null?void 0:h.has_pool)||!1,has_elevator:((b=r.property)==null?void 0:b.has_elevator)||!1,total_apartments:((c=r.property)==null?void 0:c.total_apartments)||0},address:{country:((p=r.address)==null?void 0:p.country)||"",city:((j=r.address)==null?void 0:j.city)||"",street:((C=r.address)==null?void 0:C.street)||"",house_number:((x=r.address)==null?void 0:x.house_number)||"",latitude:((N=r.address)==null?void 0:N.latitude)||0,longitude:((k=r.address)==null?void 0:k.longitude)||0},propertyAddress:{country:((B=(I=r.property)==null?void 0:I.address)==null?void 0:B.country)||((z=r.address)==null?void 0:z.country)||"",city:((U=(L=r.property)==null?void 0:L.address)==null?void 0:U.city)||((T=r.address)==null?void 0:T.city)||"",street:((G=(R=r.property)==null?void 0:R.address)==null?void 0:G.street)||((V=r.address)==null?void 0:V.street)||"",house_number:((J=(M=r.property)==null?void 0:M.address)==null?void 0:J.house_number)||((K=r.address)==null?void 0:K.house_number)||"",latitude:((Q=(O=r.property)==null?void 0:O.address)==null?void 0:Q.latitude)||((W=r.address)==null?void 0:W.latitude)||0,longitude:((Y=(X=r.property)==null?void 0:X.address)==null?void 0:Y.longitude)||((Z=r.address)==null?void 0:Z.longitude)||0},amenities:r.amenities||[]})}else w("Invalid response format")}catch(u){console.error("âŒ Error fetching hotel data:",u),w(((se=(ee=u.response)==null?void 0:ee.data)==null?void 0:se.message)||u.message||"Failed to fetch hotel data")}finally{$(!1)}},i=(t,n=null,l=null,h=null)=>{const{name:b,value:c,type:p,checked:j}=t.target,C=p==="checkbox"?j:p==="number"?parseFloat(c)||0:c;v(n&&l!==null&&h?x=>({...x,[n]:x[n].map((N,k)=>k===l?{...N,[h]:C}:N)}):n?x=>({...x,[n]:{...x[n],[b]:C}}):x=>({...x,[b]:C}))},de=()=>{v(t=>({...t,amenities:[...t.amenities,{id:"",name:"",description:"",is_available:!0}]}))},le=t=>{v(n=>({...n,amenities:n.amenities.filter((l,h)=>h!==t)}))},ce=async t=>{var n,l,h,b;t.preventDefault(),S(!0);try{const c={_id:s._id,property:{id:s.property.id,name:s.property.name,description:s.property.description,has_pool:s.property.has_pool,has_elevator:s.property.has_elevator,total_apartments:s.property.total_apartments,address:s.propertyAddress},amenities:s.amenities.map(j=>({id:j.id||"",name:j.name,description:j.description,is_available:j.is_available})),address:s.address,hotline:s.hotline,email:s.email,title:s.title,description:s.description,price_per_day:s.price_per_day,total_area:s.total_area,is_furnished:s.is_furnished,is_garage:s.is_garage,bedrooms:s.bedrooms,bathrooms:s.bathrooms,is_booked:s.is_booked,is_active:s.is_active,currency:s.currency};console.log("Updating hotel with payload:",c);const p=await re.put(`/services/hotel/apartment/apartment/${y}`,c);console.log("Hotel updated successfully:",p.data),te.success(p.data.message||"Hotel updated successfully!"),f(`/hotels/${y}`)}catch(c){console.error("Error updating hotel:",c);const p=((l=(n=c.response)==null?void 0:n.data)==null?void 0:l.message)||((b=(h=c.response)==null?void 0:h.data)==null?void 0:b.error)||"Failed to update hotel. Please try again.";te.error(p)}finally{S(!1)}};return oe?e.jsx(q,{children:e.jsx(m,{children:e.jsx(a,{xs:12,children:e.jsx(A,{children:e.jsxs(D,{className:"text-center py-5",children:[e.jsx(ae,{color:"primary",variant:"grow"}),e.jsx("div",{className:"mt-3",children:"Loading hotel data..."})]})})})})}):E?e.jsx(q,{children:e.jsx(m,{children:e.jsx(a,{xs:12,children:e.jsx(A,{children:e.jsx(D,{children:e.jsxs(xe,{color:"danger",children:[e.jsx("strong",{children:"Error:"})," ",E,e.jsxs("div",{className:"mt-2",children:[e.jsx(_,{color:"primary",size:"sm",onClick:P,children:"Retry"}),e.jsx(_,{color:"secondary",size:"sm",className:"ms-2",onClick:()=>f("/hotels"),children:"Back to Hotels"})]})]})})})})})}):e.jsx(q,{children:e.jsx(m,{children:e.jsx(a,{xs:12,children:e.jsxs(A,{children:[e.jsx(ue,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h4",{className:"mb-0",children:"Update Hotel"}),e.jsxs("div",{children:[e.jsx(_,{color:"info",variant:"outline",size:"sm",className:"me-2",onClick:()=>f(`/hotels/${y}`),children:"View Details"}),e.jsxs(_,{color:"secondary",variant:"outline",onClick:()=>f("/hotels"),children:[e.jsx(ie,{icon:je,className:"me-2"}),"Back to Hotels"]})]})]})}),e.jsx(D,{children:e.jsxs(ye,{onSubmit:ce,children:[e.jsxs(m,{className:"mb-4",children:[e.jsx(a,{xs:12,children:e.jsx("h5",{className:"text-primary border-bottom pb-2",children:"Basic Information"})}),e.jsx(a,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{htmlFor:"title",children:"Title *"}),e.jsx(d,{type:"text",id:"title",name:"title",value:s.title,onChange:i,required:!0})]})}),e.jsx(a,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{htmlFor:"email",children:"Email *"}),e.jsx(d,{type:"email",id:"email",name:"email",value:s.email,onChange:i,required:!0})]})}),e.jsx(a,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{htmlFor:"hotline",children:"Hotline *"}),e.jsx(d,{type:"text",id:"hotline",name:"hotline",value:s.hotline,onChange:i,required:!0})]})}),e.jsx(a,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{htmlFor:"currency",children:"Currency"}),e.jsx(d,{type:"text",id:"currency",name:"currency",value:s.currency,onChange:i})]})}),e.jsx(a,{xs:12,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{htmlFor:"description",children:"Description"}),e.jsx(ne,{id:"description",name:"description",rows:3,value:s.description,onChange:i})]})})]}),e.jsxs(m,{className:"mb-4",children:[e.jsx(a,{xs:12,children:e.jsx("h5",{className:"text-primary border-bottom pb-2",children:"Pricing & Space"})}),e.jsx(a,{md:3,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{htmlFor:"price_per_day",children:"Price per Day *"}),e.jsxs(be,{children:[e.jsx(_e,{children:"$"}),e.jsx(d,{type:"number",id:"price_per_day",name:"price_per_day",value:s.price_per_day,onChange:i,required:!0,min:"0",step:"0.01"})]})]})}),e.jsx(a,{md:3,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{htmlFor:"total_area",children:"Total Area (mÂ²) *"}),e.jsx(d,{type:"number",id:"total_area",name:"total_area",value:s.total_area,onChange:i,required:!0,min:"0"})]})}),e.jsx(a,{md:3,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{htmlFor:"bedrooms",children:"Bedrooms *"}),e.jsx(d,{type:"number",id:"bedrooms",name:"bedrooms",value:s.bedrooms,onChange:i,required:!0,min:"0"})]})}),e.jsx(a,{md:3,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{htmlFor:"bathrooms",children:"Bathrooms *"}),e.jsx(d,{type:"number",id:"bathrooms",name:"bathrooms",value:s.bathrooms,onChange:i,required:!0,min:"0"})]})})]}),e.jsxs(m,{className:"mb-4",children:[e.jsx(a,{xs:12,children:e.jsx("h5",{className:"text-primary border-bottom pb-2",children:"Features"})}),e.jsx(a,{md:3,children:e.jsx(g,{id:"is_furnished",name:"is_furnished",checked:s.is_furnished,onChange:i,label:"Furnished"})}),e.jsx(a,{md:3,children:e.jsx(g,{id:"is_garage",name:"is_garage",checked:s.is_garage,onChange:i,label:"Has Garage"})}),e.jsx(a,{md:3,children:e.jsx(g,{id:"is_active",name:"is_active",checked:s.is_active,onChange:i,label:"Active"})}),e.jsx(a,{md:3,children:e.jsx(g,{id:"is_booked",name:"is_booked",checked:s.is_booked,onChange:i,label:"Currently Booked"})})]}),e.jsxs(m,{className:"mb-4",children:[e.jsx(a,{xs:12,children:e.jsx("h5",{className:"text-primary border-bottom pb-2",children:"Property Information"})}),e.jsx(a,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{htmlFor:"property_name",children:"Property Name *"}),e.jsx(d,{type:"text",id:"property_name",name:"name",value:s.property.name,onChange:t=>i(t,"property"),required:!0})]})}),e.jsx(a,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{htmlFor:"total_apartments",children:"Total Apartments"}),e.jsx(d,{type:"number",id:"total_apartments",name:"total_apartments",value:s.property.total_apartments,onChange:t=>i(t,"property"),min:"0"})]})}),e.jsx(a,{xs:12,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{htmlFor:"property_description",children:"Property Description"}),e.jsx(ne,{id:"property_description",name:"description",rows:2,value:s.property.description,onChange:t=>i(t,"property")})]})}),e.jsx(a,{md:6,children:e.jsx(g,{id:"has_pool",name:"has_pool",checked:s.property.has_pool,onChange:t=>i(t,"property"),label:"Has Pool"})}),e.jsx(a,{md:6,children:e.jsx(g,{id:"has_elevator",name:"has_elevator",checked:s.property.has_elevator,onChange:t=>i(t,"property"),label:"Has Elevator"})})]}),e.jsxs(m,{className:"mb-4",children:[e.jsx(a,{xs:12,children:e.jsx("h5",{className:"text-primary border-bottom pb-2",children:"Address"})}),e.jsx(a,{md:3,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{htmlFor:"country",children:"Country *"}),e.jsx(d,{type:"text",id:"country",name:"country",value:s.address.country,onChange:t=>i(t,"address"),required:!0})]})}),e.jsx(a,{md:3,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{htmlFor:"city",children:"City *"}),e.jsx(d,{type:"text",id:"city",name:"city",value:s.address.city,onChange:t=>i(t,"address"),required:!0})]})}),e.jsx(a,{md:4,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{htmlFor:"street",children:"Street *"}),e.jsx(d,{type:"text",id:"street",name:"street",value:s.address.street,onChange:t=>i(t,"address"),required:!0})]})}),e.jsx(a,{md:2,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{htmlFor:"house_number",children:"House No. *"}),e.jsx(d,{type:"text",id:"house_number",name:"house_number",value:s.address.house_number,onChange:t=>i(t,"address"),required:!0})]})}),e.jsx(a,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{htmlFor:"latitude",children:"Latitude"}),e.jsx(d,{type:"number",id:"latitude",name:"latitude",value:s.address.latitude,onChange:t=>i(t,"address"),step:"any"})]})}),e.jsx(a,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{htmlFor:"longitude",children:"Longitude"}),e.jsx(d,{type:"number",id:"longitude",name:"longitude",value:s.address.longitude,onChange:t=>i(t,"address"),step:"any"})]})})]}),e.jsxs(m,{className:"mb-4",children:[e.jsx(a,{xs:12,children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center border-bottom pb-2 mb-3",children:[e.jsx("h5",{className:"text-primary mb-0",children:"Amenities"}),e.jsx(_,{color:"primary",variant:"outline",size:"sm",onClick:de,children:"Add Amenity"})]})}),s.amenities.map((t,n)=>e.jsx(a,{xs:12,children:e.jsx(A,{className:"mb-3 border-start border-4 border-primary",children:e.jsx(D,{children:e.jsxs(m,{children:[e.jsx(a,{md:4,children:e.jsxs("div",{className:"mb-2",children:[e.jsx(o,{htmlFor:`amenity_name_${n}`,children:"Name"}),e.jsx(d,{type:"text",id:`amenity_name_${n}`,value:t.name||"",onChange:l=>i(l,"amenities",n,"name"),required:!0})]})}),e.jsx(a,{md:6,children:e.jsxs("div",{className:"mb-2",children:[e.jsx(o,{htmlFor:`amenity_description_${n}`,children:"Description"}),e.jsx(d,{type:"text",id:`amenity_description_${n}`,value:t.description||"",onChange:l=>i(l,"amenities",n,"description")})]})}),e.jsx(a,{md:2,children:e.jsxs("div",{className:"d-flex align-items-end justify-content-between h-100",children:[e.jsx(g,{id:`amenity_available_${n}`,checked:t.is_available,onChange:l=>i(l,"amenities",n,"is_available"),label:"Available"}),e.jsx(_,{color:"danger",variant:"outline",size:"sm",onClick:()=>le(n),children:"Remove"})]})})]})})})},n))]}),e.jsx(m,{children:e.jsx(a,{xs:12,children:e.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[e.jsx(_,{color:"secondary",onClick:()=>f(`/hotels/${y}`),disabled:H,children:"Cancel"}),e.jsx(_,{color:"primary",type:"submit",disabled:H,children:H?e.jsxs(e.Fragment,{children:[e.jsx(ae,{size:"sm",className:"me-2"}),"Updating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ie,{icon:ge,className:"me-2"}),"Update Hotel"]})})]})})})]})})]})})})})};export{Ee as default};
