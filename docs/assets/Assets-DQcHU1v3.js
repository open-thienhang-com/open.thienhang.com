import{y as I,r as t,E as T,n as k,j as e,z as C,A as u,l as z,B as g,e as c,D as L,F as M}from"./index-CZxwAXbl.js";import{a as E}from"./index.esm-BOhZrsQ0.js";import{C as f,a as p}from"./CRow-BFihry9H.js";import{C as O,a as q,b as F,c as l,d as G,e as i}from"./CTable-CY1aV83v.js";import{c as _}from"./cil-trash-CBbKHhHb.js";import{C as J,a as K,b as P,c as Q,d as U}from"./CModalTitle-cZnrg16x.js";import"./DefaultLayout-DoGqnKgH.js";import"./cil-user-Dlmw-Gem.js";const ae=()=>{const y=I(),[h,v]=t.useState([]),[B,w]=t.useState(!0),[b,A]=t.useState(null),[r,D]=t.useState(null),[R,N]=t.useState(!1),[x,S]=t.useState(!1);t.useEffect(()=>{j()},[]);const j=async()=>{var s,o,a;w(!0),A(null);try{let n;try{n=await T.get("/governance/assets")}catch{n=await k.get("/governance/assets")}const d=(s=n.data)==null?void 0:s.data;if(Array.isArray(d))v(d);else throw new Error("Invalid response format")}catch(n){A(((a=(o=n.response)==null?void 0:o.data)==null?void 0:a.message)||n.message||"Failed to fetch assets")}finally{w(!1)}},H=s=>{D(s),N(!0)},$=async()=>{var s,o;if(r){S(!0);try{let a;try{a=await T.delete(`/governance/asset/${r._id}`)}catch{a=await k.delete(`/governance/asset/${r._id}`)}M.success(a.data.message||`Deleted: "${r.name}"`),v(n=>n.filter(d=>d._id!==r._id)),m()}catch(a){M.error(((o=(s=a.response)==null?void 0:s.data)==null?void 0:o.message)||"Delete failed")}finally{S(!1)}}},m=()=>{N(!1),D(null)};return B?e.jsx(f,{children:e.jsx(p,{xs:12,children:e.jsx(C,{children:e.jsxs(u,{className:"text-center py-5",children:[e.jsx(z,{color:"primary",variant:"grow"}),e.jsx("div",{className:"mt-3",children:"Loading Assets..."})]})})})}):b?e.jsx(f,{children:e.jsx(p,{xs:12,children:e.jsx(C,{children:e.jsx(u,{children:e.jsxs(g,{color:"danger",children:[e.jsx("strong",{children:"Error:"})," ",b,e.jsx("div",{className:"mt-2",children:e.jsx(c,{color:"primary",size:"sm",onClick:j,children:"Retry"})})]})})})})}):e.jsxs(e.Fragment,{children:[e.jsx(f,{children:e.jsx(p,{xs:12,children:e.jsxs(C,{children:[e.jsxs(L,{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"üè® Assets"}),e.jsxs("small",{className:"ms-2",children:["Total: ",h.length]})]}),e.jsxs("div",{children:[e.jsx(c,{color:"success",size:"sm",className:"me-2",onClick:()=>y("/governance/asset/create"),children:"Create Asset"}),e.jsx(c,{color:"primary",size:"sm",onClick:j,children:"Refresh"})]})]}),e.jsx(u,{children:h.length===0?e.jsx(g,{color:"info",children:"No assets found."}):e.jsxs(O,{hover:!0,responsive:!0,children:[e.jsx(q,{children:e.jsxs(F,{children:[e.jsx(l,{children:"Name"}),e.jsx(l,{children:"Type"}),e.jsx(l,{children:"Source"}),e.jsx(l,{children:"Location"}),e.jsx(l,{children:"Owner"}),e.jsx(l,{children:"Sensitivity"}),e.jsx(l,{children:"Description"}),e.jsx(l,{children:"Actions"})]})}),e.jsx(G,{children:h.map(s=>e.jsxs(F,{children:[e.jsx(i,{children:s.name}),e.jsx(i,{children:s.type}),e.jsx(i,{children:s.source}),e.jsx(i,{children:s.location}),e.jsx(i,{children:s.owner}),e.jsx(i,{children:s.sensitivity}),e.jsx(i,{children:s.description}),e.jsx(i,{children:e.jsxs("div",{className:"d-flex gap-1 flex-wrap",children:[e.jsx(c,{color:"success",size:"sm",onClick:()=>y(`/governance/asset/${s._id}`),children:"Details"}),e.jsx(c,{color:"danger",variant:"outline",size:"sm",onClick:()=>H(s),children:e.jsx(E,{icon:_,size:"sm"})})]})})]},s._id))})]})})]})})}),e.jsxs(J,{visible:R,onClose:m,size:"sm",children:[e.jsx(K,{children:e.jsx(P,{children:"üóëÔ∏è Confirm Delete"})}),e.jsx(Q,{children:r&&e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"Are you sure you want to delete this asset?"}),e.jsxs("div",{className:"bg-dark text-white p-3 rounded",children:[e.jsx("strong",{children:r.name}),e.jsx("br",{}),e.jsxs("small",{children:["ID: ",r._id]})]}),e.jsx(g,{color:"warning",className:"mt-3 mb-0",children:"This action cannot be undone."})]})}),e.jsxs(U,{children:[e.jsx(c,{color:"secondary",onClick:m,disabled:x,children:"Cancel"}),e.jsx(c,{color:"danger",onClick:$,disabled:x,children:x?e.jsxs(e.Fragment,{children:[e.jsx(z,{size:"sm",className:"me-2"}),"Deleting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(E,{icon:_,className:"me-2"}),"Delete"]})})]})]})]})};export{ae as default};
