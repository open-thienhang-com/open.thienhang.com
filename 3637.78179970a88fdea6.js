"use strict";(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[3637],{3637:(R,g,i)=>{i.r(g),i.d(g,{PosComponent:()=>E});var m=i(2881),l=i(9417),p=i(1141),u=i(2242),_=i(7480),h=i(8150),f=i(7722),C=i(5779),b=i(8533),e=i(1360);function y(r,c){1&r&&(e.j41(0,"div",24),e.EFF(1,"Loading catalog..."),e.k0s())}function P(r,c){if(1&r){const t=e.RV6();e.j41(0,"button",27),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(2);return e.Njj(a.addToCart(n))}),e.j41(1,"div",28)(2,"span",29),e.EFF(3),e.k0s(),e.j41(4,"span",30),e.EFF(5),e.k0s()(),e.j41(6,"h3"),e.EFF(7),e.k0s(),e.j41(8,"p",31),e.EFF(9),e.k0s(),e.j41(10,"span",32),e.EFF(11,"Tap to add"),e.k0s()()}if(2&r){const t=c.$implicit,o=e.XpG(2);e.R7$(3),e.JRh(t.category),e.R7$(2),e.JRh(t.sku||"-"),e.R7$(2),e.JRh(t.name),e.R7$(2),e.JRh(o.formatCurrency(t.price))}}function M(r,c){if(1&r&&(e.j41(0,"div",25),e.DNE(1,P,12,4,"button",26),e.k0s()),2&r){const t=e.XpG();e.R7$(),e.Y8G("ngForOf",t.filteredProducts)}}function O(r,c){if(1&r){const t=e.RV6();e.j41(0,"article",35)(1,"div",36)(2,"h4"),e.EFF(3),e.k0s(),e.j41(4,"p"),e.EFF(5),e.k0s()(),e.j41(6,"div",37)(7,"button",38),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(2);return e.Njj(a.decrease(n))}),e.EFF(8,"-"),e.k0s(),e.j41(9,"span"),e.EFF(10),e.k0s(),e.j41(11,"button",38),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(2);return e.Njj(a.increase(n))}),e.EFF(12,"+"),e.k0s(),e.j41(13,"button",39),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(2);return e.Njj(a.remove(n))}),e.EFF(14,"x"),e.k0s()(),e.j41(15,"div",40),e.EFF(16),e.k0s()()}if(2&r){const t=c.$implicit,o=e.XpG(2);e.R7$(3),e.JRh(t.product.name),e.R7$(2),e.JRh(o.formatCurrency(t.product.price)),e.R7$(5),e.JRh(t.quantity),e.R7$(6),e.JRh(o.formatCurrency(t.product.price*t.quantity))}}function v(r,c){if(1&r&&(e.j41(0,"div",33),e.DNE(1,O,17,4,"article",34),e.k0s()),2&r){const t=e.XpG();e.R7$(),e.Y8G("ngForOf",t.cart)}}function k(r,c){1&r&&(e.j41(0,"div",41),e.EFF(1,"No products in order."),e.k0s())}function F(r,c){if(1&r){const t=e.RV6();e.qex(0),e.j41(1,"label"),e.EFF(2,"Amount Received"),e.k0s(),e.j41(3,"p-inputNumber",42),e.mxI("ngModelChange",function(n){e.eBV(t);const a=e.XpG();return e.DH7(a.amountReceived,n)||(a.amountReceived=n),e.Njj(n)}),e.k0s(),e.j41(4,"div",18)(5,"span"),e.EFF(6,"Change"),e.k0s(),e.j41(7,"strong"),e.EFF(8),e.k0s()(),e.bVm()}if(2&r){const t=e.XpG();e.R7$(3),e.R50("ngModel",t.amountReceived),e.Y8G("min",0),e.R7$(5),e.JRh(t.formatCurrency(t.changeAmount))}}let E=(()=>{class r{productService;orderService;messageService;loading=!1;searchTerm="";selectedCategory="";paymentMethod="cash";amountReceived=null;placingOrder=!1;products=[];cart=[];categoryOptions=[{label:"All Categories",value:""}];paymentOptions=[{label:"Cash",value:"cash"},{label:"Card",value:"card"},{label:"E-Wallet",value:"ewallet"}];constructor(t,o,n){this.productService=t,this.orderService=o,this.messageService=n}ngOnInit(){this.loadProducts()}get filteredProducts(){const t=this.searchTerm.trim().toLowerCase();return this.products.filter(o=>(!t||o.name.toLowerCase().includes(t)||o.sku.toLowerCase().includes(t)||o.category.toLowerCase().includes(t))&&(!this.selectedCategory||o.category===this.selectedCategory))}get itemCount(){return this.cart.reduce((t,o)=>t+o.quantity,0)}get subtotal(){return this.cart.reduce((t,o)=>t+o.product.price*o.quantity,0)}get tax(){return.08*this.subtotal}get total(){return this.subtotal+this.tax}get changeAmount(){if("cash"!==this.paymentMethod)return 0;const t=Number(this.amountReceived||0);return Math.max(t-this.total,0)}loadProducts(){this.loading=!0,this.productService.listProducts(void 0,0,200).subscribe({next:t=>{const o=Array.isArray(t?.data)?t.data:[];this.products=o.map(n=>this.mapProduct(n)).filter(n=>n.isActive),this.products.length||(this.products=this.getFallbackProducts()),this.setupCategories(),this.loading=!1},error:()=>{this.products=this.getFallbackProducts(),this.setupCategories(),this.loading=!1,this.messageService.add({severity:"warn",summary:"POS",detail:"Product API unavailable. Using demo catalog."})}})}addToCart(t){const o=this.cart.find(n=>n.product.id===t.id);o?o.quantity+=1:this.cart.unshift({product:t,quantity:1})}increase(t){t.quantity+=1}decrease(t){t.quantity-=1,t.quantity<=0&&this.remove(t)}remove(t){this.cart=this.cart.filter(o=>o.product.id!==t.product.id)}clearCart(){this.cart=[],this.amountReceived=null}completeSale(){if(!this.cart.length||this.total<=0||this.placingOrder)return;if("cash"===this.paymentMethod&&Number(this.amountReceived||0)<this.total)return void this.messageService.add({severity:"warn",summary:"Insufficient Cash",detail:"Amount received is less than total amount."});const t={customer_id:"walk-in",total_amount:this.total,status:"confirmed",items:this.cart.map(o=>({product_id:o.product.id,quantity:o.quantity,unit_price:o.product.price,total_price:o.product.price*o.quantity}))};this.placingOrder=!0,this.orderService.createOrder(t).subscribe({next:()=>{this.placingOrder=!1,this.messageService.add({severity:"success",summary:"Sale Completed",detail:"Order has been created successfully."}),this.clearCart()},error:()=>{this.placingOrder=!1,this.messageService.add({severity:"info",summary:"Demo Checkout",detail:"Order API unavailable. Checkout completed in demo mode."}),this.clearCart()}})}formatCurrency(t){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:2}).format(t||0)}setupCategories(){const t=[...new Set(this.products.map(o=>o.category).filter(o=>!!o))];this.categoryOptions=[{label:"All Categories",value:""},...t.map(o=>({label:o,value:o}))]}mapProduct(t){return{id:String(t?._id||t?.id||""),name:String(t?.name||"Unnamed"),sku:String(t?.sku||""),category:String(t?.category||"General"),price:Number(t?.selling_price??t?.price??0),isActive:!1!==t?.is_active}}getFallbackProducts(){return[{id:"demo-pos-1",name:"Cold Brew Coffee",sku:"POS-001",category:"Beverage",price:3.5,isActive:!0},{id:"demo-pos-2",name:"Chicken Sandwich",sku:"POS-002",category:"Food",price:7.9,isActive:!0},{id:"demo-pos-3",name:"Chocolate Cookie",sku:"POS-003",category:"Bakery",price:2.25,isActive:!0},{id:"demo-pos-4",name:"Mineral Water",sku:"POS-004",category:"Beverage",price:1.75,isActive:!0}]}static \u0275fac=function(o){return new(o||r)(e.rXU(b.bk),e.rXU(b.QE),e.rXU(C.bg))};static \u0275cmp=e.VBU({type:r,selectors:[["app-pos"]],features:[e.Jv_([C.bg])],decls:57,vars:18,consts:[["emptyCart",""],[1,"pos-shell"],[1,"pos-header"],[1,"pos-label"],[1,"pos-header-meta"],[1,"meta-card"],[1,"pos-body"],[1,"catalog-panel"],[1,"toolbar"],["pInputText","","placeholder","Search by name, SKU, category...",3,"ngModelChange","ngModel"],["optionLabel","label","optionValue","value","styleClass","w-full md:w-18rem",3,"ngModelChange","options","ngModel"],["class","loading-state",4,"ngIf"],["class","catalog-grid",4,"ngIf"],[1,"checkout-panel"],[1,"cart-header"],["type","button",1,"clear-btn",3,"click","disabled"],["class","cart-list",4,"ngIf","ngIfElse"],[1,"payment-box"],[1,"summary-row"],[1,"summary-row","total"],[1,"payment-controls"],["optionLabel","label","optionValue","value","styleClass","w-full",3,"ngModelChange","options","ngModel"],[4,"ngIf"],["label","Complete Sale","icon","pi pi-check","styleClass","w-full",3,"onClick","loading","disabled"],[1,"loading-state"],[1,"catalog-grid"],["type","button","class","product-card",3,"click",4,"ngFor","ngForOf"],["type","button",1,"product-card",3,"click"],[1,"product-top"],[1,"category"],[1,"sku"],[1,"price"],[1,"add"],[1,"cart-list"],["class","line-item",4,"ngFor","ngForOf"],[1,"line-item"],[1,"line-main"],[1,"line-actions"],["type","button",3,"click"],["type","button",1,"remove",3,"click"],[1,"line-total"],[1,"empty-cart"],["mode","currency","currency","USD","locale","en-US","styleClass","w-full",3,"ngModelChange","ngModel","min"]],template:function(o,n){if(1&o){const a=e.RV6();e.nrm(0,"p-toast"),e.j41(1,"div",1)(2,"header",2)(3,"div")(4,"p",3),e.EFF(5,"Point of Sale"),e.k0s(),e.j41(6,"h1"),e.EFF(7,"Retail POS Terminal"),e.k0s()(),e.j41(8,"div",4)(9,"div",5)(10,"span"),e.EFF(11,"Items"),e.k0s(),e.j41(12,"strong"),e.EFF(13),e.k0s()(),e.j41(14,"div",5)(15,"span"),e.EFF(16,"Total"),e.k0s(),e.j41(17,"strong"),e.EFF(18),e.k0s()()()(),e.j41(19,"div",6)(20,"section",7)(21,"div",8)(22,"input",9),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.searchTerm,s)||(n.searchTerm=s),e.Njj(s)}),e.k0s(),e.j41(23,"p-dropdown",10),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.selectedCategory,s)||(n.selectedCategory=s),e.Njj(s)}),e.k0s()(),e.DNE(24,y,2,0,"div",11)(25,M,2,1,"div",12),e.k0s(),e.j41(26,"aside",13)(27,"div",14)(28,"h2"),e.EFF(29,"Current Order"),e.k0s(),e.j41(30,"button",15),e.bIt("click",function(){return e.eBV(a),e.Njj(n.clearCart())}),e.EFF(31,"Clear"),e.k0s()(),e.DNE(32,v,2,1,"div",16)(33,k,2,0,"ng-template",null,0,e.C5r),e.j41(35,"div",17)(36,"div",18)(37,"span"),e.EFF(38,"Subtotal"),e.k0s(),e.j41(39,"strong"),e.EFF(40),e.k0s()(),e.j41(41,"div",18)(42,"span"),e.EFF(43,"Tax (8%)"),e.k0s(),e.j41(44,"strong"),e.EFF(45),e.k0s()(),e.j41(46,"div",19)(47,"span"),e.EFF(48,"Total Due"),e.k0s(),e.j41(49,"strong"),e.EFF(50),e.k0s()(),e.j41(51,"div",20)(52,"label"),e.EFF(53,"Payment Method"),e.k0s(),e.j41(54,"p-dropdown",21),e.mxI("ngModelChange",function(s){return e.eBV(a),e.DH7(n.paymentMethod,s)||(n.paymentMethod=s),e.Njj(s)}),e.k0s(),e.DNE(55,F,9,3,"ng-container",22),e.k0s(),e.j41(56,"p-button",23),e.bIt("onClick",function(){return e.eBV(a),e.Njj(n.completeSale())}),e.k0s()()()()()}if(2&o){const a=e.sdS(34);e.R7$(13),e.JRh(n.itemCount),e.R7$(5),e.JRh(n.formatCurrency(n.total)),e.R7$(4),e.R50("ngModel",n.searchTerm),e.R7$(),e.Y8G("options",n.categoryOptions),e.R50("ngModel",n.selectedCategory),e.R7$(),e.Y8G("ngIf",n.loading),e.R7$(),e.Y8G("ngIf",!n.loading),e.R7$(5),e.Y8G("disabled",!n.cart.length),e.R7$(2),e.Y8G("ngIf",n.cart.length)("ngIfElse",a),e.R7$(8),e.JRh(n.formatCurrency(n.subtotal)),e.R7$(5),e.JRh(n.formatCurrency(n.tax)),e.R7$(5),e.JRh(n.formatCurrency(n.total)),e.R7$(4),e.Y8G("options",n.paymentOptions),e.R50("ngModel",n.paymentMethod),e.R7$(),e.Y8G("ngIf","cash"===n.paymentMethod),e.R7$(),e.Y8G("loading",n.placingOrder)("disabled",!n.cart.length||n.total<=0)}},dependencies:[m.MD,m.Sq,m.bT,l.YN,l.me,l.BC,l.vS,p.tm,p.$n,u.um,u.Sm,_.O3,_.YI,h.kr,h.ms,f.MB,f.y8],styles:[".pos-shell[_ngcontent-%COMP%]{min-height:100vh;padding:1rem;background:linear-gradient(180deg,#e2e8f0,#f8fafc 55%)}.pos-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;gap:1rem;background:#0f172a;color:#fff;border-radius:.85rem;padding:1rem 1.25rem;margin-bottom:1rem}.pos-label[_ngcontent-%COMP%]{margin:0;font-size:.72rem;text-transform:uppercase;letter-spacing:.06em;color:#93c5fd}.pos-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:.25rem 0 0;font-size:1.35rem}.pos-header-meta[_ngcontent-%COMP%]{display:flex;gap:.75rem}.meta-card[_ngcontent-%COMP%]{min-width:6.5rem;background:#ffffff14;border:1px solid rgba(255,255,255,.16);border-radius:.65rem;padding:.45rem .7rem}.meta-card[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.72rem;color:#bfdbfe;display:block}.meta-card[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:1rem}.pos-body[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 22rem;gap:1rem}.catalog-panel[_ngcontent-%COMP%], .checkout-panel[_ngcontent-%COMP%]{background:#fff;border:1px solid #dbe5f3;border-radius:.85rem;padding:.9rem}.toolbar[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 17rem;gap:.75rem;margin-bottom:.85rem}.loading-state[_ngcontent-%COMP%], .empty-cart[_ngcontent-%COMP%]{border:1px dashed #cbd5e1;color:#64748b;border-radius:.7rem;text-align:center;padding:1.5rem .75rem}.catalog-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:.7rem;max-height:calc(100vh - 16.5rem);overflow:auto}.product-card[_ngcontent-%COMP%]{border:1px solid #dbe5f3;border-radius:.75rem;padding:.75rem;text-align:left;background:#f8fafc;cursor:pointer;transition:all .14s ease}.product-card[_ngcontent-%COMP%]:hover{border-color:#38bdf8;background:#eff6ff;transform:translateY(-1px)}.product-top[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:.25rem;margin-bottom:.45rem}.category[_ngcontent-%COMP%]{font-size:.68rem;background:#dbeafe;color:#1d4ed8;border-radius:999px;padding:.1rem .45rem}.sku[_ngcontent-%COMP%]{font-size:.65rem;color:#64748b}.product-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:.92rem;color:#0f172a;min-height:2.2rem}.price[_ngcontent-%COMP%]{margin:.45rem 0 0;font-weight:700;color:#0369a1}.add[_ngcontent-%COMP%]{display:inline-block;font-size:.68rem;color:#475569;margin-top:.2rem}.cart-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:.75rem}.cart-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1rem}.clear-btn[_ngcontent-%COMP%]{border:1px solid #cbd5e1;background:#fff;border-radius:.5rem;padding:.2rem .5rem;color:#475569}.clear-btn[_ngcontent-%COMP%]:disabled{opacity:.5}.cart-list[_ngcontent-%COMP%]{max-height:46vh;overflow:auto;padding-right:.25rem}.line-item[_ngcontent-%COMP%]{border:1px solid #e2e8f0;border-radius:.65rem;padding:.55rem;margin-bottom:.55rem}.line-main[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;font-size:.86rem}.line-main[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.15rem 0 0;font-size:.75rem;color:#64748b}.line-actions[_ngcontent-%COMP%]{margin-top:.4rem;display:flex;align-items:center;gap:.3rem}.line-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:1px solid #cbd5e1;background:#fff;border-radius:.35rem;width:1.45rem;height:1.45rem;line-height:1}.line-actions[_ngcontent-%COMP%]   .remove[_ngcontent-%COMP%]{margin-left:auto}.line-total[_ngcontent-%COMP%]{margin-top:.45rem;text-align:right;font-weight:700;color:#0f172a;font-size:.86rem}.payment-box[_ngcontent-%COMP%]{margin-top:.7rem;border-top:1px solid #e2e8f0;padding-top:.8rem}.summary-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:.35rem;font-size:.86rem;color:#334155}.summary-row.total[_ngcontent-%COMP%]{font-weight:700;color:#0f172a;margin-bottom:.75rem}.payment-controls[_ngcontent-%COMP%]{display:grid;gap:.42rem;margin-bottom:.75rem}.payment-controls[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.74rem;color:#64748b}@media (max-width: 1080px){.pos-body[_ngcontent-%COMP%]{grid-template-columns:1fr}.catalog-grid[_ngcontent-%COMP%]{max-height:none}}@media (max-width: 720px){.toolbar[_ngcontent-%COMP%]{grid-template-columns:1fr}.pos-header[_ngcontent-%COMP%]{flex-direction:column}}"]})}return r})()}}]);