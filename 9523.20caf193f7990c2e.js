"use strict";(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[9523],{9523:(j,h,c)=>{c.r(h),c.d(h,{DashboardComponent:()=>R});var p=c(2881),v=c(9417),u=c(5207),_=c(1141),C=c(491),O=c(8559),b=c(7722),M=c(5716),P=c(5779),f=c(5545),t=c(1360);function k(o,m){if(1&o&&(t.j41(0,"div",10)(1,"p-card",11)(2,"div",12)(3,"div",13),t.nrm(4,"i",14),t.k0s(),t.j41(5,"div",15)(6,"span",16),t.EFF(7,"Total Revenue"),t.k0s(),t.j41(8,"span",17),t.EFF(9),t.nI1(10,"currency"),t.k0s(),t.j41(11,"span",18),t.EFF(12,"Last 30 days"),t.k0s()()()(),t.j41(13,"p-card",19)(14,"div",12)(15,"div",20),t.nrm(16,"i",21),t.k0s(),t.j41(17,"div",15)(18,"span",16),t.EFF(19,"Total Bookings"),t.k0s(),t.j41(20,"span",17),t.EFF(21),t.k0s(),t.j41(22,"span",18),t.EFF(23,"Last 30 days"),t.k0s()()()(),t.j41(24,"p-card",22)(25,"div",12)(26,"div",23),t.nrm(27,"i",24),t.k0s(),t.j41(28,"div",15)(29,"span",16),t.EFF(30,"Occupancy Rate"),t.k0s(),t.j41(31,"span",17),t.EFF(32),t.nI1(33,"number"),t.k0s(),t.j41(34,"span",18),t.EFF(35,"Last 30 days"),t.k0s()()()(),t.j41(36,"p-card",25)(37,"div",12)(38,"div",26),t.nrm(39,"i",27),t.k0s(),t.j41(40,"div",15)(41,"span",16),t.EFF(42,"Average Rating"),t.k0s(),t.j41(43,"span",17),t.EFF(44),t.nI1(45,"number"),t.k0s(),t.j41(46,"span",18),t.EFF(47,"Overall"),t.k0s()()()(),t.j41(48,"p-card",28)(49,"div",12)(50,"div",29),t.nrm(51,"i",30),t.k0s(),t.j41(52,"div",15)(53,"span",16),t.EFF(54,"Total Guests"),t.k0s(),t.j41(55,"span",17),t.EFF(56),t.k0s(),t.j41(57,"span",18),t.EFF(58,"All time"),t.k0s()()()(),t.j41(59,"p-card",31)(60,"div",12)(61,"div",32),t.nrm(62,"i",33),t.k0s(),t.j41(63,"div",15)(64,"span",16),t.EFF(65,"Active Apartments"),t.k0s(),t.j41(66,"span",17),t.EFF(67),t.k0s(),t.j41(68,"span",18),t.EFF(69,"Available"),t.k0s()()()()()),2&o){const e=t.XpG();t.R7$(9),t.JRh(t.bMT(10,6,e.totalRevenue)),t.R7$(12),t.JRh(e.totalBookings),t.R7$(11),t.SpI("",t.i5U(33,8,e.occupancyRate,"1.1-1"),"%"),t.R7$(12),t.JRh(t.i5U(45,11,e.averageRating,"1.1-1")),t.R7$(12),t.JRh(e.totalGuests),t.R7$(11),t.JRh(e.activeApartments)}}function y(o,m){if(1&o&&(t.j41(0,"div",34)(1,"p-card",35)(2,"div",36),t.nrm(3,"p-chart",37),t.k0s()(),t.j41(4,"p-card",38)(5,"div",36),t.nrm(6,"p-chart",37),t.k0s()()()),2&o){const e=t.XpG();t.R7$(3),t.Y8G("data",e.revenueChartData)("options",e.revenueChartOptions),t.R7$(3),t.Y8G("data",e.occupancyChartData)("options",e.occupancyChartOptions)}}function D(o,m){1&o&&(t.j41(0,"p-card",39)(1,"div",40),t.nrm(2,"button",41)(3,"button",42)(4,"button",43)(5,"button",44),t.k0s()())}function E(o,m){1&o&&(t.j41(0,"div",45),t.nrm(1,"p-skeleton",46)(2,"p-skeleton",47),t.k0s())}let R=(()=>{class o{hotelService;messageService;bookings=[];apartments=[];reviews=[];ratings=[];loading=!1;revenueChartData;revenueChartOptions;occupancyChartData;occupancyChartOptions;totalRevenue=0;totalBookings=0;occupancyRate=0;averageRating=0;totalGuests=0;activeApartments=0;constructor(e,i){this.hotelService=e,this.messageService=i}ngOnInit(){this.loadData()}loadData(){this.loading=!0,Promise.all([this.hotelService.getBookings().toPromise(),this.hotelService.getApartments().toPromise(),this.hotelService.getReviews().toPromise(),this.hotelService.getRatings().toPromise()]).then(([e,i,g,n])=>{this.bookings=e?.data||[],this.apartments=i?.data||[],this.reviews=g?.data||[],this.ratings=n?.data||[],this.calculateMetrics(),this.buildCharts(),this.loading=!1}).catch(()=>{this.messageService.add({severity:"error",summary:"Error",detail:"Failed to load dashboard data"}),this.loading=!1})}calculateMetrics(){const e=new Date;e.setDate(e.getDate()-30);const i=this.bookings.filter(a=>new Date(a.created)>=e&&"canceled"!==a.booking_status);this.totalBookings=i.length,this.totalRevenue=i.reduce((a,d)=>a+(d.total_price||0),0);const n=30*this.apartments.length;let r=0;i.forEach(a=>{const d=new Date(a.check_in),l=new Date(a.check_out),F=Math.ceil((l.getTime()-d.getTime())/864e5)+1;r+=F}),this.occupancyRate=n>0?r/n*100:0,this.ratings.length>0&&(this.averageRating=this.ratings.reduce((a,d)=>a+d.avg_rating,0)/this.ratings.length);const s=new Set(this.bookings.map(a=>a.account_id));this.totalGuests=s.size,this.activeApartments=this.apartments.filter(a=>a.is_active&&a.is_available_for_booking).length}buildCharts(){const e=Array.from({length:7},(n,r)=>{const s=new Date;return s.setDate(s.getDate()-(6-r)),s.toISOString().split("T")[0]}),i=e.map(n=>this.bookings.filter(r=>new Date(r.created).toISOString().split("T")[0]===n&&"canceled"!==r.booking_status).reduce((r,s)=>r+(s.total_price||0),0));this.revenueChartData={labels:e.map(n=>new Date(n).toLocaleDateString("en-US",{month:"short",day:"numeric"})),datasets:[{label:"Daily Revenue",data:i,fill:!0,backgroundColor:"rgba(59, 130, 246, 0.2)",borderColor:"rgb(59, 130, 246)",tension:.4}]},this.revenueChartOptions={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:"Revenue (Last 7 Days)"}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Revenue ($)"}}}};const g=e.map(n=>{const r=new Set;return this.bookings.forEach(s=>{const a=new Date(s.check_in),d=new Date(s.check_out),l=new Date(n);l>=a&&l<=d&&"canceled"!==s.booking_status&&r.add(s.apartment_id)}),this.apartments.length>0?r.size/this.apartments.length*100:0});this.occupancyChartData={labels:e.map(n=>new Date(n).toLocaleDateString("en-US",{month:"short",day:"numeric"})),datasets:[{label:"Occupancy Rate",data:g,fill:!0,backgroundColor:"rgba(34, 197, 94, 0.2)",borderColor:"rgb(34, 197, 94)",tension:.4}]},this.occupancyChartOptions={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:"Occupancy Rate (Last 7 Days)"}},scales:{y:{beginAtZero:!0,max:100,title:{display:!0,text:"Occupancy (%)"}}}}}static \u0275fac=function(i){return new(i||o)(t.rXU(f.g),t.rXU(P.bg))};static \u0275cmp=t.VBU({type:o,selectors:[["app-hotel-dashboard"]],features:[t.Jv_([P.bg])],decls:16,vars:4,consts:[["loadingTemplate",""],[1,"dashboard-page"],[1,"page-header"],[1,"header-content"],[1,"subtitle"],[1,"header-actions"],["pButton","","type","button","label","Refresh","icon","pi pi-refresh",1,"p-button-secondary",3,"click"],["class","metrics-grid",4,"ngIf","ngIfElse"],["class","charts-grid",4,"ngIf"],["header","Quick Actions",4,"ngIf"],[1,"metrics-grid"],[1,"metric-card","revenue"],[1,"metric-content"],[1,"metric-icon","revenue"],[1,"pi","pi-dollar"],[1,"metric-info"],[1,"metric-label"],[1,"metric-value"],[1,"metric-period"],[1,"metric-card","bookings"],[1,"metric-icon","bookings"],[1,"pi","pi-calendar-check"],[1,"metric-card","occupancy"],[1,"metric-icon","occupancy"],[1,"pi","pi-chart-bar"],[1,"metric-card","rating"],[1,"metric-icon","rating"],[1,"pi","pi-star"],[1,"metric-card","guests"],[1,"metric-icon","guests"],[1,"pi","pi-users"],[1,"metric-card","apartments"],[1,"metric-icon","apartments"],[1,"pi","pi-home"],[1,"charts-grid"],["header","Revenue Trend"],[1,"chart-container"],["type","line",3,"data","options"],["header","Occupancy Trend"],["header","Quick Actions"],[1,"quick-actions"],["pButton","","type","button","label","View Bookings","icon","pi pi-calendar","routerLink","/hotel/bookings",1,"p-button-outlined"],["pButton","","type","button","label","View Revenue","icon","pi pi-chart-line","routerLink","/hotel/analytics/revenue",1,"p-button-outlined"],["pButton","","type","button","label","View Occupancy","icon","pi pi-chart-bar","routerLink","/hotel/analytics/occupancy",1,"p-button-outlined"],["pButton","","type","button","label","View Customers","icon","pi pi-users","routerLink","/hotel/analytics/customers",1,"p-button-outlined"],[1,"loading-container"],["height","200px","styleClass","mb-3"],["height","400px"]],template:function(i,g){if(1&i){const n=t.RV6();t.j41(0,"div",1),t.nrm(1,"p-toast"),t.j41(2,"div",2)(3,"div",3)(4,"div")(5,"h1"),t.EFF(6,"Analytics Dashboard"),t.k0s(),t.j41(7,"p",4),t.EFF(8,"Overview of hotel performance and key metrics"),t.k0s()(),t.j41(9,"div",5)(10,"button",6),t.bIt("click",function(){return t.eBV(n),t.Njj(g.loadData())}),t.k0s()()()(),t.DNE(11,k,70,14,"div",7)(12,y,7,4,"div",8)(13,D,6,0,"p-card",9)(14,E,3,0,"ng-template",null,0,t.C5r),t.k0s()}if(2&i){const n=t.sdS(15);t.R7$(11),t.Y8G("ngIf",!g.loading)("ngIfElse",n),t.R7$(),t.Y8G("ngIf",!g.loading),t.R7$(),t.Y8G("ngIf",!g.loading)}},dependencies:[p.MD,p.bT,p.QX,p.oe,v.YN,u.iI,u.Wk,_.tm,_._f,C.Dw,C.Zp,O.Fr,O.X9,b.MB,b.y8,M.k2,M.EA],styles:[".dashboard-page[_ngcontent-%COMP%]{padding:2rem}.dashboard-page[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem;background:linear-gradient(135deg,var(--p-surface-0) 0%,rgba(var(--p-primary-500),.05) 100%);padding:2rem;border-radius:12px;border-bottom:2px solid rgba(var(--p-primary-500),.2)}.dashboard-page[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:space-between;align-items:center}.dashboard-page[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:2rem;font-weight:700;color:var(--p-surface-900)}.dashboard-page[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{margin:0;font-size:.95rem;color:var(--p-surface-600)}.dashboard-page[_ngcontent-%COMP%]   .metrics-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:1.5rem;margin-bottom:2rem}.dashboard-page[_ngcontent-%COMP%]   .metrics-grid[_ngcontent-%COMP%]   .metric-card[_ngcontent-%COMP%]   .metric-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1.5rem;padding:1rem}.dashboard-page[_ngcontent-%COMP%]   .metrics-grid[_ngcontent-%COMP%]   .metric-card[_ngcontent-%COMP%]   .metric-content[_ngcontent-%COMP%]   .metric-icon[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:1.5rem;color:#fff}.dashboard-page[_ngcontent-%COMP%]   .metrics-grid[_ngcontent-%COMP%]   .metric-card[_ngcontent-%COMP%]   .metric-content[_ngcontent-%COMP%]   .metric-icon.revenue[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b82f6,#2563eb)}.dashboard-page[_ngcontent-%COMP%]   .metrics-grid[_ngcontent-%COMP%]   .metric-card[_ngcontent-%COMP%]   .metric-content[_ngcontent-%COMP%]   .metric-icon.bookings[_ngcontent-%COMP%]{background:linear-gradient(135deg,#22c55e,#16a34a)}.dashboard-page[_ngcontent-%COMP%]   .metrics-grid[_ngcontent-%COMP%]   .metric-card[_ngcontent-%COMP%]   .metric-content[_ngcontent-%COMP%]   .metric-icon.occupancy[_ngcontent-%COMP%]{background:linear-gradient(135deg,#06b6d4,#0891b2)}.dashboard-page[_ngcontent-%COMP%]   .metrics-grid[_ngcontent-%COMP%]   .metric-card[_ngcontent-%COMP%]   .metric-content[_ngcontent-%COMP%]   .metric-icon.rating[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f59e0b,#d97706)}.dashboard-page[_ngcontent-%COMP%]   .metrics-grid[_ngcontent-%COMP%]   .metric-card[_ngcontent-%COMP%]   .metric-content[_ngcontent-%COMP%]   .metric-icon.guests[_ngcontent-%COMP%]{background:linear-gradient(135deg,#a855f7,#9333ea)}.dashboard-page[_ngcontent-%COMP%]   .metrics-grid[_ngcontent-%COMP%]   .metric-card[_ngcontent-%COMP%]   .metric-content[_ngcontent-%COMP%]   .metric-icon.apartments[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f97316,#ea580c)}.dashboard-page[_ngcontent-%COMP%]   .metrics-grid[_ngcontent-%COMP%]   .metric-card[_ngcontent-%COMP%]   .metric-content[_ngcontent-%COMP%]   .metric-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1}.dashboard-page[_ngcontent-%COMP%]   .metrics-grid[_ngcontent-%COMP%]   .metric-card[_ngcontent-%COMP%]   .metric-content[_ngcontent-%COMP%]   .metric-info[_ngcontent-%COMP%]   .metric-label[_ngcontent-%COMP%]{font-size:.85rem;color:var(--p-surface-600);margin-bottom:.25rem}.dashboard-page[_ngcontent-%COMP%]   .metrics-grid[_ngcontent-%COMP%]   .metric-card[_ngcontent-%COMP%]   .metric-content[_ngcontent-%COMP%]   .metric-info[_ngcontent-%COMP%]   .metric-value[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:700;color:var(--p-surface-900);margin-bottom:.25rem}.dashboard-page[_ngcontent-%COMP%]   .metrics-grid[_ngcontent-%COMP%]   .metric-card[_ngcontent-%COMP%]   .metric-content[_ngcontent-%COMP%]   .metric-info[_ngcontent-%COMP%]   .metric-period[_ngcontent-%COMP%]{font-size:.75rem;color:var(--p-surface-500)}.dashboard-page[_ngcontent-%COMP%]   .charts-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:2rem;margin-bottom:2rem}@media (max-width: 1024px){.dashboard-page[_ngcontent-%COMP%]   .charts-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.dashboard-page[_ngcontent-%COMP%]   .charts-grid[_ngcontent-%COMP%]   .chart-container[_ngcontent-%COMP%]{height:300px;position:relative}.dashboard-page[_ngcontent-%COMP%]   .quick-actions[_ngcontent-%COMP%]{display:flex;gap:1rem;flex-wrap:wrap}.dashboard-page[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]{padding:2rem}"]})}return o})()}}]);