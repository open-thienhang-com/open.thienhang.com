"use strict";(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[9711],{491:(L,$,r)=>{r.d($,{Dw:()=>m,Zp:()=>p});var h=r(2881),t=r(1360),k=r(9744),M=r(5779),T=r(3491),B=r(6263);const o=["header"],y=["title"],w=["subtitle"],U=["content"],I=["footer"],F=["*",[["p-header"]],[["p-footer"]]],l=["*","p-header","p-footer"];function G(n,v){1&n&&t.eu8(0)}function e(n,v){if(1&n&&(t.j41(0,"div",8),t.SdG(1,1),t.DNE(2,G,1,0,"ng-container",6),t.k0s()),2&n){const c=t.XpG();t.R7$(2),t.Y8G("ngTemplateOutlet",c.headerTemplate||c._headerTemplate)}}function D(n,v){if(1&n&&(t.qex(0),t.EFF(1),t.bVm()),2&n){const c=t.XpG(2);t.R7$(),t.JRh(c.header)}}function E(n,v){1&n&&t.eu8(0)}function j(n,v){if(1&n&&(t.j41(0,"div",9),t.DNE(1,D,2,1,"ng-container",10)(2,E,1,0,"ng-container",6),t.k0s()),2&n){const c=t.XpG();t.R7$(),t.Y8G("ngIf",c.header&&!c._titleTemplate&&!c.titleTemplate),t.R7$(),t.Y8G("ngTemplateOutlet",c.titleTemplate||c._titleTemplate)}}function a(n,v){if(1&n&&(t.qex(0),t.EFF(1),t.bVm()),2&n){const c=t.XpG(2);t.R7$(),t.JRh(c.subheader)}}function A(n,v){1&n&&t.eu8(0)}function d(n,v){if(1&n&&(t.j41(0,"div",11),t.DNE(1,a,2,1,"ng-container",10)(2,A,1,0,"ng-container",6),t.k0s()),2&n){const c=t.XpG();t.R7$(),t.Y8G("ngIf",c.subheader&&!c._subtitleTemplate&&!c.subtitleTemplate),t.R7$(),t.Y8G("ngTemplateOutlet",c.subtitleTemplate||c._subtitleTemplate)}}function C(n,v){1&n&&t.eu8(0)}function f(n,v){1&n&&t.eu8(0)}function _(n,v){if(1&n&&(t.j41(0,"div",12),t.SdG(1,2),t.DNE(2,f,1,0,"ng-container",6),t.k0s()),2&n){const c=t.XpG();t.R7$(2),t.Y8G("ngTemplateOutlet",c.footerTemplate||c._footerTemplate)}}const R=({dt:n})=>`\n.p-card {\n    background: ${n("card.background")};\n    color: ${n("card.color")};\n    box-shadow: ${n("card.shadow")};\n    border-radius: ${n("card.border.radius")};\n    display: flex;\n    flex-direction: column;\n}\n\n.p-card-caption {\n    display: flex;\n    flex-direction: column;\n    gap: ${n("card.caption.gap")};\n}\n\n.p-card-body {\n    padding: ${n("card.body.padding")};\n    display: flex;\n    flex-direction: column;\n    gap: ${n("card.body.gap")};\n}\n\n.p-card-title {\n    font-size: ${n("card.title.font.size")};\n    font-weight: ${n("card.title.font.weight")};\n}\n\n.p-card-subtitle {\n    color: ${n("card.subtitle.color")};\n}\n`,s={root:"p-card p-component",header:"p-card-header",body:"p-card-body",caption:"p-card-caption",title:"p-card-title",subtitle:"p-card-subtitle",content:"p-card-content",footer:"p-card-footer"};let u=(()=>{class n extends B.j{name="card";theme=R;classes=s;static \u0275fac=(()=>{let c;return function(i){return(c||(c=t.xGo(n)))(i||n)}})();static \u0275prov=t.jDH({token:n,factory:n.\u0275fac})}return n})(),p=(()=>{class n extends T.${header;subheader;set style(c){(0,k.aI)(this._style(),c)||this._style.set(c)}styleClass;headerFacet;footerFacet;headerTemplate;titleTemplate;subtitleTemplate;contentTemplate;footerTemplate;_headerTemplate;_titleTemplate;_subtitleTemplate;_contentTemplate;_footerTemplate;_style=(0,t.vPA)(null);_componentStyle=(0,t.WQX)(u);getBlockableElement(){return this.el.nativeElement.children[0]}templates;ngAfterContentInit(){this.templates.forEach(c=>{switch(c.getType()){case"header":this._headerTemplate=c.template;break;case"title":this._titleTemplate=c.template;break;case"subtitle":this._subtitleTemplate=c.template;break;case"content":default:this._contentTemplate=c.template;break;case"footer":this._footerTemplate=c.template}})}static \u0275fac=(()=>{let c;return function(i){return(c||(c=t.xGo(n)))(i||n)}})();static \u0275cmp=t.VBU({type:n,selectors:[["p-card"]],contentQueries:function(P,i,b){if(1&P&&(t.wni(b,M.Y9,5),t.wni(b,M.wi,5),t.wni(b,o,4),t.wni(b,y,4),t.wni(b,w,4),t.wni(b,U,4),t.wni(b,I,4),t.wni(b,M.Ei,4)),2&P){let O;t.mGM(O=t.lsd())&&(i.headerFacet=O.first),t.mGM(O=t.lsd())&&(i.footerFacet=O.first),t.mGM(O=t.lsd())&&(i.headerTemplate=O.first),t.mGM(O=t.lsd())&&(i.titleTemplate=O.first),t.mGM(O=t.lsd())&&(i.subtitleTemplate=O.first),t.mGM(O=t.lsd())&&(i.contentTemplate=O.first),t.mGM(O=t.lsd())&&(i.footerTemplate=O.first),t.mGM(O=t.lsd())&&(i.templates=O)}},inputs:{header:"header",subheader:"subheader",style:"style",styleClass:"styleClass"},features:[t.Jv_([u]),t.Vt3],ngContentSelectors:l,decls:9,vars:10,consts:[[3,"ngClass","ngStyle"],["class","p-card-header",4,"ngIf"],[1,"p-card-body"],["class","p-card-title",4,"ngIf"],["class","p-card-subtitle",4,"ngIf"],[1,"p-card-content"],[4,"ngTemplateOutlet"],["class","p-card-footer",4,"ngIf"],[1,"p-card-header"],[1,"p-card-title"],[4,"ngIf"],[1,"p-card-subtitle"],[1,"p-card-footer"]],template:function(P,i){1&P&&(t.NAR(F),t.j41(0,"div",0),t.DNE(1,e,3,1,"div",1),t.j41(2,"div",2),t.DNE(3,j,3,2,"div",3)(4,d,3,2,"div",4),t.j41(5,"div",5),t.SdG(6),t.DNE(7,C,1,0,"ng-container",6),t.k0s(),t.DNE(8,_,3,1,"div",7),t.k0s()()),2&P&&(t.HbH(i.styleClass),t.Y8G("ngClass","p-card p-component")("ngStyle",i._style()),t.BMQ("data-pc-name","card"),t.R7$(),t.Y8G("ngIf",i.headerFacet||i.headerTemplate||i._headerTemplate),t.R7$(2),t.Y8G("ngIf",i.header||i.titleTemplate||i._titleTemplate),t.R7$(),t.Y8G("ngIf",i.subheader||i.subtitleTemplate||i._subtitleTemplate),t.R7$(3),t.Y8G("ngTemplateOutlet",i.contentTemplate||i._contentTemplate),t.R7$(),t.Y8G("ngIf",i.footerFacet||i.footerTemplate||i._footerTemplate))},dependencies:[h.MD,h.YU,h.bT,h.T3,h.B3,M.Gg],encapsulation:2,changeDetection:0})}return n})(),m=(()=>{class n{static \u0275fac=function(P){return new(P||n)};static \u0275mod=t.$C({type:n});static \u0275inj=t.G2t({imports:[p,M.Gg,M.Gg]})}return n})()},935:(L,$,r)=>{r.d($,{$C:()=>j,vw:()=>E});var h=r(2881),t=r(1360),k=r(5779),M=r(3491),T=r(6263);const B=["icon"],o=["*"];function y(a,A){if(1&a&&t.nrm(0,"span",4),2&a){const d=t.XpG(2);t.Y8G("ngClass",d.icon)}}function w(a,A){if(1&a&&(t.qex(0),t.DNE(1,y,1,1,"span",3),t.bVm()),2&a){const d=t.XpG();t.R7$(),t.Y8G("ngIf",d.icon)}}function U(a,A){}function I(a,A){1&a&&t.DNE(0,U,0,0,"ng-template")}function F(a,A){if(1&a&&(t.j41(0,"span",5),t.DNE(1,I,1,0,null,6),t.k0s()),2&a){const d=t.XpG();t.R7$(),t.Y8G("ngTemplateOutlet",d.iconTemplate||d._iconTemplate)}}const l=({dt:a})=>`\n.p-tag {\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n    background: ${a("tag.primary.background")};\n    color: ${a("tag.primary.color")};\n    font-size: ${a("tag.font.size")};\n    font-weight: ${a("tag.font.weight")};\n    padding: ${a("tag.padding")};\n    border-radius: ${a("tag.border.radius")};\n    gap: ${a("tag.gap")};\n}\n\n.p-tag-icon {\n    font-size: ${a("tag.icon.size")};\n    width: ${a("tag.icon.size")};\n    height:${a("tag.icon.size")};\n}\n\n.p-tag-rounded {\n    border-radius: ${a("tag.rounded.border.radius")};\n}\n\n.p-tag-success {\n    background: ${a("tag.success.background")};\n    color: ${a("tag.success.color")};\n}\n\n.p-tag-info {\n    background: ${a("tag.info.background")};\n    color: ${a("tag.info.color")};\n}\n\n.p-tag-warn {\n    background: ${a("tag.warn.background")};\n    color: ${a("tag.warn.color")};\n}\n\n.p-tag-danger {\n    background: ${a("tag.danger.background")};\n    color: ${a("tag.danger.color")};\n}\n\n.p-tag-secondary {\n    background: ${a("tag.secondary.background")};\n    color: ${a("tag.secondary.color")};\n}\n\n.p-tag-contrast {\n    background: ${a("tag.contrast.background")};\n    color: ${a("tag.contrast.color")};\n}\n`,G={root:({props:a})=>["p-tag p-component",{"p-tag-info":"info"===a.severity,"p-tag-success":"success"===a.severity,"p-tag-warn":"warn"===a.severity,"p-tag-danger":"danger"===a.severity,"p-tag-secondary":"secondary"===a.severity,"p-tag-contrast":"contrast"===a.severity,"p-tag-rounded":a.rounded}],icon:"p-tag-icon",label:"p-tag-label"};let e=(()=>{class a extends T.j{name="tag";theme=l;classes=G;static \u0275fac=(()=>{let d;return function(f){return(d||(d=t.xGo(a)))(f||a)}})();static \u0275prov=t.jDH({token:a,factory:a.\u0275fac})}return a})(),E=(()=>{class a extends M.${get style(){return this._style}set style(d){this._style=d,this.cd.markForCheck()}styleClass;severity;value;icon;rounded;iconTemplate;templates;_iconTemplate;_style;_componentStyle=(0,t.WQX)(e);ngAfterContentInit(){this.templates?.forEach(d=>{"icon"===d.getType()&&(this._iconTemplate=d.template)})}containerClass(){let d="p-tag p-component";return this.severity&&(d+=` p-tag-${this.severity}`),this.rounded&&(d+=" p-tag-rounded"),this.styleClass&&(d+=` ${this.styleClass}`),d}static \u0275fac=(()=>{let d;return function(f){return(d||(d=t.xGo(a)))(f||a)}})();static \u0275cmp=t.VBU({type:a,selectors:[["p-tag"]],contentQueries:function(C,f,_){if(1&C&&(t.wni(_,B,4),t.wni(_,k.Ei,4)),2&C){let R;t.mGM(R=t.lsd())&&(f.iconTemplate=R.first),t.mGM(R=t.lsd())&&(f.templates=R)}},hostVars:4,hostBindings:function(C,f){2&C&&(t.Aen(f.style),t.HbH(f.containerClass()))},inputs:{style:"style",styleClass:"styleClass",severity:"severity",value:"value",icon:"icon",rounded:[2,"rounded","rounded",t.L39]},features:[t.Jv_([e]),t.Vt3],ngContentSelectors:o,decls:5,vars:3,consts:[[4,"ngIf"],["class","p-tag-icon",4,"ngIf"],[1,"p-tag-label"],["class","p-tag-icon",3,"ngClass",4,"ngIf"],[1,"p-tag-icon",3,"ngClass"],[1,"p-tag-icon"],[4,"ngTemplateOutlet"]],template:function(C,f){1&C&&(t.NAR(),t.SdG(0),t.DNE(1,w,2,1,"ng-container",0)(2,F,2,1,"span",1),t.j41(3,"span",2),t.EFF(4),t.k0s()),2&C&&(t.R7$(),t.Y8G("ngIf",!f.iconTemplate&&!f._iconTemplate),t.R7$(),t.Y8G("ngIf",f.iconTemplate||f._iconTemplate),t.R7$(2),t.JRh(f.value))},dependencies:[h.MD,h.YU,h.bT,h.T3,k.Gg],encapsulation:2,changeDetection:0})}return a})(),j=(()=>{class a{static \u0275fac=function(C){return new(C||a)};static \u0275mod=t.$C({type:a});static \u0275inj=t.G2t({imports:[E,k.Gg,k.Gg]})}return a})()},5545:(L,$,r)=>{r.d($,{g:()=>M});var h=r(4754),t=r(1360),k=r(8989);let M=(()=>{class T{http;baseUrl=`${(0,h.Gi)()}/data-mesh/domains/hotel`;constructor(o){this.http=o}createApartment(o){return this.http.post(`${this.baseUrl}/apartments`,o)}getApartments(){return this.http.get(`${this.baseUrl}/apartments`)}getApartmentById(o){return this.http.get(`${this.baseUrl}/apartments/${o}`)}updateApartment(o,y){return this.http.put(`${this.baseUrl}/apartments/${o}`,y)}deleteApartment(o){return this.http.delete(`${this.baseUrl}/apartments/${o}`)}createRoom(o){return this.http.post(`${this.baseUrl}/rooms/room`,o)}getRooms(){return this.http.get(`${this.baseUrl}/rooms/rooms`)}getRoomById(o){return this.http.get(`${this.baseUrl}/rooms/room/${o}`)}updateRoom(o,y){return this.http.put(`${this.baseUrl}/rooms/room/${o}`,y)}deleteRoom(o){return this.http.delete(`${this.baseUrl}/rooms/room/${o}`)}createBooking(o){return this.http.post(`${this.baseUrl}/bookings/booking`,o)}getBookingById(o){return this.http.get(`${this.baseUrl}/bookings/booking/${o}`)}getBookings(){return this.http.get(`${this.baseUrl}/bookings/bookings`)}updateBooking(o,y){return this.http.put(`${this.baseUrl}/bookings/booking/${o}`,y)}deleteBooking(o){return this.http.delete(`${this.baseUrl}/bookings/booking/${o}`)}cancelBooking(o){return this.http.patch(`${this.baseUrl}/bookings/booking/${o}/cancel`,{})}createReview(o){return this.http.post(`${this.baseUrl}/reviews/review`,o)}getReviewById(o){return this.http.get(`${this.baseUrl}/reviews/review/${o}`)}getReviews(){return this.http.get(`${this.baseUrl}/reviews/reviews`)}getReviewsByApartment(o){return this.http.get(`${this.baseUrl}/reviews/reviews?apartment_id=${o}`)}updateReview(o,y){return this.http.put(`${this.baseUrl}/reviews/review/${o}`,y)}deleteReview(o){return this.http.delete(`${this.baseUrl}/reviews/review/${o}`)}createRating(o){return this.http.post(`${this.baseUrl}/ratings/rating`,o)}getRatingById(o){return this.http.get(`${this.baseUrl}/ratings/rating/${o}`)}getRatings(){return this.http.get(`${this.baseUrl}/ratings/ratings`)}getRatingsByApartment(o){return this.http.get(`${this.baseUrl}/ratings/ratings?apartment_id=${o}`)}getRoomsByApartment(o){return this.http.get(`${this.baseUrl}/rooms/rooms?apartment_id=${o}`)}updateRating(o,y){return this.http.put(`${this.baseUrl}/ratings/rating/${o}`,y)}deleteRating(o){return this.http.delete(`${this.baseUrl}/ratings/rating/${o}`)}healthCheck(){return this.http.get(`${this.baseUrl}/health/`)}getVersion(){return this.http.get(`${this.baseUrl}/version`)}static \u0275fac=function(y){return new(y||T)(t.KVO(k.Qq))};static \u0275prov=t.jDH({token:T,factory:T.\u0275fac,providedIn:"root"})}return T})()},5716:(L,$,r)=>{r.d($,{EA:()=>I,k2:()=>F});var h=r(2881),t=r(1360),k=r(5779),M=r(3491),T=r(6263);const B=({dt:l})=>`\n.p-skeleton {\n    overflow: hidden;\n    background: ${l("skeleton.background")};\n    border-radius: ${l("skeleton.border.radius")};\n}\n\n.p-skeleton::after {\n    content: "";\n    animation: p-skeleton-animation 1.2s infinite;\n    height: 100%;\n    left: 0;\n    position: absolute;\n    right: 0;\n    top: 0;\n    transform: translateX(-100%);\n    z-index: 1;\n    background: linear-gradient(90deg, rgba(255, 255, 255, 0), ${l("skeleton.animation.background")}, rgba(255, 255, 255, 0));\n}\n\n[dir='rtl'] .p-skeleton::after {\n    animation-name: p-skeleton-animation-rtl;\n}\n\n.p-skeleton-circle {\n    border-radius: 50%;\n}\n\n.p-skeleton-animation-none::after {\n    animation: none;\n}\n\n@keyframes p-skeleton-animation {\n    from {\n        transform: translateX(-100%);\n    }\n    to {\n        transform: translateX(100%);\n    }\n}\n\n@keyframes p-skeleton-animation-rtl {\n    from {\n        transform: translateX(100%);\n    }\n    to {\n        transform: translateX(-100%);\n    }\n}\n`,o={root:{position:"relative"}},y={root:({props:l})=>["p-skeleton p-component",{"p-skeleton-circle":"circle"===l.shape,"p-skeleton-animation-none":"none"===l.animation}]};let w=(()=>{class l extends T.j{name="skeleton";theme=B;classes=y;inlineStyles=o;static \u0275fac=(()=>{let e;return function(E){return(e||(e=t.xGo(l)))(E||l)}})();static \u0275prov=t.jDH({token:l,factory:l.\u0275fac})}return l})(),I=(()=>{class l extends M.${styleClass;style;shape="rectangle";animation="wave";borderRadius;size;width="100%";height="1rem";_componentStyle=(0,t.WQX)(w);containerClass(){return{"p-skeleton p-component":!0,"p-skeleton-circle":"circle"===this.shape,"p-skeleton-animation-none":"none"===this.animation}}get containerStyle(){const e=this._componentStyle?.inlineStyles.root;let D;return D=this.size?{...this.style,...e,width:this.size,height:this.size,borderRadius:this.borderRadius}:{...e,width:this.width,height:this.height,borderRadius:this.borderRadius,...this.style},D}static \u0275fac=(()=>{let e;return function(E){return(e||(e=t.xGo(l)))(E||l)}})();static \u0275cmp=t.VBU({type:l,selectors:[["p-skeleton"]],inputs:{styleClass:"styleClass",style:"style",shape:"shape",animation:"animation",borderRadius:"borderRadius",size:"size",width:"width",height:"height"},features:[t.Jv_([w]),t.Vt3],decls:1,vars:7,consts:[[3,"ngClass","ngStyle"]],template:function(D,E){1&D&&t.nrm(0,"div",0),2&D&&(t.HbH(E.styleClass),t.Y8G("ngClass",E.containerClass())("ngStyle",E.containerStyle),t.BMQ("data-pc-name","skeleton")("aria-hidden",!0)("data-pc-section","root"))},dependencies:[h.MD,h.YU,h.B3,k.Gg],encapsulation:2,changeDetection:0})}return l})(),F=(()=>{class l{static \u0275fac=function(D){return new(D||l)};static \u0275mod=t.$C({type:l});static \u0275inj=t.G2t({imports:[I,k.Gg,k.Gg]})}return l})()},9711:(L,$,r)=>{r.r($),r.d($,{OccupancyComponent:()=>f});var h=r(2881),t=r(9417),k=r(5207),M=r(1141),T=r(491),B=r(8150),o=r(8559),y=r(6221),w=r(6150),U=r(7722),I=r(5716),F=r(935),l=r(5779),G=r(5545),e=r(1360);const D=()=>[10,25,50];function E(_,R){if(1&_&&(e.j41(0,"p-card",14)(1,"div",15),e.nrm(2,"p-chart",16),e.k0s()()),2&_){const s=e.XpG();e.R7$(2),e.Y8G("data",s.occupancyChartData)("options",s.occupancyChartOptions)}}function j(_,R){1&_&&(e.j41(0,"tr")(1,"th"),e.EFF(2,"Apartment"),e.k0s(),e.j41(3,"th"),e.EFF(4,"Booked Days"),e.k0s(),e.j41(5,"th"),e.EFF(6,"Total Days"),e.k0s(),e.j41(7,"th"),e.EFF(8,"Occupancy Rate"),e.k0s(),e.j41(9,"th"),e.EFF(10,"Revenue"),e.k0s()())}function a(_,R){if(1&_&&(e.j41(0,"tr")(1,"td")(2,"span",22),e.EFF(3),e.k0s()(),e.j41(4,"td")(5,"span",23),e.EFF(6),e.k0s()(),e.j41(7,"td")(8,"span",24),e.EFF(9),e.k0s()(),e.j41(10,"td")(11,"div",25)(12,"div",26),e.nrm(13,"div",27),e.k0s(),e.nrm(14,"p-badge",28),e.nI1(15,"number"),e.k0s()(),e.j41(16,"td")(17,"span",29),e.EFF(18),e.nI1(19,"currency"),e.k0s()()()),2&_){const s=R.$implicit,u=e.XpG(2);e.R7$(3),e.JRh(s.apartment_name),e.R7$(3),e.JRh(s.bookedDays),e.R7$(3),e.JRh(s.totalDays),e.R7$(4),e.xc7("width",s.occupancyRate,"%"),e.Y8G("ngClass","bg-"+u.getOccupancySeverity(s.occupancyRate)),e.R7$(),e.Y8G("value",e.i5U(15,9,s.occupancyRate,"1.1-1%"))("severity",u.getOccupancySeverity(s.occupancyRate)),e.R7$(4),e.JRh(e.bMT(19,12,s.revenue))}}function A(_,R){1&_&&(e.j41(0,"tr")(1,"td",30)(2,"div",31),e.nrm(3,"i",32),e.j41(4,"p"),e.EFF(5,"No occupancy data available"),e.k0s()()()())}function d(_,R){if(1&_&&(e.j41(0,"p-card",17)(1,"p-table",18),e.DNE(2,j,11,0,"ng-template",19)(3,a,20,14,"ng-template",20)(4,A,6,0,"ng-template",21),e.k0s()()),2&_){const s=e.XpG();e.R7$(),e.Y8G("value",s.apartmentOccupancyData)("paginator",!0)("rows",10)("rowsPerPageOptions",e.lJ4(5,D))("showCurrentPageReport",!0)}}function C(_,R){1&_&&(e.j41(0,"div",33),e.nrm(1,"p-skeleton",34),e.k0s())}let f=(()=>{class _{hotelService;messageService;bookings=[];apartments=[];loading=!1;selectedPeriod="month";periodOptions=[{label:"Last 7 Days",value:"week"},{label:"Last 30 Days",value:"month"},{label:"Last 3 Months",value:"quarter"},{label:"Last Year",value:"year"}];occupancyChartData;occupancyChartOptions;apartmentOccupancyData=[];overallOccupancyRate=0;totalBookedDays=0;totalAvailableDays=0;averageOccupancyRate=0;constructor(s,u){this.hotelService=s,this.messageService=u}ngOnInit(){this.loadData()}loadData(){this.loading=!0,Promise.all([this.hotelService.getBookings().toPromise(),this.hotelService.getApartments().toPromise()]).then(([s,u])=>{this.bookings=s?.data||[],this.apartments=u?.data||[],this.processOccupancyData(),this.loading=!1}).catch(()=>{this.messageService.add({severity:"error",summary:"Error",detail:"Failed to load occupancy data"}),this.loading=!1})}processOccupancyData(){const s=this.getFilteredBookings();this.calculateOverallOccupancy(s),this.buildChartData(s),this.buildApartmentOccupancy(s)}getFilteredBookings(){const s=new Date;let u=new Date;switch(this.selectedPeriod){case"week":u.setDate(s.getDate()-7);break;case"month":u.setDate(s.getDate()-30);break;case"quarter":u.setMonth(s.getMonth()-3);break;case"year":u.setFullYear(s.getFullYear()-1)}return this.bookings.filter(g=>{const p=new Date(g.check_in),m=new Date(g.check_out);return p<=s&&m>=u&&"canceled"!==g.booking_status})}calculateOverallOccupancy(s){const u=this.getDaysInPeriod();this.totalAvailableDays=this.apartments.length*u;const p=new Map;s.forEach(m=>{const n=new Date(m.check_in),v=new Date(m.check_out),c=new Date(n);for(;c<=v;){const P=c.toISOString().split("T")[0];p.has(P)||p.set(P,new Set),p.get(P).add(m.apartment_id),c.setDate(c.getDate()+1)}}),this.totalBookedDays=Array.from(p.values()).reduce((m,n)=>m+n.size,0),this.overallOccupancyRate=this.totalAvailableDays>0?this.totalBookedDays/this.totalAvailableDays*100:0}getDaysInPeriod(){switch(this.selectedPeriod){case"week":return 7;case"month":default:return 30;case"quarter":return 90;case"year":return 365}}buildChartData(s){const u=this.getDaysInPeriod(),g=new Date,p=new Date;p.setDate(g.getDate()-u);const m=new Map,n=new Date(p);for(;n<=g;){const i=n.toISOString().split("T")[0];m.set(i,{booked:0,total:this.apartments.length}),n.setDate(n.getDate()+1)}s.forEach(i=>{const b=new Date(i.check_in),O=new Date(i.check_out),S=new Date(b);for(;S<=O&&S<=g;){const K=S.toISOString().split("T")[0],x=m.get(K);x&&x.booked++,S.setDate(S.getDate()+1)}});const v=Array.from(m.keys()).sort(),c=v.map(i=>{const b=m.get(i);return b.total>0?b.booked/b.total*100:0}),P=v.map(i=>m.get(i).booked);this.occupancyChartData={labels:v.map(i=>new Date(i).toLocaleDateString("en-US","year"===this.selectedPeriod?{month:"short",year:"numeric"}:{month:"short",day:"numeric"})),datasets:[{label:"Occupancy Rate (%)",data:c,fill:!0,backgroundColor:"rgba(34, 197, 94, 0.2)",borderColor:"rgb(34, 197, 94)",tension:.4,yAxisID:"y"},{label:"Booked Apartments",data:P,fill:!1,backgroundColor:"rgba(59, 130, 246, 0.2)",borderColor:"rgb(59, 130, 246)",tension:.4,yAxisID:"y1"}]},this.occupancyChartOptions={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},title:{display:!0,text:"Occupancy Rate Trend"}},scales:{y:{type:"linear",display:!0,position:"left",min:0,max:100,title:{display:!0,text:"Occupancy Rate (%)"}},y1:{type:"linear",display:!0,position:"right",title:{display:!0,text:"Number of Booked Apartments"},grid:{drawOnChartArea:!1}}}}}buildApartmentOccupancy(s){const u=this.getDaysInPeriod(),g=new Map;s.forEach(p=>{const m=new Date(p.check_in),n=new Date(p.check_out),v=Math.ceil((n.getTime()-m.getTime())/864e5)+1,c=g.get(p.apartment_id)||{bookedDays:0,revenue:0};g.set(p.apartment_id,{bookedDays:c.bookedDays+v,revenue:c.revenue+(p.total_price||0)})}),this.apartmentOccupancyData=Array.from(g.entries()).map(([p,m])=>({apartment_id:p,apartment_name:this.getApartmentName(p),totalDays:u,bookedDays:m.bookedDays,occupancyRate:m.bookedDays/u*100,revenue:m.revenue})).sort((p,m)=>m.occupancyRate-p.occupancyRate),this.apartmentOccupancyData.length>0&&(this.averageOccupancyRate=this.apartmentOccupancyData.reduce((p,m)=>p+m.occupancyRate,0)/this.apartmentOccupancyData.length)}onPeriodChange(){this.processOccupancyData()}getApartmentName(s){const u=this.apartments.find(g=>(g.id||g._id)===s);return u?u.title:s}getOccupancySeverity(s){return s>=80?"success":s>=60?"info":s>=40?"warning":"danger"}static \u0275fac=function(u){return new(u||_)(e.rXU(G.g),e.rXU(l.bg))};static \u0275cmp=e.VBU({type:_,selectors:[["app-hotel-occupancy"]],features:[e.Jv_([l.bg])],decls:43,vars:15,consts:[["loadingTemplate",""],[1,"occupancy-page"],[1,"page-header"],[1,"header-content"],[1,"subtitle"],[1,"header-actions"],["optionLabel","label","optionValue","value",1,"period-selector",3,"ngModelChange","onChange","options","ngModel"],["pButton","","type","button","label","Refresh","icon","pi pi-refresh",1,"p-button-secondary",3,"click"],[1,"summary-cards"],[1,"summary-stat"],[1,"stat-value"],[1,"stat-label"],["header","Occupancy Rate Trend",4,"ngIf","ngIfElse"],["header","Occupancy by Apartment",4,"ngIf"],["header","Occupancy Rate Trend"],[1,"chart-container"],["type","line",3,"data","options"],["header","Occupancy by Apartment"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} apartments","styleClass","p-datatable-sm",3,"value","paginator","rows","rowsPerPageOptions","showCurrentPageReport"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"apartment-name"],[1,"booked-days"],[1,"total-days"],[1,"occupancy-display"],[1,"occupancy-bar"],[1,"occupancy-fill",3,"ngClass"],[3,"value","severity"],[1,"revenue-amount"],["colspan","5",1,"text-center"],[1,"empty-state"],[1,"pi","pi-chart-bar"],[1,"loading-container"],["height","400px"]],template:function(u,g){if(1&u){const p=e.RV6();e.j41(0,"div",1),e.nrm(1,"p-toast"),e.j41(2,"div",2)(3,"div",3)(4,"div")(5,"h1"),e.EFF(6,"Occupancy Analytics"),e.k0s(),e.j41(7,"p",4),e.EFF(8,"Track apartment occupancy rates and utilization"),e.k0s()(),e.j41(9,"div",5)(10,"p-dropdown",6),e.mxI("ngModelChange",function(n){return e.eBV(p),e.DH7(g.selectedPeriod,n)||(g.selectedPeriod=n),e.Njj(n)}),e.bIt("onChange",function(){return e.eBV(p),e.Njj(g.onPeriodChange())}),e.k0s(),e.j41(11,"button",7),e.bIt("click",function(){return e.eBV(p),e.Njj(g.loadData())}),e.k0s()()()(),e.j41(12,"div",8)(13,"p-card")(14,"div",9)(15,"span",10),e.EFF(16),e.nI1(17,"number"),e.k0s(),e.j41(18,"span",11),e.EFF(19,"Overall Occupancy Rate"),e.k0s()()(),e.j41(20,"p-card")(21,"div",9)(22,"span",10),e.EFF(23),e.k0s(),e.j41(24,"span",11),e.EFF(25,"Total Booked Days"),e.k0s()()(),e.j41(26,"p-card")(27,"div",9)(28,"span",10),e.EFF(29),e.k0s(),e.j41(30,"span",11),e.EFF(31,"Total Available Days"),e.k0s()()(),e.j41(32,"p-card")(33,"div",9)(34,"span",10),e.EFF(35),e.nI1(36,"number"),e.k0s(),e.j41(37,"span",11),e.EFF(38,"Average Occupancy Rate"),e.k0s()()()(),e.DNE(39,E,3,2,"p-card",12)(40,d,5,6,"p-card",13)(41,C,2,0,"ng-template",null,0,e.C5r),e.k0s()}if(2&u){const p=e.sdS(42);e.R7$(10),e.Y8G("options",g.periodOptions),e.R50("ngModel",g.selectedPeriod),e.R7$(6),e.SpI("",e.i5U(17,9,g.overallOccupancyRate,"1.1-1"),"%"),e.R7$(7),e.JRh(g.totalBookedDays),e.R7$(6),e.JRh(g.totalAvailableDays),e.R7$(6),e.SpI("",e.i5U(36,12,g.averageOccupancyRate,"1.1-1"),"%"),e.R7$(4),e.Y8G("ngIf",!g.loading)("ngIfElse",p),e.R7$(),e.Y8G("ngIf",!g.loading)}},dependencies:[h.MD,h.YU,h.bT,h.QX,h.oe,t.YN,t.BC,t.vS,k.iI,M.tm,M._f,l.Ei,T.Dw,T.Zp,B.kr,B.ms,o.Fr,o.X9,y.bG,y.XI,w.EJ,w.Ex,U.MB,U.y8,I.k2,I.EA,F.$C],styles:[".occupancy-page[_ngcontent-%COMP%]{padding:2rem}.occupancy-page[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem;background:linear-gradient(135deg,var(--p-surface-0) 0%,rgba(var(--p-primary-500),.05) 100%);padding:2rem;border-radius:12px;border-bottom:2px solid rgba(var(--p-primary-500),.2)}.occupancy-page[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:space-between;align-items:center}.occupancy-page[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:2rem;font-weight:700;color:var(--p-surface-900)}.occupancy-page[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{margin:0;font-size:.95rem;color:var(--p-surface-600)}.occupancy-page[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;gap:1rem;align-items:center}.occupancy-page[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .period-selector[_ngcontent-%COMP%]{min-width:180px}.occupancy-page[_ngcontent-%COMP%]   .summary-cards[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:1.5rem;margin-bottom:2rem}.occupancy-page[_ngcontent-%COMP%]   .summary-cards[_ngcontent-%COMP%]   p-card[_ngcontent-%COMP%]   .summary-stat[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:1rem}.occupancy-page[_ngcontent-%COMP%]   .summary-cards[_ngcontent-%COMP%]   p-card[_ngcontent-%COMP%]   .summary-stat[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;color:var(--p-primary-600)}.occupancy-page[_ngcontent-%COMP%]   .summary-cards[_ngcontent-%COMP%]   p-card[_ngcontent-%COMP%]   .summary-stat[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{font-size:.85rem;color:var(--p-surface-600);margin-top:.5rem}.occupancy-page[_ngcontent-%COMP%]   .chart-container[_ngcontent-%COMP%]{height:400px;position:relative}.occupancy-page[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]{padding:2rem}.occupancy-page[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{padding:3rem;text-align:center;color:var(--p-surface-600)}.occupancy-page[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:3rem;margin-bottom:1rem;color:var(--p-surface-400)}.occupancy-page[_ngcontent-%COMP%]   .apartment-name[_ngcontent-%COMP%]{font-weight:500}.occupancy-page[_ngcontent-%COMP%]   .booked-days[_ngcontent-%COMP%], .occupancy-page[_ngcontent-%COMP%]   .total-days[_ngcontent-%COMP%]{font-weight:600;color:var(--p-surface-700)}.occupancy-page[_ngcontent-%COMP%]   .revenue-amount[_ngcontent-%COMP%]{font-weight:600;color:var(--p-primary-600)}.occupancy-page[_ngcontent-%COMP%]   .occupancy-display[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.occupancy-page[_ngcontent-%COMP%]   .occupancy-display[_ngcontent-%COMP%]   .occupancy-bar[_ngcontent-%COMP%]{flex:1;height:8px;background:var(--p-surface-200);border-radius:4px;overflow:hidden}.occupancy-page[_ngcontent-%COMP%]   .occupancy-display[_ngcontent-%COMP%]   .occupancy-bar[_ngcontent-%COMP%]   .occupancy-fill[_ngcontent-%COMP%]{height:100%;transition:width .3s ease}.occupancy-page[_ngcontent-%COMP%]   .occupancy-display[_ngcontent-%COMP%]   .occupancy-bar[_ngcontent-%COMP%]   .occupancy-fill.bg-success[_ngcontent-%COMP%]{background:var(--p-success-500)}.occupancy-page[_ngcontent-%COMP%]   .occupancy-display[_ngcontent-%COMP%]   .occupancy-bar[_ngcontent-%COMP%]   .occupancy-fill.bg-info[_ngcontent-%COMP%]{background:var(--p-primary-500)}.occupancy-page[_ngcontent-%COMP%]   .occupancy-display[_ngcontent-%COMP%]   .occupancy-bar[_ngcontent-%COMP%]   .occupancy-fill.bg-warning[_ngcontent-%COMP%]{background:var(--p-warning-500)}.occupancy-page[_ngcontent-%COMP%]   .occupancy-display[_ngcontent-%COMP%]   .occupancy-bar[_ngcontent-%COMP%]   .occupancy-fill.bg-danger[_ngcontent-%COMP%]{background:var(--p-danger-500)}"]})}return _})()}}]);